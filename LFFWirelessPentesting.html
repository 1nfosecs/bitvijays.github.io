<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-92365403-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
    <title>Learning from the field : Wireless Pentesting &#8212; tech.bitvijays.com</title>
    
    <link rel="stylesheet" href="_static/pyramid.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="search" title="Search" href="search.html" />
    <link rel="top" title="tech.bitvijays.com" href="index.html" />
    <link rel="next" title="Learning from the CTF : Reverse Engineering" href="LFCReverseEngineering.html" />
    <link rel="prev" title="Learning from the field : Reconnaissance - Information Gathering" href="LFFInformationGathering.html" />
<!--[if lte IE 6]>
<link rel="stylesheet" href="_static/ie6.css" type="text/css" media="screen" charset="utf-8" />
<![endif]-->

  </head>
  <body role="document">

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="LFCReverseEngineering.html" title="Learning from the CTF : Reverse Engineering"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="LFFInformationGathering.html" title="Learning from the field : Reconnaissance - Information Gathering"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">tech.bitvijays.com</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="learning-from-the-field-wireless-pentesting">
<h1>Learning from the field : Wireless Pentesting<a class="headerlink" href="#learning-from-the-field-wireless-pentesting" title="Permalink to this headline">¶</a></h1>
<p>Recently, We got a chance to do some penetration testing. This post would cover the basics and approach.</p>
<p><strong>Thanks to Girish Nemade</strong></p>
<p>Basic wireless network tests could be performed by using your wireless adapter installed in your laptop. However, few external USB cards are suggested by Offsec such as</p>
<ul class="simple">
<li>Netgear WN111v2 USB</li>
<li>ALFA Networks AWUS036H USB 500mW</li>
</ul>
<blockquote>
<div>which provide a better area coverage.</div></blockquote>
<div class="section" id="basics">
<h2>Basics<a class="headerlink" href="#basics" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li>Set the wireless interface in the monitor mode.</li>
</ol>
<blockquote>
<div><div class="highlight-bash"><div class="highlight"><pre><span></span>airmon-ng &lt;start<span class="p">|</span>stop&gt; &lt;interface&gt; <span class="o">[</span>channel<span class="o">]</span> : Enable monitor mode on an interface <span class="o">(</span>and specify a channel<span class="o">)</span>.
airmon-ng &lt;check&gt; <span class="o">[</span>kill<span class="o">]</span>                     : List all possible programs that could interfere with the wireless card. If <span class="s1">&#39;kill&#39;</span> is specified, it will try to <span class="nb">kill</span> all of them.
</pre></div>
</div>
</div></blockquote>
<ol class="arabic simple">
<li>use airodump</li>
</ol>
<blockquote>
<div><div class="highlight-bash"><div class="highlight"><pre><span></span>airodump &lt;monitor interface&gt;
   -N, --essid                 : Filter APs by ESSID.                                  <span class="c1">##Name of the Access Point</span>
   -d &lt;bssid&gt;, --bssid &lt;bssid&gt; : It will only show networks, matching the given bssid. <span class="c1">##MAC Address of Access Point</span>
   -a                          : It will only show associated clients.
   -t &lt;OPN<span class="p">|</span>WEP<span class="p">|</span>WPA<span class="p">|</span>WPA1<span class="p">|</span>WPA2&gt;, --encrypt &lt;OPN<span class="p">|</span>WEP<span class="p">|</span>WPA<span class="p">|</span>WPA1<span class="p">|</span>WPA2&gt; : It will only show networks matching the given encryption.
   -R, --essid-regex              Filter APs by ESSID using a regular expression
</pre></div>
</div>
</div></blockquote>
<ol class="arabic simple">
<li>OPEN If there is no MAC authentication, and dhcp enabled, your machine would connect automatically. If there is no MAC authentication but dhcp is not enabled, it is advisable to sniff the network using wireshark and find the appropiate network range and the default gateway and set them manually. If there is MAC authentication and DHCP not enabled, you need to find valid associated clients. The catch is the valid associated clients will have an IP address whereas invalid associated clients will not have the IP address.</li>
</ol>
<blockquote>
<div><p>Find the associated clients connected to the particular access point by using the csv file produced by airodump. In the below example the access point is &#8220;24:DE:C6:C7:92:C2&#8221;.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>cat PL-01.csv <span class="p">|</span> grep <span class="m">24</span>:DE:C6:C7:92:C2 <span class="p">|</span> cut -d , -f <span class="m">1</span>,6 <span class="p">|</span> grep -v OPN
</pre></div>
</div>
<p>You may change your ip address of wireless adapter using</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>ifconfig wlan4 hw ether <span class="m">30</span>:5A:3A:B4:09:BC
</pre></div>
</div>
<p>or</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">macchanger</span>
       <span class="o">-</span><span class="n">m</span><span class="p">,</span>  <span class="o">--</span><span class="n">mac</span><span class="o">=</span><span class="n">XX</span><span class="p">:</span><span class="n">XX</span><span class="p">:</span><span class="n">XX</span><span class="p">:</span><span class="n">XX</span><span class="p">:</span><span class="n">XX</span><span class="p">:</span><span class="n">XX</span>
       <span class="o">--</span><span class="n">mac</span> <span class="n">XX</span><span class="p">:</span><span class="n">XX</span><span class="p">:</span><span class="n">XX</span><span class="p">:</span><span class="n">XX</span><span class="p">:</span><span class="n">XX</span><span class="p">:</span><span class="n">XX</span>  <span class="n">Set</span> <span class="n">the</span> <span class="n">MAC</span> <span class="n">XX</span><span class="p">:</span><span class="n">XX</span><span class="p">:</span><span class="n">XX</span><span class="p">:</span><span class="n">XX</span><span class="p">:</span><span class="n">XX</span><span class="p">:</span><span class="n">XX</span>
</pre></div>
</div>
<p>Once associated, we still need to find the valid IP address and valid MAC address, sniff the network, find the network ranges, gateway. Do a nmap Ping Scan to the local subnet which will provide IP address and MAC address. Cross-verify with the associated clients. Valid associated clients will have an IP address and MAC address entry in the airodump listing. Set the IP address using</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>ifconfig wlan4 <span class="m">10</span>.10.3.71 netmask <span class="m">255</span>.255.240.0
</pre></div>
</div>
<p>Set the association using</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>iwconfig wlan4 essid <span class="s2">&quot;ESSID_NAME&quot;</span> ap <span class="s2">&quot;24:DE:C6:C7:92:C2(SSID_MAC_Address)&quot;</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="wep">
<h2>WEP<a class="headerlink" href="#wep" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>Abbrev:</p>
<p>ENC* WEP: Wired Equivalent Privacy WPA: Wi-Fi Protected Access WPA: i-Fi Protected Access II</p>
<p>Cipher TKIP: Temporal Key Integrity Protocol CCMP: Counter Mode CBC-MAC Protocol</p>
<p>AUTH** PSK: Pre-Shared Key MGT: SKA: Shared Key Authentication</p>
</div></blockquote>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Learning from the field : Wireless Pentesting</a><ul>
<li><a class="reference internal" href="#basics">Basics</a></li>
<li><a class="reference internal" href="#wep">WEP</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="LFFInformationGathering.html"
                        title="previous chapter">Learning from the field : Reconnaissance - Information Gathering</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="LFCReverseEngineering.html"
                        title="next chapter">Learning from the CTF : Reverse Engineering</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="LFCReverseEngineering.html" title="Learning from the CTF : Reverse Engineering"
             >next</a></li>
        <li class="right" >
          <a href="LFFInformationGathering.html" title="Learning from the field : Reconnaissance - Information Gathering"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">tech.bitvijays.com</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, Vijay Kumar.
    </div>
  </body>
</html>