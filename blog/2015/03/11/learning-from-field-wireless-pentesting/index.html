
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Learning From Field : Wireless Pentesting - tech.bitvijays.com</title>
  <meta name="author" content="Vijay Kumar">

  
  <meta name="description" content="Recently, We got a chance to do some penetration testing. This post would cover the basics and approach. Thanks to Girish Nemade Basic wireless &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://bitvijays.github.io/blog/2015/03/11/learning-from-field-wireless-pentesting/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="tech.bitvijays.com" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body    class="collapse-sidebar sidebar-footer" >
  <header role="banner"><hgroup>
  <h1><a href="/">tech.bitvijays.com</a></h1>
  
    <h2>The Magic of Learning.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="sitesearch" value="bitvijays.github.io">
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/about">About</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Learning From Field : Wireless Pentesting</h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2015-03-11T15:28:34+05:30'><span class='date'><span class='date-month'>Mar</span> <span class='date-day'>11</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>3:28 pm</span></time>
        
      </p>
    
  </header>


<div class="entry-content"><p>Recently, We got a chance to do some penetration testing. This post would cover the basics and approach.</p>

<!-- more -->


<p></p>

<h3>Thanks to Girish Nemade</h3>

<p>Basic wireless network tests could be performed by using your wireless adapter installed in your laptop. However, few external USB cards are suggested by Offsec such as</p>

<ol type=i>
<li>Netgear WN111v2 USB</li>
<li>ALFA Networks AWUS036H USB 500mW</li>
</ol>


<p>which provide a better area coverage.</p>

<p><strong>Basics:</strong></p>

<ol>
<li>Set the wireless interface in the monitor mode.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>airmon-ng &lt;start|stop&gt; &lt;interface&gt; [channel] : Enable monitor mode on an interface (and specify a channel).
</span><span class='line'>airmon-ng &lt;check&gt; [kill]                     : List all possible programs that could interfere with the wireless card. If 'kill' is specified, it will try to kill all of them.</span></code></pre></td></tr></table></div></figure>
</li>
<li>Use airodump

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>airodump &lt;monitor interface&gt;
</span><span class='line'>-N, --essid                 : Filter APs by ESSID.                                  ##Name of the Access Point
</span><span class='line'>-d &lt;bssid&gt;, --bssid &lt;bssid&gt; : It will only show networks, matching the given bssid. ##MAC Address of Access Point
</span><span class='line'>-a                          : It will only show associated clients.
</span><span class='line'>-t &lt;OPN|WEP|WPA|WPA1|WPA2&gt;, --encrypt &lt;OPN|WEP|WPA|WPA1|WPA2&gt; : It will only show networks matching the given encryption.
</span><span class='line'>-R, --essid-regex              Filter APs by ESSID using a regular expression</span></code></pre></td></tr></table></div></figure>
</li>   
<li>OPEN
If there is no MAC authentication, and dhcp enabled, your machine would connect automatically. If there is no MAC authentication but dhcp is not enabled, it is advisable to sniff the network using wireshark and find the appropiate network range and the default gateway and set them manually. If there is MAC authentication and DHCP not enabled, you need to find valid associated clients. The catch is the valid associated clients will have an IP address whereas invalid associated clients will not have the IP address.
<br>
Find the associated clients connected to the particular access point by using the csv file produced by airodump. In the below example the access point is "24:DE:C6:C7:92:C2".
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>cat PL-01.csv | grep 24:DE:C6:C7:92:C2 | cut -d , -f 1,6 | grep -v OPN</span></code></pre></td></tr></table></div></figure>
You may change your ip address of wireless adapter using
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>ifconfig wlan4 hw ether 30:5A:3A:B4:09:BC
</span><span class='line'>or 
</span><span class='line'>macchanger
</span><span class='line'>  -m,  --mac=XX:XX:XX:XX:XX:XX
</span><span class='line'>       --mac XX:XX:XX:XX:XX:XX  Set the MAC XX:XX:XX:XX:XX:XX</span></code></pre></td></tr></table></div></figure>
Once associated, we still need to find the valid IP address and valid MAC address, sniff the network, find the network ranges, gateway. Do a nmap Ping Scan to the local subnet which will provide IP address and MAC address. Cross-verify with the associated clients. Valid associated clients will have an IP address and MAC address entry in the airodump listing.
Set the IP address using
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>ifconfig wlan4 10.10.3.71 netmask 255.255.240.0</span></code></pre></td></tr></table></div></figure>
Set the association using
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>iwconfig wlan4 essid "ESSID_NAME" ap "24:DE:C6:C7:92:C2(SSID_MAC_Address)"</span></code></pre></td></tr></table></div></figure></li>
</ol>


<p><strong>WEP</strong></p>

<p>Abbrev:</p>

<p><strong><strong><strong><strong>ENC</strong></strong></strong></strong>*
WEP: Wired Equivalent Privacy
WPA: Wi-Fi Protected Access
WPA: i-Fi Protected Access II</p>

<p><strong><strong><strong>**Cipher</strong></strong></strong>
TKIP: Temporal Key Integrity Protocol
CCMP: Counter Mode CBC-MAC Protocol</p>

<p><strong><strong><strong><em>AUTH</em></strong></strong></strong>**
PSK: Pre-Shared Key
MGT:
SKA: Shared Key Authentication</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Vijay Kumar</span></span>

      




<time class='entry-date' datetime='2015-03-11T15:28:34+05:30'><span class='date'><span class='date-month'>Mar</span> <span class='date-day'>11</span><span class='date-suffix'>th</span>, <span class='date-year'>2015</span></span> <span class='time'>3:28 pm</span></time>
      


    </p>
    
      <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://bitvijays.github.io/blog/2015/03/11/learning-from-field-wireless-pentesting/" data-via="" data-counturl="http://bitvijays.github.io/blog/2015/03/11/learning-from-field-wireless-pentesting/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2015/01/02/learning-from-ctf-reverse-engineering/" title="Previous Post: Learning from CTF : Reverse Engineering">&laquo; Learning from CTF : Reverse Engineering</a>
      
      
        <a class="basic-alignment right" href="/blog/2015/04/09/learning-from-the-field-intelligence-gathering/" title="Next Post: Learning from the field: Intelligence Gathering">Learning from the field: Intelligence Gathering &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    
  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2017 - Vijay Kumar -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'techbitvijays';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://bitvijays.github.io/blog/2015/03/11/learning-from-field-wireless-pentesting/';
        var disqus_url = 'http://bitvijays.github.io/blog/2015/03/11/learning-from-field-wireless-pentesting/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
