
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Learning From CTF : Web Exploitation - My Octopress Blog</title>
  <meta name="author" content="Your Name">

  
  <meta name="description" content="This post (Work in Progress) lists the tips and tricks while doing Web Exploitation challenges during various CTF&rsquo;s. You may want to use your &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://bitvijays.github.io/blog/2014/11/07/learning-from-ctf-web-exploitation/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="My Octopress Blog" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="/javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="//fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="//fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">My Octopress Blog</a></h1>
  
    <h2>A blogging framework for hackers.</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="https://www.google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="sitesearch" value="bitvijays.github.io">
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Learning From CTF : Web Exploitation</h1>
    
    
      <p class="meta">
        




<time class='entry-date' datetime='2014-11-07T00:32:50+05:30'><span class='date'><span class='date-month'>Nov</span> <span class='date-day'>7</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>12:32 am</span></time>
        
      </p>
    
  </header>


<div class="entry-content"><p>This post (Work in Progress) lists the tips and tricks while doing Web Exploitation challenges during various CTF&rsquo;s.</p>

<!-- more -->


<ol>
<li> You may want to use your browser to view the source of the web page. Sometimes, important information is hidden using comments.</li>
<br>
<li> It may be helpful to learn how to 'Inspect Elements' in your browser. It helps you to distinguish each element which might be or not be hidden. </li>
<br>
<li> Some symbols need to be URL Encoded when included in GET requests.
<br>
<table cellpadding="6px" border="1" style="border:1px solid #C0C0C0; border-collapse:collapse; background-color:white;">
<caption>Reserved characters after percent-encoding</caption>
<tr>
<td><code>!</code></td>
<td><code>#</code></td>
<td><code>$</code></td>
<td><code>&amp;</code></td>
<td><code>'</code></td>
<td><code>(</code></td>
<td><code>)</code></td>
<td><code>*</code></td>
<td><code>+</code></td>
<td><code>,</code></td>
<td><code>/</code></td>
<td><code>:</code></td>
<td><code>;</code></td>
<td><code>=</code></td>
<td><code>?</code></td>
<td><code>@</code></td>
<td><code>[</code></td>
<td><code>]</code></td>
</tr>
<tr>
<td><code>%21</code></td>
<td><code>%23</code></td>
<td><code>%24</code></td>
<td><code>%26</code></td>
<td><code>%27</code></td>
<td><code>%28</code></td>
<td><code>%29</code></td>
<td><code>%2A</code></td>
<td><code>%2B</code></td>
<td><code>%2C</code></td>
<td><code>%2F</code></td>
<td><code>%3A</code></td>
<td><code>%3B</code></td>
<td><code>%3D</code></td>
<td><code>%3F</code></td>
<td><code>%40</code></td>
<td><code>%5B</code></td>
<td><code>%5D</code></td>
</tr>
</table>
<br>
<table cellpadding="6px" border="1" style="border:1px solid #C0C0C0; border-collapse:collapse; background-color:white;">
<caption>Common characters after percent-encoding (ASCII or UTF-8 based)</caption>
<tr>
<td>newline</td>
<td>space</td>
<td><code>"</code></td>
<td><code>%</code></td>
<td><code>-</code></td>
<td><code>.</code></td>
<td><code>&lt;</code></td>
<td><code>&gt;</code></td>
<td><code>\</code></td>
<td><code>^</code></td>
<td><code>_</code></td>
<td><code>`</code></td>
<td><code>{</code></td>
<td><code>|</code></td>
<td><code>}</code></td>
<td><code>~</code></td>
</tr>
<tr>
<td><code>%0A</code> <i>or</i> <code>%0D</code> <i>or</i> <code>%0D%0A</code></td>
<td><code>%20</code></td>
<td><code>%22</code></td>
<td><code>%25</code></td>
<td><code>%2D</code></td>
<td><code>%2E</code></td>
<td><code>%3C</code></td>
<td><code>%3E</code></td>
<td><code>%5C</code></td>
<td><code>%5E</code></td>
<td><code>%5F</code></td>
<td><code>%60</code></td>
<td><code>%7B</code></td>
<td><code>%7C</code></td>
<td><code>%7D</code></td>
<td><code>%7E</code></td>
</tr>
</table>
</li>
<br>
<li> In some web exploitation challenges, if the secret is stored on the client side and there are some javascript involved, you could possibly find the answer in the Javascript console, Browser Developer Tools.  (F12 Key).</li>
<br>
<li>Websites keep track of you (Whether you are login-ed or not) by keeping a cookie for you, check that if the value (if easy and most probably assigned linearly) of cookie can be changed to any user who might already be logined.</li>
<br>
<li>If the Login prompt contains SQL query and check contains only one result if (mysqli_num_rows($result) !== 1), then use limit 1 such as admin' or 1=1 limit 1;#
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$username = $_POST["username"];
</span><span class='line'>$password = $_POST["password"];
</span><span class='line'>$query = "SELECT * FROM users WHERE username='$username' AND password='$password'";
</span><span class='line'>$result = mysqli_query($con, $query);
</span><span class='line'>
</span><span class='line'>if (mysqli_num_rows($result) !== 1) {
</span><span class='line'>  echo "&lt;h1&gt;Login failed.&lt;/h1&gt;";
</span><span class='line'>} else {
</span><span class='line'>  echo "&lt;h1&gt;Logged in!&lt;/h1&gt;";
</span><span class='line'>  echo "&lt;p&gt;Your flag is: $FLAG&lt;/p&gt;";
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>
</li>
<li>If the Login prompt contains SQL query and checks only one result, plus have extra checks (see example below), then we can create a fake row SQL whose value we control.
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$con = mysqli_connect("localhost", "sql2", "sql2", "sql2");
</span><span class='line'>$username = $_POST["username"];
</span><span class='line'>$password = $_POST["password"];
</span><span class='line'>$query = "SELECT * FROM users WHERE username='$username'";
</span><span class='line'>$result = mysqli_query($con, $query);
</span><span class='line'>
</span><span class='line'>$logged_in = false;
</span><span class='line'>if (mysqli_num_rows($result) === 1) {
</span><span class='line'>  $row = mysqli_fetch_array($result);
</span><span class='line'>  if ($row["password"] === $password) {
</span><span class='line'>    $logged_in = true;
</span><span class='line'>    echo "&lt;h1&gt;Logged in!&lt;/h1&gt;";
</span><span class='line'>    echo "&lt;pre&gt;User level: ", $row["user_level"],  "&lt;/pre&gt;";
</span><span class='line'>    if ($row["user_level"] &gt;= 1337) {
</span><span class='line'>      echo "&lt;p&gt;Your flag is: $FLAG&lt;/p&gt;";
</span><span class='line'>    } else {
</span><span class='line'>      echo "&lt;p&gt;Only user levels 1337 or above can see the flag.&lt;/p&gt;";
</span><span class='line'>    }
</span><span class='line'>  }
</span><span class='line'>}</span></code></pre></td></tr></table></div></figure>
You have to create a fake query such as
<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>random'AND 1=0 UNION ALL SELECT 'admin' AS username, 'hax' AS password, 2000 AS user_level --
</span><span class='line'>where  
</span><span class='line'>The ' closes the username string and 1=0 will always return false, invalidating the first half.
</span><span class='line'>The union all statement allows us to concatenate two SQL select queries, so we append UNION ALL and then our fake select statement.</span></code></pre></td></tr></table></div></figure>
Don't forget to enter the same password in the password field :P
</li>
<br>
<li>Perl Script running on a webpage, read <a href="http://www.cgisecurity.com/lib/sips.html">Security Issues in Perl Scripts</a></li>
<br>
<li>In some web exploitation excercises, you can modify the GET/POST request in the burpsuite to get the flag.</li>
<br>
</ol>



</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Your Name</span></span>

      




<time class='entry-date' datetime='2014-11-07T00:32:50+05:30'><span class='date'><span class='date-month'>Nov</span> <span class='date-day'>7</span><span class='date-suffix'>th</span>, <span class='date-year'>2014</span></span> <span class='time'>12:32 am</span></time>
      


    </p>
    
      <div class="sharing">
  
  <a href="//twitter.com/share" class="twitter-share-button" data-url="http://bitvijays.github.io/blog/2014/11/07/learning-from-ctf-web-exploitation/" data-via="" data-counturl="http://bitvijays.github.io/blog/2014/11/07/learning-from-ctf-web-exploitation/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2014/11/03/learning-from-vulnhub/" title="Previous Post: Learning from VulnHub">&laquo; Learning from VulnHub</a>
      
      
        <a class="basic-alignment right" href="/blog/2014/11/08/learning-from-ctf-cryptography/" title="Next Post: Learning from CTF : Cryptography">Learning from CTF : Cryptography &raquo;</a>
      
    </p>
  </footer>
</article>

</div>

<aside class="sidebar">
  
    
  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2016 - Your Name -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
